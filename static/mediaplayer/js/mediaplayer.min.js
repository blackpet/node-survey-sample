!function(){"use strict";var e;(e=String.prototype).trim||(e.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});e.isNumber||(e.isNumber=function(){return!!/^([0-9]+)$/.exec(this)});e.includes||(e.includes=function(e,t){"number"!=typeof t&&(t=0);return!(t+e.length>this.length)&&-1!==this.indexOf(e,t)})}();!function(){"use strict";if(!window.getDframework){var t={}.toString,p={};!function(){function e(e,t){p.versionText=t;p.type=e;return p[e]=parseFloat(t)}var t,i,n=navigator.userAgent,r=null,s=null;p.isWindows=!1;p.isMacosx=!1;p.isLinux=!1;if(t=/Mozilla\/([0-9\.]+)[\s\S]+(Windows NT) ([0-9\.]+);/i.exec(n)){p.isWindows=!0;p.mozilla=parseFloat(t[1]);p.mozillaText=t[1];p.os="windows";p.osText=t[2];p.osVersionText=t[3]}else if(t=/Mozilla\/([0-9\.]+)[\s\S]+Macintosh[\s\S]+(Mac OS X)[\s\S]+/i.exec(n)){p.isMacosx=!0;p.mozilla=parseFloat(t[1]);p.mozillaText=t[1];p.os="macosx";p.osText=t[2];p.osVersionText=""}else if(t=/Mozilla\/([0-9\.]+)/i.exec(n)){if(-1!=n.indexOf("Linux")){p.isLinux=!0;p.os="linux"}else p.os="etc";p.mozilla=parseFloat(t[1]);p.mozillaText=t[1];p.osText="";p.osVersionText=""}else{p.mozilla=0;p.mozillaText="0.0";p.os="etc";p.osText="";p.osVersionText=""}p.gecko=-1!=n.indexOf("Gecko");(t=/[\S\s]+Firefox\/([0-9\.]+)/i.exec(n))&&(i=e("firefox",t[1]));(t=/[\S\s]+Safari\/([0-9\.]+)/i.exec(n))&&(i=e("safari",t[1]));(t=/[\S\s]+Chrome\/([0-9\.]+)/i.exec(n))&&(i=e("chrome",t[1]));(t=/[\S\s]+Edge\/([0-9\.]+)/i.exec(n))&&(i=e("edge",t[1]));(t=/[\S\s]+OPR\/([0-9\.]+)/i.exec(n))&&(i=e("opera",t[1]));!i&&(t=/MSIE[\s\S]+?([0-9\.]+)/i.exec(n))&&(i=e("ie",t[1]));i||-1==n.indexOf("Trident/")||-1==n.indexOf("rv:")||(i=e("ie","11.0"));if(p.opera){p._chrome=p.chrome;p._safari=p.safari;p.chrome=p.safari=null}else if(p.chrome){p._safari=p.safari;p.safari=null}p.version=i?Math.floor(i):0;!function(){if(-1!=n.indexOf("Windows CE"))r="ce";else if(-1!=n.indexOf("Windows 95"))r="95";else if(-1!=n.indexOf("Windows 98"))r=-1!=n.indexOf("Win9x4.90")?"me":"98";else if(-1!=n.indexOf("Windows NT 4.0"))r="NT 4.0";else if(-1!=n.indexOf("Windows NT 5.0"))r="2000";else if(-1!=n.indexOf("Windows NT 5.01")){r="2000";s="sp1"}else r=-1!=n.indexOf("Windows NT 5.1")?"xp":-1!=n.indexOf("Windows NT 5.2")?"2003":-1!=n.indexOf("Windows NT 6.0")?"vista":-1!=n.indexOf("Windows NT 6.1")?"7":-1!=n.indexOf("Windows NT 6.2")?"8":-1!=n.indexOf("Windows NT 6.3")?"8.1":-1!=n.indexOf("Windows NT 6.4")?"10":null;p.osAlias=r;p.osSp=s;p.osAlias&&(p.isWindows=!0)}();p.isMobile=!0;p.iOS=!1;p.ios=!1;var a=n.toLowerCase();if(t=/Android[\s]+([0-9\.]);/i.exec(n)){p.androidText=t[1];p.android=parseFloat(t[1]);p.android||(p.android=!0)}else if(t=/(Android)/i.exec(n)){if(t=/Android[\s]+([0-9\.]+)/i.exec(n)){p.androidVersion=t[1];p.android=parseFloat(t[1])}p.android||(p.android=!0)}else if(-1!==a.indexOf("android"))p.android=!0;else if(t=/(iPhone)/i.exec(n)){if(t=/[\s]+Version\/([0-9\.]+)/i.exec(n)){p.iphoneVersion=t[1];p.iphone=parseFloat(t[1])}p.iphone||(p.iphone=!0)}else if(-1!==a.indexOf("iphone"))p.iphone=!0;else if(t=/(iPad)/i.exec(n)){if(t=/[\s]+Version\/([0-9\.]+)/i.exec(n)){p.ipadVersion=t[1];p.ipad=parseFloat(t[1])}p.ipad||(p.ipad=!0)}else-1!==a.indexOf("iphone")?p.iphone=!0:(t=/(iPod)/i.exec(n))?p.ipod=!0:(t=/(blackberry)/i.exec(n))?p.blackberry=!0:(t=/(webos)/i.exec(n))?p.webos=!0:(t=/(windows phone)/i.exec(n))?p.windowsPhone=!0:p.isMobile=!1;(p.iphone||p.ipad||p.ipod)&&(p.ios=p.iOS=!0);p.isWindows||delete p.isWindows;p.isMacosx||delete p.isMacosx;p.isLinux||delete p.isLinux;p.isMobile||delete p.isMobile;p.iOS||delete p.iOS;p.ios||delete p.ios;p.androidVersion||delete p.androidVersion;p.android||delete p.android}();var y,m,e,g,c,o,n,u,l=!!window.addEventListener||!window.attachEvent&&undefined,h=(Object.defineProperty,{}),E={},i={},b={},T={},w={},r=function(){var e=!(p.ie&&p.ie<9)&&typeof Element,t=("function"==e||"object"==e)&&Element.prototype;if(t){t._duitest=function(){return this.nodeName};if("a"==document.createElement("a")._duitest().toLowerCase()){delete t._duitest;return!0}delete t._duitest}return!1}(),s="DFWLANG";window.getDframework=function(){return y};(y={version:"0.0.4.4",b:p,bstyle:["-ms-","-webkit-","-khtml-","-moz-","-o-"],error:function(e,t,i,n,r,s,a){try{var o=window.console&&window.console.error,l=y.b;o&&(l.ie?a!==undefined?o(e,t,i,n,r,s,a):s!==undefined?o(e,t,i,n,r,s):r!==undefined?o(e,t,i,n,r):n!==undefined?o(e,t,i,n):i!==undefined?o(e,t,i):t!==undefined?o(e,t):e!==undefined&&o(e):o.apply(this,arguments))}catch(u){}},log:function(e,t,i,n,r,s,a){try{var o=window.console&&window.console.log;o&&(p.ie?a!==undefined?o(e,t,i,n,r,s,a):s!==undefined?o(e,t,i,n,r,s):r!==undefined?o(e,t,i,n,r):n!==undefined?o(e,t,i,n):i!==undefined?o(e,t,i):t!==undefined?o(e,t):e!==undefined&&o(e):o.apply(this,arguments))}catch(l){}},warn:function(e,t,i,n,r,s,a){try{var o=window.console&&window.console.warn;o&&(p.ie?a?o(e,t,i,n,r,s,a):s?o(e,t,i,n,r,s):r?o(e,t,i,n,r):n?o(e,t,i,n):i?o(e,t,i):t?o(e,t):e&&o(e):o.apply(this,arguments))}catch(l){}},toString:function(e){return t.call(e)},scriptUrl:function(e,t){function i(){if(t)throw new TypeError("Not found "+e+" name at script elements.");return!1}var n,r=document.getElementsByTagName("script"),s=r[r.length-1],a=s.src.lastIndexOf("/"),o=-1==a?s.src:s.src.substring(0,a);return(n=new RegExp("[\\S]*/("+e+")\\?{0,1}[\\S]*","i").exec(s.src))?n[1]!==e?i():s.baseurl?s.baseurl:o:i()},setNamespaceUrl:function(e,t){var i=h[e];if(i)return i===t?undefined:y.error("Aleady has namespace. ns: "+e,NaN+i+", new-url: "+t);h[e]=t},getNamespaceUrl:function(e){var t=e.indexOf("/"),i=-1==t?e:e.substring(0,t);return h[i]?h[i]:""},namespaceurl:function(e,t){var i=e.indexOf("/"),n=-1==i?e:e.substring(0,i),r=-1==i?"":e.substring(i),s=t&&"string"==typeof t?0===t.indexOf(".")?t:"."+t:"";return h[n]?h[n]+r+s:e+s},define:function(e,t,i){var n=typeof E[e];if("undefined"!=n&&null!==n)throw new TypeError("Already defined module. name: "+e);var r=typeof t,s=typeof i;if("function"==r)return E[e]=t.apply(this);if("function"==s){var a=[];"string"==r?a.push(E[t]):t.length&&y.each(t,function(e){a.push(E[e])});return E[e]=i.apply(this,a)}return"undefined"==r&&null===t?t:E[e]=t},module:function(e){var t,i,n,r,s=[];if("string"==typeof e){r=!0;e=[e]}y.each(e,function(e){if(-1!=(t=e.lastIndexOf("#"))){i=e.substring(t+1).trim();e=e.substring(0,t).trim()}n=E[e];i&&(n=n[i]);n&&s.push(n)});return r?s[0]:s},require:function(e,t,i,s){function r(e,n){var r=y.namespaceurl(e),t={url:r,error:function(e){n(null,e||"Not load "+r)},success:function(e,t,i){if(200!=t)return n(null,"Not load "+r+". status: "+t);n(e)}};s&&s.headers&&(t.headers=s.headers);y.ajax(t)}function a(e,t,i,n,r){if(i){if(!t[i])return new Error("Not found module shap special member. name: "+n+", shap: "+i+", loaded-url: "+r);e.push(t[i])}else e.push(t)}function o(e,t,i,n,r){var s;if(i){if(!(s=y.query(t,'[viewid="'+i+'"]')))return new Error("Not found element shap special member. name: "+n+", shap: "+i+", loaded-url: "+r);e.push(s)}else e.push(t)}var l,u,c,h,d,f,p=[],n=[];"string"==typeof e?n.push(e):n=e;m.each.call(this,n,function(i,n){if(0===(i=i.trim()).indexOf("text://")){u="text";i=i.substring(7)}else if(0===i.indexOf("html://")){u="html";i=i.substring(7)}else if(0===i.indexOf("resource://")){u="resource";i=i.substring(11)}if(-1!=(f=i.lastIndexOf("#"))){d=i.substring(f+1).trim();i=i.substring(0,f).trim()}else d=!1;switch(u){case"text":if(!(c=b[i]))return r(i,function(e,t){if(!t){b[i]=e;p.push(e)}n(t)});p.push(c);return n();case"html":return(c=T[i])?n(o(p,c,d,i,l)):(h=b[i])?n(o(p,T[i]=y.element(h),d,i,l)):r(i,function(e,t){if(!t){b[i]=e;return n(o(p,T[i]=y.element(e),d,i,l))}n(t)});case"resource":if(!(c=w[i])){l=y.namespaceurl(i);throw new TypeError("require: Not surport resource mode.")}p.push(c);return n();default:if(!(c=E[i])){l=y.namespaceurl(i,"js");return y.loadScript(l,function(e){e||(e=(c=E[i])?a(p,c,d,i,l):new Error("Not found module. name: "+i+", loaded-url: "+l));n(e)})}err=a(p,c,d,i,l);return n(err)}},function(e){if(e){y.error(e);i&&i.call(this,e)}else t.apply(this,p)})},hasCssString:function(e,t){var i,n=0;if((t=t||document).createStyleSheet&&(i=t.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===e)return!0}else if(i=t.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===e)return!0;return!1},importCssString:function(e,t,i){i=i||document;if(t&&y.hasCssString(t,i))return null;var n;t&&(e+="\n/*# sourceURL=dframework/css/"+t+" */");if(i.createStyleSheet){(n=i.createStyleSheet()).cssText=e;t&&(n.owningElement.id=t)}else{(n=document.createElement("style")).appendChild(i.createTextNode(e));t&&(n.id=t);y.getDocumentHead(i).appendChild(n)}},importCssStylsheet:function(e,t){t||(t=document);if(t.createStyleSheet)t.createStyleSheet(e);else{var i=document.createElement("link");i.rel="stylesheet";i.href=e;y.getDocumentHead(t).appendChild(i)}},parseCss:function(e){for(var t,i,n,r,s,a,o,l,u,c,h=[];;){if(-1==(t=e.indexOf("{"))||-1==(i=e.indexOf("}",t)))return h;if((n=e.substring(0,t).trim())&&(r=e.substring(t+1,i).trim())){a=r.split(";");l=[];for(s=0;s<a.length;s++)-1!=(u=(o=a[s].trim()).indexOf(":"))?(c=o.substring(0,u).trim())&&l.push({name:c,value:o.substring(u+1).trim()}):o&&l.push({name:o,value:""});h.push({name:n,value:r,childs:l})}if(!(e=e.substring(i+1).trim()))return h}},importJteStyleParsed:function(e){function t(e){var t,i,n,r,s,a,o,l="",u={};y.each(e,function(e){if(t=/^(-[\S]+?-)([\S]+)$/i.exec(e.name)){i=t[2];switch(t[0]){case"-ms-zoom":break;default:u[i]||(u[i]=[]);return u[i].push({b:t[1],val:e.value})}}l+=e.name+": "+e.value+"; "});for(r in u){o={text:"",bs:{},val:""};for(a=0;a<u[r].length;a++){s=u[r][a];o.bs[s.b]=1;o.val=s.val;o.text+=s.b+r+": "+s.val+"; "}for(a=0;a<y.bstyle.length;a++){i=y.bstyle[a];if(!o.bs[i]){o.text+=i+r+": "+o.val+"; ";o.bs[i]=2}}o.text+=r+": "+o.val+"; ";o.bs.x=2;n=o.val;(t=/scale\(([\S\s]+?)\)/i.exec(n))&&((i=/(\-ms\-zoom[\s]*?\:)/i.exec(l))||(o.text+="-ms-zoom: "+t[1]+"; "));l+=o.text}return l}y.isArray(e)?y.each(e,function(e){e.text=t(e.childs)}):e.childs&&(e.text=t(e.childs))},importJteStyleText:function(e,t){var i=y.parseCss(e),n="";y.importJteStyleParsed(i);y.each(i,function(e){n+=e.name+" { "+e.text+" }\n"});y.importCssString(n,t?t.id:"")},importJteStyleElement:function(e){var t=y.attrs(e);"jte-style"==t.type&&(t.type="text/style");y.importJteStyleText(e.innerHTML,t)},computedStyle:function(e,t){return t?window.getComputedStyle(e).getPropertyValue(t):window.getComputedStyle(e)},addPrefixStyle:function(e,t){var i,n,r,s=document.createElement("style"),a="",o=t.split("\n");for(i in o)if((r=o[i].trim()).length)if(-1!=(n=r.indexOf("{"))){var l=r.substring(0,n).trim(),u=r.substring(n).trim();l||u||(a+=e+" "+l+" "+u+"\n")}else y.error('Not found "{" in \''+r+"'");s.innerText=a;document.body.appendChild(s)},getDocument:function(e){return e||document},getDocumentHead:function(e){return(e=y.getDocument(e)).head||e.getElementsByTagName("head")[0]||e.documentElement},loadScript:function(i,n){var e=y.getDocumentHead(),r=document.createElement("script");r.src=i;r.type="text/javascript";r.async=!0;r.onload=r.onreadystatechange=function(e,t){if(t||!r.readyState||"loaded"==r.readyState||"complete"==r.readyState){r=r.onload=r.onreadystatechange=null;if(!n&&t)throw new Error("Abort load "+i);n&&(t?n(new Error("Abort load "+i)):n())}};r.onerror=function(){r.onerror=null;n&&n(new Error("Not load "+i))};e.appendChild(r);y.b.ie&&y.b.ie<9||r.parentNode.removeChild(r)},__guids:{},guid:function(e){void 0===e&&(e="-");function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}for(var i;;){i=t()+t()+e+t()+e+t()+e+t()+e+t()+t()+t();if(!y.__guids[i]){y.__guids[i]=!0;return i}}},uname:function(e,t){if("function"!=typeof e&&"object"!=typeof e)return y.error(new Error("uname argument is function or object."));for(var i,n,r;;){i="A"+y.guid("");if(!window[i]){r=window[i]=e;if(t)for(n in t)r[n]=t[n];return r.uname=i}}},extendClass:function(e,t,i){e.prototype=new t;e.prototype.constructor=e;if(i)for(var n in i)e.prototype[n]=i[n];e.__super=new t;return e},url:function(e){var t=DFrameworkJson;return t&&(t=t.dframework)&&(t=t.workPath)?t+e:e},sortNumber:function(e){return e.sort(function(e,t){return e-t})},isArray:function(e){return"[object Array]"===t.call(e)},isElement:function(e){function t(e){return e instanceof HTMLElement}function i(e){return e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}if(e&&"object"==typeof HTMLElement)return(y.isElement=t)(e);if(i(e)){y.isElement=i;return!0}return!1},initDui:function(){if(!u){(u=document.createElement("div")).style.display="none";y.attr(u,"id","dui-saved-element");y.attr(u,"dui-saved-element","true");y.append(document.body,u)}},appendDui:function(e){y.initDui();y.append(u,e)},copy:function(e,t){for(var i in t)e[i]=t[i]},each:function(e,t){var i,n="function";if(!y.isArray(e))return typeof t==n?t.call(this,e):typeof e==n&&e.call(this);if(typeof t==n)for(i=0;i<e.length;i++)t.call(this,e[i]);else if(typeof e[0]==n)for(i=0;i<e.length;i++)e[i].call(this);e=t=null},on:function(e,t,i,n,r,s){function a(e,t,i,n,r,s){if(!y.isArray(e))return l?e.addEventListener(t,i,n,r,s):e.attachEvent("on"+t,i,n,r,s);var a;for(a=0;a<e.length;a++)l?e[a].addEventListener(t,i,n,r,s):e[a].attachEvent("on"+t,i,n,r,s)}if(void 0===l){if(void 0===(l=!!e.addEventListener||!e.attachEvent&&undefined))throw new TypeError("Not found element add event listener or attach event.");return a(e,t,i,n,r,s)}return(y.on=a)(e,t,i,n,r,s)},off:function(e,t,i){function n(e,t,i){if(!y.isArray(e))return l?e.removeEventListener(t,i):e.detachEvent("on"+t,i);var n;for(n=0;n<e.length;n++)l?e[n].removeEventListener(t,i):e[n].detachEvent("on"+t,i)}if(void 0===l){if(void 0===(l=!!e.removeEventListener||!e.detachEvent&&undefined))throw new TypeError("Not found element add event listener or attach event.");return n(e,t,i)}return(y.off=n)(e,t,i)},parseInt:function(e,t){var i=parseInt(e);return isNaN(i)?"number"==typeof t?t:-1:i},cursor:function(e,t){var i;if(t){"hand"==t&&(t="pointer");if(y.isElement(e))e.style.cursor=t;else if(y.isArray(e))for(i=0;i<e.length;i++)e[i].style.cursor=t}else if(1<arguments.length)if(y.isElement(e))e.style.cursor="";else if(y.isArray(e))for(i=0;i<e.length;i++)e[i].style.cursor="";if(y.isElement(e))return e.style.cursor},param:function(e,t){if(!t&&c)return c[e];var i,n,r,s,a=t||document.location.href,o=a.indexOf("?"),l=(-1==o?a:a.substring(o+1)).split("&"),u={};for(n=0;n<l.length;n++){r=(i=l[n].split("=",2))[0].trim();s=1<i.length?i[1].trim():"";r?u[r]=decodeURI(s):s&&(u[r]="="+decodeURI(s))}t||(c=u);return u[e]},makeUrl:function(e,t){var i,n="";for(i in t)n=n?n+"&"+i+"="+encodeURI(t[i]):i+"="+encodeURI(t[i]);return e+(n?"?"+n:"")},location:function(){},query:function(e,t){if("string"==typeof e){t=e;e=document}var i=e.querySelector?function(e,t){if("string"==typeof e)return document.querySelector(e);if(y.isElement(e)||e===document)return e.querySelector(t);if(y.isArray(e)){var i,n;for(i=0;i<e.length;i++)if(n=e[i].querySelector(t))return n}return null}:y.jQuery?function(e,t){var i;if("string"==typeof e)return(i=y.jQuery(document).find(e))&&i.length?i[0]:null;if(y.isElement(e)||e===document)return(i=y.jQuery(e).find(t))&&i.length?i[0]:null;if(y.isArray(e)){var n,r;for(n=0;n<e.length;n++)if((i=y.jQuery(e[n]).find(t))&&i.length&&(r=i[0]))return r}return null}:null;return i?(y.query=i)(e,t):null},queryAll:function(e,t){if("string"==typeof e){t=e;e=document}var i=e.querySelectorAll?function(e,t){if("string"==typeof e){t=e;e=document}var i,n=[],r=e.querySelectorAll(t);for(i=0;i<r.length;i++)n.push(r[i]);return n}:y.jQuery?function(e,t){if("string"==typeof e){t=e;e=document}var i,n=[],r=y.jQuery(e).find(t);for(i=0;i<r.length;i++)n.push(r[i]);return n}:null;return i&&(y.queryAll=i)?i(e,t):null},checkedName:function(e,t,i){var n=y.queryAll(e,t),r=[];y.each(n,function(e){e.checked&&r.push(e)});return r},element:function(e){var t,i,n,r,s,a,o,l,u,c,h,d=e.trim(),f=/^<([\S]+?)[\s|>|\/]/.exec(d),p=f&&2==f.length?f[1]:null;if(!p)return null;function m(e){var t=document.createElement("div");t.innerHTML=e;return t}function g(e,t){var i=m("<"+t+">"+e+"</"+t+">"),n=y.childs(i.children[0]);return 1<n.length?n:1==n.length?n[0]:null}switch(p.toLowerCase()){case"thead":case"tbody":return g(d,"table");case"tr":return c=m("<"+(l="table")+"><"+(u="tbody")+">"+d+"</"+u+"></"+l+">"),1<(h=y.childs(c.children[0].children[0])).length?h:1==h.length?h[0]:null;case"td":case"th":return a=m("<"+(n="table")+"><"+(r="tbody")+"><"+(s="tr")+">"+d+"</"+s+"></"+r+"></"+n+">"),1<(o=y.childs(a.children[0].children[0].children[0])).length?o:1==o.length?o[0]:null;case"option":return g(d,"select");default:return t=m(d),1<(i=y.childs(t)).length?i:1==i.length?i[0]:null}},append:function(e,t){var i;if(y.isElement(e))if(y.isElement(t))e.appendChild(t);else if(y.isArray(t))for(i=0;i<t.length;i++)e.appendChild(t[i])},parent:function(e,t){if(!t)return e.parentNode;y.before(e,t);y.remove(e);t.appendChild(e)},first:function(e,t){if(t){e.children&&e.children.length?e.insertBefore(t,e.children[0]):e.appendChild(t);return t}if(e.children&&e.children.length)return e.children[0]},last:function(e,t){if(t){e.appendChild(t);return t}if(e.children&&e.children.length)return e.children[e.children.length-1]},before:function(e,t){if(!t){if(!1===t)return e.previousSibling;for(;;){if(!(e=e.previousSibling))return;if(y.isElement(e))return e}}e.parentNode.insertBefore(t,e);return t},after:function(e,t){var i;if(!t)return e.nextSibling;if(e.nextSibling)return y.before(e.nextSibling,t);(i=y.parent(e))&&i.appendChild(t);return t},childs:function(e){var t,i=[];for(t=0;t<e.children.length;t++)i.push(e.children[t]);return i},childAll:function(e){var t,i=[];for(t=0;t<e.childNodes.length;t++)i.push(e.childNodes[t]);return i},removeElement:function(e){e.parentElement.removeChild(e)},remove:function(e,t){if(y.isArray(e)&&"number"==typeof t)return e.splice(t,1);if(y.isElement(e)){var i=typeof t;if("string"==i)return e.removeAttribute(t);if("undefined"==i&&e.parentElement)return e.parentElement.removeChild(e)}},removeChildAll:function(e){if(y.isElement(e))for(var t=y.childs(e),i=t.length-1;0<=i;i--)y.remove(t[i])},save:function(e){function t(e){y.remove(e)}if(p.ie&&p.ie<9){var i=document.createElement("div");i.style.display="none";n=i;y.appendDui(i);y.save=function(e){y.append(n,e)};return y.append(n,e)}return(y.save=t)(e)},val:function(e,t,i){var n,r,s,a,o=typeof i;if(y.isElement(e))switch(e.nodeName.toLowerCase()){case"select":s=!1;if("undefined"!=(o=typeof(i=t))&&"object"!=o){for(n=0;n<e.options.length;n++)if((r=e.options[n]).value){if(r.value===i){s=e.selectedIndex=n;break}}else if(r.text===i){s=e.selectedIndex=n;break}if(!1===s)return!1}return e.options[e.selectedIndex].value;case"option":case"input":return"undefined"==o||"object"==o?e.value:e.value=i;default:switch(t.toLowerCase()){case"outerhtml":return"undefined"==o||"object"==o?e.outerHTML:e.outerHTML=i;case"html":return"undefined"==o||"object"==o?e.innerHTML:e.innerHTML=i;default:return"undefined"==o||"object"==o?e.innerText:e.innerText=i}}else if(y.isArray(e)&&e.length&&y.isElement(a=e[0]))switch(a.nodeName.toLowerCase()){case"input":switch(a.getAttribute("type")){case"radio":for(n=0;n<e.length;n++)if(e[n].checked)return y.val(e[n])}}return""},hasAttr:function(e,t){return e.hasAttribute?e.hasAttribute(t):null!==(v=e.getAttribute(t))},attr:function(e,t,i){return arguments.length<3?e.getAttribute(t):e.setAttribute(t,i)},attrs:function(e){y.attrs=p.ie&&p.ie<8?function(e){var t,i,n,r={},s=e.attributes;if(!s)return r;for(t=0;t<s.length;t++){i=s[t];null!==(n=e.getAttribute(i.name))&&""!==n&&(r[i.name]=n)}return r}:function(e){var t,i,n={},r=e.attributes;if(!r)return n;for(t=0;t<r.length;t++)n[(i=r[t]).name]=i.value;return n};return y.attrs(e)},duiAttr:function(e,t,i){y.duiAttr=!r||p.ie&&p.ie<9?function(e,t,i){var n="--dui-attr-"+t;return arguments.length<3?e[n]:e[n]=i}:function(e,t,i){var n=e.dui.__attr;return arguments.length<3?n[t]:n[t]=i};return y.duiAttr(e,t,i)},hasDuiAttr:function(e,t){y.hasDuiAttr=!r||p.ie&&p.ie<9?function(e,t){var i="--dui-attr-"+t;return null!==e[i]&&"undefined"!=typeof e[i]}:function(e,t){return"undefined"!=typeof e.dui.__attr[t]};return y.hasDuiAttr(e,t)},duiAttrs:function(e){return e.dui&&e.dui.__attr?e.dui.__attr:{}},includes:function(e,t,i){return function(e){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");var t,i=Object(this),n=parseInt(i.length,10)||0;if(0===n)return!1;var r,s=parseInt(arguments[1],10)||0;0<=s?t=s:(t=n+s)<0&&(t=0);for(;t<n;){if(e===(r=i[t])||e!=e&&r!=r)return!0;t++}return!1}.call(e,t,i)},addClass:function(e,t){function i(t,e){var i=[];y.each(e.split(" "),function(e){e&&(e=e.trim())&&i.push(e)});y.each(i,function(e){!function(e,t){if(e.classList)return e.classList.add(t);y.hasClass(e,t)||(e.className?e.className+=" "+t:e.className=t)}(t,e)})}if(!y.isArray(e))return i(e,t);for(var n=0;n<e.length;n++)i(e[n],t)},removeClass:function(e,t){var i=[],n=e.className.split(" "),r="";y.each(t.split(" "),function(e){e&&(e=e.trim())&&i.push(e)});y.each(n,function(e){e&&(e=e.trim())&&(y.includes(i,e)||(r?r+=" "+e:r=e))});e.className=r},hasClass:function(e,t){if(e.classList)return e.classList.contains(t);var i,n=e.className.split(" ");for(i=0;i<n.length;i++)if(n[i]&&n[i].trim()===t)return!0;return!1},toggleClass:function(e,t){if(e.classList)return e.classList.toggle(t);y.hasClass(e,t)?y.removeClass(e,t):y.addClass(e,t)},stringPad:function(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e},formatBytes:function(e,t){if(0===e)return"0 Bytes";var i=t||2,n=Math.floor(Math.log(e)/Math.log(1024)),r=parseFloat((e/Math.pow(1024,n)).toFixed(i));return(t?r.toFixed(i):r)+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},byteLength:function(e){var t,i,n;for(t=i=0;n=e.charCodeAt(i++);t+=n>>11?3:n>>7?2:1);return t},target:function(e){return e.target?e.target:e.srcElement?e.srcElement:e.toElement?e.toElement:undefined},urlencoded:function(e){return encodeURI(e)},getBoundingClientRect:function(e){var t=e.getBoundingClientRect(),i=y.math.rect();i.left=t.left;i.top=t.top;i.right=t.right;i.bottom=t.bottom;return i},getElementsByPoint:function(s,a){var e,t,o=[],i=[],n=0,r=0,l=a&&a.document?a.document:document;function u(e){var t,i,n=y.getBoundingClientRect(e).contains(s),r=!1;if(!e.children||e.children&&0===e.children.length)return!!n&&(o.push(e)||1);for(i=0;i<e.children.length;i++){t=e.children[i];!y.hasClass(t,"dui-devel-ui")&&u(t)&&(r=!0)}return!r&&n||r&&a&&a.isparent?o.push(e)||1:r}if(l.body.children)for(e=0;e<l.body.children.length;e++)(t=l.body.children[e]).classList.contains("dui-devel-ui")||u(t);if(1<o.length){o.forEach(function(e){e.children&&0<e.children.length?n++:r++});if((!a||!a.isparent)&&r&&n){o.forEach(function(e){e.children&&0<e.children.length||i.push(e)});return i.length?i:null}}return o.length?o:null},getCompatElement:function(e){var t=e.getDocument();return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.html},getCompatMode:function(e){return e.compatMode&&"CSS1Compat"!=e.compatMode?e.body:e.html},scrollTop:function(e){if(0===window.scrollY||window.scrollY){(e||0===e)&&(window.scrollTo?window.scrollTo(window.scrollX,e):window.scrollY=e);return window.scrollY}var t="CSS1Compat"===(document.compatMode||"")?document.documentElement:document.body;return e||0===e?t.scrollTop=e:t.scrollTop},scrollLeft:function(e){if(0===window.scrollX||window.scrollX){(e||0===e)&&(window.scrollTo?window.scrollTo(e,window.scrollY):window.scrollX=e);return window.scrollX}var t="CSS1Compat"===(document.compatMode||"")?document.documentElement:document.body;return e||0===e?t.scrollLeft=e:t.scrollLeft},fileSize:function(e){return e<1024?e+" b":e<1048576?(e/1024).toFixed(1)+" Kb":e<1073741824?(e/1048576).toFixed(1)+" Mb":(e/1073741824).toFixed(1)+" Gb"},event:function(e,t){function i(e,t){var i=document.createEvent("Event"),n=!t||"boolean"!=typeof t.bubbles||t.bubbles,r=!t||"boolean"!=typeof t.cancelable||t.cancelable,s=t?t.detail:undefined;i.initEvent(e,n,r,s);return i}function n(e,t){t=t||{bubbles:!0,cancelable:!0,detail:undefined};return new Event(e,t)}return document.createEvent?(y.event=i)(e,t):window.Event?(y.event=n)(e,t):void 0},keyCode:{ENTER:13,SPACE:32,ESCAPE:27,ENDED:-1},ready:function(e){if("complete"==document.readyState||"loading"!=document.readyState&&!document.documentElement.doScroll)return e();!p.ie||p.ie&&9<=p.ie&&10!=p.ie?y.on(document,"DOMContentLoaded",function(){e()}):y.on(window,"load",function(){e()})},load:function(e){y.on(window,"load",e)},alert:function(e,t){alert(e);return t},confirm:function(e,t){confirm(e);return t},supportFileApi:function(){var e=document.createElement("INPUT");e.type="file";return"files"in e},supportProgressEvent:function(){var e=O.getRequest();return!!(e&&"upload"in e&&"onprogress"in e.upload)},supportFormData:function(){return!!window.FormData},supportUploadProgress:function(){return y.supportFileApi()&&y.supportProgressEvent()&&y.supportFormData()},toJson:function(e){y.toJson=p.ie&&p.ie<9?function(e){var t;try{t=y.jQuery.parseJSON(e)}catch(i){y.error("parse error: ",e);throw i}return t}:function(e){var t;try{t=JSON.parse(e)}catch(i){y.error("parse error: ",e);throw i}return t};return y.toJson(e)},json:function(e){if(DFrameworkJson&&"undefined"!=typeof DFrameworkJson[e])return DFrameworkJson[e]},ajax:function(e){return new O(e)},ajaxJson:function(a){var o=a.error,l=a.success;a.error=function(e){if(a.no_result_error)return o?o(e):null;y.ui.alert("Error",{close:function(){o&&o(e)}})};a.success=function(e,t,i){var n,r;try{n=y.toJson(e)}catch(s){y.error(s);r="Not parse result."}if(r||n&&!n.result){r||(r=n.error_msg?n.error_msg:"Error");if(a.no_result_error)return o?o(i,r):null;y.ui.alert(r,{close:function(){o&&o(i)}})}else a.no_result_ok?l&&l(n,i):y.ui.alert("Success.",{close:function(){l&&l(n,i)}})};return y.ajax(a)},cookie:function(e,t,i){o=function(){var e,t,i,n,r,s=[],a=document.cookie,o=a?a.split(";"):null;if(o)for(e in o){i=(t=o[e]).indexOf("=");n=t.substring(0,i).trim();r=t.substring(i+1).trim();s.push({name:n,value:r})}return s}();y.cookie=function(e,t,i){if(1===arguments.length){var n,r=o;for(n=0;n<r.length;n++)if(r[n].name===e)return r[n].value}else if(1<arguments.length){i||(i={});i.path||(i.path="/");var s=e+"="+escape(t)+"; path="+i.path;if(i.seconds){var a=new Date;a.setTime(a.getTime()+i.seconds);s+="; expires="+a.toGMTString()}o.push({name:e,value:t,attr:i});document.cookie=s}};return 1===arguments.length?y.cookie(e):2==arguments.length?y.cookie(e,t):3==arguments.length?y.cookie(e,t,i):void 0},lang:function(e){e&&y.cookie(s,e);return y.cookie(s)},igEventAll:function(e){"function"==typeof e.preventDefault&&e.preventDefault();"function"==typeof e.stopPropagation&&e.stopPropagation();"function"==typeof e.stopImmediatepropagation&&e.stopImmediatepropagation();if(y.b.ie&&y.b.ie<9){var t=e.srcElement||e.target;t?t.dframework_igeventall=!0:y.warn("Not found target element.",e)}return!1},contains:function(e,t){if(y.isArray(e)){var i;for(i=0;i<e.length;i++)if(e[i]===t)return!0;return!1}},onlyNumber:function(e){y.on(e,"keydown",function(e){var t=e.keyCode;if(!y.contains([46,8,9,27,13,110,190],t)&&(65!=t&&67!=t&&88!=t||!0!==e.ctrlKey&&!0!==e.metaKey)&&!(35<=t&&t<=39||96<=t&&t<=105||!e.shiftKey&&48<=t&&t<=57))return y.igEventAll(e)})},offset:function(e,t){if(t){e.style.top=t.top+"px";e.style.left=t.left+"px"}return y.getBoundingClientRect(e)},height:function(e){return y.offset(e).height()},width:function(e){return y.offset(e).width()},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),r=new Uint8Array(n),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return new Blob([n],{type:i})},open:function(e){if(!e)return window.open();if("string"==typeof e)return window.open(e);if("object"!=typeof e)return window.open();var t,i,n,r,s,a,o="boolean"==typeof e.replace?e.replace:"true"==e.replace||"false"!=e.replace&&null,l=e.specs?e.specs:{},u="";if("string"==(a=typeof l)){i=l.split(",");l={};for(r=0;r<i.length;r++)(s=(n=i[r].split("=",2))[0].trim())&&(1<n.length?l[s]=n[1].trim():l[s]="")}else"object"!=a&&(l={});e.width&&(l.width=e.width);e.height&&(l.height=e.height);e.top&&(l.top=e.top);e.left&&(l.left=e.left);function c(e,t,i){var n=t[i],r=typeof n;!r||"string"!=r&&"number"!=r&&"boolean"!=r||(e[i]="true"==n||!0===n?"yes":"false"==n||!1===n?"no":n)}c(l,e,"channelmode");c(l,e,"directories");c(l,e,"fullscreen");c(l,e,"location");c(l,e,"menubar");c(l,e,"resizable");c(l,e,"scrollbars");c(l,e,"status");c(l,e,"titlebar");c(l,e,"toolbar");if(!0===e.notab||"true"==e.notab){l.width||(l.width=300);l.height||(l.height=300)}for(s in l)u+=s+"="+l[s]+"; ";t="boolean"==typeof o?window.open(e.url,e.name,u,o):u?window.open(e.url,e.name,u):e.name?window.open(e.url,e.name):window.open(e.url);var h=["load","ready","unload","pageshow","close"];for(r=0;r<h.length;r++){h[r];"function"==typeof e[s]&&y.on(t,s,an)}return t},worker:function(e){if(!window.Worker)return y.error(new Error("Not support Worker class."));if("object"!=typeof e)return y.error(new TypeError("worker arguments is null."));if(!e.url||"string"!=typeof e.url)return y.error(new TypeError("worker url is js filepath string."));var t=y.namespaceurl(e.url,"js"),i=new Worker(t);i.args=e;i.namespaceurl=t;"function"==typeof e.message&&(i.onmessage=function(){e.message.apply(i,arguments)});"function"==typeof e.error&&(i.onerror=function(){e.error.apply(i,arguments)});"function"==typeof e.ready&&setTimeout(function(){e.ready.apply(i)},1);return i},websocket:function(t){if(!window.WebSocket)return y.error(new Error("Not support WebSocket class."));if("object"!=typeof t)return y.error(new TypeError("web socket arguments is null."));if(!t.url||"string"!=typeof t.url)return y.error(new TypeError("web socket url is server url string."));var i,e=-1!=t.url.indexOf("://")?y.namespaceurl(t.url,""):t.url;try{i=new WebSocket(e,t.protocol?t.protocol:"")}catch(n){return t.error?t.error(n):null}i.onopen=function(e){"function"==typeof t.connect&&t.connect.apply(i,arguments)};t.message&&(i.onmessage=t.message);t.error&&(i.oneror=t.error);t.close&&(i.onclose=t.close);return i},upload:function(r,e){return window.WebSocket?window.FileReader?r?y.worker({url:"dframework/worker/uploader",ready:function(){this.postMessage({type:"init",data:{url:r.url,file:r.file,sleepTime:r.sleepTime,readBytes:r.readBytes,sendBytes:r.sendBytes,data:r.data}})},message:function(e){var t=e.data,i=t.type,n=t.data;switch(i){case"init":case"ready":break;case"progress":"function"==typeof r.progress&&r.progress(n);break;case"error":"function"==typeof r.error&&r.error(t)}},error:function(e){}}):y.error("Not found arguments"):y.error("Not support FileReader."):y.error("Not support WebSocket.")}}).prettyDate=function(e){var t,i=new Date((e||"").replace(/-/g,"/").replace(/[TZ]/g," ").split(".")[0]),n=((new Date).getTime()-i.getTime())/1e3;(n-=33e3)<0&&(n=0);t=Math.floor(n/86400);if(!(isNaN(t)||t<0))return 0===t&&((n<60?"\ubc29\uae08\uc804":n<120&&"1\ubd84\uc804")||n<3600&&Math.floor(n/60)+" \ubd84\uc804"||n<7200&&"1 \uc2dc\uac04\uc804"||n<86400&&Math.floor(n/3600)+" \uc2dc\uac04\uc804")||1==t&&"\uc5b4\uc81c"||t<7&&t+" \uc77c\uc804"||t<31&&Math.floor(t/7)+" \uc8fc\uc804"||t<360&&Math.floor(t/30)+" \uac1c\uc6d4 \uc804"||360<=t&&(0===Math.floor(t/360)?1:Math.floor(t/360))+" \ub144 \uc804"};(y.DuiFromData=D).prototype={constructor:D,append:function(e,t){if(y.isElement(t)&&"input"==t.nodeName.toLowerCase()&&"string"==typeof t.type&&"file"==t.type.toLowerCase()){t.value&&(this._hasFile=!0);this.data.push({name:e,value:t,isfile:!0,element:!0})}else if(window.FileList&&t instanceof FileList){t.length&&(this._hasFile=!0);this.data.push({name:e,value:t,isfile:!0,filelist:!0})}else this.data.push({name:e,value:t})},hasFile:function(){if(this.formElement){ae=y.queryAll(this.formElement,'input[type="file"]');if(ae&&ae.length)return!0}return!!this._hasFile},body:function(){},empty:function(){return!this.data.length&&!this.formElement},length:function(){return this.data.length},get:function(e){return this.data[e]},form:function(e){var t,i,n,r,s=this.formElement?this.formElement:document.createElement("form");if(e){e.target&&(s.target=e.target);e.url&&(s.action=e.url);e.method&&(s.method=e.method)}this.formElement&&(r=y.queryAll(this.formElement,'input[type="file"]'))&&r.length&&(s.enctype="multipart/form-data");for(t=0;t<this.data.length;t++)if((i=this.data[t]).element)i.isfile&&y.error("Warring: file is using form tag(element).");else{(n=document.createElement("input")).duiType=!0;n.type="hidden";n.name=i.name;n.value=i.value;s.appendChild(n);this.formElement&&this.saveElement.push(n)}return s},submit:function(i){var e="A"+y.guid(""),t={target:i&&i.target?i.target:e,url:i&&i.url?i.url:null,method:i&&i.method?i.method:"POST"},n=this.form(t),r=document.createElement("iframe");r.width="300";r.height="300";r.style.border="solid 1px red";r.name=t.target;r.src="";r.style.display="none";this.formElement||document.body.appendChild(n);document.body.appendChild(r);var s=this;y.on(r,"load",function(){try{if("about:blank"==r.contentWindow.document.location.href)return""!==n.action&&"about:blank"!=n.action?n.submit():void 0}catch(t){"function"==typeof i.error&&i.error(t);return s.clean()}var e=r.contentWindow.document.body.innerText;y.remove(r);s.formElement||y.remove(n);"function"==typeof i.success&&i.success(e,200,null);s.clean();s=null})},clean:function(){var e;for(e=0;e<this.saveElement.length;e++)y.remove(this.saveElement[e])}};(y.DuiHeader=M).prototype={constructor:M,append:function(e,t){this.data.push({name:e,value:t})},length:function(){return this.data.length},get:function(e){return this.data[e]}};(y.HttpAjaxClient=O).xhrType=null;O.getRequest=function(){switch(O.xhrType){case"xhr":return new XMLHttpRequest;case"xdr":return new XDomainRequest;case"mxh":return new ActiveXObject("Microsoft.XMLHTTP")}if((!p.ie||p.ie&&9<=p.ie)&&window.XMLHttpRequest){O.xhrType="xhr";return new XMLHttpRequest}if(window.XDomainRequest){O.xhrType="xdr";return new XDomainRequest}if(window.ActiveXObject){O.xhrType="mxh";return new ActiveXObject("Microsoft.XMLHTTP")}return y.error(new TypeError("Not found XMLHttpRequest object."))};O.prototype={constructor:O,onerror:function(e){y.error("onerror: ",e)},onsuccess:function(e,t,i){},onreadystatechange:function(e){},onprogress:function(){},close:function(){this.xmlHttp=null},ready:function(){function t(e){"function"==typeof this.onerror&&this.onerror(this);this.close()}function i(){var e;switch(O.xhrType){case"xdr":if(!(e=this.xmlHttp))return"function"==typeof this.onerror?this.onerror("Not found xmlhttp"):null;this.onsuccess(e.responseText,200,e)}}function n(e){}function r(e){this.onprogress(e)}function s(e){}function a(){"function"==typeof this.onerror&&this.onerror(this);this.close()}if(!(this.xmlHttp=O.getRequest()))return y.error("Not found xml http object.");!function(e){e.xmlHttp.onreadystatechange=function(){(function(e){var t;if(t=e?y.target(e):p.ie&&p.ie<9?this:null){this.readyState=t.readyState;"function"==typeof this.onreadystatechange&&this.onreadystatechange(t);switch(t.readyState){case 0:case 1:case 2:case 3:break;case 4:if(0<t.status){this.status=t.status;this.statusText=t.statusText;this.onsuccess(t.responseText,t.status,t);this.close()}}}else alert("eeee")}).apply(e,arguments)};switch(O.xhrType){case"xhr":e.xmlHttp.onabort=function(){(function(e){"function"==typeof this.onerror&&this.onerror(this);this.close()}).apply(e,arguments)};e.xmlHttp.onerror=function(){t.apply(e,arguments)};e.xmlHttp.onload=function(){i.apply(e,arguments)};e.xmlHttp.ontimeout=function(){a.apply(e,arguments)};if(e.xmlHttp.upload){e.xmlHttp.upload.onloadstart=function(){n.apply(e,arguments)};e.xmlHttp.upload.onprogress=function(){r.apply(e,arguments)};e.xmlHttp.upload.onloadend=function(){s.apply(e,arguments)}}else{e.xmlHttp.onloadstart=function(){n.apply(e,arguments)};e.xmlHttp.onprogress=function(){r.apply(e,arguments)};e.xmlHttp.onloadend=function(){s.apply(e,arguments)}}break;case"xdr":e.xmlHttp.onerror=function(){t.apply(e,arguments)};e.xmlHttp.onload=function(){i.apply(e,arguments)};e.xmlHttp.onprogress=function(){r.apply(e,arguments)};e.xmlHttp.ontimeout=function(){a.apply(e,arguments)}}}(this);return!0},open:function(e,t){if(!0!==this.ready())return!1;e&&(this.type=e.toUpperCase());this.type||(this.type="GET");t&&(this.url=t);if(this["safe-cross-domain"]){var i,n="";-1!=(i=t.lastIndexOf("?"))&&(n=t.substring(i+1));this["safe-cross-domain"]["x-qs"]=n;this["safe-cross-domain"]["x-url"]=-1!=i?t.substring(0,i):this.url;this.url=this["safe-cross-domain"].url;this.type="POST"}this.formdata&&(this.type="POST");this.xmlHttp.open(this.type,this.url,!0);return!0},setRequestHeader:function(e,t){this.headers.append(e,t)},repairData:function(e){var t,i,n,r,s,a=this.formdata?this.formdata:y.supportFormData()?this.formdata=new FormData:this.formdata=new D;if(y.isElement(e)&&"form"==e.nodeName.toLowerCase())a=y.supportFormData()?this.formdata=new FormData(e):this.formdata=new D(e);else if(e instanceof FormData)a=this.formdata=e;else if(y.isArray(e))for(i=0;i<e.length;i++){n=e[i];s=!1;if(y.isElement(n)&&"input"==n.nodeName.toLowerCase())switch("string"==typeof n.type?n.type.toLowerCase():""){case"input":case"hidden":s=!0;a.append(n.name,n.value);break;case"file":s=!0;if(n.files){y.hasAttr(n,"multiple")&&!/(\[\]$)/.exec(n.name)&&y.error('multiple input file name suffix "[]".');for(r=0;r<n.files.length;r++)a.append(n.name,n.files[r])}else a.append(n.name,n)}!s&&n.name&&a.append(n.name,n.value)}else if("object"==typeof e)for(t in e)a.append(t,e[t])},send:function(e){var t,i,n;e&&this.repairData(e);if(this["safe-cross-domain"]){this["safe-cross-domain"]["x-qs"]&&this.xmlHttp.setRequestHeader("x-dproject-safe-cross-domain-qs",this["safe-cross-domain"]["x-qs"]);this.xmlHttp.setRequestHeader("x-dproject-safe-cross-domain-url",this["safe-cross-domain"]["x-url"])}this["virtual-host"]&&this.xmlHttp.setRequestHeader("x-dproject-virtual-host",this["virtual-host"]);this["virtual-ip"]&&this.xmlHttp.setRequestHeader("x-dproject-virtual-ip",this["virtual-ip"]);this["virtual-cookie"]&&this.xmlHttp.setRequestHeader("x-dproject-virtual-cookie",this["virtual-cookie"]);this["safe-cross-domain"]&&this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(i=0;i<this.headers.length();i++){n=this.headers.get(i);this.xmlHttp.setRequestHeader(n.name,n.value)}t=this.formdata;this.enctype&&(t.enctype=this.enctype);if(y.supportFormData())return t?this.xmlHttp.send(t):this.xmlHttp.send();if("POST"!=this.type)return this.xmlHttp.send();if(!t||t&&t.empty())return this.xmlHttp.send();t.hasFile()&&y.error("Warring:: Not support file upload on ajax. Your response content-type is text/plain.");var r=this;t.submit({error:function(e){y.error(e);"function"==typeof r.onerror&&r.onerror("Don't submit.")},success:function(e,t,i){"function"==typeof r.onsuccess&&r.onsuccess(e,t,r)},method:this.type,url:this.url})},abort:function(){this.xmlHttp&&this.xmlHttp.abort&&this.xmlHttp.abort()}};m={waterfall:function(e,t){var o=this;return 0<e.length?function i(n,r,s,a){var e=s[n];r||(r=[]);r.push(function(){if(arguments[0]){a&&a.apply(o,arguments);o=s=a=r=undefined}else{var e,t=[];for(e=1;e<arguments.length;e++)t.push(arguments[e]);s.length>n+1?i.call(o,n+1,t,s,a):a&&a.apply(o,arguments)}});if(e)e.apply(o,r);else{a&&a.call(o);o=s=a=r=undefined}}.call(o,0,null,e,t):t&&t.call(o)},each:function(r,e,s){return 0<r.length?function t(i){var n=this;e.call(this,r[i],function(e){!e&&r.length>i+1?t.call(n,i+1):s&&s.call(n,e);n=undefined})}.call(this,0):s?s.call(this):""},ins:function(e,t,i){var n,r=[];for(n in e)r.push(n);m.each.call(this,r,t,i)},mapSeries:function(e,t,r){var s=[];function a(e){if("function"==typeof r)return e?r(e):r(null,s);y.error("Not found callback function at mapSeries.")}!function i(n){if(n>=e.length)return a(null);if("function"!=typeof t)return y.error("Not found array callback function at mapSeries.");t(e[n],function(e,t){if(!e){s.push(t);return i(n+1)}if("function"==typeof r)return a(e)})}(0)}};e={RADIAN:180/Math.PI,point:function(e,t){return new d(e,t)},rect:function(e,t,i,n){return new P(e,t,i,n)}};var d=function(e,t){switch(typeof e){case"number":this.x=e;this.y=t;break;case"object":if(e instanceof P){this.x=e.left;this.y=e.top}else{this.x=e.x;this.y=e.y}break;case"string":this.x=parseInt(e);this.y=parseInt(t)}};d.prototype={vector:function(e,t){var i=new d(e,t);return new d(i.x-this.x,i.y-this.y)},abs:function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},dotproduct:function(e,t){var i=new d(e,t);return this.x*i.x+this.y*i.y},distance:function(e,t){if(void 0===e)return Math.sqrt(this.abs());var i=new d(e,t),n=i.x-this.x,r=i.y-this.y;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))},normalize:function(){var e=this.distance();return new d(this.x/e,this.y/e)},atan2:function(){return Math.atan2(this.y,this.x)},angle:function(){return this.atan2()*e.RADIAN},clone:function(){return new d(this)}};P.copy=function(e,t){e.left=t.left;e.top=t.top;e.right=t.right;e.bottom=e.bottom};P.prototype={constructor:P,width:function(){return this.right-this.left},height:function(){return this.bottom-this.top},area:function(){return this.width*this.height},clone:function(){return new P(this)},vector:function(){return new d(this.right-this.left,this.bottom-this.top)},distance:function(){var e=this.right-this.left,t=this.bottom-this.top;return Math.sqrt(Math.abs(e*e)+Math.abs(t*t))},normalize:function(){var e=this.distance();return new d(this.right/e,this.bottom/e)},contains:function(e,t){var i;1==arguments.length?"object"==typeof e&&(e instanceof d||"number"==typeof e.x&&"number"==typeof e.y)&&(i=e):2==arguments.length&&"number"==typeof e&&"number"==typeof t&&(i={x:e,y:t});return!!(i&&this.left<=i.x&&this.right>=i.x&&this.top<=i.y&&this.bottom>=i.y)},center:function(e){return{x:(this.width()-e.width())/2,y:(this.height()-e.height())/2}}};e.DuiPoint=d;e.DuiRect=P;g={innerWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth},innerHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight},FRAME:30,getFrame:function(e){return e*g.FRAME/1e3},addShowModule:function(e){if(!e.name)throw new TypeError("Not found name at show module.");i[e.name]=e},getShowModule:function(e){return i[e]},showhide:function(e,t,i,n){var r,s="dui-showhide-origin";function a(e,t){var i,n=e.style.display;if(!(t&&"none"!=n||!t&&"none"==n)){if(!(r=e[s])){r={style:{display:n&&"none"!=n?n:""}};e[s]=r}i=r.style;n&&"none"!=n&&i.display!=n&&(i.display=n);e.style.display=t?i.display&&"none"!=i.display?i.display:"":"none"}}if(y.isElement(e))return a(e,"show"==n)},hide:function(e,t){if(y.isArray(e)){var i;for(i=0;i<e.length;i++)g.showhide(e[i],t,"none","hide")}else g.showhide(e,t,"none","hide")},show:function(e,t){if(y.isArray(e)){var i;for(i=0;i<e.length;i++)g.showhide(e[i],t,"block","show")}else g.showhide(e,t,"block","show")},repaireUi:function(e){var t=y.getBoundingClientRect(e);t.top<=0&&(e.style.top="10px");t.left<=0&&(e.style.left="10px")},center:function(e,t){var i=y.math.rect(0,0,y.ui.innerWidth(),y.ui.innerHeight()),n=y.getBoundingClientRect(e),r=i.center(n),s=r.y,a=r.x;t||(t={});t.offsetTop||(t.offsetTop=20);e.style.top=s-t.offsetTop+"px";e.style.left=a+"px";y.ui.repaireUi(e)},popup:function(e){e||(e={});var t=(!0===e.modal||"true"==e.modal)&&document.createElement("div"),i=e.ui;if(!y.isElement(i))throw new TypeError("ui parameter is not element.");i.style.position="absolute";if(t){y.addClass(t,"dui-protect-background");t.style.position="fixed";y.append(t,i);y.append(document.body,t)}else y.append(document.body,i);y.ui.center(i,e);e.auto;return t||i}};!function(){function e(e){var t=y.getBoundingClientRect(this),i=y.documentSize();e.user_data={depth:{x:e.width/(e.duration/e.perSeconds),y:e.height/(e.duration/e.perSeconds),left:t.right/(e.duration/e.perSeconds),right:(i.x-t.left)/(e.duration/e.perSeconds),top:t.bottom/(e.duration/e.perSeconds),bottom:(i.y-t.top)/(e.duration/e.perSeconds)},current:{x:0,y:0,left:0,top:0,right:0,bottom:0},rect:t,ds:i}}function t(e){var t=e.user_data.current,i=e.user_data.depth,n=e.user_data.rect,r=e.user_data.ds;t.x+=i.x;t.y+=i.y;t.left+=i.left;t.top+=i.top;t.right+=i.right;t.bottom+=i.bottom;if(e.isshow){t.ml=-n.right+t.left;t.mr=r.x-n.left-t.right;t.mt=-n.bottom+t.top;t.mb=r.y-n.top-t.bottom}else{t.ml=-t.left;t.mr=t.right;t.mt=-t.top;t.mb=t.bottom}switch(e.type){case"out-right":this.style.marginLeft=t.mr+"px";break;case"out-left":this.style.marginLeft=t.ml+"px";break;case"out-bottom":this.style.marginTop=t.mb+"px";break;case"out-top":this.style.marginTop=t.mt+"px";break;case"out-leftbottom":case"out-lefttop":break;case"out-rightbottom":case"out-righttop":break;default:throw new TypeError("Not found show/hide method(type) name. type: "+e.type)}return t.top>n.bottom}for(var i=["out-left","out-right","out-top","out-bottom","out-lefttop","out-leftbottom","out-righttop","out-rightbottom"],n=0;n<i.length;n++)g.addShowModule({name:i[n],init:e,onevent:t})}();!function(){function e(e){this.style.paddingLeft=this.style.paddingRight=this.style.paddingTop=this.style.paddingBottom="0px";e.user_data={depth:{x:e.width/(e.duration/e.perSeconds),y:e.height/(e.duration/e.perSeconds)},current:{x:0,y:0}}}function t(e){var t=e.user_data.current,i=e.user_data.depth;t.x+=i.x;t.y+=i.y;if(e.isshow){t.rw=t.x;t.rh=t.y;t.ml=e.width-t.x+y.parseInt(e.origin.margin.left,0);t.mt=e.height-t.y+y.parseInt(e.origin.margin.top,0)}else{t.rw=e.width-t.x;t.rh=e.height-t.y;t.ml=t.x+y.parseInt(e.origin.margin.left,0);t.mt=t.y+y.parseInt(e.origin.margin.top,0)}switch(e.type){case"right":this.style.marginLeft=t.ml+"px";case"left":this.style.width=t.rw+"px";this.style.height=e.height+"px";break;case"bottom":this.style.marginTop=t.mt+"px";case"top":this.style.height=t.rh+"px";this.style.width=e.width+"px";break;case"leftbottom":this.style.marginTop=t.mt+"px";case"lefttop":this.style.width=t.rw+"px";this.style.height=t.rh+"px";break;case"rightbottom":this.style.marginTop=t.mt+"px";case"righttop":this.style.marginLeft=t.ml+"px";this.style.width=t.rw+"px";this.style.height=t.rh+"px";break;default:throw new TypeError("Not found show/hide method(type) name. type: "+e.type)}return t.x>=e.width}for(var i=["left","right","top","bottom","lefttop","leftbottom","righttop","rightbottom"],n=0;n<i.length;n++)g.addShowModule({name:i[n],init:e,onevent:t})}();var f=[];g.addResizeable=function(e){f.push(e);1===f.length&&y.on(window,"resize",g.onResizeable)};g.removeResizeable=function(e){var t;for(t=0;t<f.length;t++)if(f[t]===e){y.remove(f,t);break}0===f.length&&y.off(window,"resize",g.onResizeable)};g.onResizeable=function(e){var t,i;for(t=0;t<f.length;t++)if("function"==typeof(i=f[t]).resize)try{i.resize(e)}catch(n){}};!function(){var n=function(e,a){if(e){a||(a={});a.offset||(a.offset=5);a.limitHeightOffset||(a.limitHeightOffset=2);a.limitWidthOffset||(a.limitWidthOffset=2);this.attr=a;this.sourceElement=e;this.enable=!1;this.lastEvent=null;this.status="";this.statusList=[];this.statusTarget={};this.type=function(){var e,t,i="string"==typeof a.type?a.type.split(","):[],n=["right","bottom","left","top"],r=[],s=[];for(e in i)(t=i[e].trim())&&r.push(t);if(!r.length)return n;for(e in r){if("all"==r[e])return n;switch(r[e]){case"right":case"bottom":case"left":case"top":s.push(r[e])}}return s.length?s:n}()}},c=n,s=[],a=[],r=["active","unactive","down","up"],o=["resizeable_down","resizeable_move","resizeable_up"],l=["bottom","top","right","left"];c.defaultOffset=10;c.addObject=function(e){var t,i=s;for(t=0;t<i.length;t++)if(i[t]===e)return;i.push(e);if(1===i.length){y.on(document,"mousedown",c.mousedown);y.on(document,"mousemove",c.mousemove);y.on(document,"mouseup",c.mouseup)}};c.removeObject=function(e){var t,i=s;for(t=0;t<i.length;t++)if(i[t]===e){i.slice(t,1);c.removeDownObject(e);break}if(0===i.length){y.off(document,"mousedown",c.mousedown);y.on(document,"mousemove",c.mousemove);y.on(document,"mouseup",c.mouseup)}};c.removeDownObject=function(e){var t,i=a;for(t=0;t<i.length;t++)if(i[t]===e)return i.slice(t,1)};c.mousedown=function(e){var t,i,n=s,r=[];for(t=0;t<n.length;t++){(i=n[t]).onmosuedown(e);switch(i.status){case c.s_down:r.push(i)}}r.length&&y.addClass(document.body,"dui-none-select");a=r};c.mouseup=function(e){var t,i=a;for(t=0;t<i.length;t++)i[t].onmouseup(e);y.removeClass(document.body,"dui-none-select");a=[]};c.mousemove=function(e){var t,i=a;for(t=0;t<i.length;t++)i[t].onmousemove(e)};c.prototype={constructor:n,active:function(){this.status=c.s_active;c.addObject(this)},unactive:function(){c.removeObject(this);this.status=c.s_unactive},rect:function(){return y.getBoundingClientRect(this.sourceElement)},refreshCursor:function(){var e=this.statusTarget,t=window.document.body;this.oldCursor=t.style.cursor;e.rightBottom?t.style.cursor="se-resize":e.rightTop?t.style.cursor="ne-resize":e.leftBottom?t.style.cursor="sw-resize":e.leftTop?t.style.cursor="nw-resize":e.right?t.style.cursor="e-resize":e.bottom?t.style.cursor="s-resize":e.left?t.style.cursor="w-resize":e.top&&(t.style.cursor="n-resize")},getMouseRange:function(e){var t,i,n=this.attr,r=n.offset?n.offset:c.defaultOffset,s=this.rect(),a=e.clientX,o=e.clientY,l=this.type,u={status:"",statusList:[],statusTarget:{}};for(t in l)switch(i=l[t]){case"right":if(a>=s.right-r&&a<=s.right+r&&o>=s.top-r&&o<=s.bottom+r){u.status=c.s_down;u.statusList.push(i);u.statusTarget.right=!0;u.statusTarget.top?u.statusTarget.rightTop=!0:u.statusTarget.bottom&&(u.statusTarget.rightBottom=!0)}break;case"bottom":if(o>=s.bottom-r&&o<=s.bottom+r&&a>=s.left-r&&a<=s.right+r){u.status=c.s_down;u.statusList.push(i);u.statusTarget.bottom=!0;u.statusTarget.left?u.statusTarget.leftBottom=!0:u.statusTarget.right&&(u.statusTarget.rightBottom=!0)}break;case"left":if(a>=s.left-r&&a<=s.left+r&&o>=s.top-r&&o<=s.bottom+r){u.status=c.s_down;u.statusList.push(i);u.statusTarget.left=!0;u.statusTarget.top?u.statusTarget.leftTop=!0:u.statusTarget.bottom&&(u.statusTarget.leftBottom=!0)}break;case"top":if(o>=s.top-r&&o<=s.top+r&&a>=s.left-r&&a<=s.right+r){u.status=c.s_down;u.statusList.push(i);u.statusTarget.top=!0;u.statusTarget.left?u.statusTarget.leftTop=!0:u.statusTarget.right&&(u.statusTarget.rightTop=!0)}}return u},onmosuedown:function(e){var t=this.getMouseRange(e);this.status=t.status;this.statusList=t.statusList;this.statusTarget=t.statusTarget;this.lastEvent=this.status?e:null;this.refreshCursor()},onmouseup:function(e){var t=document.body;this.lastEvent=null;this.status=c.s_up;this.statusTarget={};t.style.cursor=this.oldCursor?this.oldCursor:""},onmousemove:function(e){this.attr,this.rect();var t,i=this.lastEvent,n=e.clientX-i.clientX,r=e.clientY-i.clientY;for(t in this.statusList)switch(this.statusList[t]){case"right":this.resizeRight(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"bottom":this.resizeBottom(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"left":this.resizeLeft(this.sourceElement,{dx:n,dy:r,attr:this.attr});break;case"top":this.resizeTop(this.sourceElement,{dx:n,dy:r,attr:this.attr})}this.lastEvent=e},resizeRight:function(e,t){if(!y.isElement(e))throw new TypeError("Not found element parameter.");if(!t)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(e),n=parseInt(i.getPropertyValue("left")),r=parseInt(i.getPropertyValue("width")),s=t.attr&&t.attr.offset?t.attr.offset:c.defaultOffset,a=t.dx,o=t.dy,l=r+a;if(2*s<l&&l+n<window.innerWidth){e.style.width=l+"px";t.attr&&t.attr.resizeRight&&t.attr.resizeRight.call(this,{dx:a,dy:o})}},resizeLeft:function(e,t){if(!y.isElement(e))throw new TypeError("Not found element parameter.");if(!t)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(e),n=parseInt(i.getPropertyValue("left")),r=parseInt(i.getPropertyValue("width")),s=t.attr&&t.attr.offset?t.attr.offset:c.defaultOffset,a=t.dx,o=t.dy,l=n+a,u=r-a;if(0<l){e.style.left=l+"px";t.attr&&t.attr.resizeLeft&&t.attr.resizeLeft.call(this,{dx:a,dy:o})}!t.noWidth&&2*s<u&&(e.style.width=u+"px")},resizeTop:function(e,t){if(!y.isElement(e))throw new TypeError("Not found element parameter.");if(!t)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(e),n=parseInt(i.getPropertyValue("top")),r=parseInt(i.getPropertyValue("height")),s=t.attr&&t.attr.offset?t.attr.offset:c.defaultOffset,a=t.dx,o=t.dy,l=n+o,u=r-o;if(0<l){e.style.top=l+"px";t.attr&&t.attr.resizeTop&&t.attr.resizeTop.call(this,{dx:a,dy:o})}!t.noHeight&&2*s<u&&(e.style.height=u+"px")},resizeBottom:function(e,t){if(!y.isElement(e))throw new TypeError("Not found element parameter.");if(!t)throw new TypeError("Not found attribute parameter.");var i=window.getComputedStyle(e),n=parseInt(i.getPropertyValue("top")),r=parseInt(i.getPropertyValue("height")),s=t.attr&&t.attr.offset?t.attr.offset:c.defaultOffset,a=t.dx,o=t.dy,l=r+o;if(2*s<l&&l+n<window.innerHeight){e.style.height=l+"px";t.attr&&t.attr.resizeBottom&&t.attr.resizeBottom.call(this,{dx:a,dy:o})}}};g.resizeable=function(e,t){var i=new n(e,t);t&&!1===t.auto||i.active();return i};!function(){var e,t,i;for(e in r){t="s_"+(i=r[e]);g.resizeable[t]=c[t]=i}for(e in o){t="css_"+(i=o[e]);g.resizeable[t]=c[t]=i}for(e in l){t="type_"+(i=l[e]);g.resizeable[t]=c[t]=i}}()}();I.prototype={constructor:I,addUi:function(e){this.ui=e;this.contents=y.query(this.ui,".contents"),this.linkElement();if(!0===this._modal){this.background=document.createElement("div");y.addClass(this.background,"dui-protect-background");this.background.style.position="fixed";y.append(this.background,this.ui)}},auto:function(){!0!==this._auto&&"true"!==this._auto||this.show()},show:function(){document.body.appendChild(this.background);this.linkEvent();this.linkPosition()},linkElement:function(){var e=this.attr;this.main=y.query(this.ui,".main");this.ctrlMain=y.query(this.ui,".ctrl-main");this.okBtn=y.query(this.ui,".ok-btn");this.okBtn.innerText="OK";"string"==typeof this.text&&this.text&&(this.contents.innerText=this.text);e.width&&(this.main.style.width=e.width+"px");e.height&&(this.main.style.height=e.height+"px")},linkEvent:function(){var t=this;y.on(this.okBtn,"click",function(e){t.onOk(e)})},linkPosition:function(){var e=y.math.rect(0,0,y.ui.innerWidth(),y.ui.innerHeight()),t=y.getBoundingClientRect(this.ui),i=e.center(t),n=this.attr.top||"number"==typeof this.attr.top?this.attr.top:i.y,r=this.attr.left||"number"==typeof this.attr.left?this.attr.left:i.x;this.ui.style.top=n+this.offsetTop+"px";this.ui.style.left=r+"px";this.repaire();g.addResizeable(this);e=t=i=null},onOk:function(e){this.close(e)},close:function(e){if("function"==typeof this.attr.close&&!1===this.attr.close.call(this,e))return!1;!0===this._modal?y.remove(this.background):y.remove(this.ui);g.removeResizeable(this);this.reuse||this.destroy()},resize:function(e){var t=y.math.rect(0,0,y.ui.innerWidth(),y.ui.innerHeight()),i=y.getBoundingClientRect(this.ui),n=t.center(i);this.ui.style.top=n.y+this.offsetTop+"px";this.ui.style.left=n.x+"px";this.repaire()},repaire:function(){var e=y.getBoundingClientRect(this.ui);e.top<=0&&(this.ui.style.top="10px");e.left<=0&&(this.ui.style.left="10px")},destroy:function(){this.background&&delete this.background;this.ui&&delete this.ui;this.text&&delete this.text;this.attr&&delete this.attr;this.contents&&delete this.contents;this.okBtn&&delete this.okBtn}};g.DuiAlert=I;g.alert=function(t,i){t||(t="");i||(i={});var e=window.top&&window.top!==window?window.top.getDframework():null;if(e)return e.ui.alert(t,i);var n=new I(t,i),r=i.resource?i.resource:"html://dframework/html/base.html";y.require(r+"#dui-alert",function(e){n.addUi(y.element(e.outerHTML));n.auto();n=t=i=r=null},function(e){e&&y.error(e)});return n};y.extendClass(F,I,{linkElement:function(){F.__super.linkElement.apply(this,arguments);this.cancelBtn=y.query(this.ui,".cancel-btn");this.cancelBtn.innerText="Cancel"},linkEvent:function(){F.__super.linkEvent.apply(this,arguments);var t=this;y.on(this.cancelBtn,"click",function(e){t.onCancel(e)})},onCancel:function(e){if("function"==typeof this.attr.cancel&&!1===this.attr.cancel(e))return!1;this.close(e)},onOk:function(e){if("function"==typeof this.attr.ok&&!1===this.attr.ok(e))return!1;this.close(e)}});g.DuiConfirm=F;g.confirm=function(t,i){t||(t="");i||(i={});var e=window.top&&window.top!==window?window.top.getDframework():null;if(e)return e.ui.confirm(t,i);var n=new F(t,i),r=i.resource?i.resource:"html://dframework/html/base.html";y.require(r+"#dui-confirm",function(e){n.addUi(y.element(e.outerHTML));n.auto();n=t=i=r=null},function(e){e&&y.error(e)});return n};y.extendClass(B,F,{show:function(){var i,e,n=this.attr,r=this;this.titlebar=y.query(this.ui,".ctrl-titlebar");if(this.noiframe){if(this.userui){i=y.element(this.userui.outerHTML);this.contents.appendChild(i)}}else{i=this.iframe=document.createElement("iframe");y.attr(i,"frameborder",0);y.addClass(i,"dui-iframe");n.name&&(i.name=n.name);n.url&&(i.src=n.url);y.on(this.iframe,"load",function(e){var t=i.contentWindow||i.contentDocument;t.dframework_dialog_guid=r.guid;t.dframework_parent_window=window;(t.dframework_parent_dialog=r).iframeWindow=t;"function"==typeof n.load&&n.load.apply(r,e)});this.contents.appendChild(i)}B.__super.show.apply(this,arguments);if(this.no_button){y.getBoundingClientRect(this.main);y.getBoundingClientRect(this.ctrlMain);y.ui.hide(this.ctrlMain)}if(this.use_titlebar){n.title&&(e=y.query(this.ui,".titlebar"))&&(e.innerText=n.title);this.closeTitleBtn=y.query(this.ui,".close-btn");y.on(this.closeTitleBtn,"click",function(){r.close()})}else{y.getBoundingClientRect(this.main);y.getBoundingClientRect(this.titlebar);y.ui.hide(this.titlebar)}"function"==typeof n.show&&n.show.apply(this)}});g.DuiDialog=B;g.dialog=function(e){e||(e={});e.nobutton=!0;var t=new B(e),i=e.resource?e.resource:"html://dframework/html/base.html";y.require(i+"#dui-dialog",function(e){t.addUi(y.element(e.outerHTML));t.auto()},function(e){e&&y.error(e)});return t};g.closeDialog=function(){var e,t=dframework_dialog_guid;t&&(e=dframework_parent_dialog)&&e.guid==t&&e.close()};g.callbackDialog=function(e,t){var i,n=dframework_dialog_guid;if(n&&(i=dframework_parent_dialog)&&i.guid==n&&"function"==typeof i.callback)return i.callback(e,t)};g.open=function(e){e||(e={});e.nobutton=!0;var t=new B(e),i=e.resource?e.resource:"html://dframework/html/base.html";y.require(i+"#dui-dialog",function(e){t.addUi(y.element(e.outerHTML));t.auto()},function(e){e&&y.error(e)});return t};U.prototype={constructor:U,addUi:function(e){this.ui=e;this.contents=y.query(this.ui,".contents");this.contents&&(this.contentsHtml=this.contents.innerHTML);this.linkElement();if(!0===this._modal){this.background=document.createElement("div");y.addClass(this.background,"dui-protect-background");this.background.style.position="fixed";y.append(this.background,this.ui)}},auto:function(){!0!==this._auto&&"true"!==this._auto||this.show()},show:function(e){var t=e&&e.event?e.event:window.event,i={left:t.clientX+30,top:t.clientY-10};this._lastShowAttr=e;this.linkElement();this._parent=e?e.parent:undefined;e.addItems&&this.addItems(e.addItems);e.disable&&this.disableItem(e.disable);i.top+y.height(this.ui)+5>window.innerHeight&&(i.top-=y.height(this.ui)+5);i.left+y.width(this.ui)+5>window.innerWidth&&(i.left-=y.width(this.ui)+5);!0===this._modal?document.body.appendChild(this.background):document.body.appendChild(this.ui);y.offset(this.ui,i);U.showObjects.push(this)},close:function(e){var t;for(t=U.showObjects.length-1;0<=t;t--)if(U.showObjects[t]===this){y.remove(U.showObjects,t);break}if("function"==typeof this.attr.close&&!1===this.attr.close.call(this,e))return!1;!0===this._modal?y.remove(this.background):y.remove(this.ui);g.removeResizeable(this)},disableItem:function(e){var t,i,n,r,s=y.childs(this.contents);for(t=0;t<s.length;t++){r=(n=s[t]).getAttribute("cmd");for(i=0;i<e.length;i++)if(r==e[i]){y.addClass(n,"disable");break}}},onClickItem:function(e,t,i){if(this.attr.fn&&"function"==typeof this.attr.fn.click){this.attr.fn.click({item:i,target:t,event:e,data:this._lastShowAttr});i.hassub||this.close()}},setClickItem:function(t,i){var n=this;y.on(t,"click",function(e){y.hasClass(t,"disable")||n.onClickItem(e,t,i)})},addItems:function(e){var t,i,n;for(t=0;t<e.length;t++){i=e[t];(n=y.element(this.contentsHtml)).innerText=i.name;n.setAttribute("cmd",i.cmd);this.setClickItem(n,i);this.contents.appendChild(n);y.removeClass(n,"disable")}},linkElement:function(){var e=this.attr;this.main=y.query(this.ui,".main");e.width&&(this.main.style.width=e.width+"px");e.height&&(this.main.style.height=e.height+"px");this.contents.innerHTML="";this.items&&this.items.length&&this.addItems(this.items)}};U.showObjects=[];g.closeContextmenu=function(){var e;for(e=U.showObjects.length-1;0<=e;e--)U.showObjects[e].close()};y.on(window,"click",g.closeContextmenu);y.on(window,"contextmenu",g.closeContextmenu);g.contextmenu=function(e){e||(e={});e.nobutton=!0;g.closeContextmenu();var t=new U(e),i=e.resource?e.resource:"html://dframework/html/base.html";y.require(i+"#dui-contextmenu",function(e){t.addUi(y.element(e.outerHTML));t.auto()},function(e){e&&y.ui.alert(e)});return t};y.define("dframework/uitl/resize-ui",function(){function n(e,t){this.attr=t;this.ui=e}n.prototype={resize:function(e){"function"==typeof this.attr.onresize&&this.attr.onresize.call(this,e)}};return function(e,t){var i=new n(e,t);Ui.addResizeable(i);return i}});y.define("dframework/uitl/select-ui",function(){function t(e){this.uuid="selectui_"+y.guid("");this.attr=e||{};this.selectedUis=[];this.selectedParents=[];this.drawUis=[];this.isstarted=!1;!function(t){t.__static__onselect=function(e){t.onSelectUi(e)};t.__static__oncontext=function(e){return t.onContextmenu(e)}}(this)}t.prototype={constructor:t,getDocument:function(){return"function"==typeof this.attr.document?this.attr.document():this.attr.document?this.attr.document:document},clean:function(){var e;for(e=0;e<this.selectedUis.length;e++)y.remove(this.selectedUis[e].rectUi);for(e=0;e<this.selectedParents.length;e++)y.remove(this.selectedParents[e].rectUi);for(e=0;e<this.drawUis.length;e++)y.remove(this.drawUis[e].rectUi);this.selectedUis=[];this.selectedParents=[];this.drawUis=[]},createRoundUi:function(e){var t=doc.createElement("div");y.offset(t,{top:e.top,left:e.left});t.style.position="absolute";t.style.width=e.width+"px";t.style.height=e.height+"px";t.style.border=e.border;t.style.zIndex=9999999;return t},drawRoundUi:function(e,t){var i=this.getDocument(),n=y.getBoundingClientRect(e),r=i.body.scrollTop||i.documentElement.scrollTop,s=i.body.scrollLeft||i.documentElement.scrollLeft,a=this.createRoundUi({top:n.top+r,left:n.left+s,width:n.width(),height:n.height(),border:"solid 2px red"});i.body.appendChild(a);t||this.drawUis.push({rectUi:a,srcUi:e});return a},onSelectUi:function(e){var t,i,n=this.getDocument(),r=y.math.point(e.clientX,e.clientY),s=y.getElementsByPoint(r,{document:n});if(s){this.clean();for(t=0;t<s.length;t++){i=s[t];this.selectedUis.push({rectUi:this.drawRoundUi(i,!0),srcUi:i})}"function"==typeof this.attr.onselect&&this.attr.onselect.call(this)}},onSelectParent:function(e,t){var i,n,r,s=doc.body.scrollTop||doc.documentElement.scrollTop,a=doc.body.scrollLeft||doc.documentElement.scrollLeft;t||(t=0);if((i=y.parent(e))&&y.isElement(i)){n=y.getBoundingClientRect(i);r=this.createRoundUi({top:n.top+s,left:n.left+a,width:n.width(),height:n.height(),border:"solid 1px blue"});doc.body.appendChild(r);this.selectedParents.push({rectUi:r,srcUi:i});this.onSelectParent(i,t+1)}},onContextmenu:function(e){var t;this.selectedParents=[];for(t=0;t<this.selectedUis.length;t++)this.onSelectParent(this.selectedUis[t].srcUi);if(this.selectedParents.length){"function"==typeof this.attr.onselectparent&&this.attr.onselectparent.call(this,this.selectedParents);return y.igEventAll(e)}},start:function(e){var t=this.getDocument();y.on(t,"mousemove",this.__static__onselect);y.on(t,"contextmenu",this.__static__oncontext);this.isstarted=!0},stop:function(e){var t=this.getDocument();y.off(t,"mousemove",this.__static__onselect);y.off(t,"contextmenu",this.__static__oncontext);this.clean();this.isstarted=!1}};return function(e){return new t(e)}});V.aname="@dui-module-data";V.mname="@dui-module-list";(V.Cursor=function(e){this.iscd=e instanceof V.Cursor.Data;this.root=this.iscd?e:new V.Cursor.Data(e);this.current=this.root}).prototype={constructor:V.Cursor};V.JteData=V.Cursor.Data=function(e,t){this.origin=e;this.type="undefined";this.parent=t;if(!(e instanceof V.JteData||e instanceof H)&&(null!==e&&e!==undefined||"string"==typeof e||"boolean"==typeof e))if(y.isArray(e)){this.hasName=!0;this.type="array";this.index=-1;this.length=e.length;this.hasData=!!this.length;this.current=undefined;this.childs=[];for(var i=0;i<e.length;i++){var n=e[i];if(y.isArray(n))throw new Error("ERROR(jte): array has not array.");n instanceof V.JteData||n instanceof H||this.childs.push(new V.Cursor.Data(n,this))}}else if("object"==typeof e){this.hasName=!0;this.type="object";this.childs={};for(var r in e){r&&(this.hasData=!0);(n=e[r])instanceof V.JteData||n instanceof H||(this.childs[r]=new V.Cursor.Data(n,this))}}else if("function"==typeof e){this.type="function";this.childs=e;this.hasData=!1}else{this.type="value";this.childs=e;this.hasData=""!==e&&null!==e&&e!==undefined}};V.Cursor.Data.prototype={constructor:V.Cursor.Data,data:function(e){return this.hasName?this.childs[e]:this.childs},value:function(){return this.hasName?"":this.origin},cursor:function(e,t){var i;if("array"!=this.type||e){if(!e)return;i=this.data(e)}else i=this;switch(t){case"i":return i;case"":case"current":return-1<i.index?i.data(i.index):i.data(0);case"l":case"last":return i.data(i.length-1);case"f":case"first":return i.data(0);default:var n,r,s,a;if(n=/([\S]+?)\=([\S]+)/.exec(t)){for(r=0;r<i.length;r++)if((s=i.data(r))&&(a=s.data(n[1]))&&a.data()===n[2])return s;return}if(t)return i.data(parseInt(t))}},isa:function(){return"array"==this.type},isArray:function(){return this.isa()}};H.prototype={constructor:H,callModule:function(e,t){var i,n="ERROR(jte): Not found module. moduleName: "+e;if(!(i=this.module?this.module[e]:undefined)&&!(i=y.module(e)))throw new TypeError(n);if("function"!=typeof i)throw new TypeError(n);i.call(this,t)},draw:function(){var e=this.from,t=y.attr(e,"jte-register");t&&(t=t.trim())&&C.push(A[t]=new j(e,t));this.drawElement(this.cursor.current,e)},removeElement:function(e,t){var i,n,r,s,a,o=y.childs(t),l=y.isArray(e)?e:[e];y.each(l,function(e){if(e=e.origin?e.origin:null)for(i=0;i<o.length;i++){n=o[i];if(!y.hasAttr(n,"jte-sample")){a=!1;for(s in e)if(r=y.query(n,'[jte-name="'+s+'"]')){a=!0;if(r.innerText===e[s]||r.innerHTML===e[s])break;a=!1}a&&y.remove(n)}}})},drawSpecialElement:function(e,t){},drawElement:function(e,t){var i,n,r,s,a,o,l=y.attr(t,"jte-control"),u=t.nodeName.toLowerCase();if(!l||!1!==this.callModule(l,{data:e,element:t})){t=this.sampleElement(t);if(y.hasAttr(t,"jte-sample"))p.ie&&p.ie<9&&g.hide(t);else{switch(u){case"select":case"option":return this.drawSpecialElement(e,t)}this.patchJteElement(e,t);switch(this.type){case"module":return this.drawChilds(e,y.childs(t))}if(!(i=y.attr(t,"jte-list")))return this.drawElementSub(e,t);var c=y.attr(t,"jte-row-last");null==c&&(c=-1);"number"!=typeof c&&(c=y.parseInt(c,-1));if(n=y.attr(t,"jte-list-from")){if(!(r=V.query(t,{target:n,query:'[jte-name="'+i+'"]'})))return y.error("Not found jte-list. name: "+i+", target: "+n,"at element :",t);if(!r.element||!r.element.length)return y.error("Not found jte-list. name: "+i+", target: "+n,"at element :",t);r=r.element[0];s=[];if("table"==r.nodeName.toLowerCase()&&r.children.length)for(a=0;a<r.children.length;a++)if("tbody"==r.children[a].nodeName.toLowerCase()){r=r.children[a];break}for(a=0;a<r.children.length;a++)s.push(y.element(r.children[a].outerHTML))}else{if(!(r=y.query(t,'[jte-name="'+i+'"]')))return y.error("Not found jte-list. name: "+i,"at element :",t);s=[y.element(r.outerHTML)]}if(this.remove)return this.removeElement(e,t);var h="array"==e.type?e.childs:[e],d=c+1;y.each.call(this,h,function(e){for(a=0;a<s.length;a++){o=s[a];y.remove(o,"jte-sample");y.remove(o,"jte-name");y.attr(o,"jte-row-no",d);o["jte-row-object"]=e;y.append(t,o);this.drawElement(e,o)}y.attr(t,"jte-row-last",d++)})}}},drawElementSub:function(e,t){var i,n,r="jte-only-array",s=e===this.cursor.current,a=y.hasAttr(t,r),o=y.hasAttr(t,"jte-must"),l=y.hasAttr(t,"jte-no-array"),u=(a?t.getAttribute(r):undefined,this.cursor),c=e.isa();if(a&&!c)return y.error(new Error("ERROR(jte): jte-only-array."));if(c){if(l)return y.error(new Error("ERROR(jte): jte-no-array."));if(o&&(!e||e&&!e.hasData))return this.empty(t);this.drawArray(e,t);u.current=e}else{if("value"==e.type)return o&&!e.hasData?this.empty(t):this.value(e.origin,t);var h,d=t.getAttribute("jte-name");n=y.childs(t);!d||(h=this.findValue(e,d))||s||y.error(new Error("ERROR(jte): Not found jte-name's vlaue. name:"+d));if(!d||h===undefined||null===h||""===h)return o&&d?this.empty(t):this.drawChilds(e,n);if(o&&!h.hasData)return this.empty(t);switch(h.type){case"array":i=u.current;u.current=h;this.drawArray(h,t);u.current=i;break;case"object":i=u.current;u.current=h;this.drawChilds(h,n);u.current=i;break;case"value":this.value(h.origin,t)}}},drawChilds:function(e,t){var i,n;if(0!==t.length)for(i=0;i<t.length;i++)try{n=t[i];y.isElement(n)&&this.drawElement(e,n)}catch(r){y.error(r)}},drawArray:function(e,t){if(0===e.length)return this.empty(t);var i,n,r,s,a,o=this.getArrayAttribute(t),l=t.nodeName.toLowerCase(),u=o.inner?t.getAttribute("jte-save-html"):"",c=u||(o.inner?t.innerHTML:t.outerHTML),h=this.cursor;if(o.inner){switch(l){case"thead":case"tbody":case"tr":case"select":y.removeChildAll(t);break;default:t.innerText=""}!u&&c&&t.setAttribute("jte-save-html",c)}else{if(u)return y.error("Already called draw array !");!u&&c&&t.setAttribute("jte-save-html",c)}for(i=0;i<e.childs.length;i++){if(o.max&&o.max<=i)return;r=e.childs[i];e.index=i;h.current=e.current=r;if(o.inner){s=y.element(c);a=y.isArray(s)?s:[s];for(n=0;n<a.length;n++){s=a[n];t.appendChild(s);if(y.isElement(s)){if("value"==r.type){var d=y.attrs(t);for(var f in d)null!==d[f]&&"undefined"!=typeof d[f]&&s.setAttribute(f,d[f])}this.drawElement(r,s)}}}else{(s=y.element(c)).removeAttribute("jte-only-array");s.removeAttribute("jte-name");s.setAttribute("jte-no-array","true");y.before(t,s);this.drawElement(r,s)}}o.inner||y.remove(t);e.index=-1;e.current=undefined},empty:function(e){var t=e.getAttribute("jte-empty");y.hasAttr(e,"jte-must");switch(t){case"remove":y.remove(e);break;case"noremove":case"no-remove":break;default:e.innerText=""}},value:function(e,t){if(null===e||e===undefined||""===e)return this.empty(t);var i=this.getValueAttribute(t),n=y.hasAttr(t,"jte-must"),r=i.prefix+(e+"")+i.sufix;switch(typeof e){case"string":if((e===undefined||null===e||""===e)&&n)return this.empty(t);i.html?t.innerHTML=r:t.innerText=r;break;case"number":case"boolean":if((e===undefined||null===e||""===e)&&n)return this.empty(t);t.innerText=r}},getValueAttribute:function(e){var t=this.getMultiAttribute(e.getAttribute("jte-value")),i=e.getAttribute("jte-prefix"),n=e.getAttribute("jte-sufix");t.prefix=i||"";t.sufix=n||"";t.html=y.hasAttr(e,"jte-html");return t},getArrayAttribute:function(e){var t=this.getMultiAttribute(e.getAttribute("jte-array"));t.max=t.max?parseInt(t.max):0;t.inner=!t.html||"inner"==t.html.toLowerCase();return t},getMultiAttribute:function(e){var r={};if(e){e=e.split(";");y.each(e,function(e){var t=e.split(":",2),i=t[0].trim(),n=2==t.length?t[1].trim():undefined;i&&(r[i]=n)})}return r},patchJteElement:function(e,t){var i,n,r,s="module"==this.type?V.getJteModuleElements(t):V.getJteAttrElements(t);for(i=0;i<s.length;i++)switch((n=s[i]).type){case"attr":this.patchAttributeElement(e,n,y.attrs(n.element));break;case"module":r=this.patchAttributeWithChildElement(n.element);this.patchModuleElement(e,n,r)}},patchAttributeWithChildElement:function(e){var t,i,n=y.childs(e),r=y.attrs(e);if(0===n.length)return r;r.childs=[];for(i=0;i<n.length;i++){t=this.patchAttributeWithChildElement(n[i]);r.childs.push(t)}return r},patchAttributeElement:function(e,t,i){var n,r=t.mine,s=t.name;if(r){if(y.hasDuiAttr(r,"jte-removed"))return;if(s){n=this.findValue(e,i.value);if(!1===this.patchEmpty(r,i,n))return;y.attr(r,s,n?n.value():"")}}i.module&&this.callModule(i.module,{data:e,element:r,attr:i})},patchModuleElement:function(e,t,i){var n=t.mine,r=t.name;if(r&&!y.hasDuiAttr(n,"jte-removed")){if(V.jteHasModule(r))return V.jteCallModuleElement(r,{jte:this,data:e,element:n,attr:i});this.callModule(r,{jte:this,data:e,element:n,attr:i})}},findValue:function(e,t,i){if(t){if("/"==(t?t.charAt(0):undefined)){var n,r,s=/^([\S]*?)\[([\S]*)\]$/i,a=t.substring(1).split("/"),o=a.length,l=this.cursor?this.cursor.root:undefined;for(r=0;r<o;r++){if(!l)return;if(t=a[r].trim())if(n=s.exec(t))l=l.cursor(n[1],n[2]);else if(void 0===(l=l.cursor(t,"i")))return}return l}return e.data(t)}},isEmpty:function(e){return void 0===e||""===e||null===e||"object"==typeof e&&(void 0===(e=e.value())||""===e||null===e)},patchEmpty:function(e,t,i){if(this.isEmpty(i))switch(t.empty){case"remove":y.duiAttr(e,"jte-removed",!0);y.remove(e);return!1}else switch(t.noempty){case"remove":y.duiAttr(e,"jte-removed",!0);y.remove(e);return!1}},sampleElement:function(e){var t,i,n,r,s,a,o,l;if(!(i=y.attr(e,"jte-from")))return e;if(!(t=-1!=(n=i.indexOf(":"))?i.substring(n+1):i))return e;r=-1!=n?i.substring(0,n):"outer";y.attr(e,"jte-source");s="jte-sample";y.isElement(this.top)&&(l=y.query(this.top,'[jte-name="'+t+'"]'));if(!l&&!(l=y.query(document,'[jte-name="'+t+'"]')))throw new Error("Not found jte-name("+t+")");if(a=y.hasAttr(l,s)){p.ie&&p.ie<8&&g.hide(l);o=l.getAttribute(s);l.removeAttribute(s)}if("inner"==r){e.innerHTML=l.outerHTML.trim();a&&l.setAttribute(s,o);a&&p.ie&&p.ie<8&&g.show(y.first(e));return e}var u,c,h,d=y.element(l.outerHTML.trim());a&&p.ie&&p.ie<8&&g.show(d);for(c=0;c<e.attributes.length;c++){u=e.attributes[c];if(p.ie&&p.ie<8)if("style"==u.name){h=e.getAttribute(u.name);for(var f in h)h[f]&&(d.style[f]=h[f])}else null!==(h=e.getAttribute(u.name))&&"null"!=u.value&&""!==h&&void 0!==h&&"boolean"!=typeof h&&0!==h&&d.setAttribute(u.name,u.value);else d.setAttribute(u.name,u.value)}y.before(e,d);y.remove(e);(e=d).removeAttribute(s);e.removeAttribute("jte-from");a&&l.setAttribute(s,o);return e}};V.baseController=function(e){new H(e).draw()};V.selectTag=function(e,t,i,n){var r,s,a,o,l;if(y.isArray(t))for(a=0;a<t.length;a++){o=t[a];(r=document.createElement("option")).value=o.name;r.innerText=o.value;r.value===i&&(l=r.selected=!0);e.appendChild(r)}else for(s in t){(r=document.createElement("option")).value=s;r.value===i&&(l=r.selected=!0);r.innerText="string"==typeof t[s]?t[s]:t[s].value;e.appendChild(r)}"function"==typeof n&&n(l)};V.isJteAttrElement=function(e){var t,i=e.nodeName.toLowerCase();if("div"==i||"tr"==i||"thead"==i||"tbody"==i||"option"==i){if(t=e.getAttribute("jte-module"))return{type:"module",element:e,name:t};if(t=e.getAttribute("jte-attr"))return{type:"attr",element:e,name:t}}return!1};V.getJteAttrElements=function(e){var t,i,n,r=[];for(t=0;t<e.children.length;t++)(n=V.isJteAttrElement(i=e.children[t]))&&r.push(n);if(0===r.length)return r;for(t=0;t<r.length;t++){(i=r[t]).mine=V.searchMineElement(e,i.element);y.remove(i.element)}return r};V.isJteModuleElement=function(e){var t,i=e.nodeName.toLowerCase();return!("div"!=i&&"tr"!=i&&"thead"!=i&&"tbody"!=i&&"option"!=i||!(t=e.getAttribute("jte-module")))&&{type:"module",element:e,name:t}};V.getJteModuleElements=function(e){var t,i,n,r=[];for(t=0;t<e.children.length;t++)(n=V.isJteModuleElement(i=e.children[t]))&&r.push(n);if(0===r.length)return r;for(t=0;t<r.length;t++){(i=r[t]).mine=V.searchMineElement(e,i.element);y.remove(i.element)}return r};(V.jteModuleNames={})["@event"]="dframework/jte/module/event";V.jteModuleNames["@show"]="dframework/jte/module/show";V.jteModuleNames["@hide"]="dframework/jte/module/hide";V.jteModuleNames["@toggle"]="dframework/jte/module/toggle";V.jteModuleNames["@checked"]="dframework/jte/module/checked";V.jteModuleNames["@checkbox"]="dframework/jte/module/checkbox";V.jteModuleNames["@receiver"]="dframework/jte/module/receiver";V.jteModuleNames["@remove-row"]="dframework/jte/module/remove-row";V.jteModuleNames["@dragzone"]="dframework/jte/module/dragzone";V.jteModuleNames["@filedragzone"]="dframework/jte/module/filedragzone";V.jteModuleNames["@file"]="dframework/jte/module/file";V.jteModuleNames["@gallery"]="dframework/jte/module/gallery";V.jteModuleNames["@cburl"]="dframework/jte/module/cburl";V.jteModuleNames["@inputchk"]="dframework/jte/module/inputchk";V.jteModuleNames["@submit"]="dframework/jte/module/submit";V.jteModuleNames["@ajax"]="dframework/jte/module/ajax";V.jteModuleNames["@dialog"]="dframework/jte/module/dialog";V.jteModuleNames["@close"]="dframework/jte/module/close";V.jteHasModule=function(e){return!!V.jteModuleNames[e]};V.jteModuleName=function(e){return V.jteModuleNames[e]};V.jteCallModuleElement=function(e,t){var i=t.attr,n=y.module(V.jteModuleNames[e]);if("function"!=typeof n)return y.error(new TypeError("Not found jte element module. name: "+e));i.sourceJTE=t.jte;i.sourceData=t.data;n(t.element,i)};V.findTargetElement=function(e,t){var i=window.document,n=i.body;function r(e,t){switch(t){case"document":return i;case"body":return n;case"this":return e;case"parent":return y.parent(e);case"before":case"beforeall":return y.before(e);case"after":case"afterall":return y.after(e);case"first":return y.first(e);case"last":return y.last(e);default:return}}for(var s=r(e,t);;){if(!s||!y.isElement(s)||s===n)return s;if(!!!(y.hasAttr(s,"jte-sample")||y.hasAttr(s,"jte-attr")||y.hasAttr(s,"jte-module")))return s;switch(t){case"before":case"beforeall":case"after":case"afterall":s=r(s,t);continue}return s}};V.query=function(e,t){if(!t)return null;var i,n,r,s=document,a=s.body,o=e,l=t.target;if(t.query)i=t.query.trim();else if(t.queryAll||t.queryall){n=!0;i=t.queryAll?t.queryAll.trim():t.queryall.trim()}if(y.isElement(l)||l===s||l===a)o=l;else{var u,c,h,d,f,p=[],m=l?l.split("/"):["before"];for(h=0;h<m.length;h++)if(f=m[h].trim())if(-1!=(u=f.indexOf(":"))){if(c=f.substring(0,u).trim()){p.push(c);if((f=f.substring(u+1).trim())&&1<(f=parseInt(f)))for(d=1;d<f;d++)p.push(c)}}else p.push(f);for(h=0;h<p.length;h++)if(f=p[h].trim()){if(!(o=V.findTargetElement(o,f)))return null;r=f}}o&&i&&(o=n?y.queryAll(o,i):y.query(o,i));return!o||y.isArray(o)&&0===o.length?null:{source:e,lastName:r,names:p,element:n?o:[o]}};V.searchMineElement=function(e,t){var i;if(!(i=y.attr(t,"mine"))||!(i=i.trim())||"parent"==i.toLowerCase())return e;if("before"!=i.toLowerCase())return y.error(new Error("attribute element mine value is parent or before."));for(;;){if(!(t=y.before(t)))return;if(y.isElement(t)&&!V.isJteAttrElement(t))return t}};V.toJson=p.ie&&p.ie<9?function(e){return y.jQuery.parseJSON(e)}:function(e){var t,r,i=function(){for(var e;;){e="a"+y.guid("");if(!window[e])return e}}(),n="'"+i+"'";function s(e,t,i){var n=window[e];if(n){r=t;p.ie&&p.ie<9||y.remove(window[e].script);window[e]=n=n.error=n.script=undefined}}window[i]=function(e,t){s(e,t)};window[i].error=function(e,t){s(e,null)};window[i].script=document.createElement("script");window[i].script.type="text/javascript";t="try {\n\twindow["+n+"]("+n+", "+e+");\n} catch(e){\n\t\twindow["+n+"].error("+n+", e);\n}";if(p.ie&&p.ie<9)return y.error(new Error("Not support script inner text. under ie 9."));window[i].script.innerText=t;document.body.appendChild(window[i].script);return r};V.elementToJson=function(e){var t;if(t=e.innerText.trim())return V.toJson(t)};V.getChildAttribute=function(e,t,i,n){if(e&&e.childs){var r,s,a,o=[];if(!n){for(s=0;s<e.childs.length;s++)(r=e.childs[s])[t]===i&&o.push(r);return o.length?o:null}for(s=e.childs.length-1;0<=s;s--)if((r=e.childs[s])[t]===i){o.push(r);e.childs.splice(s,1)}if(o.length){a=[];for(s=o.length-1;0<=s;s--)a.push(o[s]);return a}}};var S=[];V.addUserData=function(e,t){var i=new Error("add data : "+e);S.push({name:e,value:t,stack:i})};V.removeUserData=function(e,t){for(var i=S.length-1;0<=i;i--)S[i].name===e&&S.splice(i,1)};V.getUserData=function(e){for(var t=0;t<S.length;t++)if(S[t].name===e)return S[t]};V.getUserDataValue=function(e){var t=V.getUserData(e);if(t)return t.value};V.getUserDataAll=function(e){for(var t=[],i=0;i<S.length;i++)S[i].name===e&&t.push(S[i]);return t};var _,C=[],A={},x={},k=[];V.getRegister=function(e){return A[e]};V.getRegisterModule=function(e){return x[e]};j.prototype={constructor:j,hasEvent:function(e){return!!this.event[e]},getEvent:function(e){return this.event[e]},addEvent:function(e,t){if(e){var i,n,r,s=e.split(",");y.each.call(this,s,function(e){if(e=e.trim()){n=this.event[e];if((r=n||(this.event[e]=[])).length)for(i=0;i<r.length;i++)if(r[i]===t)return;r.push(t);this._events.push(t);n||y.on(this.element,e,j.onEvent)}})}},removeEvent:function(e,t){if(e){var i,n,r,s,a,o=e.split(",");for(i=0;i<o.length;i++)if((r=o[i].trim())&&(s=this.event[r])){a=!1;for(n=0;n<s.length;n++)if(s[n]===t){a=n;break}if(!1!==a){y.remove(s,a);0===s.length&&y.off(this.element,r,j.onEvent)}}}},callEvent:function(e){var t,i,n;if(t=this.event[e.type])for(n=0;n<t.length;n++){i=t[n];try{if(i instanceof G&&!1===i.__on(e))return!1}catch(err){y.error(err)}}}};j.onEvent=function(e){var t,i=p.ie&&p.ie<9?y.target(e):this;if(p.ie&&p.ie<9)for(;(!(t=y.duiAttr(i,"jte-element"))||!t.hasEvent(e.type))&&(i=y.parent(i)););else t=y.duiAttr(i,"jte-element");if(t)return t.callEvent(e)};j.on=function(e,t,i){j.get(e).addEvent(t,i)};j.off=function(e,t,i){j.get(e).removeEvent(t,i)};j.get=function(e){var t=y.duiAttr(e,"jte-element");return t||(t=y.duiAttr(e,"jte-element",new j(e)))?t:y.error(new Error("Not found JteElement dui attribute."),e)};j.has=function(e){return!!y.duiAttr(e,"jte-element")};G.prototype={constructor:G,ready:function(){var e=this.args,t=V.getChildAttribute(e,"way","to",!0),i=V.getChildAttribute(e,"way","from",!0);t&&t.length&&(this.toElement=this.patchWithElement(t));i&&i.length&&(this.fromElement=this.patchWithElement(i));this.callUserModule("ready")},patchWithElement:function(e){var l,u,c=null;if(e&&e.length){c=[];y.each.call(this,e,function(e){l=e.module?y.module(e.module):null;if(e.event&&"string"==typeof e.event){var t,i,n,r,s,a={},o=e.event.split(",");for(t=0;t<o.length;t++)(i=o[t].trim())&&(-1==(n=i.indexOf(":"))?a[i]=!0:(r=i.substring(0,n).trim())?a[r]=!(s=i.substring(n+1).trim())||s:a.all=!(s=i.substring(n+1).trim())||s);e.event=a}if(e.target)return(u=this.patchQuery(e))?this.addWithElement(c,u,e,l):null;c.push({module:l})})}return c},addWithElement:function(e,i,n,r){var s,a,t=y.isArray(i.element)?i.element:[i.element],o=n.childs;y.each.call(this,t,function(t){if(y.isElement(t)&&!this.getWithElement(e,t)){y.each.call(this,o,function(e){if(e){s=(s=V.jteModuleName(e.module))?s:e.module;if(!(a=y.module(s)))return y.error(new Error("Not found module. name: "+e.name));"this"==e.target&&(e.target=this.origin);a(t,e)}});e.push({module:r,element:t,query:i,option:n})}})},getWithElement:function(e,t){var i;for(i=0;i<e.length;i++)if(e[i].element===t)return e[i]},patchQuery:function(e){var t;if(e.target&&(t=V.query(this.origin,e)))return t;e.target||y.error("Not found query element.",e,"at element: ",this.origin);return null},_addEvent:function(e){var t,i,n=this.asEvent?this.asEvent:this.asEvent={},r=e.indexOf(":");if(-1==r)i=e.trim();else{i=e.substring(0,r).trim();t=e.substring(r+1).trim()}n[i]=t||!0;this.jtee.addEvent(i,this)},addEvent:function(e){"string"==typeof e?y.each.call(this,e.split(","),function(e){this._addEvent(e)}):y.isArray(e)&&e.length&&y.each.call(this,e,function(e){this._addEvent(e)})},removeEvent:function(e){this.jtee&&this.jtee.removeEvent(e,this)},hasEvent:function(e){return!(!this.asEvent||!this.asEvent[e])},getEvent:function(e){return this.asEvent?this.asEvent[e]:null},callUserModule:function(e){var t,i,n,r=this.userModule;if(r&&r.length)for(t=0;t<r.length;t++)if(i=r[t][e])if(this.jte&&this.jte.module&&(n=this.jte.module[i])){if(!1===n.apply(this,arguments))return!1}else if(n=y.module(i)){if(!1===n.apply(this,arguments))return!1}else y.error(new Error("Not found module ("+i+") for "+e+".",this))},_getDispatchEventArgument:function(e,t,i,n,r){var s,a,o=r&&r.event?r.event:null;e||(e={});e.target=y.isElement(i)?i:this.origin;if(o&&o.all&&!0!==o.all){e.type&&(e.originType=e.type);e.type=o.all}else e.type?e.type=o&&o[e.type]&&!0!==o[e.type]?o[e.type]:e.type:t&&t.type&&(e.type=o&&o[t.type]&&!0!==o[t.type]?o[t.type]:t.type);if(!e.type)return y.error(new Error("Not found event type. ",t,i,n,r));t&&(e.fromEvent=t);e.fromElement||(e.fromElement=y.isElement(this.origin)?this.origin:t?t.target:null);if(e.args){if("object"==typeof n){s=e.args;for(a in n)s[a]=n[a]}}else s=e.args="object"==typeof n?n:{};s.data=this.data;s.jte=this.jte;s.fromModule=this;return e},getDispatchEventArgument:function(e,t,i,n,r){return this._getDispatchEventArgument(e,t,i,n,r)},repatchEventToElement:function(e,t){return j.get(e).callEvent(t)},_dispatchEventToElement:function(e,t,i,n){var r;if("function"==typeof i.module){r=this.getDispatchEventArgument(e,t,i.element,n,i.option);if(!1===i.module(r))return!1}if(y.isElement(i.element)&&i.element!==this.origin){r=this.getDispatchEventArgument(e,t,i.element,n,i.option);if(!1===this.repatchEventToElement(i.element,r))return!1}if(y.isElement(i)&&i!==this.origin){r=this.getDispatchEventArgument(e,t,i,n);if(!1===this.repatchEventToElement(i,r))return!1}},dispatchEventToElement:function(e,t,i,n){return this._dispatchEventToElement(e,t,i,n)},_dispatchEvent:function(e,t,i,n){var r;if(!y.isArray(i))return this.dispatchEventToElement(e,t,i,n);for(r=0;r<i.length;r++)if(!1===this.dispatchEventToElement(e,t,i[r],n))return!1},dispatchEvent:function(e,t,i){var n,r=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(e,t,null,i)))&&((!(n=r&&r.element)||!1!==this._dispatchEvent(e,t,n,i))&&((!(n=this.toElement)||!1!==this._dispatchEvent(e,t,n,i))&&void 0))},_dispatchElement:function(t,e){y.isArray(e)?y.each.call(this,e,function(e){t.push(e)}):t.push(e)},dispatchElement:function(){var e,t=this.targetElement,i=[];"function"==typeof this.module&&i.push(this.module);(e=t&&t.element)&&this._dispatchElement(i,e);(e=this.toElement)&&this._dispatchElement(i,e);return i},__on:function(e){return!1!==this.callUserModule("on")&&(!1!==this.on(e)&&(!1!==this.callUserModule("complete")&&void 0))},on:function(e){}};V.JteModule=G;y.define("dframework/jte/module/event",function(){function i(e,t){V.JteModule.apply(this,arguments)}y.extendClass(i,V.JteModule,{on:function(e){var t,i=e.type;if(t=this.getEvent(i)){if(!0===t)return this.dispatchEvent({type:i},e);if("string"==typeof t)return this.dispatchEvent({type:t},e)}}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/show",function(){function i(e,t){V.JteModule.apply(this,arguments);this.isUserEvent||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.hasEvent(e.type))return this.show(e)},show:function(e){var t,i=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(ne,oe,null,a)))&&((!(t=i&&i.element)||!1!==function(e,t){y.each(t,function(e){y.ui.show(e)})}.call(this,e,t))&&void 0)}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/hide",function(){function i(e,t){V.JteModule.apply(this,arguments);this.isUserEvent||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.hasEvent(e.type))return this.hide(e)},hide:function(e){var t,i=this.targetElement;return("function"!=typeof this.module||!1!==this.module.call(this,this.getDispatchEventArgument(ne,oe,null,a)))&&((!(t=i&&i.element)||!1!==function(e,t){y.each(t,function(e){y.ui.hide(e)})}.call(this,e,t))&&void 0)}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/toggle",function(){function i(e,t){V.JteModule.apply(this,arguments);this.toggleStatus="show";t.nocursor||y.cursor(e,t.cursor?t.cursor:"hand");if("hide"==t.status){this.toggleStatus="show";this.toggle({target:e},"hide")}else if("show"==t.status){this.toggleStatus="hide";this.toggle({target:e},"show")}this.isUserEvent||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.hasEvent(e.type))return this.toggle(e)},toggle:function(e,t){function i(e,t,i,n,r){for(var s,a=r||this.toggleStatus;t;){y.isElement(t)&&!y.hasAttr(t,"jte-sample")&&("hide"==r?g.hide(t):"show"==r?g.show(t):"show"==a?g.show(t,n):g.hide(t,n));switch(i.lastName){case"beforeall":t=y.before(t);break;case"afterall":t=y.after(t);break;default:t=undefined}}(s="function"==typeof o.module?o.module:"string"==typeof o.module&&y.module(o.module))&&a&&s.call(this.origin,e,a)}var n,r,s,o=this.args;(o.animation||o.duration||o.method)&&(n={module:o.method,duration:o.duration?parseInt(o.duration):undefined});this.toggleStatus="show"==this.toggleStatus?"hide":"show";if(s=this.patchQuery(o))for(r=0;r<s.element.length;r++)i.call(this,e,s.element[r],s,n,t)}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/checked",function(){function i(e,t){V.JteModule.apply(this,arguments);t.nocursor||y.cursor(e,t.cursor?t.cursor:"hand");this.isUserEvent||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.hasEvent(e.type))return this.toggleChecked(e)},toggleChecked:function(e){var t,i,n=this.args;if(t=this.patchQuery(n))for(i=0;i<t.element.length;i++)this.toggleCheckedTarget(e,t.element[i])},toggleCheckedTarget:function(e,t){var i,n;(i=y.attr(t,"type"))||(i="");if(!t.disabled){n=!t.checked;switch(i.toLowerCase()){case"checkbox":case"radio":default:t.checked=n}t.checked===n&&this.dispatchEventToElement({type:"change"},e,t,{value:n})}}});return function(e,t){return new i(e,t)}});y.setTimeout=function(e,t){setTimeout(function(){},t)};y.define("dframework/jte/module/receiver",function(){function n(e,t){V.JteModule.apply(this,arguments);this.addEvent("receiver")}y.extendClass(n,V.JteModule,{on:function(e){if(this.hasEvent(e.type))return this.receiver(e)},receiver:function(e){var t,i,n=this.args,r=e.args,s=n?n.method:e.args&&e.args.method?e.args.method:"";switch(s){case"class":if(r&&!0===r.value){n.on&&y.addClass(this.origin,n.on);"string"==typeof n.ontext?this.origin.innerText=n.ontext:"string"==typeof n.onhtml&&(this.origin.innerHTML=n.onhtml);n.off&&y.removeClass(this.origin,n.off);n.init&&y.removeClass(this.origin,n.init)}else if(!r||r&&!1===r.value){n.on&&y.removeClass(this.origin,n.on);n.off&&y.addClass(this.origin,n.off);"string"==typeof n.offtext?this.origin.innerText=n.offtext:"string"==typeof n.offhtml&&(this.origin.innerHTML=n.offhtml);n.init&&y.removeClass(this.origin,n.init)}else if(r&&0===r.value){n.on&&y.removeClass(this.origin,n.on);n.off&&y.removeClass(this.origin,n.off);n.init&&y.addClass(this.origin,n.init);"string"==typeof n.inittext?this.origin.innerText=n.inittext:"string"==typeof n.inithtml&&(this.origin.innerHTML=n.inithtml)}return;case"setclass":if(r){r.add&&y.addClass(this.origin,r.add);r.remove&&y.removeClass(this.origin,r.remove)}return;case"toggle-data":return this.receiver_data(e,{remove:!(!r||"boolean"!=typeof r.value)&&!r.value,data:e.args.data});case"toggle-value":return this.receiver_data(e,{remove:!(!r||"boolean"!=typeof r.value)&&!r.value,data:e.args.value});case"jte-data":return this.receiver_data(e);case"jte-module":if(!(t=n?n.moduleName:""))return y.error("Not found module name at receiver module",e);i=(i=V.jteModuleName(t))?i:t;return(i=y.module(i))?"function"!=typeof i?y.error(new Error("Is Not function. module-name: "+t),e):i(e,this):y.error(new Error("Not found module. name: "+t),e);case"enabled":this.origin.disabled=!r.value;break;case"disabled":this.origin.disabled=!!r.value;break;default:y.error("Not found method at receiver module. method: "+s,e)}},receiver_data:function(e,t){var i,n={from:this.origin};if(t)for(i in t)n[i]=t[i];V(n)}});return function(e,t){var i=j.get(e).event.receiver;if(!i||!i.length)return new n(e,t)}});y.define("dframework/jte/module/checkbox",function(){function i(e,t){V.JteModule.apply(this,arguments);p.ie&&p.ie<9&&this.addEvent("click");this.addEvent("change")}y.extendClass(i,V.JteModule,{on:function(e){return this.dispatchEvent({type:"receiver"},e,{value:this.origin.checked})}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/remove-row",function(){function i(e,t){V.JteModule.apply(this,arguments);t.nocursor||y.cursor(e,t.cursor?t.cursor:"hand");this.isUserEvent||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.hasEvent(e.type)){for(var t,i,n,r,s=this.origin,a=null;;){if(!y.isElement(s))break;if(n||null===(a=y.attr(s,"jte-row-no"))){if(!r&&null!==y.attr(s,"jte-list")){r=s;break}}else n=s;s=y.parent(s)}if(n&&r&&(t=y.queryAll(r,'[jte-row-no="'+a+'"]')))for(i=0;i<t.length;i++)y.remove(t[i]);return this.dispatchEvent({},e,{value:{removeElement:t,listElement:r}})}}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/dragzone",function(){function i(e,t){V.JteModule.apply(this,arguments);var i;this.getEvent(i="dragenter")||this.addEvent(i);this.getEvent(i="dragover")||this.addEvent(i);this.getEvent(i="dragleave")||this.addEvent(i);this.getEvent(i="drop")||this.addEvent(i)}y.extendClass(i,V.JteModule,{on:function(e){var t,i=e.type;if(t=this.getEvent(i))switch(i){case"drop":break;default:if(!0===t)return this.dispatchEvent({type:i},e);if("string"==typeof t)return this.dispatchEvent({type:t},e)}}});return function(e,t){return new i(e,t)}});var R,N=function(e){e.stopPropagation&&e.stopPropagation();e.preventDefault&&e.preventDefault();e.dataTransfer.dropEffect="copy";return _.on(e)},L=function(e){var t,i,n;e.preventDefault&&e.preventDefault();if((t=e.dataTransfer.files)&&t.length){i=[];for(n=0;n<t.length;n++)i.push(t[n])}e.args={value:i};return _.on(e)};q.prototype={constructor:q,add:function(e){this.mods.push(e);1==this.mods.length&&this.start()},remove:function(e){for(var t=0;t<this.mods.length;t++)if(this.mods[t]===e)return this.mods.splice(t,1);0===this.mods.length&&this.stop()},start:function(){y.on(this.target,"dragover",N);y.on(this.target,"drop",L)},stop:function(){y.off(this.target,"dragover",N);y.off(this.target,"drop",L)},on:function(e){var t,i,n,r,s,a,o,l;for(i=this.mods.length-1;0<=i;i--){t=this.mods[i];if(y.isElement(n=t.origin)&&"none"!=t.origin.style.display){s=!1;r=n;for(;;){a=y.parent(r);if("none"==r.style.display||y.attr(r,"jte-sample")||!a)break;if(a===document.body||a===document){s=!0;break}r=a}if(s&&(!((l=t.args)&&l.inrect&&"false"!=l.inrect&&(o=y.getBoundingClientRect(t.origin)))||o.contains(e.x,e.y))&&!1===t.__on(e))return!1}}}};_=new q;y.define("dframework/jte/module/filedragzone",function(){function i(e,t){V.JteModule.apply(this,arguments);_.add(this)}y.extendClass(i,V.JteModule,{on:function(e){var t,i,n,r=e.type,s=e.args,a=s&&s.value;if(a)for(t=0;t<a.length;t++){(i=a[t]).sizeText=y.fileSize(i.size);2==(n=i.sizeText.split(" ")).length&&(i.sizeName=n[1])}return"drop"!==r?this.dispatchEvent({type:r},e,{value:a}):this.dispatchEvent({type:"receiver"},e,{value:a})}});return function(e,t){if(p.ie&&p.ie<10)throw new TypeError("filedragzone module is not support. ie<=9");return new i(e,t)}});y.define("dframework/jte/module/cburl",function(){function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){var t,i=this.args;if(i.method&&(t=y.param("cb-"+i.method))){"true"===i.replace?document.location.replace(t):document.location.href=t;return"true"==i.replace?document.location.replace(t):document.location.href=t}switch(i.method){case"cancel":window.history.back()}}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/inputchk",function(){var h=function(e,t){return new i(e,t)};h.specialChars="`~!@#$%^&*()-=_+[]{}:;\"'\\|<>?,./";h.numberChars="0123456789";h.E2000={code:2e3,val:"There is no {$x-name} input."};h.E2001={code:2001,val:"{$x-name} is english, number, '_'"};h.E2002={code:2002,val:"{$x-name} length is min better {$min}."};h.E2003={code:2003,val:"{$x-name} length is max better {$max}."};h.E2004={code:2004,val:"{$x-name} with special charactor"};h.E2005={code:2005,val:"{$x-name} with number charactor"};h.E2006={code:2006,val:"{$x-name} is Wrong email type"};h.E2007={code:2007,val:"{$x-name} is no comparison found"};h.E2008={code:2008,val:"{$x-name} is not equals confirm password"};h.E2009={code:2009,val:"Integer"};h.E2010={code:2010,val:"Float"};h.E2012={code:2012,val:"min value"};h.E2013={code:2013,val:"max value"};h.E2800={code:2800,val:"Not found target element."};h.E2810={code:2810,val:"Not found form element."};h.E2811={code:2811,val:"You has submit element."};h.E2990={code:2990,val:"Wrong format"};h.E2999={code:2999,val:""};function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("keyup")||this.addEvent("keyup");this.id="dframework/jte/module/inputchk";this.errorCode}y.extendClass(i,V.JteModule,{ready:function(){i.__super.ready.call(this);var e=this.args;e.min&&(e.min=y.parseInt(e.min));e.max&&(e.max=y.parseInt(e.max))},on:function(e){return this.check(e)},getErrorMessage:function(){var e,t,i,n,r,s,a=this.errorInfo?this.errorInfo.val:"",o=a,l="";if(!a)return"";for(;;){if(!o||!(e=/\{[\s]*\$([a-zA-Z0-9\-\_\:]+)[\s]*\}/i.exec(o)))break;t=e[0];i=e[1];r=o.indexOf(t);s=o.substring(0,r);o=o.substring(r+t.length);(n=this.args[i])?l+=s+n:l+=s}return o?l+o:l},getErrorCode:function(){return this.errorInfo?this.errorInfo.code:0},setErrorCode:function(e,t){return!(this.errorInfo={code:e.code,val:e.val,args:t})},repatchEventToElement:function(e,t){if(!j.has(e))return!1;var i,n,r,s,a=j.get(e).event.receiver;if(!a)return!1;for(i=0;i<a.length;i++){n=a[i];try{if(n instanceof G)switch(n.args.method){case"class":s=t.args.value;t.args.value.checksum;t.args.value=0===this.origin.value.length?0:!t.args.value.checksum;r=n.__on(t);t.args.value=s;if(!1===r)return!1;break;default:if(!1===n.__on(t))return!1}}catch(err){y.error(err)}}},check:function(e,t){var i=this._check(e,t),n=(this.dispatchElement(),this.origin.value);this.dispatchEvent({type:"receiver"},e,{value:{value:n,checksum:!1!==i,errorCode:this.getErrorCode(),errorMessage:this.getErrorMessage(),args:this.args}});return i},_check:function(e,t){var i,n,r=this.args,s=this.origin.value?this.origin.value:"";this.errorInfo=null;"false"!=r.trim&&s&&(s=s.trim());switch(r.method){case"string":if(!s)return this.setErrorCode(h.E2000,r);if("number"==typeof r.min&&s.length<r.min)return this.setErrorCode(h.E2002,r);if("number"==typeof r.max&&s.length>r.max)return this.setErrorCode(h.E2003,r);break;case"number":if(!s)return this.setErrorCode(h.E2000,r);iv=parseInt(s);if("number"==typeof r.min&&iv<r.min)return this.setErrorCode(h.E2012,r);if("number"==typeof r.max&&iv>r.max)return this.setErrorCode(h.E2013,r)}switch(r.format){case"id":if(!/^([a-zA-Z]{1}[0-9a-zA-Z\_]+)$/.exec(s))return this.setErrorCode(h.E2001,r);break;case"integer":if(!/^([0-9]+)$/.exec(s))return this.setErrorCode(h.E2009,r);break;case"float":if(!/^([0-9\.]+)$/.exec(s))return this.setErrorCode(h.E2010,r);break;case"email":if(!/^([\S]+?)@([\S]+)$/.exec(s))return this.setErrorCode(h.E2006,r);break;case"password":var a=0,o=0,l=y.parseInt(r["with-special-char"],0),u=y.parseInt(r["with-number-char"],0);if(l||u)for(n=0;n<s.length;n++){l&&-1!=h.specialChars.indexOf(s[n])&&a++;u&&-1!=h.numberChars.indexOf(s[n])&&o++}if(l&&a<l)return this.setErrorCode(h.E2004,r);if(u&&o<u)return this.setErrorCode(h.E2005,r);if(!1===this.checkWithEqual(s,r,t))return!1}if(r.regexp&&(i=r.regexp.trim())){var c=r["regexp-flags"];if(!(c&&(c=c.trim())?new RegExp(i,c):new RegExp(i)).exec(s))return this.setErrorCode(h.E2990,r)}if("password"!=r.format&&!1===this.checkWithEqual(s,r,t))return!1},checkWithEqual:function(e,t,i){if(!i&&t["with-equal-target"]){var n,r,s,a,o,l={target:t["with-equal-target"],query:t["with-equal-query"],queryAll:t["with-equal-queryall"]?t["with-equal-queryall"]:t["with-equal-queryAll"]},u=V.query(this.origin,l);if(!u||!u.element||!u.element.length)return this.setErrorCode(h.E2007,t);for(n=0;n<u.element.length;n++){if((s=u.element[n]).value!==e)return this.setErrorCode(h.E2008,t);if(j.has(s)){a=j.get(s);for(r=0;r<a._events.length;r++)"dframework/jte/module/inputchk"==(o=a._events[r]).id&&o.check(null,!0)}}}}});return h});g.openArguments=["width","height","top","left","channelmode","directories","fullscreen","location","menubar","resizable","scrollbars","status","titlebar","toolbar","notab","replace","no-result-ok","x-ok-btn","x-ok-btnAll","x-cancel-btn","x-cancel-btnAll"];y.define("dframework/jte/module/submit",function(){var a=y.module("dframework/jte/module/inputchk");function i(e,t){V.JteModule.apply(this,arguments);this.formElement=(i=this.targetElement,n=i&&i.element?i.element[0]:null,!(!y.isElement(n)||"form"!=n.nodeName.toLowerCase())&&n);var i,n;if(this.formElement){var r=this;y.on(this.formElement,"submit",function(e){return r.__on(e)})}this.getEvent("click")||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){return this.check(e)},check:function(e){var t,i=this.args,n=this.targetElement,r=n&&n.element?n.element[0]:null;"function"==typeof e.preventDefault&&e.preventDefault();"function"==typeof e.stopPropagation&&e.stopPropagation();"function"==typeof e.stopImmediatepropagation&&e.stopImmediatepropagation();this._ces_error=[];this._submits=[];this._inputs=[];this._files=0;r&&y.isElement(r)||this._ces_error.push({element:this.origin,mod:null,code:a.E2800.code,val:a.E2800.val});this.checkElement(e,r);if(!this.formElement)switch(i.method){case"form":this._ces_error.push({element:this.origin,mod:null,code:a.E2810.code,val:a.E2810.val})}this._submits.length&&this._ces_error.push({element:this.origin,mod:null,code:a.E2811.code,val:a.E2811.val});if(this._ces_error.length){y.error(this._ces_error);var s=this._ces_error[0];setTimeout(function(){y.ui.alert(s.val,{close:function(){s.element.focus&&s.element.focus();s=null}})},1)}else t=this.submit(e,r);delete this._ces_error;delete this._submits;delete this._inputs;delete this._files;return t},checkElement:function(e,t){if(y.isElement(t)){var i,n=y.childs(t),r=y.attr(t,"type"),s=r?r.toLowerCase():"",a=t.nodeName.toLowerCase();if("submit"==s&&"input"!=a)this._submits.push(t);else if("input"==a){"file"==s&&this._files++;"button"!=s&&this._inputs.push(t)}this.checkJteElement(e,t);this._ces_error.length;for(i=0;i<n.length;i++)this.checkElement(e,n[i])}},checkJteElement:function(e,t){var i,n,r;if(j.has(t)&&(i=j.get(t))&&i._events&&i._events.length)for(n=0;n<i._events.length;n++)"dframework/jte/module/inputchk"==i._events[n].id&&!1===(r=i._events[n]).check()&&this._ces_error.push({element:t,mod:r,code:r.getErrorCode(),val:r.getErrorMessage()})},submit:function(e,s){var a=this.args,t=a.method?a.method:"",i=a.url?a.url:"",n=a.type?a.type.toLowerCase():"",r=a.enctype?a.enctype.toLowerCase():"",o=a.window?a.window:a.windowName?a.windowName:"",l={action:i||(this.formElement&&s.action?s.action:""),enctype:r||(this.formElement&&s.enctype?s.enctype:""),target:o||(this.formElement&&s.target?s.target:""),method:n||(this.formElement&&s.method?s.method:"")};if(this.formElement){s.action=l.action;s.enctype=l.enctype;s.target=l.target;s.method=l.method;if(!a.method||"form"==a.method)return s.submit()}var u,c,h,d={},f=g.openArguments;for(h=0;h<f.length;h++){c=f[h];!(u=typeof a[c])||"string"!=u&&"boolean"!=u&&"number"!=u||(d[c]=a[c])}d.url=l.action;d.name=l.target;var p=this;switch(t){case"window":if(this.formElement){s.target=d.name?d.name:d.name="A"+y.guid("");s.action=d.url;d.url="about:blank";y.open(d);return s.submit()}return y.error("Not support.");case"dialog":s.target=d.name?d.name:d.name="A"+y.guid("");s.action=d.url;d.url="about:blank";d.show=function(){s.submit();d=s=null};return y.ui.open(d);case"ajax":d.type=l.method;d.data=this.formElement?s:this._inputs;d.error=function(e){y.ui.alert("Error",{close:function(){p.error(null,e)}})};d.success=function(e,t,i){var n,r;try{n=y.toJson(e)}catch(s){y.error(s);r="Not parse result."}if(r||n&&!n.result){r||(r=n.error_msg?n.error_msg:"Error");y.ui.alert(r,{close:function(){p.error(n,i)}})}else a["no-result-ok"]?p.success():y.ui.alert("Success.",{close:function(){p.success(n,i)}})};return y.ajax(d);default:p=null}},error:function(e,t){this.lastjob(e,t,!1,"error")},success:function(e,t){this.lastjob(e,t,!0,"success")},lastjob:function(e,t,i,n){var r,s,a,o,l,u,c,h,d=this.args,f=V.getChildAttribute(d,"way",n,!0);if(f&&(!f||f.length))for(r=0;r<f.length;r++)if(o=(a=f[r]).location)document.location=o;else if(o=a["location-replace"])document.location.replace(o);else if(o=a["location-reload"])document.location.reload();else if(o=a["parent-href"])parent.location=o;else if(o=a["parent-replace"])parent.location.replace(o);else if(o=a["parent-reload"])parent.location.reload();else if(o=a["top-href"])top.location=o;else if(o=a["top-replace"])top.location.replace(o);else if(o=a["top-reload"])top.location.reload();else if(o=a.window){c={url:o};for(s=0;s<nl.length;s++)!(u=typeof a[l=nl[r]])||"string"!=u&&"boolean"!=u&&"number"!=u||(c[l]=a[l]);y.open(c)}else if(o=a.dialog){c={url:o};for(s=0;s<nl.length;s++)!(u=typeof a[l=nl[r]])||"string"!=u&&"boolean"!=u&&"number"!=u||(c[l]=a[l]);y.ui.open(c)}else(o=a.history)?history.go(parseInt(o)):(o=a.module)&&"function"==typeof(h=y.module(o))&&h.call(this,e,t,i)}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/ajax",function(){function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.getEvent(e.type))return this.ajax(e)},ajax:function(e){var a=this.args,t={type:a.method?a.method:"get",url:a.url},o=this;t.error=function(e){y.ui.alert("Error",{close:function(){o.error(null,e)}})};t.success=function(e,t,i){var n,r;try{n=y.toJson(e)}catch(s){y.error(s);r="Not parse result."}if(r||n&&!n.result){r||(r=n.error_msg?n.error_msg:"Error");y.ui.alert(r,{close:function(){o.error(n,i)}})}else a["no-result-ok"]?o.success():y.ui.alert("Success.",{close:function(){o.success(n,i)}})};return y.ajax(t)},error:function(e,t){this.lastjob(e,t,!1,"error")},success:function(e,t){this.lastjob(e,t,!0,"success")},lastjob:function(e,t,i,n){var r,s,a,o,l,u,c,h,d=this.args,f=V.getChildAttribute(d,"way",n,!0);if(f&&(!f||f.length))for(r=0;r<f.length;r++)if(o=(a=f[r]).location)document.location=o;else if(o=a["location-replace"])document.location.replace(o);else if(o=a["location-reload"])document.location.reload();else if(o=a["parent-href"])parent.location=o;else if(o=a["parent-replace"])parent.location.replace(o);else if(o=a["parent-reload"])parent.location.reload();else if(o=a["top-href"])top.location=o;else if(o=a["top-replace"])top.location.replace(o);else if(o=a["top-reload"])top.location.reload();else if(o=a.window){c={url:o};for(s=0;s<nl.length;s++)!(u=typeof a[l=nl[r]])||"string"!=u&&"boolean"!=u&&"number"!=u||(c[l]=a[l]);y.open(c)}else if(o=a.dialog){c={url:o};for(s=0;s<nl.length;s++)!(u=typeof a[l=nl[r]])||"string"!=u&&"boolean"!=u&&"number"!=u||(c[l]=a[l]);y.ui.open(c)}else(o=a.history)?history.go(parseInt(o)):(o=a.module)&&"function"==typeof(h=y.module(o))&&h.call(this,e,t,i)}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/dialog",function(){function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.getEvent(e.type))return this.open(e)},open:function(e){var t,i,n,r=this.args,s={url:r.url?r.url:"about:blank"},a=g.openArguments;for(t=0;t<a.length;t++)!(n=typeof r[i=a[t]])||"string"!=n&&"boolean"!=n&&"number"!=n||(s[i]=r[i]);y.ui.open(s);return!1}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/close",function(){function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("click")||this.addEvent("click")}y.extendClass(i,V.JteModule,{on:function(e){if(this.getEvent(e.type))return this.close(e)},close:function(e){this.args;return window.dframework_parent_dialog?window.dframework_parent_dialog.close():window.close()}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/file",function(){function i(e,t){V.JteModule.apply(this,arguments);this.getEvent("change")||this.addEvent("change:receiver");this.getEvent("remove-file")||this.addEvent("remove-file")}y.extendClass(i,V.JteModule,{on:function(e){var t,i,n=e.type;if(i=this.getEvent(n))switch(n){case"remove-file":if(p.ie&&10==p.ie){this.origin.type="text";this.origin.type="file"}else if(p.ie&&p.ie<10||"safari"==p.type&&p.safari<600){var r=document.createElement("div"),s=document.createElement("form");y.before(this.origin,r);s.appendChild(this.origin);s.reset();y.after(r,this.origin);y.remove(r)}else this.origin.value="";break;case"change":var a,o,l=e.target.files,u=[];if(l)for(t=0;t<l.length;t++){(o=l[t]).sizeText=y.fileSize(o.size);2==(a=o.sizeText.split(" ")).length&&(o.sizeName=a[1]);u.push(o)}return!0===i?this.dispatchEvent({type:n},e,{value:u}):this.dispatchEvent({type:i},e,{value:u})}}});return function(e,t){return new i(e,t)}});y.define("dframework/jte/module/gallery",function(){var a="click-gallary-ctrl";function s(e,t){V.JteModule.apply(this,arguments);this.addEvent(a)}y.extendClass(s,V.JteModule,{ready:function(){s.__super.ready.call(this);var e,t,i=this.args,n=this.fromElement,r=V.getChildAttribute(i,"way","ui-controller",!0);this.curId=-1;this.maxId=-1;this.real=[];this.receiverCtrl=[];if(!n||!n.length)return y.error("Not found from elements for gallery module.");y.each.call(this,n,function(e){if(y.isElement(e.element)){y.save(e.element);y.ui.show(e.element);"element"==i.method&&this.real.push(e.element)}});r&&r.length&&(e=this.patchWithElement(r))&&e.length&&this.readyCtrlEvent(this.uiController=e);if(i=this.args){i.timer&&(this.timerMsec=y.parseInt(i.timer));if(i.autotimer){this.autoTimer=!0;this.timerMsec||(this.timerMsec=2e3)}else i.timer&&(this.autoTimer=!0);switch(e=i["enable-user-next"]){case"false":this.enableUserNext=!1;break;case"true":this.enableUserNext=!0;break;default:this.enableUserNext=e||!0}}this.timerName=(t=this,y.uname(function(e,t){setTimeout(function(){window[e].object.onTimer()},t)},{object:t}));this.lastTime=(new Date).getTime();this.next();this.autoTimer&&this.timer()},_readyCtrlEvent:function(e){var t=e.element,i=y.queryAll(t,"[gal-event]"),s=y.module("dframework/jte/module/event"),n=y.module("dframework/jte/module/receiver");y.each.call(this,i,function(e){var t=y.attr(e,"gal-event");y.attr(e,"gal-checked");t||s(e,{event:"click:"+a,target:this.origin});if(t){var i=t.split(",")[0].trim(),n=i?i.indexOf(":"):-1,r=-1==n?i:i.substring(0,n);r&&s(e,{event:r+":"+a,target:this.origin})}});i=y.queryAll(t,"[gal-checked]");y.each.call(this,i,function(e){y.attr(e,"gal-checked");n(e);this.receiverCtrl.push({element:e,prefix:""})})},readyCtrlEvent:function(e){if(!y.isArray(e))return this._readyCtrlEvent(e);var t;for(t=0;t<e.length;t++)this._readyCtrlEvent(e[t])},currentId:function(){return this.curId},nextId:function(){return this.real.length>this.curId+1?this.curId+1:this.args.loop?0:-1},next:function(e,t){var i;if("number"==typeof e){var n=this.real.length;i=n<=e?n-1:e<0?0:e}else i=this.nextId();if(-1==i)return!1;this._showid(i,t);return!0},go:function(e){return this.next(e,!0)},timer:function(e){if(this.autoTimer){e=e||this.timerMsec;this.timerName&&e&&window[this.timerName](this.timerName,e)}},onTimer:function(){var e=(new Date).getTime()-this.lastTime;return e<this.timerMsec?this.timer(e):!1!==this.next()?this.timer(this.timerMsec):void 0},_showid:function(e,t){var i=this.real[e];if(y.isElement(i)){if(!t&&this.module&&!1===this.module.call(this,this.getDispatchEventArgument({type:"show-element"},null,this.origin,{id:e,element:i})))return!1;this._showElement(i,e);this.curId=e;this.curId>this.maxId&&(this.maxId=this.curId)}},_showElement:function(e,n){this.lastTime=(new Date).getTime();var t=y.first(this.origin);y.remove(t);y.append(this.origin,e);this.receiverCtrl&&this.receiverCtrl.length&&y.each.call(this,this.receiverCtrl,function(e){var t,i=y.attr(e.element,"gal-dataid");if(0<=(i=y.parseInt(i)))if(i<n){y.cursor(e.element,"pointer");this.dispatchEventToElement({type:"receiver"},{},e,{method:"setclass",add:"gal-selected-ctrl",remove:"gal-current-ctrl gal-noselected-ctrl"})}else if(i===n){y.cursor(e.element,"pointer");this.dispatchEventToElement({type:"receiver"},{},e,{method:"setclass",add:"gal-current-ctrl",remove:"gal-selected-ctrl gal-noselected-ctrl"})}else if(n<i){!0===(t=this.enableUserNext)?y.cursor(e.element,"pointer"):"max"==t&&this.maxId>=i?y.cursor(e.element,"pointer"):y.cursor(e.element,"");this.dispatchEventToElement({type:"receiver"},{},e,{method:"setclass",add:"gal-noselected-ctrl",remove:"gal-selected-ctrl gal-current-ctrl"})}})},on:function(e){var t,i=e.fromElement;switch(e.type){case a:if(this.enableUserNext&&(t=y.attrs(i)["gal-dataid"])&&(t=t.trim())&&t.isNumber()&&(0===(t=parseInt(t))||t)){if("max"===this.enableUserNext&&this.maxId<t)return;if("latest"===this.enableUserNext&&this.curId<t)return;return this.next(t)}}}});return function(e,t){return new s(e,t)}});y.async=m;y.math=e;y.ui=g;y.jte=V;y.define("dframework",function(){return y});y.define("dframework/async",function(){return m});y.define("dframework/math",function(){return e});y.define("dframework/ui",function(){return g});y.define("dframework/jte",function(){return V});R=y.scriptUrl("dframework"),y.setNamespaceUrl("dframework",R);y.readyFunction=function(){!0;y.async.waterfall([function(e){y.getNamespaceUrl("dframework");!function(){var e,t,i;if(p.ie&&p.ie<8){t=y.queryAll(document,"[jte-sample]");for(e=0;e<t.length;e++)g.hide(t[e])}u||y.initDui();var n=y.queryAll(document,'style[type="jte-style"]');for(e=0;e<n.length;e++)y.importJteStyleElement(n[e]);var r=y.queryAll(document,"[jte-user-data]");function s(e){var t,i,n;if((t=e.innerText.trim())&&(i=V.toJson(t)))for(n in i)V.addUserData(n,i[n])}var a,o=[];for(e=0;e<r.length;e++)o.push(r[e]);for(e=0;e<o.length;e++){a=o[e];if(y.isArray(a))for(i=0;i<a.length;i++)s(a[i]);else s(a);g.hide(a);y.remove(a)}r=o=undefined;var l=y.queryAll(document,"[jte-auto]");y.each(l,function(e){var t,i,n=y.attr(e,"jte-auto"),r=y.attr(e,"jte-data-name"),s=r?r.split("/"):null,a=s?s[0]:null,o=a?(o=V.getUserDataValue(a))?o:window.DFrameworkJson&&(o=window.DFrameworkJson[a])?o:window[a]:undefined;if(o&&1<s.length)for(t=1;o&&t<s.length;t++)o=void 0===(i=o[s[t]])?undefined:i;n&&"false"==n||V({from:e,data:o,type:n,debug:!0})});l=undefined}();e()},function(t){y.require("text://dframework/css/jte-style.css",function(e){y.importJteStyleText(e);t()},function(e){t(e)})}],function(e){e&&y.error(e)})}}function D(e){this.data=[];this.formElement=y.isElement(e)&&"form"==e.nodeName.toLowerCase()?e:null;this.saveElement=[]}function M(){this.data=[]}function O(e){this.readyState=0;this.xmlHttp=null;this.headers=new M;this.form={};if(e){var t;"function"==typeof e.error&&(this.onerror=e.error);"function"==typeof e.success&&(this.onsuccess=e.success);"function"==typeof e.progress&&(this.onprogress=e.progress);"function"==typeof e.readystatechange&&(this.onreadystatechange=e.readystatechange);this.enctype=e.enctype;this.type=e.type;this.user=e.user;this.password=e.password;this.url=e.url&&"string"==typeof e.url?e.url:undefined;e.data&&this.repairData(e.data);if(e.headers)for(t in e.headers)this.headers.append(t,e.headers[t]);"boolean"==typeof e.auto?this.auto=e.auto:this.auto=!0;e["safe-cross-domain"]&&(this["safe-cross-domain"]={url:"/dproject/helper/cross-domain/cross-domain.dsp"});e["virtual-host"]&&(this["virtual-host"]=e["virtual-host"]);e["virtual-ip"]&&(this["virtual-ip"]=e["virtual-ip"]);e["virtual-cookie"]&&(this["virtual-cookie"]=e["virtual-cookie"])}this.auto&&!0===this.open()&&this.send()}function P(e,t,i,n){switch(typeof e){case"number":this.left=e;this.top=t;this.right=i;this.bottom=n;break;case"object":if(e instanceof d){this.left=e.x;this.top=e.y;if(t instanceof d){this.right=t.x;this.bottom=t.y}}else{this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=e.bottom}break;case"string":this.left=parseInt(e);this.top=parseInt(t);this.right=parseInt(i);this.bottom=parseInt(n)}}function I(e,t){if("string"==typeof e)this.text=e;else if("object"==typeof e){t=e;this.title=t.title;this.text=t.text}this.attr=t||{};this.offsetTop=-100;this._auto="boolean"==typeof this.attr.auto?this.attr.auto:"false"!==this.attr.auto;this._modal="boolean"==typeof this.attr.modal?this.attr.modal:"false"!==this.attr.modal}function F(e,t){I.call(this,e,t)}function B(e){"object"==typeof e?F.call(this,e):F.call(this);this.guid=y.guid();this.userui=y.isElement(e.ui)?e.ui:null;this.noiframe=!!this.userui;this.no_button="true"===e.nobutton||!0===e.nobutton;this.use_titlebar="false"!==e.titlebar&&!1!==e.titlebar;this.no_result_ok="false"!==e.no_result_ok&&!1!==e.no_result_ok;this.callback=e.callback;e.success&&(this.success=e.success);e.error&&(this.error=e.error)}function U(e){this.attr=e||{};this.items=e.items;this.offsetTop=-100;this._auto="boolean"==typeof this.attr.auto?this.attr.auto:(this.attr.auto,!1);this._modal="boolean"==typeof this.attr.modal?this.attr.modal:(this.attr.modal,!1);this.ui;this.main;this.contents;this.contentsHtml="";this.background;this.reuse;this._lastShowAttr;this._parent}function V(s){var o,e,t,i;!function(){if(!s)throw new TypeError("ERROR(jte): Not found attribute parameter.");var e,t,i,n=typeof s.source,r=y.isElement(s.source)?s.source:undefined;s.to;if(!s.from)throw new TypeError("ERROR(jte): Not found from attribute.");s.to||"string"==n||(s.to=s.from);if(s.to&&"string"!=typeof s.to&&!y.isElement(s.to))throw new TypeError("ERROR(jte): to attribute is query-string or Element.");e=s.from===s.to&&"string"!=n;if("string"==typeof s.from&&s.source&&!r&&"string"!=n)throw new TypeError("ERROR(jte): source is Element or String.");(t={}).name="string"==typeof s.from?s.from:undefined;t.element=y.isElement(s.from)?s.from:t.name?s.source?y.isElement(s.source)?y.query(s.source,'[jte-name="'+a+'"]'):undefined:y.query(document,'[jte-name="'+s.from+'"]'):undefined;t.sourceName="string"==typeof s.source?s.source:undefined;if(!t.sourceName&&!t.element)throw new TypeError("ERROR(jte): from or to attribute is Element or query-string.");i={name:e?t.name:"string"==typeof s.to?s.to:undefined,element:e?t.element:s.to?y.isElement(s.to)?s.to:y.isElement(s.source)?y.query(s.source,'[jte-name="'+s.to+'"]'):y.query(document,'[jte-name="'+s.to+'"]'):undefined};if(s.to&&!i.element)throw new TypeError("ERROR(jte): Not found to element. to: "+s.to);o={debug:!!s.debug,type:s.type?s.type:undefined,data:s.data,cursor:new V.Cursor(s.data),module:s.module,init:s.init,from:t.element,fromName:t.name,source:r,sourceName:t.sourceName?0===t.sourceName.indexOf("html://")?t.sourceName:"html://"+t.sourceName:undefined,to:i.element,toName:i.name,equals:e,remove:s.remove}}();if(o.init&&(e=o.init.call(o)))return y.error(e);if(!s.controller){(t=o.from.getAttribute("jte-control"))&&(t=t.trim());if(t){if("function"!=typeof o.module[t])return y.error(new Error("Not found jte-control module. name: "+t));s.controller=o.module[t]}}switch(typeof s.controller){case"function":o.controller=s.controller;break;case"string":if("function"!=typeof o.module[t=s.controller])return y.error(new Error("Not found controller module. name: "+t));o.controller=o.module[t];break;default:o.controller=V.baseController}0;o.top||(o.top=o.from);t=o.controller(o);o.equals||!o.to?i&&y.before(i,o.from):y.isElement(o.to)&&o.to.appendChild(o.from);i&&y.remove(i);return t}function H(e){for(var t in e)this[t]=e[t];this.controller&&(this.controller=undefined)}function j(e){this.element=e;this.event={};this._events=[]}function G(e,t){y.isElement(this.origin=e)&&(this.jtee=j.get(e));if(t){var i,n;this.userModule=[];(this.args=t).sourceData&&(this.data=t.sourceData);t.sourceJTE&&(this.jte=t.sourceJTE);t.module&&(n=(r=t.module,(s=V.jteModuleName(r))?s:r))&&(n=n.trim())&&(this.module=y.module(this.moduleName=n));(i=V.getChildAttribute(t,"way","user",!0))&&i.length&&y.each.call(this,i,function(e){this.userModule.push(e)});t.target&&(this.targetElement=this.patchQuery(t));if(t.event){this.addEvent(t.event);this.asEvent&&(this.isUserEvent=!0)}(n=t["jte-register"])&&(n=n.trim())&&k.push(x[n]=this);this.ready()}var r,s}function q(){this.mods=[];this.target=document}}(window);!function(){var e,t,i=getDframework();if(i.b.ie&&i.b.ie<9){var n=window.$,r=window.jQuery;window.$=window.jQuery=undefined;e="undefined"!=typeof window?window:this,t=function(S,t){var h=[],p=S.document,c=h.slice,m=h.concat,o=h.push,l=h.indexOf,i={},u=i.toString,g=i.hasOwnProperty,_={},e="1.12.5-pre e09907ce152fb6ef7537a3733b1d65ead8ee6303",C=function(e,t){return new C.fn.init(e,t)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r=/^-ms-/,s=/-([\da-z])/gi,a=function(e,t){return t.toUpperCase()};C.fn=C.prototype={jquery:e,constructor:C,selector:"",length:0,toArray:function(){return c.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:c.call(this)},pushStack:function(e){var t=C.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return C.each(this,e)},map:function(i){return this.pushStack(C.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(c.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(0<=i&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:h.sort,splice:h.splice},C.extend=C.fn.extend=function(){var e,t,i,n,r,s,a=arguments[0]||{},o=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[o]||{},o++),"object"==typeof a||C.isFunction(a)||(a={}),o===l&&(a=this,o--);o<l;o++)if(null!=(r=arguments[o]))for(n in r)e=a[n],a!==(i=r[n])&&(u&&i&&(C.isPlainObject(i)||(t=C.isArray(i)))?(t?(t=!1,s=e&&C.isArray(e)?e:[]):s=e&&C.isPlainObject(e)?e:{},a[n]=C.extend(u,s,i)):void 0!==i&&(a[n]=i));return a},C.extend({expando:"jQuery"+(e+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===C.type(e)},isArray:Array.isArray||function(e){return"array"===C.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!C.isArray(e)&&0<=t-parseFloat(t)+1},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==C.type(e)||e.nodeType||C.isWindow(e))return!1;try{if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(h){return!1}if(!_.ownFirst)for(t in e)return g.call(e,t);for(t in e);return void 0===t||g.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?i[u.call(e)]||"object":typeof e},globalEval:function(e){e&&C.trim(e)&&(S.execScript||function(e){S.eval.call(S,e)})(e)},camelCase:function(e){return e.replace(r,"ms-").replace(s,a)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,n=0;if(v(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(n,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(v(Object(e))?C.merge(i,"string"==typeof e?[e]:e):o.call(i,e)),i},inArray:function(e,t,i){var n;if(t){if(l)return l.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,r=e.length;n<i;)e[r++]=t[n++];if(i!=i)for(;void 0!==t[n];)e[r++]=t[n++];return e.length=r,e},grep:function(e,t,i){for(var n=[],r=0,s=e.length,a=!i;r<s;r++)!t(e[r],r)!==a&&n.push(e[r]);return n},map:function(e,t,i){var n,r,s=0,a=[];if(v(e))for(n=e.length;s<n;s++)null!=(r=t(e[s],s,i))&&a.push(r);else for(s in e)null!=(r=t(e[s],s,i))&&a.push(r);return m.apply([],a)},guid:1,proxy:function(e,t){var i,n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),C.isFunction(e))return i=c.call(arguments,2),(n=function(){return e.apply(t||this,i.concat(c.call(arguments)))}).guid=e.guid=e.guid||C.guid++,n},now:function(){return+new Date},support:_}),"function"==typeof Symbol&&(C.fn[Symbol.iterator]=h[Symbol.iterator]),C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){i["[object "+t+"]"]=t.toLowerCase()});function v(e){var t=!!e&&"length"in e&&e.length,i=C.type(e);return"function"!==i&&!C.isWindow(e)&&("array"===i||0===t||"number"==typeof t&&0<t&&t-1 in e)}var d=function(i){var e,p,b,s,r,m,h,g,T,l,u,w,S,a,_,v,o,c,y,C="sizzle"+1*new Date,E=i.document,A=0,n=0,x=re(),d=re(),k=re(),f=function(e,t){return e===t&&(u=!0),0},R={}.hasOwnProperty,t=[],N=t.pop,L=t.push,D=t.push,M=t.slice,O=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\["+I+"*("+F+")(?:"+I+"*([*^$|!~]?=)"+I+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+I+"*\\]",U=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",V=new RegExp(I+"+","g"),H=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),j=new RegExp("^"+I+"*,"+I+"*"),G=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),q=new RegExp("="+I+"*([^\\]'\"]*?)"+I+"*\\]","g"),W=new RegExp(U),z=new RegExp("^"+F+"$"),Y={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,Z=/'|\\/g,ee=new RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),te=function(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ie=function(){w()};try{D.apply(t=M.call(E.childNodes),E.childNodes),t[E.childNodes.length].nodeType}catch(be){D={apply:t.length?function(e,t){L.apply(e,M.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function ne(e,t,i,n){var r,s,a,o,l,u,c,h,d=t&&t.ownerDocument,f=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return i;if(!n&&((t?t.ownerDocument||t:E)!==S&&w(t),t=t||S,_)){if(11!==f&&(u=J.exec(e)))if(r=u[1]){if(9===f){if(!(a=t.getElementById(r)))return i;if(a.id===r)return i.push(a),i}else if(d&&(a=d.getElementById(r))&&y(t,a)&&a.id===r)return i.push(a),i}else{if(u[2])return D.apply(i,t.getElementsByTagName(e)),i;if((r=u[3])&&p.getElementsByClassName&&t.getElementsByClassName)return D.apply(i,t.getElementsByClassName(r)),i}if(p.qsa&&!k[e+" "]&&(!v||!v.test(e))){if(1!==f)d=t,h=e;else if("object"!==t.nodeName.toLowerCase()){(o=t.getAttribute("id"))?o=o.replace(Z,"\\$&"):t.setAttribute("id",o=C),s=(c=m(e)).length,l=z.test(o)?"#"+o:"[id='"+o+"']";for(;s--;)c[s]=l+" "+pe(c[s]);h=c.join(","),d=$.test(e)&&de(t.parentNode)||t}if(h)try{return D.apply(i,d.querySelectorAll(h)),i}catch(x){}finally{o===C&&t.removeAttribute("id")}}}return g(e.replace(H,"$1"),t,i,n)}function re(){var n=[];return function e(t,i){return n.push(t+" ")>b.cacheLength&&delete e[n.shift()],e[t+" "]=i}}function se(e){return e[C]=!0,e}function ae(e){var t=S.createElement("div");try{return!!e(t)}catch(p){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function oe(e,t){for(var i=e.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=t}function le(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function ue(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ce(i){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===i}}function he(a){return se(function(s){return s=+s,se(function(e,t){for(var i,n=a([],e.length,s),r=n.length;r--;)e[i=n[r]]&&(e[i]=!(t[i]=e[i]))})})}function de(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}p=ne.support={},r=ne.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},w=ne.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:E;return n!==S&&9===n.nodeType&&n.documentElement&&(a=(S=n).documentElement,_=!r(S),(i=S.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",ie,!1):i.attachEvent&&i.attachEvent("onunload",ie)),p.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),p.getElementsByTagName=ae(function(e){return e.appendChild(S.createComment("")),!e.getElementsByTagName("*").length}),p.getElementsByClassName=Q.test(S.getElementsByClassName),p.getById=ae(function(e){return a.appendChild(e).id=C,!S.getElementsByName||!S.getElementsByName(C).length}),p.getById?(b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&_){var i=t.getElementById(e);return i?[i]:[]}},b.filter.ID=function(e){var t=e.replace(ee,te);return function(e){return e.getAttribute("id")===t}}):(delete b.find.ID,b.filter.ID=function(e){var i=e.replace(ee,te);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===i}}),b.find.TAG=p.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):p.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],r=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},b.find.CLASS=p.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&_)return t.getElementsByClassName(e)},o=[],v=[],(p.qsa=Q.test(S.querySelectorAll))&&(ae(function(e){a.appendChild(e).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+C+"-]").length||v.push("~="),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+C+"+*").length||v.push(".#.+[+~]")}),ae(function(e){var t=S.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+I+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(p.matchesSelector=Q.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ae(function(e){p.disconnectedMatch=c.call(e,"div"),c.call(e,"[s!='']:x"),o.push("!=",U)}),v=v.length&&new RegExp(v.join("|")),o=o.length&&new RegExp(o.join("|")),t=Q.test(a.compareDocumentPosition),y=t||Q.test(a.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},f=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!p.sortDetached&&t.compareDocumentPosition(e)===i?e===S||e.ownerDocument===E&&y(E,e)?-1:t===S||t.ownerDocument===E&&y(E,t)?1:l?O(l,e)-O(l,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var i,n=0,r=e.parentNode,s=t.parentNode,a=[e],o=[t];if(!r||!s)return e===S?-1:t===S?1:r?-1:s?1:l?O(l,e)-O(l,t):0;if(r===s)return le(e,t);i=e;for(;i=i.parentNode;)a.unshift(i);i=t;for(;i=i.parentNode;)o.unshift(i);for(;a[n]===o[n];)n++;return n?le(a[n],o[n]):a[n]===E?-1:o[n]===E?1:0}),S},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==S&&w(e),t=t.replace(q,"='$1']"),p.matchesSelector&&_&&!k[t+" "]&&(!o||!o.test(t))&&(!v||!v.test(t)))try{var i=c.call(e,t);if(i||p.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(s){}return 0<ne(t,S,null,[e]).length},ne.contains=function(e,t){return(e.ownerDocument||e)!==S&&w(e),y(e,t)},ne.attr=function(e,t){(e.ownerDocument||e)!==S&&w(e);var i=b.attrHandle[t.toLowerCase()],n=i&&R.call(b.attrHandle,t.toLowerCase())?i(e,t,!_):void 0;return void 0!==n?n:p.attributes||!_?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,i=[],n=0,r=0;if(u=!p.detectDuplicates,l=!p.sortStable&&e.slice(0),e.sort(f),u){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return l=null,e},s=ne.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=s(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=s(t);return i},(b=ne.selectors={cacheLength:50,createPseudo:se,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ee,te),e[3]=(e[3]||e[4]||e[5]||"").replace(ee,te),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&W.test(i)&&(t=m(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ee,te).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&x(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(e){var t=ne.attr(e,i);return null==t?"!="===n:!n||(t+="","="===n?t===r:"!="===n?t!==r:"^="===n?r&&0===t.indexOf(r):"*="===n?r&&-1<t.indexOf(r):"$="===n?r&&t.slice(-r.length)===r:"~="===n?-1<(" "+t.replace(V," ")+" ").indexOf(r):"|="===n&&(t===r||t.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,e,t,m,g){var v="nth"!==p.slice(0,3),y="last"!==p.slice(-4),E="of-type"===e;return 1===m&&0===g?function(e){return!!e.parentNode}:function(e,t,i){var n,r,s,a,o,l,u=v!==y?"nextSibling":"previousSibling",c=e.parentNode,h=E&&e.nodeName.toLowerCase(),d=!i&&!E,f=!1;if(c){if(v){for(;u;){a=e;for(;a=a[u];)if(E?a.nodeName.toLowerCase()===h:1===a.nodeType)return!1;l=u="only"===p&&!l&&"nextSibling"}return!0}if(l=[y?c.firstChild:c.lastChild],y&&d){f=(o=(n=(r=(s=(a=c)[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]||[])[0]===A&&n[1])&&n[2],a=o&&c.childNodes[o];for(;a=++o&&a&&a[u]||(f=o=0)||l.pop();)if(1===a.nodeType&&++f&&a===e){r[p]=[A,o,f];break}}else if(d&&(f=o=(n=(r=(s=(a=e)[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]||[])[0]===A&&n[1]),!1===f)for(;(a=++o&&a&&a[u]||(f=o=0)||l.pop())&&((E?a.nodeName.toLowerCase()!==h:1!==a.nodeType)||!++f||(d&&((r=(s=a[C]||(a[C]={}))[a.uniqueID]||(s[a.uniqueID]={}))[p]=[A,f]),a!==e)););return(f-=g)===m||f%m==0&&0<=f/m}}},PSEUDO:function(e,s){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return a[C]?a(s):1<a.length?(t=[e,e,"",s],b.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,t){for(var i,n=a(e,s),r=n.length;r--;)e[i=O(e,n[r])]=!(t[i]=n[r])}):function(e){return a(e,0,t)}):a}},pseudos:{not:se(function(e){var n=[],r=[],o=h(e.replace(H,"$1"));return o[C]?se(function(e,t,i,n){for(var r,s=o(e,null,n,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))}):function(e,t,i){return n[0]=e,o(n,null,i,r),n[0]=null,!r.pop()}}),has:se(function(t){return function(e){return 0<ne(t,e).length}}),contains:se(function(t){return t=t.replace(ee,te),function(e){return-1<(e.textContent||e.innerText||s(e)).indexOf(t)}}),lang:se(function(i){return z.test(i||"")||ne.error("unsupported lang: "+i),i=i.replace(ee,te).toLowerCase(),function(e){var t;do{if(t=_?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===i||0===t.indexOf(i+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===S.activeElement&&(!S.hasFocus||S.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return X.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,i){return[i<0?i+t:i]}),even:he(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:he(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:he(function(e,t,i){for(var n=i<0?i+t:i;0<=--n;)e.push(n);return e}),gt:he(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=b.pseudos.eq;for(e in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=ue(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=ce(e);function fe(){}fe.prototype=b.filters=b.pseudos,b.setFilters=new fe,m=ne.tokenize=function(e,t){var i,n,r,s,a,o,l,u=d[e+" "];if(u)return t?0:u.slice(0);a=e,o=[],l=b.preFilter;for(;a;){i&&!(n=j.exec(a))||(n&&(a=a.slice(n[0].length)||a),o.push(r=[])),i=!1,(n=G.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(H," ")}),a=a.slice(i.length));for(s in b.filter)!(n=Y[s].exec(a))||l[s]&&!(n=l[s](n))||(i=n.shift(),r.push({value:i,type:s,matches:n}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ne.error(e):d(e,o).slice(0)};function pe(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function me(o,e,t){var l=e.dir,u=t&&"parentNode"===l,c=n++;return e.first?function(e,t,i){for(;e=e[l];)if(1===e.nodeType||u)return o(e,t,i)}:function(e,t,i){var n,r,s,a=[A,c];if(i){for(;e=e[l];)if((1===e.nodeType||u)&&o(e,t,i))return!0}else for(;e=e[l];)if(1===e.nodeType||u){if((n=(r=(s=e[C]||(e[C]={}))[e.uniqueID]||(s[e.uniqueID]={}))[l])&&n[0]===A&&n[1]===c)return a[2]=n[2];if((r[l]=a)[2]=o(e,t,i))return!0}}}function ge(r){return 1<r.length?function(e,t,i){for(var n=r.length;n--;)if(!r[n](e,t,i))return!1;return!0}:r[0]}function ve(e,t,i,n,r){for(var s,a=[],o=0,l=e.length,u=null!=t;o<l;o++)(s=e[o])&&(i&&!i(s,n,r)||(a.push(s),u&&t.push(o)));return a}function ye(f,p,m,g,v,e){return g&&!g[C]&&(g=ye(g)),v&&!v[C]&&(v=ye(v,e)),se(function(e,t,i,n){var r,s,a,o=[],l=[],u=t.length,c=e||function(e,t,i){for(var n=0,r=t.length;n<r;n++)ne(e,t[n],i);return i}(p||"*",i.nodeType?[i]:i,[]),h=!f||!e&&p?c:ve(c,o,f,i,n),d=m?v||(e?f:u||g)?[]:t:h;if(m&&m(h,d,i,n),g){r=ve(d,l),g(r,[],i,n),s=r.length;for(;s--;)(a=r[s])&&(d[l[s]]=!(h[l[s]]=a))}if(e){if(v||f){if(v){r=[],s=d.length;for(;s--;)(a=d[s])&&r.push(h[s]=a);v(null,d=[],r,n)}s=d.length;for(;s--;)(a=d[s])&&-1<(r=v?O(e,a):o[s])&&(e[r]=!(t[r]=a))}}else d=ve(d===t?d.splice(u,d.length):d),v?v(null,t,d,n):D.apply(t,d)})}function Ee(e){for(var r,t,i,n=e.length,s=b.relative[e[0].type],a=s||b.relative[" "],o=s?1:0,l=me(function(e){return e===r},a,!0),u=me(function(e){return-1<O(r,e)},a,!0),c=[function(e,t,i){var n=!s&&(i||t!==T)||((r=t).nodeType?l(e,t,i):u(e,t,i));return r=null,n}];o<n;o++)if(t=b.relative[e[o].type])c=[me(ge(c),t)];else{if((t=b.filter[e[o].type].apply(null,e[o].matches))[C]){for(i=++o;i<n&&!b.relative[e[i].type];i++);return ye(1<o&&ge(c),1<o&&pe(e.slice(0,o-1).concat({value:" "===e[o-2].type?"*":""})).replace(H,"$1"),t,o<i&&Ee(e.slice(o,i)),i<n&&Ee(e=e.slice(i)),i<n&&pe(e))}c.push(t)}return ge(c)}return h=ne.compile=function(e,t){var i,g,v,y,E,n,r=[],s=[],a=k[e+" "];if(!a){t||(t=m(e)),i=t.length;for(;i--;)(a=Ee(t[i]))[C]?r.push(a):s.push(a);(a=k(e,(g=s,y=0<(v=r).length,E=0<g.length,n=function(e,t,i,n,r){var s,a,o,l=0,u="0",c=e&&[],h=[],d=T,f=e||E&&b.find.TAG("*",r),p=A+=null==d?1:Math.random()||.1,m=f.length;for(r&&(T=t===S||t||r);u!==m&&null!=(s=f[u]);u++){if(E&&s){a=0,t||s.ownerDocument===S||(w(s),i=!_);for(;o=g[a++];)if(o(s,t||S,i)){n.push(s);break}r&&(A=p)}y&&((s=!o&&s)&&l--,e&&c.push(s))}if(l+=u,y&&u!==l){a=0;for(;o=v[a++];)o(c,h,t,i);if(e){if(0<l)for(;u--;)c[u]||h[u]||(h[u]=N.call(n));h=ve(h)}D.apply(n,h),r&&!e&&0<h.length&&1<l+v.length&&ne.uniqueSort(n)}return r&&(A=p,T=d),c},y?se(n):n))).selector=e}return a},g=ne.select=function(e,t,i,n){var r,s,a,o,l,u="function"==typeof e&&e,c=!n&&m(e=u.selector||e);if(i=i||[],1===c.length){if(2<(s=c[0]=c[0].slice(0)).length&&"ID"===(a=s[0]).type&&p.getById&&9===t.nodeType&&_&&b.relative[s[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(ee,te),t)||[])[0]))return i;u&&(t=t.parentNode),e=e.slice(s.shift().value.length)}r=Y.needsContext.test(e)?0:s.length;for(;r--&&(a=s[r],!b.relative[o=a.type]);)if((l=b.find[o])&&(n=l(a.matches[0].replace(ee,te),$.test(s[0].type)&&de(t.parentNode)||t))){if(s.splice(r,1),!(e=n.length&&pe(s)))return D.apply(i,n),i;break}}return(u||h(e,c))(n,t,!_,i,!t||$.test(e)&&de(t.parentNode)||t),i},p.sortStable=C.split("").sort(f).join("")===C,p.detectDuplicates=!!u,w(),p.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(S.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||oe("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),p.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||oe("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||oe(P,function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),ne}(S);C.find=d,C.expr=d.selectors,C.expr[":"]=C.expr.pseudos,C.uniqueSort=C.unique=d.uniqueSort,C.text=d.getText,C.isXMLDoc=d.isXML,C.contains=d.contains;var f=function(e,t,i){for(var n=[],r=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&C(e).is(i))break;n.push(e)}return n},y=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},E=C.expr.match.needsContext,A=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,b=/^.[^:#\[\.,]*$/;function T(e,i,n){if(C.isFunction(i))return C.grep(e,function(e,t){return!!i.call(e,t,e)!==n});if(i.nodeType)return C.grep(e,function(e){return e===i!==n});if("string"==typeof i){if(b.test(i))return C.filter(i,e,n);i=C.filter(i,e)}return C.grep(e,function(e){return-1<C.inArray(e,i)!==n})}C.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?C.find.matchesSelector(n,e)?[n]:[]:C.find.matches(e,C.grep(t,function(e){return 1===e.nodeType}))},C.fn.extend({find:function(e){var t,i=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(C(e).filter(function(){for(t=0;t<r;t++)if(C.contains(n[t],this))return!0}));for(t=0;t<r;t++)C.find(e,n[t],i);return(i=this.pushStack(1<r?C.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&E.test(e)?C(e):e||[],!1).length}});var w,x=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(C.fn.init=function(e,t,i){var n,r;if(!e)return this;if(i=i||w,"string"==typeof e){if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:x.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof C?t[0]:t,C.merge(this,C.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:p,!0)),A.test(n[1])&&C.isPlainObject(t))for(n in t)C.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if((r=p.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return w.find(e);this.length=1,this[0]=r}return this.context=p,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):C.isFunction(e)?"undefined"!=typeof i.ready?i.ready(e):e(C):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),C.makeArray(e,this))}).prototype=C.fn,w=C(p);var k=/^(?:parents|prev(?:Until|All))/,R={children:!0,contents:!0,next:!0,prev:!0};C.fn.extend({has:function(e){var t,i=C(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(C.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,r=this.length,s=[],a=E.test(e)||"string"!=typeof e?C(e,t||this.context):0;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&C.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(1<s.length?C.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?C.inArray(this[0],C(e)):C.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function N(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}C.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return f(e,"parentNode")},parentsUntil:function(e,t,i){return f(e,"parentNode",i)},next:function(e){return N(e,"nextSibling")},prev:function(e){return N(e,"previousSibling")},nextAll:function(e){return f(e,"nextSibling")},prevAll:function(e){return f(e,"previousSibling")},nextUntil:function(e,t,i){return f(e,"nextSibling",i)},prevUntil:function(e,t,i){return f(e,"previousSibling",i)},siblings:function(e){return y((e.parentNode||{}).firstChild,e)},children:function(e){return y(e.firstChild)},contents:function(e){return C.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:C.merge([],e.childNodes)}},function(n,r){C.fn[n]=function(e,t){var i=C.map(this,r,e);return"Until"!==n.slice(-5)&&(t=e),t&&"string"==typeof t&&(i=C.filter(t,i)),1<this.length&&(R[n]||(i=C.uniqueSort(i)),k.test(n)&&(i=i.reverse())),this.pushStack(i)}});var L,D,M=/\S+/g;C.Callbacks=function(n){n="string"==typeof n?(e=n,i={},C.each(e.match(M)||[],function(e,t){i[t]=!0}),i):C.extend({},n);var e,i,r,t,s,a,o=[],l=[],u=-1,c=function(){for(a=n.once,s=r=!0;l.length;u=-1){t=l.shift();for(;++u<o.length;)!1===o[u].apply(t[0],t[1])&&n.stopOnFalse&&(u=o.length,t=!1)}n.memory||(t=!1),r=!1,a&&(o=t?[]:"")},h={add:function(){return o&&(t&&!r&&(u=o.length-1,l.push(t)),function i(e){C.each(e,function(e,t){C.isFunction(t)?n.unique&&h.has(t)||o.push(t):t&&t.length&&"string"!==C.type(t)&&i(t)})}(arguments),t&&!r&&c()),this},remove:function(){return C.each(arguments,function(e,t){for(var i;-1<(i=C.inArray(t,o,i));)o.splice(i,1),i<=u&&u--}),this},has:function(e){return e?-1<C.inArray(e,o):0<o.length},empty:function(){return o&&(o=[]),this},disable:function(){return a=l=[],o=t="",this},disabled:function(){return!o},lock:function(){return a=!0,t||h.disable(),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],l.push(t),r||c()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},C.extend({Deferred:function(e){var s=[["resolve","done",C.Callbacks("once memory"),"resolved"],["reject","fail",C.Callbacks("once memory"),"rejected"],["notify","progress",C.Callbacks("memory")]],r="pending",a={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var r=arguments;return C.Deferred(function(n){C.each(s,function(e,t){var i=C.isFunction(r[e])&&r[e];o[t[1]](function(){var e=i&&i.apply(this,arguments);e&&C.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[t[0]+"With"](this===a?n.promise():this,i?[e]:arguments)})}),r=null}).promise()},promise:function(e){return null!=e?C.extend(e,a):a}},o={};return a.pipe=a.then,C.each(s,function(e,t){var i=t[2],n=t[3];a[t[1]]=i.add,n&&i.add(function(){r=n},s[1^e][2].disable,s[2][2].lock),o[t[0]]=function(){return o[t[0]+"With"](this===o?a:this,arguments),this},o[t[0]+"With"]=i.fireWith}),a.promise(o),e&&e.call(o,o),o},when:function(e){var r,t,i,n=0,s=c.call(arguments),a=s.length,o=1!==a||e&&C.isFunction(e.promise)?a:0,l=1===o?e:C.Deferred(),u=function(t,i,n){return function(e){i[t]=this,n[t]=1<arguments.length?c.call(arguments):e,n===r?l.notifyWith(i,n):--o||l.resolveWith(i,n)}};if(1<a)for(r=new Array(a),t=new Array(a),i=new Array(a);n<a;n++)s[n]&&C.isFunction(s[n].promise)?s[n].promise().progress(u(n,t,r)).done(u(n,i,s)).fail(l.reject):--o;return o||l.resolveWith(i,s),l.promise()}});C.fn.ready=function(e){return C.ready.promise().done(e),this},C.extend({isReady:!1,readyWait:1,holdReady:function(e){e?C.readyWait++:C.ready(!0)},ready:function(e){(!0===e?--C.readyWait:C.isReady)||((C.isReady=!0)!==e&&0<--C.readyWait||(L.resolveWith(p,[C]),C.fn.triggerHandler&&(C(p).triggerHandler("ready"),C(p).off("ready"))))}});function O(){p.addEventListener?(p.removeEventListener("DOMContentLoaded",P),S.removeEventListener("load",P)):(p.detachEvent("onreadystatechange",P),S.detachEvent("onload",P))}function P(){(p.addEventListener||"load"===S.event.type||"complete"===p.readyState)&&(O(),C.ready())}C.ready.promise=function(t){if(!L)if(L=C.Deferred(),"complete"===p.readyState||"loading"!==p.readyState&&!p.documentElement.doScroll)S.setTimeout(C.ready);else if(p.addEventListener)p.addEventListener("DOMContentLoaded",P),S.addEventListener("load",P);else{p.attachEvent("onreadystatechange",P),S.attachEvent("onload",P);var i=!1;try{i=null==S.frameElement&&p.documentElement}catch(c){}i&&i.doScroll&&function e(){if(!C.isReady){try{i.doScroll("left")}catch(t){return S.setTimeout(e,50)}O(),C.ready()}}()}return L.promise(t)},C.ready.promise();for(D in C(_))break;_.ownFirst="0"===D,_.inlineBlockNeedsLayout=!1,C(function(){var e,t,i,n;(i=p.getElementsByTagName("body")[0])&&i.style&&(t=p.createElement("div"),(n=p.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",_.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(i.style.zoom=1)),i.removeChild(n))}),function(){var e=p.createElement("div");_.deleteExpando=!0;try{delete e.test}catch(t){_.deleteExpando=!1}e=null}();var I,F=function(e){var t=C.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return(1===i||9===i)&&(!t||!0!==t&&e.getAttribute("classid")===t)},B=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/([A-Z])/g;function V(e,t,i){if(void 0===i&&1===e.nodeType){var n="data-"+t.replace(U,"-$1").toLowerCase();if("string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:B.test(i)?C.parseJSON(i):i)}catch(c){}C.data(e,t,i)}else i=void 0}return i}function H(e){var t;for(t in e)if(("data"!==t||!C.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function j(e,t,i,n){if(F(e)){var r,s,a=C.expando,o=e.nodeType,l=o?C.cache:e,u=o?e[a]:e[a]&&a;if(u&&l[u]&&(n||l[u].data)||void 0!==i||"string"!=typeof t)return u||(u=o?e[a]=h.pop()||C.guid++:a),l[u]||(l[u]=o?{}:{toJSON:C.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[u]=C.extend(l[u],t):l[u].data=C.extend(l[u].data,t)),s=l[u],n||(s.data||(s.data={}),s=s.data),void 0!==i&&(s[C.camelCase(t)]=i),"string"==typeof t?null==(r=s[t])&&(r=s[C.camelCase(t)]):r=s,r}}function G(e,t,i){if(F(e)){var n,r,s=e.nodeType,a=s?C.cache:e,o=s?e[C.expando]:C.expando;if(a[o]){if(t&&(n=i?a[o]:a[o].data)){C.isArray(t)?t=t.concat(C.map(t,C.camelCase)):t in n?t=[t]:t=(t=C.camelCase(t))in n?[t]:t.split(" "),r=t.length;for(;r--;)delete n[t[r]];if(i?!H(n):!C.isEmptyObject(n))return}(i||(delete a[o].data,H(a[o])))&&(s?C.cleanData([e],!0):_.deleteExpando||a!=a.window?delete a[o]:a[o]=void 0)}}}C.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?C.cache[e[C.expando]]:e[C.expando])&&!H(e)},data:function(e,t,i){return j(e,t,i)},removeData:function(e,t){return G(e,t)},_data:function(e,t,i){return j(e,t,i,!0)},_removeData:function(e,t){return G(e,t,!0)}}),C.fn.extend({data:function(e,t){var i,n,r,s=this[0],a=s&&s.attributes;if(void 0===e){if(this.length&&(r=C.data(s),1===s.nodeType&&!C._data(s,"parsedAttrs"))){i=a.length;for(;i--;)a[i]&&(0===(n=a[i].name).indexOf("data-")&&V(s,n=C.camelCase(n.slice(5)),r[n]));C._data(s,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){C.data(this,e)}):1<arguments.length?this.each(function(){C.data(this,e,t)}):s?V(s,e,C.data(s,e)):void 0},removeData:function(e){return this.each(function(){C.removeData(this,e)})}}),C.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=C._data(e,t),i&&(!n||C.isArray(i)?n=C._data(e,t,C.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=C.queue(e,t),n=i.length,r=i.shift(),s=C._queueHooks(e,t);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete s.stop,r.call(e,function(){C.dequeue(e,t)},s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return C._data(e,i)||C._data(e,i,{empty:C.Callbacks("once memory").add(function(){C._removeData(e,t+"queue"),C._removeData(e,i)})})}}),C.fn.extend({queue:function(t,i){var e=2;return"string"!=typeof t&&(i=t,t="fx",e--),arguments.length<e?C.queue(this[0],t):void 0===i?this:this.each(function(){var e=C.queue(this,t,i);C._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&C.dequeue(this,t)})},dequeue:function(e){return this.each(function(){C.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=C.Deferred(),s=this,a=this.length,o=function(){--n||r.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";for(;a--;)(i=C._data(s[a],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(o));return o(),r.promise(t)}}),_.shrinkWrapBlocks=function(){if(null!=I)return I;I=!1;var e,t,i;return(t=p.getElementsByTagName("body")[0])&&t.style?(e=p.createElement("div"),(i=p.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(i).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(p.createElement("div")).style.width="5px",I=3!==e.offsetWidth),t.removeChild(i),I):void 0};var q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,W=new RegExp("^(?:([+-])=|)("+q+")([a-z%]*)$","i"),z=["Top","Right","Bottom","Left"],Y=function(e,t){return e=t||e,"none"===C.css(e,"display")||!C.contains(e.ownerDocument,e)};function K(e,t,i,n){var r,s=1,a=20,o=n?function(){return n.cur()}:function(){return C.css(e,t,"")},l=o(),u=i&&i[3]||(C.cssNumber[t]?"":"px"),c=(C.cssNumber[t]||"px"!==u&&+l)&&W.exec(C.css(e,t));if(c&&c[3]!==u){u=u||c[3],i=i||[],c=+l||1;for(;c/=s=s||".5",C.style(e,t,c+u),s!==(s=o()/l)&&1!==s&&--a;);}return i&&(c=+c||+l||0,r=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=u,n.start=c,n.end=r)),r}var X,Q,J,$=function(e,t,i,n,r,s,a){var o=0,l=e.length,u=null==i;if("object"===C.type(i)){r=!0;for(o in i)$(e,t,o,i[o],!0,s,a)}else if(void 0!==n&&(r=!0,C.isFunction(n)||(a=!0),u&&(a?(t.call(e,n),t=null):(u=t,t=function(e,t,i){return u.call(C(e),i)})),t))for(;o<l;o++)t(e[o],i,a?n:n.call(e[o],o,t(e[o],i)));return r?e:u?t.call(e):l?t(e[0],i):s},Z=/^(?:checkbox|radio)$/i,ee=/<([\w:-]+)/,te=/^$|\/(?:java|ecma)script/i,ie=/^\s+/,ne="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function re(e){var t=ne.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}X=p.createElement("div"),Q=p.createDocumentFragment(),J=p.createElement("input"),X.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",_.leadingWhitespace=3===X.firstChild.nodeType,_.tbody=!X.getElementsByTagName("tbody").length,_.htmlSerialize=!!X.getElementsByTagName("link").length,_.html5Clone="<:nav></:nav>"!==p.createElement("nav").cloneNode(!0).outerHTML,J.type="checkbox",J.checked=!0,Q.appendChild(J),_.appendChecked=J.checked,X.innerHTML="<textarea>x</textarea>",_.noCloneChecked=!!X.cloneNode(!0).lastChild.defaultValue,Q.appendChild(X),(J=p.createElement("input")).setAttribute("type","radio"),J.setAttribute("checked","checked"),J.setAttribute("name","t"),X.appendChild(J),_.checkClone=X.cloneNode(!0).cloneNode(!0).lastChild.checked,_.noCloneEvent=!!X.addEventListener,X[C.expando]=1,_.attributes=!X.getAttribute(C.expando);var se={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:_.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};se.optgroup=se.option,se.tbody=se.tfoot=se.colgroup=se.caption=se.thead,se.th=se.td;function be(e,t){var i,n,r=0,s="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!s)for(s=[],i=e.childNodes||e;null!=(n=i[r]);r++)!t||C.nodeName(n,t)?s.push(n):C.merge(s,be(n,t));return void 0===t||t&&C.nodeName(e,t)?C.merge([e],s):s}function ae(e,t){for(var i,n=0;null!=(i=e[n]);n++)C._data(i,"globalEval",!t||C._data(t[n],"globalEval"))}var oe=/<|&#?\w+;/,le=/<tbody/i;function ue(e){Z.test(e.type)&&(e.defaultChecked=e.checked)}function ce(e,t,i,n,r){for(var s,a,o,l,u,c,h,d=e.length,f=re(t),p=[],m=0;m<d;m++)if((a=e[m])||0===a)if("object"===C.type(a))C.merge(p,a.nodeType?[a]:a);else if(oe.test(a)){l=l||f.appendChild(t.createElement("div")),u=(ee.exec(a)||["",""])[1].toLowerCase(),h=se[u]||se._default,l.innerHTML=h[1]+C.htmlPrefilter(a)+h[2],s=h[0];for(;s--;)l=l.lastChild;if(!_.leadingWhitespace&&ie.test(a)&&p.push(t.createTextNode(ie.exec(a)[0])),!_.tbody){s=(a="table"!==u||le.test(a)?"<table>"!==h[1]||le.test(a)?0:l:l.firstChild)&&a.childNodes.length;for(;s--;)C.nodeName(c=a.childNodes[s],"tbody")&&!c.childNodes.length&&a.removeChild(c)}C.merge(p,l.childNodes),l.textContent="";for(;l.firstChild;)l.removeChild(l.firstChild);l=f.lastChild}else p.push(t.createTextNode(a));l&&f.removeChild(l),_.appendChecked||C.grep(be(p,"input"),ue),m=0;for(;a=p[m++];)if(n&&-1<C.inArray(a,n))r&&r.push(a);else if(o=C.contains(a.ownerDocument,a),l=be(f.appendChild(a),"script"),o&&ae(l),i){s=0;for(;a=l[s++];)te.test(a.type||"")&&i.push(a)}return l=null,f}!function(){var e,t,i=p.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(_[e]=t in S)||(i.setAttribute(t,"t"),_[e]=!1===i.attributes[t].expando);i=null}();var he=/^(?:input|select|textarea)$/i,de=/^key/,fe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,pe=/^(?:focusinfocus|focusoutblur)$/,me=/^([^.]*)(?:\.(.+)|)/;function ge(){return!0}function ve(){return!1}function ye(){try{return p.activeElement}catch(S){}}function Ee(e,t,i,n,r,s){var a,o;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=void 0);for(o in t)Ee(e,o,i,n,t[o],s);return e}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=ve;else if(!r)return e;return 1===s&&(a=r,(r=function(e){return C().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=C.guid++)),e.each(function(){C.event.add(this,t,r,n,i)})}C.event={global:{},add:function(e,t,i,n,r){var s,a,o,l,u,c,h,d,f,p,m,g=C._data(e);if(g){i.handler&&(i=(l=i).handler,r=l.selector),i.guid||(i.guid=C.guid++),(a=g.events)||(a=g.events={}),(c=g.handle)||((c=g.handle=function(e){return void 0===C||e&&C.event.triggered===e.type?void 0:C.event.dispatch.apply(c.elem,arguments)}).elem=e),o=(t=(t||"").match(M)||[""]).length;for(;o--;)f=m=(s=me.exec(t[o])||[])[1],p=(s[2]||"").split(".").sort(),f&&(u=C.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=C.event.special[f]||{},h=C.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&C.expr.match.needsContext.test(r),namespace:p.join(".")},l),(d=a[f])||((d=a[f]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,n,p,c)||(e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c))),u.add&&(u.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),C.event.global[f]=!0);e=null}},remove:function(e,t,i,n,r){var s,a,o,l,u,c,h,d,f,p,m,g=C.hasData(e)&&C._data(e);if(g&&(c=g.events)){u=(t=(t||"").match(M)||[""]).length;for(;u--;)if(f=m=(o=me.exec(t[u])||[])[1],p=(o[2]||"").split(".").sort(),f){h=C.event.special[f]||{},d=c[f=(n?h.delegateType:h.bindType)||f]||[],o=o[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=d.length;for(;s--;)a=d[s],!r&&m!==a.origType||i&&i.guid!==a.guid||o&&!o.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(s,1),a.selector&&d.delegateCount--,h.remove&&h.remove.call(e,a));l&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,g.handle)||C.removeEvent(e,f,g.handle),delete c[f])}else for(f in c)C.event.remove(e,f+t[u],i,n,!0);C.isEmptyObject(c)&&(delete g.handle,C._removeData(e,"events"))}},trigger:function(e,t,i,n){var r,s,a,o,l,u,c,h=[i||p],d=g.call(e,"type")?e.type:e,f=g.call(e,"namespace")?e.namespace.split("."):[];if(a=u=i=i||p,3!==i.nodeType&&8!==i.nodeType&&!pe.test(d+C.event.triggered)&&(-1<d.indexOf(".")&&(d=(f=d.split(".")).shift(),f.sort()),s=d.indexOf(":")<0&&"on"+d,(e=e[C.expando]?e:new C.Event(d,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:C.makeArray(t,[e]),l=C.event.special[d]||{},n||!l.trigger||!1!==l.trigger.apply(i,t))){if(!n&&!l.noBubble&&!C.isWindow(i)){for(o=l.delegateType||d,pe.test(o+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(i.ownerDocument||p)&&h.push(u.defaultView||u.parentWindow||S)}c=0;for(;(a=h[c++])&&!e.isPropagationStopped();)e.type=1<c?o:l.bindType||d,(r=(C._data(a,"events")||{})[e.type]&&C._data(a,"handle"))&&r.apply(a,t),(r=s&&a[s])&&r.apply&&F(a)&&(e.result=r.apply(a,t),!1===e.result&&e.preventDefault());if(e.type=d,!n&&!e.isDefaultPrevented()&&(!l._default||!1===l._default.apply(h.pop(),t))&&F(i)&&s&&i[d]&&!C.isWindow(i)){(u=i[s])&&(i[s]=null),C.event.triggered=d;try{i[d]()}catch(v){}C.event.triggered=void 0,u&&(i[s]=u)}return e.result}},dispatch:function(e){e=C.event.fix(e);var t,i,n,r,s,a=[],o=c.call(arguments),l=(C._data(this,"events")||{})[e.type]||[],u=C.event.special[e.type]||{};if((o[0]=e).delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){a=C.event.handlers.call(this,e,l),t=0;for(;(r=a[t++])&&!e.isPropagationStopped();){e.currentTarget=r.elem,i=0;for(;(s=r.handlers[i++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(s.namespace)||(e.handleObj=s,e.data=s.data,void 0!==(n=((C.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,o))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()))}return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,r,s,a=[],o=t.delegateCount,l=e.target;if(o&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(n=[],i=0;i<o;i++)void 0===n[r=(s=t[i]).selector+" "]&&(n[r]=s.needsContext?-1<C(r,this).index(l):C.find(r,this,null,[l]).length),n[r]&&n.push(s);n.length&&a.push({elem:l,handlers:n})}return o<t.length&&a.push({elem:this,handlers:t.slice(o)}),a},fix:function(e){if(e[C.expando])return e;var t,i,n,r=e.type,s=e,a=this.fixHooks[r];a||(this.fixHooks[r]=a=fe.test(r)?this.mouseHooks:de.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new C.Event(s),t=n.length;for(;t--;)e[i=n[t]]=s[i];return e.target||(e.target=s.srcElement||p),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,r,s=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||p).documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ye()&&this.focus)try{return this.focus(),!1}catch(S){}},delegateType:"focusin"},blur:{trigger:function(){if(this===ye()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(C.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return C.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i){var n=C.extend(new C.Event,i,{type:e,isSimulated:!0});C.event.trigger(n,null,t),n.isDefaultPrevented()&&i.preventDefault()}},C.removeEvent=p.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)}:function(e,t,i){var n="on"+t;e.detachEvent&&("undefined"==typeof e[n]&&(e[n]=null),e.detachEvent(n,i))},C.Event=function(e,t){return this instanceof C.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?ge:ve):this.type=e,t&&C.extend(this,t),this.timeStamp=e&&e.timeStamp||C.now(),void(this[C.expando]=!0)):new C.Event(e,t)},C.Event.prototype={constructor:C.Event,isDefaultPrevented:ve,isPropagationStopped:ve,isImmediatePropagationStopped:ve,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ge,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ge,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=ge,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,r){C.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,i=e.relatedTarget,n=e.handleObj;return i&&(i===this||C.contains(this,i))||(e.type=n.origType,t=n.handler.apply(this,arguments),e.type=r),t}}}),_.submit||(C.event.special.submit={setup:function(){return!C.nodeName(this,"form")&&void C.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=C.nodeName(t,"input")||C.nodeName(t,"button")?C.prop(t,"form"):void 0;i&&!C._data(i,"submit")&&(C.event.add(i,"submit._submit",function(e){e._submitBubble=!0}),C._data(i,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&C.event.simulate("submit",this.parentNode,e))},teardown:function(){return!C.nodeName(this,"form")&&void C.event.remove(this,"._submit")}}),_.change||(C.event.special.change={setup:function(){return he.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(C.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),C.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),C.event.simulate("change",this,e)})),!1):void C.event.add(this,"beforeactivate._change",function(e){var t=e.target;he.test(t.nodeName)&&!C._data(t,"change")&&(C.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||C.event.simulate("change",this.parentNode,e)}),C._data(t,"change",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return C.event.remove(this,"._change"),!he.test(this.nodeName)}}),_.focusin||C.each({focus:"focusin",blur:"focusout"},function(i,n){var r=function(e){C.event.simulate(n,e.target,C.event.fix(e))};C.event.special[n]={setup:function(){var e=this.ownerDocument||this,t=C._data(e,n);t||e.addEventListener(i,r,!0),C._data(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=C._data(e,n)-1;t?C._data(e,n,t):(e.removeEventListener(i,r,!0),C._removeData(e,n))}}}),C.fn.extend({on:function(e,t,i,n){return Ee(this,e,t,i,n)},one:function(e,t,i,n){return Ee(this,e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,C(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=ve),this.each(function(){C.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){C.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return C.event.trigger(e,t,i,!0)}});var Te=/ jQuery\d+="(?:null|\d+)"/g,we=new RegExp("<(?:"+ne+")[\\s/>]","i"),Se=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,_e=/<script|<style|<link/i,Ce=/checked\s*(?:[^=]|=\s*.checked.)/i,Ae=/^true\/(.*)/,xe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ke=re(p).appendChild(p.createElement("div"));function Re(e,t){return C.nodeName(e,"table")&&C.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ne(e){return e.type=(null!==C.find.attr(e,"type"))+"/"+e.type,e}function Le(e){var t=Ae.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function De(e,t){if(1===t.nodeType&&C.hasData(e)){var i,n,r,s=C._data(e),a=C._data(t,s),o=s.events;if(o){delete a.handle,a.events={};for(i in o)for(n=0,r=o[i].length;n<r;n++)C.event.add(t,i,o[i][n])}a.data&&(a.data=C.extend({},a.data))}}function Me(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!_.noCloneEvent&&t[C.expando]){r=C._data(t);for(n in r.events)C.removeEvent(t,n,r.handle);t.removeAttribute(C.expando)}"script"===i&&t.text!==e.text?(Ne(t).text=e.text,Le(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),_.html5Clone&&e.innerHTML&&!C.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Z.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function Oe(i,n,r,s){n=m.apply([],n);var e,t,a,o,l,u,c=0,h=i.length,d=h-1,f=n[0],p=C.isFunction(f);if(p||1<h&&"string"==typeof f&&!_.checkClone&&Ce.test(f))return i.each(function(e){var t=i.eq(e);p&&(n[0]=f.call(this,e,t.html())),Oe(t,n,r,s)});if(h&&(e=(u=ce(n,i[0].ownerDocument,!1,i,s)).firstChild,1===u.childNodes.length&&(u=e),e||s)){for(a=(o=C.map(be(u,"script"),Ne)).length;c<h;c++)t=u,c!==d&&(t=C.clone(t,!0,!0),a&&C.merge(o,be(t,"script"))),r.call(i[c],t,c);if(a)for(l=o[o.length-1].ownerDocument,C.map(o,Le),c=0;c<a;c++)t=o[c],te.test(t.type||"")&&!C._data(t,"globalEval")&&C.contains(l,t)&&(t.src?C._evalUrl&&C._evalUrl(t.src):C.globalEval((t.text||t.textContent||t.innerHTML||"").replace(xe,"")));u=e=null}return i}function Pe(e,t,i){for(var n,r=t?C.filter(t,e):e,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||C.cleanData(be(n)),n.parentNode&&(i&&C.contains(n.ownerDocument,n)&&ae(be(n,"script")),n.parentNode.removeChild(n));return e}C.extend({htmlPrefilter:function(e){return e.replace(Se,"<$1></$2>")},clone:function(e,t,i){var n,r,s,a,o,l=C.contains(e.ownerDocument,e);if(_.html5Clone||C.isXMLDoc(e)||!we.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(ke.innerHTML=e.outerHTML,ke.removeChild(s=ke.firstChild)),!(_.noCloneEvent&&_.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||C.isXMLDoc(e)))for(n=be(s),o=be(e),a=0;null!=(r=o[a]);++a)n[a]&&Me(r,n[a]);if(t)if(i)for(o=o||be(e),n=n||be(s),a=0;null!=(r=o[a]);a++)De(r,n[a]);else De(e,s);return 0<(n=be(s,"script")).length&&ae(n,!l&&be(e,"script")),n=o=r=null,s},cleanData:function(e,t){for(var i,n,r,s,a=0,o=C.expando,l=C.cache,u=_.attributes,c=C.event.special;null!=(i=e[a]);a++)if((t||F(i))&&(s=(r=i[o])&&l[r])){if(s.events)for(n in s.events)c[n]?C.event.remove(i,n):C.removeEvent(i,n,s.handle);l[r]&&(delete l[r],u||"undefined"==typeof i.removeAttribute?i[o]=void 0:i.removeAttribute(o),h.push(r))}}}),C.fn.extend({domManip:Oe,detach:function(e){return Pe(this,e,!0)},remove:function(e){return Pe(this,e)},text:function(e){return $(this,function(e){return void 0===e?C.text(this):this.empty().append((this[0]&&this[0].ownerDocument||p).createTextNode(e))},null,e,arguments.length)},append:function(){return Oe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){Re(this,e).appendChild(e)}})},prepend:function(){return Oe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Oe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Oe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){1===e.nodeType&&C.cleanData(be(e,!1));for(;e.firstChild;)e.removeChild(e.firstChild);e.options&&C.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return C.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Te,""):void 0;if("string"==typeof e&&!_e.test(e)&&(_.htmlSerialize||!we.test(e))&&(_.leadingWhitespace||!ie.test(e))&&!se[(ee.exec(e)||["",""])[1].toLowerCase()]){e=C.htmlPrefilter(e);try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(C.cleanData(be(t,!1)),t.innerHTML=e);t=0}catch(c){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var i=[];return Oe(this,arguments,function(e){var t=this.parentNode;C.inArray(this,i)<0&&(C.cleanData(be(this)),t&&t.replaceChild(e,this))},i)}}),C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){C.fn[e]=function(e){for(var t,i=0,n=[],r=C(e),s=r.length-1;i<=s;i++)t=i===s?this:this.clone(!0),C(r[i])[a](t),o.apply(n,t.get());return this.pushStack(n)}});var Ie,Fe={HTML:"block",BODY:"block"};function Be(e,t){var i=C(t.createElement(e)).appendTo(t.body),n=C.css(i[0],"display");return i.detach(),n}function Ue(e){var t=p,i=Fe[e];return i||("none"!==(i=Be(e,t))&&i||((t=((Ie=(Ie||C("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Ie[0].contentDocument).document).write(),t.close(),i=Be(e,t),Ie.detach()),Fe[e]=i),i}var Ve=/^margin/,He=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),je=function(e,t,i,n){var r,s,a={};for(s in t)a[s]=e.style[s],e.style[s]=t[s];r=i.apply(e,n||[]);for(s in t)e.style[s]=a[s];return r},Ge=p.documentElement;!function(){var n,r,s,a,o,l,u=p.createElement("div"),c=p.createElement("div");function e(){var e,t,i=p.documentElement;i.appendChild(u),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=s=l=!1,r=o=!0,S.getComputedStyle&&(t=S.getComputedStyle(c),n="1%"!==(t||{}).top,l="2px"===(t||{}).marginLeft,s="4px"===(t||{width:"4px"}).width,c.style.marginRight="50%",r="4px"===(t||{marginRight:"4px"}).marginRight,(e=c.appendChild(p.createElement("div"))).style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",c.style.width="1px",o=!parseFloat((S.getComputedStyle(e)||{}).marginRight),c.removeChild(e)),c.style.display="none",(a=0===c.getClientRects().length)&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",(e=c.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(a=0===e[0].offsetHeight)&&(e[0].style.display="",e[1].style.display="none",a=0===e[0].offsetHeight)),i.removeChild(u)}c.style&&(c.style.cssText="float:left;opacity:.5",_.opacity="0.5"===c.style.opacity,_.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",_.clearCloneStyle="content-box"===c.style.backgroundClip,(u=p.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",u.appendChild(c),_.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,C.extend(_,{reliableHiddenOffsets:function(){return null==n&&e(),a},boxSizingReliable:function(){return null==n&&e(),s},pixelMarginRight:function(){return null==n&&e(),r},pixelPosition:function(){return null==n&&e(),n},reliableMarginRight:function(){return null==n&&e(),o},reliableMarginLeft:function(){return null==n&&e(),l}}))}();var qe,We,ze=/^(top|right|bottom|left)$/;S.getComputedStyle?(qe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=S),t.getComputedStyle(e)},We=function(e,t,i){var n,r,s,a,o=e.style;return""!==(a=(i=i||qe(e))?i.getPropertyValue(t)||i[t]:void 0)&&void 0!==a||C.contains(e.ownerDocument,e)||(a=C.style(e,t)),i&&!_.pixelMarginRight()&&He.test(a)&&Ve.test(t)&&(n=o.width,r=o.minWidth,s=o.maxWidth,o.minWidth=o.maxWidth=o.width=a,a=i.width,o.width=n,o.minWidth=r,o.maxWidth=s),void 0===a?a:a+""}):Ge.currentStyle&&(qe=function(e){return e.currentStyle},We=function(e,t,i){var n,r,s,a,o=e.style;return null==(a=(i=i||qe(e))?i[t]:void 0)&&o&&o[t]&&(a=o[t]),He.test(a)&&!ze.test(t)&&(n=o.left,(s=(r=e.runtimeStyle)&&r.left)&&(r.left=e.currentStyle.left),o.left="fontSize"===t?"1em":a,a=o.pixelLeft+"px",o.left=n,s&&(r.left=s)),void 0===a?a:a+""||"auto"});function Ye(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}var Ke=/alpha\([^)]*\)/i,Xe=/opacity\s*=\s*([^)]*)/i,Qe=/^(none|table(?!-c[ea]).+)/,Je=new RegExp("^("+q+")(.*)$","i"),$e={position:"absolute",visibility:"hidden",display:"block"},Ze={letterSpacing:"0",fontWeight:"400"},et=["Webkit","O","Moz","ms"],tt=p.createElement("div").style;function it(e){if(e in tt)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),i=et.length;i--;)if((e=et[i]+t)in tt)return e}function nt(e,t){for(var i,n,r,s=[],a=0,o=e.length;a<o;a++)(n=e[a]).style&&(s[a]=C._data(n,"olddisplay"),i=n.style.display,t?(s[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Y(n)&&(s[a]=C._data(n,"olddisplay",Ue(n.nodeName)))):(r=Y(n),(i&&"none"!==i||!r)&&C._data(n,"olddisplay",r?i:C.css(n,"display"))));for(a=0;a<o;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?s[a]||"":"none"));return e}function rt(e,t,i){var n=Je.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function st(e,t,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,a=0;s<4;s+=2)"margin"===i&&(a+=C.css(e,i+z[s],!0,r)),n?("content"===i&&(a-=C.css(e,"padding"+z[s],!0,r)),"margin"!==i&&(a-=C.css(e,"border"+z[s]+"Width",!0,r))):(a+=C.css(e,"padding"+z[s],!0,r),"padding"!==i&&(a+=C.css(e,"border"+z[s]+"Width",!0,r)));return a}function at(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,s=qe(e),a=_.boxSizing&&"border-box"===C.css(e,"boxSizing",!1,s);if(r<=0||null==r){if(((r=We(e,t,s))<0||null==r)&&(r=e.style[t]),He.test(r))return r;n=a&&(_.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+st(e,t,i||(a?"border":"content"),n,s)+"px"}C.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=We(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":_.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,s,a,o=C.camelCase(t),l=e.style;if(t=C.cssProps[o]||(C.cssProps[o]=it(o)||o),a=C.cssHooks[t]||C.cssHooks[o],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(e,!1,n))?r:l[t];if("string"===(s=typeof i)&&(r=W.exec(i))&&r[1]&&(i=K(e,t,r),s="number"),null!=i&&i==i&&("number"===s&&(i+=r&&r[3]||(C.cssNumber[o]?"":"px")),_.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(e,i,n)))))try{l[t]=i}catch(u){}}},css:function(e,t,i,n){var r,s,a,o=C.camelCase(t);return t=C.cssProps[o]||(C.cssProps[o]=it(o)||o),(a=C.cssHooks[t]||C.cssHooks[o])&&"get"in a&&(s=a.get(e,!0,i)),void 0===s&&(s=We(e,t,n)),"normal"===s&&t in Ze&&(s=Ze[t]),""===i||i?(r=parseFloat(s),!0===i||isFinite(r)?r||0:s):s}}),C.each(["height","width"],function(e,r){C.cssHooks[r]={get:function(e,t,i){if(t)return Qe.test(C.css(e,"display"))&&0===e.offsetWidth?je(e,$e,function(){return at(e,r,i)}):at(e,r,i)},set:function(e,t,i){var n=i&&qe(e);return rt(0,t,i?st(e,r,i,_.boxSizing&&"border-box"===C.css(e,"boxSizing",!1,n),n):0)}}}),_.opacity||(C.cssHooks.opacity={get:function(e,t){return Xe.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=C.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=n&&n.filter||i.filter||"";((i.zoom=1)<=t||""===t)&&""===C.trim(s.replace(Ke,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=Ke.test(s)?s.replace(Ke,r):s+" "+r)}}),C.cssHooks.marginRight=Ye(_.reliableMarginRight,function(e,t){if(t)return je(e,{display:"inline-block"},We,[e,"marginRight"])}),C.cssHooks.marginLeft=Ye(_.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||(C.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-je(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px"}),C.each({margin:"",padding:"",border:"Width"},function(r,s){C.cssHooks[r+s]={expand:function(e){for(var t=0,i={},n="string"==typeof e?e.split(" "):[e];t<4;t++)i[r+z[t]+s]=n[t]||n[t-2]||n[0];return i}},Ve.test(r)||(C.cssHooks[r+s].set=rt)}),C.fn.extend({css:function(e,t){return $(this,function(e,t,i){var n,r,s={},a=0;if(C.isArray(t)){for(n=qe(e),r=t.length;a<r;a++)s[t[a]]=C.css(e,t[a],!1,n);return s}return void 0!==i?C.style(e,t,i):C.css(e,t)},e,t,1<arguments.length)},show:function(){return nt(this,!0)},hide:function(){return nt(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Y(this)?C(this).show():C(this).hide()})}});function ot(e,t,i,n,r){return new ot.prototype.init(e,t,i,n,r)}((C.Tween=ot).prototype={constructor:ot,init:function(e,t,i,n,r,s){this.elem=e,this.prop=i,this.easing=r||C.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(C.cssNumber[i]?"":"px")},cur:function(){var e=ot.propHooks[this.prop];return e&&e.get?e.get(this):ot.propHooks._default.get(this)},run:function(e){var t,i=ot.propHooks[this.prop];return this.options.duration?this.pos=t=C.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):ot.propHooks._default.set(this),this}}).init.prototype=ot.prototype,(ot.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=C.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){C.fx.step[e.prop]?C.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[C.cssProps[e.prop]]&&!C.cssHooks[e.prop]?e.elem[e.prop]=e.now:C.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=ot.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},C.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},C.fx=ot.prototype.init,C.fx.step={};var lt,ut,ct,ht,dt,ft,pt,mt=/^(?:toggle|show|hide)$/,gt=/queueHooks$/;function vt(){return S.setTimeout(function(){lt=void 0}),lt=C.now()}function yt(e,t){var i,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)n["margin"+(i=z[r])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function Et(e,t,i){for(var n,r=(bt.tweeners[t]||[]).concat(bt.tweeners["*"]),s=0,a=r.length;s<a;s++)if(n=r[s].call(i,t,e))return n}function bt(s,e,t){var i,a,n=0,r=bt.prefilters.length,o=C.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var e=lt||vt(),t=Math.max(0,u.startTime+u.duration-e),i=1-(t/u.duration||0),n=0,r=u.tweens.length;n<r;n++)u.tweens[n].run(i);return o.notifyWith(s,[u,i,t]),i<1&&r?t:(o.resolveWith(s,[u]),!1)},u=o.promise({elem:s,props:C.extend({},e),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},t),originalProperties:e,originalOptions:t,startTime:lt||vt(),duration:t.duration,tweens:[],createTween:function(e,t){var i=C.Tween(s,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var t=0,i=e?u.tweens.length:0;if(a)return this;for(a=!0;t<i;t++)u.tweens[t].run(1);return e?(o.notifyWith(s,[u,1,0]),o.resolveWith(s,[u,e])):o.rejectWith(s,[u,e]),this}}),c=u.props;for(function(e,t){var i,n,r,s,a;for(i in e)if(r=t[n=C.camelCase(i)],s=e[i],C.isArray(s)&&(r=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),(a=C.cssHooks[n])&&"expand"in a){s=a.expand(s),delete e[n];for(i in s)i in e||(e[i]=s[i],t[i]=r)}else t[n]=r}(c,u.opts.specialEasing);n<r;n++)if(i=bt.prefilters[n].call(u,s,c,u.opts))return C.isFunction(i.stop)&&(C._queueHooks(u.elem,u.opts.queue).stop=C.proxy(i.stop,i)),i;return C.map(c,Et,u),C.isFunction(u.opts.start)&&u.opts.start.call(s,u),C.fx.timer(C.extend(l,{elem:s,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}C.Animation=C.extend(bt,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return K(i.elem,e,W.exec(t),i),i}]},tweener:function(e,t){C.isFunction(e)?(t=e,e=["*"]):e=e.match(M);for(var i,n=0,r=e.length;n<r;n++)i=e[n],bt.tweeners[i]=bt.tweeners[i]||[],bt.tweeners[i].unshift(t)},prefilters:[function(t,e,i){var n,r,s,a,o,l,u,c=this,h={},d=t.style,f=t.nodeType&&Y(t),p=C._data(t,"fxshow");i.queue||(null==(o=C._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,l=o.empty.fire,o.empty.fire=function(){o.unqueued||l()}),o.unqueued++,c.always(function(){c.always(function(){o.unqueued--,C.queue(t,"fx").length||o.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(u=C.css(t,"display"))?C._data(t,"olddisplay")||Ue(t.nodeName):u)&&"none"===C.css(t,"float")&&(_.inlineBlockNeedsLayout&&"inline"!==Ue(t.nodeName)?d.zoom=1:d.display="inline-block")),i.overflow&&(d.overflow="hidden",_.shrinkWrapBlocks()||c.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],mt.exec(r)){if(delete e[n],s=s||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!p||void 0===p[n])continue;f=!0}h[n]=p&&p[n]||C.style(t,n)}else u=void 0;if(C.isEmptyObject(h))"inline"===("none"===u?Ue(t.nodeName):u)&&(d.display=u);else{p?"hidden"in p&&(f=p.hidden):p=C._data(t,"fxshow",{}),s&&(p.hidden=!f),f?C(t).show():c.done(function(){C(t).hide()}),c.done(function(){var e;C._removeData(t,"fxshow");for(e in h)C.style(t,e,h[e])});for(n in h)a=Et(f?p[n]:0,n,c),n in p||(p[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}],prefilter:function(e,t){t?bt.prefilters.unshift(e):bt.prefilters.push(e)}}),C.speed=function(e,t,i){var n=e&&"object"==typeof e?C.extend({},e):{complete:i||!i&&t||C.isFunction(e)&&e,duration:e,easing:i&&t||t&&!C.isFunction(t)&&t};return n.duration=C.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in C.fx.speeds?C.fx.speeds[n.duration]:C.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){C.isFunction(n.old)&&n.old.call(this),n.queue&&C.dequeue(this,n.queue)},n},C.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Y).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){var r=C.isEmptyObject(t),s=C.speed(e,i,n),a=function(){var e=bt(this,C.extend({},t),s);(r||C._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===s.queue?this.each(a):this.queue(s.queue,a)},stop:function(r,e,s){var a=function(e){var t=e.stop;delete e.stop,t(s)};return"string"!=typeof r&&(s=e,e=r,r=void 0),e&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var e=!0,t=null!=r&&r+"queueHooks",i=C.timers,n=C._data(this);if(t)n[t]&&n[t].stop&&a(n[t]);else for(t in n)n[t]&&n[t].stop&&gt.test(t)&&a(n[t]);for(t=i.length;t--;)i[t].elem!==this||null!=r&&i[t].queue!==r||(i[t].anim.stop(s),e=!1,i.splice(t,1));!e&&s||C.dequeue(this,r)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=C._data(this),i=t[a+"queue"],n=t[a+"queueHooks"],r=C.timers,s=i?i.length:0;for(t.finish=!0,C.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===a&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete t.finish})}}),C.each(["toggle","show","hide"],function(e,n){var r=C.fn[n];C.fn[n]=function(e,t,i){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(yt(n,!0),e,t,i)}}),C.each({slideDown:yt("show"),slideUp:yt("hide"),slideToggle:yt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){C.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}}),C.timers=[],C.fx.tick=function(){var e,t=C.timers,i=0;for(lt=C.now();i<t.length;i++)(e=t[i])()||t[i]!==e||t.splice(i--,1);t.length||C.fx.stop(),lt=void 0},C.fx.timer=function(e){C.timers.push(e),e()?C.fx.start():C.timers.pop()},C.fx.interval=13,C.fx.start=function(){ut||(ut=S.setInterval(C.fx.tick,C.fx.interval))},C.fx.stop=function(){S.clearInterval(ut),ut=null},C.fx.speeds={slow:600,fast:200,_default:400},C.fn.delay=function(n,e){return n=C.fx&&C.fx.speeds[n]||n,e=e||"fx",this.queue(e,function(e,t){var i=S.setTimeout(e,n);t.stop=function(){S.clearTimeout(i)}})},ht=p.createElement("input"),dt=p.createElement("div"),ft=p.createElement("select"),pt=ft.appendChild(p.createElement("option")),(dt=p.createElement("div")).setAttribute("className","t"),dt.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ct=dt.getElementsByTagName("a")[0],ht.setAttribute("type","checkbox"),dt.appendChild(ht),(ct=dt.getElementsByTagName("a")[0]).style.cssText="top:1px",_.getSetAttribute="t"!==dt.className,_.style=/top/.test(ct.getAttribute("style")),_.hrefNormalized="/a"===ct.getAttribute("href"),_.checkOn=!!ht.value,_.optSelected=pt.selected,_.enctype=!!p.createElement("form").enctype,ft.disabled=!0,_.optDisabled=!pt.disabled,(ht=p.createElement("input")).setAttribute("value",""),_.input=""===ht.getAttribute("value"),ht.value="t",ht.setAttribute("type","radio"),_.radioValue="t"===ht.value;var Tt=/\r/g,wt=/[\x20\t\r\n\f]+/g;C.fn.extend({val:function(i){var n,e,r,t=this[0];return arguments.length?(r=C.isFunction(i),this.each(function(e){var t;1===this.nodeType&&(null==(t=r?i.call(this,e,C(this).val()):i)?t="":"number"==typeof t?t+="":C.isArray(t)&&(t=C.map(t,function(e){return null==e?"":e+""})),(n=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,t,"value")||(this.value=t))})):t?(n=C.valHooks[t.type]||C.valHooks[t.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(Tt,""):null==e?"":e:void 0}}),C.extend({valHooks:{option:{get:function(e){var t=C.find.attr(e,"value");return null!=t?t:C.trim(C.text(e)).replace(wt," ")}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,s="select-one"===e.type||r<0,a=s?null:[],o=s?r+1:n.length,l=r<0?o:s?r:0;l<o;l++)if(((i=n[l]).selected||l===r)&&(_.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!C.nodeName(i.parentNode,"optgroup"))){if(t=C(i).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var i,n,r=e.options,s=C.makeArray(t),a=r.length;a--;)if(n=r[a],-1<C.inArray(C.valHooks.option.get(n),s))try{n.selected=i=!0}catch(l){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),r}}}}),C.each(["radio","checkbox"],function(){C.valHooks[this]={set:function(e,t){if(C.isArray(t))return e.checked=-1<C.inArray(C(e).val(),t)}},_.checkOn||(C.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var St,_t,Ct=C.expr.attrHandle,At=/^(?:checked|selected)$/i,xt=_.getSetAttribute,kt=_.input;C.fn.extend({attr:function(e,t){return $(this,C.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){C.removeAttr(this,e)})}}),C.extend({attr:function(e,t,i){var n,r,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return"undefined"==typeof e.getAttribute?C.prop(e,t,i):(1===s&&C.isXMLDoc(e)||(t=t.toLowerCase(),r=C.attrHooks[t]||(C.expr.match.bool.test(t)?_t:St)),void 0!==i?null===i?void C.removeAttr(e,t):r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:(e.setAttribute(t,i+""),i):r&&"get"in r&&null!==(n=r.get(e,t))?n:null==(n=C.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!_.radioValue&&"radio"===t&&C.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n,r=0,s=t&&t.match(M);if(s&&1===e.nodeType)for(;i=s[r++];)n=C.propFix[i]||i,C.expr.match.bool.test(i)?kt&&xt||!At.test(i)?e[n]=!1:e[C.camelCase("default-"+i)]=e[n]=!1:C.attr(e,i,""),e.removeAttribute(xt?i:n)}}),_t={set:function(e,t,i){return!1===t?C.removeAttr(e,i):kt&&xt||!At.test(i)?e.setAttribute(!xt&&C.propFix[i]||i,i):e[C.camelCase("default-"+i)]=e[i]=!0,i}},C.each(C.expr.match.bool.source.match(/\w+/g),function(e,t){var s=Ct[t]||C.find.attr;kt&&xt||!At.test(t)?Ct[t]=function(e,t,i){var n,r;return i||(r=Ct[t],Ct[t]=n,n=null!=s(e,t,i)?t.toLowerCase():null,Ct[t]=r),n}:Ct[t]=function(e,t,i){if(!i)return e[C.camelCase("default-"+t)]?t.toLowerCase():null}}),kt&&xt||(C.attrHooks.value={set:function(e,t,i){return C.nodeName(e,"input")?void(e.defaultValue=t):St&&St.set(e,t,i)}}),xt||(St={set:function(e,t,i){var n=e.getAttributeNode(i);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i))return t}},Ct.id=Ct.name=Ct.coords=function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},C.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);if(i&&i.specified)return i.value},set:St.set},C.attrHooks.contenteditable={set:function(e,t,i){St.set(e,""!==t&&t,i)}},C.each(["width","height"],function(e,i){C.attrHooks[i]={set:function(e,t){if(""===t)return e.setAttribute(i,"auto"),t}}})),_.style||(C.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Rt=/^(?:input|select|textarea|button|object)$/i,Nt=/^(?:a|area)$/i;C.fn.extend({prop:function(e,t){return $(this,C.prop,e,t,1<arguments.length)},removeProp:function(e){return e=C.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),C.extend({prop:function(e,t,i){var n,r,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&C.isXMLDoc(e)||(t=C.propFix[t]||t,r=C.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=C.find.attr(e,"tabindex");return t?parseInt(t,10):Rt.test(e.nodeName)||Nt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),_.hrefNormalized||C.each(["href","src"],function(e,t){C.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),_.optSelected||(C.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),C.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){C.propFix[this.toLowerCase()]=this}),_.enctype||(C.propFix.enctype="encoding");var Lt=/[\t\r\n\f]/g;function Dt(e){return C.attr(e,"class")||""}C.fn.extend({addClass:function(t){var e,i,n,r,s,a,o,l=0;if(C.isFunction(t))return this.each(function(e){C(this).addClass(t.call(this,e,Dt(this)))});if("string"==typeof t&&t){e=t.match(M)||[];for(;i=this[l++];)if(r=Dt(i),n=1===i.nodeType&&(" "+r+" ").replace(Lt," ")){a=0;for(;s=e[a++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r!==(o=C.trim(n))&&C.attr(i,"class",o)}}return this},removeClass:function(t){var e,i,n,r,s,a,o,l=0;if(C.isFunction(t))return this.each(function(e){C(this).removeClass(t.call(this,e,Dt(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t){e=t.match(M)||[];for(;i=this[l++];)if(r=Dt(i),n=1===i.nodeType&&(" "+r+" ").replace(Lt," ")){a=0;for(;s=e[a++];)for(;-1<n.indexOf(" "+s+" ");)n=n.replace(" "+s+" "," ");r!==(o=C.trim(n))&&C.attr(i,"class",o)}}return this},toggleClass:function(r,t){var s=typeof r;return"boolean"==typeof t&&"string"===s?t?this.addClass(r):this.removeClass(r):C.isFunction(r)?this.each(function(e){C(this).toggleClass(r.call(this,e,Dt(this),t),t)}):this.each(function(){var e,t,i,n;if("string"===s){t=0,i=C(this),n=r.match(M)||[];for(;e=n[t++];)i.hasClass(e)?i.removeClass(e):i.addClass(e)}else void 0!==r&&"boolean"!==s||((e=Dt(this))&&C._data(this,"__className__",e),C.attr(this,"class",e||!1===r?"":C._data(this,"__className__")||""))})},hasClass:function(e){var t,i,n=0;t=" "+e+" ";for(;i=this[n++];)if(1===i.nodeType&&-1<(" "+Dt(i)+" ").replace(Lt," ").indexOf(t))return!0;return!1}}),C.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,i){C.fn[i]=function(e,t){return 0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),C.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var Mt=S.location,Ot=C.now(),Pt=/\?/,It=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;C.parseJSON=function(e){if(S.JSON&&S.JSON.parse)return S.JSON.parse(e+"");var r,s=null,t=C.trim(e+"");return t&&!C.trim(t.replace(It,function(e,t,i,n){return r&&t&&(s=0),0===s?e:(r=i||t,s+=!n-!i,"")}))?Function("return "+t)():C.error("Invalid JSON: "+e)},C.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{S.DOMParser?t=(new S.DOMParser).parseFromString(e,"text/xml"):((t=new S.ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(c){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||C.error("Invalid XML: "+e),t};var Ft=/#.*$/,Bt=/([?&])_=[^&]*/,Ut=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Vt=/^(?:GET|HEAD)$/,Ht=/^\/\//,jt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Gt={},qt={},Wt="*/".concat("*"),zt=Mt.href,Yt=jt.exec(zt.toLowerCase())||[];function Kt(s){return function(e,t){"string"!=typeof e&&(t=e,e="*");var i,n=0,r=e.toLowerCase().match(M)||[];if(C.isFunction(t))for(;i=r[n++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(s[i]=s[i]||[]).unshift(t)):(s[i]=s[i]||[]).push(t)}}function Xt(t,r,s,a){var o={},l=t===qt;function u(e){var n;return o[e]=!0,C.each(t[e]||[],function(e,t){var i=t(r,s,a);return"string"!=typeof i||l||o[i]?l?!(n=i):void 0:(r.dataTypes.unshift(i),u(i),!1)}),n}return u(r.dataTypes[0])||!o["*"]&&u("*")}function Qt(e,t){var i,n,r=C.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&C.extend(!0,e,i),e}C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Yt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":C.parseJSON,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Qt(Qt(e,C.ajaxSettings),t):Qt(C.ajaxSettings,e)},ajaxPrefilter:Kt(Gt),ajaxTransport:Kt(qt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,n,c,h,d,f,p,r,m=C.ajaxSetup({},t),g=m.context||m,v=m.context&&(g.nodeType||g.jquery)?C(g):C.event,y=C.Deferred(),E=C.Callbacks("once memory"),b=m.statusCode||{},s={},a={},T=0,o="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===T){if(!r){r={};for(;t=Ut.exec(h);)r[t[1].toLowerCase()]=t[2]}t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===T?h:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return T||(e=a[i]=a[i]||e,s[e]=t),this},overrideMimeType:function(e){return T||(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(T<2)for(t in e)b[t]=[b[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||o;return p&&p.abort(t),l(0,t),this}};if(y.promise(w).complete=E.add,w.success=w.done,w.error=w.fail,m.url=((e||m.url||zt)+"").replace(Ft,"").replace(Ht,Yt[1]+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=C.trim(m.dataType||"*").toLowerCase().match(M)||[""],null==m.crossDomain&&(i=jt.exec(m.url.toLowerCase()),m.crossDomain=!(!i||i[1]===Yt[1]&&i[2]===Yt[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Yt[3]||("http:"===Yt[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=C.param(m.data,m.traditional)),Xt(Gt,m,t,w),2===T)return w;(f=C.event&&m.global)&&0==C.active++&&C.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Vt.test(m.type),c=m.url,m.hasContent||(m.data&&(c=m.url+=(Pt.test(c)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=Bt.test(c)?c.replace(Bt,"$1_="+Ot++):c+(Pt.test(c)?"&":"?")+"_="+Ot++)),m.ifModified&&(C.lastModified[c]&&w.setRequestHeader("If-Modified-Since",C.lastModified[c]),C.etag[c]&&w.setRequestHeader("If-None-Match",C.etag[c])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Wt+"; q=0.01":""):m.accepts["*"]);for(n in m.headers)w.setRequestHeader(n,m.headers[n]);if(m.beforeSend&&(!1===m.beforeSend.call(g,w,m)||2===T))return w.abort();o="abort";for(n in{success:1,error:1,complete:1})w[n](m[n]);if(p=Xt(qt,m,t,w)){if(w.readyState=1,f&&v.trigger("ajaxSend",[w,m]),2===T)return w;m.async&&0<m.timeout&&(d=S.setTimeout(function(){w.abort("timeout")},m.timeout));try{T=1,p.send(s,l)}catch(A){if(!(T<2))throw A;l(-1,A)}}else l(-1,"No Transport");function l(e,t,i,n){var r,s,a,o,l,u=t;2!==T&&(T=2,d&&S.clearTimeout(d),p=void 0,h=n||"",w.readyState=0<e?4:0,r=200<=e&&e<300||304===e,i&&(o=function(e,t,i){for(var n,r,s,a,o=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in o)if(o[a]&&o[a].test(r)){l.unshift(a);break}if(l[0]in i)s=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){s=a;break}n||(n=a)}s=s||n}if(s)return s!==l[0]&&l.unshift(s),i[s]}(m,w,i)),o=function(e,t,i,n){var r,s,a,o,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];s=c.shift();for(;s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=c.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(a=u[l+" "+s]||u["* "+s]))for(r in u)if((o=r.split(" "))[1]===s&&(a=u[l+" "+o[0]]||u["* "+o[0]])){!0===a?a=u[r]:!0!==u[r]&&(s=o[0],c.unshift(o[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(_){return{state:"parsererror",error:a?_:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}(m,o,w,r),r?(m.ifModified&&((l=w.getResponseHeader("Last-Modified"))&&(C.lastModified[c]=l),(l=w.getResponseHeader("etag"))&&(C.etag[c]=l)),204===e||"HEAD"===m.type?u="nocontent":304===e?u="notmodified":(u=o.state,s=o.data,r=!(a=o.error))):(a=u,!e&&u||(u="error",e<0&&(e=0))),w.status=e,w.statusText=(t||u)+"",r?y.resolveWith(g,[s,u,w]):y.rejectWith(g,[w,u,a]),w.statusCode(b),b=void 0,f&&v.trigger(r?"ajaxSuccess":"ajaxError",[w,m,r?s:a]),E.fireWith(g,[w,u]),f&&(v.trigger("ajaxComplete",[w,m]),--C.active||C.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,i){return C.get(e,t,i,"json")},getScript:function(e,t){return C.get(e,void 0,t,"script")}}),C.each(["get","post"],function(e,r){C[r]=function(e,t,i,n){return C.isFunction(t)&&(n=n||i,i=t,t=void 0),C.ajax(C.extend({url:e,type:r,dataType:n,data:t,success:i},C.isPlainObject(e)&&e))}}),C._evalUrl=function(e){return C.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},C.fn.extend({wrapAll:function(t){if(C.isFunction(t))return this.each(function(e){C(this).wrapAll(t.call(this,e))});if(this[0]){var e=C(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(i){return C.isFunction(i)?this.each(function(e){C(this).wrapInner(i.call(this,e))}):this.each(function(){var e=C(this),t=e.contents();t.length?t.wrapAll(i):e.append(i)})},wrap:function(t){var i=C.isFunction(t);return this.each(function(e){C(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){C.nodeName(this,"body")||C(this).replaceWith(this.childNodes)}).end()}});C.expr.filters.hidden=function(e){return _.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:function(e){if(!C.contains(e.ownerDocument||p,e))return!0;for(;e&&1===e.nodeType;){if("none"===((t=e).style&&t.style.display||C.css(t,"display"))||"hidden"===e.type)return!0;e=e.parentNode}var t;return!1}(e)},C.expr.filters.visible=function(e){return!C.expr.filters.hidden(e)};var Jt=/%20/g,$t=/\[\]$/,Zt=/\r?\n/g,ei=/^(?:submit|button|image|reset|file)$/i,ti=/^(?:input|select|textarea|keygen)/i;function ii(i,e,n,r){var t;if(C.isArray(e))C.each(e,function(e,t){n||$t.test(i)?r(i,t):ii(i+"["+("object"==typeof t&&null!=t?e:"")+"]",t,n,r)});else if(n||"object"!==C.type(e))r(i,e);else for(t in e)ii(i+"["+t+"]",e[t],n,r)}C.param=function(e,t){var i,n=[],r=function(e,t){t=C.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=C.ajaxSettings&&C.ajaxSettings.traditional),C.isArray(e)||e.jquery&&!C.isPlainObject(e))C.each(e,function(){r(this.name,this.value)});else for(i in e)ii(i,e[i],t,r);return n.join("&").replace(Jt,"+")},C.fn.extend({serialize:function(){return C.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=C.prop(this,"elements");return e?C.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!C(this).is(":disabled")&&ti.test(this.nodeName)&&!ei.test(e)&&(this.checked||!Z.test(e))}).map(function(e,t){var i=C(this).val();return null==i?null:C.isArray(i)?C.map(i,function(e){return{name:t.name,value:e.replace(Zt,"\r\n")}}):{name:t.name,value:i.replace(Zt,"\r\n")}}).get()}}),C.ajaxSettings.xhr=void 0!==S.ActiveXObject?function(){return this.isLocal?oi():8<p.documentMode?ai():/^(get|post|head|put|delete|options)$/i.test(this.type)&&ai()||oi()}:ai;var ni=0,ri={},si=C.ajaxSettings.xhr();S.attachEvent&&S.attachEvent("onunload",function(){for(var e in ri)ri[e](void 0,!0)}),_.cors=!!si&&"withCredentials"in si,(si=_.ajax=!!si)&&C.ajaxTransport(function(l){if(!l.crossDomain||_.cors){var u;return{send:function(e,s){var t,a=l.xhr(),o=++ni;if(a.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)a[t]=l.xhrFields[t];l.mimeType&&a.overrideMimeType&&a.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(t in e)void 0!==e[t]&&a.setRequestHeader(t,e[t]+"");a.send(l.hasContent&&l.data||null),u=function(e,t){var i,n,r;if(u&&(t||4===a.readyState))if(delete ri[o],u=void 0,a.onreadystatechange=C.noop,t)4!==a.readyState&&a.abort();else{r={},i=a.status,"string"==typeof a.responseText&&(r.text=a.responseText);try{n=a.statusText}catch(g){n=""}i||!l.isLocal||l.crossDomain?1223===i&&(i=204):i=r.text?200:404}r&&s(i,n,r,a.getAllResponseHeaders())},l.async?4===a.readyState?S.setTimeout(u):a.onreadystatechange=ri[o]=u:u()},abort:function(){u&&u(void 0,!0)}}}});function ai(){try{return new S.XMLHttpRequest}catch(t){}}function oi(){try{return new S.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return C.globalEval(e),e}}}),C.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),C.ajaxTransport("script",function(t){if(t.crossDomain){var n,r=p.head||C("head")[0]||p.documentElement;return{send:function(e,i){(n=p.createElement("script")).async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(void 0,!0)}}}});var li=[],ui=/(=)\?(?=&|$)|\?\?/;C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=li.pop()||C.expando+"_"+Ot++;return this[e]=!0,e}}),C.ajaxPrefilter("json jsonp",function(e,t,i){var n,r,s,a=!1!==e.jsonp&&(ui.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ui.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=C.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ui,"$1"+n):!1!==e.jsonp&&(e.url+=(Pt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return s||C.error(n+" was not called"),s[0]},e.dataTypes[0]="json",r=S[n],S[n]=function(){s=arguments},i.always(function(){void 0===r?C(S).removeProp(n):S[n]=r,e[n]&&(e.jsonpCallback=t.jsonpCallback,li.push(n)),s&&C.isFunction(r)&&r(s[0]),s=r=void 0}),"script"}),C.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||p;var n=A.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=ce([e],t,r),r&&r.length&&C(r).remove(),C.merge([],n.childNodes))};var ci=C.fn.load;C.fn.load=function(e,t,i){if("string"!=typeof e&&ci)return ci.apply(this,arguments);var n,r,s,a=this,o=e.indexOf(" ");return-1<o&&(n=C.trim(e.slice(o,e.length)),e=e.slice(0,o)),C.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),0<a.length&&C.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){s=arguments,a.html(n?C("<div>").append(C.parseHTML(e)).find(n):e)}).always(i&&function(e,t){a.each(function(){i.apply(this,s||[e.responseText,t,e])})}),this},C.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){C.fn[t]=function(e){return this.on(t,e)}}),C.expr.filters.animated=function(t){return C.grep(C.timers,function(e){return t===e.elem}).length};function hi(e){return C.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}C.offset={setOffset:function(e,t,i){var n,r,s,a,o,l,u=C.css(e,"position"),c=C(e),h={};"static"===u&&(e.style.position="relative"),o=c.offset(),s=C.css(e,"top"),l=C.css(e,"left"),("absolute"===u||"fixed"===u)&&-1<C.inArray("auto",[s,l])?(a=(n=c.position()).top,r=n.left):(a=parseFloat(s)||0,r=parseFloat(l)||0),C.isFunction(t)&&(t=t.call(e,i,C.extend({},o))),null!=t.top&&(h.top=t.top-o.top+a),null!=t.left&&(h.left=t.left-o.left+r),"using"in t?t.using.call(e,h):c.css(h)}},C.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){C.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],s=r&&r.ownerDocument;return s?(e=s.documentElement,C.contains(e,r)?("undefined"!=typeof r.getBoundingClientRect&&(n=r.getBoundingClientRect()),i=hi(s),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===C.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),C.nodeName(e[0],"html")||(i=e.offset()),i.top+=C.css(e[0],"borderTopWidth",!0),i.left+=C.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-C.css(n,"marginTop",!0),left:t.left-i.left-C.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!C.nodeName(e,"html")&&"static"===C.css(e,"position");)e=e.offsetParent;return e||Ge})}}),C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var s=/Y/.test(r);C.fn[t]=function(e){return $(this,function(e,t,i){var n=hi(e);return void 0===i?n?r in n?n[r]:n.document.documentElement[t]:e[t]:void(n?n.scrollTo(s?C(n).scrollLeft():i,s?i:C(n).scrollTop()):e[t]=i)},t,e,arguments.length,null)}}),C.each(["top","left"],function(e,i){C.cssHooks[i]=Ye(_.pixelPosition,function(e,t){if(t)return t=We(e,i),He.test(t)?C(e).position()[i]+"px":t})}),C.each({Height:"height",Width:"width"},function(s,a){C.each({padding:"inner"+s,content:a,"":"outer"+s},function(n,e){C.fn[e]=function(e,t){var i=arguments.length&&(n||"boolean"!=typeof e),r=n||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,i){var n;return C.isWindow(e)?e.document.documentElement["client"+s]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+s],n["scroll"+s],e.body["offset"+s],n["offset"+s],n["client"+s])):void 0===i?C.css(e,t,r):C.style(e,t,i,r)},a,i?e:void 0,i,null)}})}),C.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),C.fn.size=function(){return this.length},C.fn.andSelf=C.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return C});var di=S.jQuery,fi=S.$;return C.noConflict=function(e){return S.$===C&&(S.$=fi),e&&S.jQuery===C&&(S.jQuery=di),C},t||(S.jQuery=S.$=C),C},"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e);i.jQuery=window.jQuery?window.jQuery:window.$;window.$=n;window.jQuery=r}}();!function(){"use strict";var l=getDframework();l.define("imgtech.media.Fullscreen",function(){function e(e,t){this.attr=e;this.addedObject=t;this.realElement=null;this.fullscreenElement=null;this.fullscreenAttribute=null;this.saved={};this.mobileDepthSize=150;this.__replaceCsse=null;this.__replaceFixedCsses=null;this.__replaceHideElement=null;this.__replaceFirstElement=null;this.__ieResizeWindow=null}e.prototype={constructor:e,onOrientationChange:function(e){e.orientation&&"landscape"==e.orientation&&(90==window.rotation?this.rotate(this,-90):this.rotate(this,90))},rotate:function(e,t){var i=this.realElement||this.fullscreenElement;if(i&&this.isFullscreen()){var n=t/90;n<0&&(n+=4);var r="rotate("+t+"deg)",s="progid:DXImageTransform.Microsoft.BasicImage(rotation="+n+")";i.style.transform=r;i.style.WebkitTransform=r;i.style.MozTransform=r;i.style.OTransform=r;if(l.b.ie){i.style.filter=s;i.style.MsFilter=s}}},isReplaceElement:function(){return this.attr&&this.attr.fullscreenReplaceElement},isReplaceCss:function(){return this.attr&&this.attr.fullscreenReplaceCss},isReplaceFixedCss:function(){return this.attr&&this.attr.fullscreenReplaceFixedCss},isReplaceHideElement:function(){return this.attr&&this.attr.fullscreenHideElement},isResizeWindow:function(){return this.attr&&this.attr.fullscreenResizeWindow},getBodyElement:function(e){for(var t,i,n=e;t=n.parentNode;){if("body"==(i=t.nodeName.toLowerCase())||"html"==i)return t;n=t}},getFullscreenParentElements:function(e){for(var t,i={fsElements:[],hideElements:[]},n=e;t=n.parentNode;){i.fsElements.push({parent:t,safe:n});if("body"==t.nodeName.toLowerCase())break;n=t}for(var r=0;r<i.fsElements.length;r++){var s=i.fsElements[r],a=s.parent,o=s.safe,l=a.children;if(l)for(var u=0;u<l.length;u++)l[u]!==o&&i.hideElements.push({element:l[u]})}return i},replaceCss:function(e,t){var i,n,r,s="mpv-fullscreen-none-rootnode",a="mpv-fullscreen-rootnode",o=this.__replaceCsse;if(o){i=o.fsElements;n=o.hideElements;for(r=0;r<n.length;r++)l.removeClass(n[r].element,s);for(r=0;r<i.length;r++)l.removeClass(i[r].safe,a);this.__replaceCsse=null}if(t){i=(o=this.getFullscreenParentElements(e)).fsElements;n=o.hideElements;for(r=0;r<n.length;r++)l.addClass(n[r].element,s);for(r=0;r<i.length;r++)l.addClass(i[r].safe,a);this.__replaceCsse=o}},replaceFixedCss:function(e,t){var i,n,r,s=this.__replaceFixedCsses;if(s){i=s.fsElements;n=s.hideElements;for(r=0;r<n.length;r++)n[r].element.style.zIndex=n[r].element_style.zIndex;for(r=0;r<i.length;r++)i[r].safe.style.zIndex=i[r].safe_style.zIndex;this.__replaceFixedCsses=null}if(t){i=(s=this.getFullscreenParentElements(e)).fsElements;n=s.hideElements;for(r=0;r<n.length;r++){n[r].element_style={zIndex:n[r].element.style.zIndex};n[r].element.style.zIndex=1}for(r=0;r<i.length;r++){i[r].safe_style={zIndex:i[r].safe.style.zIndex};i[r].safe.style.zIndex=99999}this.__replaceFixedCsses=s}},replaceHideElement:function(e,t){var i,n,r=this.__replaceHideElement;if(r){r.fsElements;i=r.hideElements;for(n=0;n<i.length;n++)i[n].element.style.display=i[n].element_style.display;this.__replaceHideElement=null}if(t){(r=this.getFullscreenParentElements(e)).fsElements;i=r.hideElements;for(n=0;n<i.length;n++){var s=i[n].element.style.display;i[n].element_style={display:s||""};i[n].element.style.display="none"}this.__replaceHideElement=r}},replaceElement:function(e,t){var i,n,r=this.windowSize();if(t){this.hasReplaceElement=!0;this.__replaceFirstElement=[];var s=document.body.children[0];for(i=0;i<document.body.children.length;i++){n=document.body.children[i];this.__replaceFirstElement.push(n);l.addClass(n,"mpv-fullscreen-mob-none")}this._originPosition=document.createElement("div");l.addClass(this._originPosition,"mpv-fullscreen-origin-position");this._virtualPosition=document.createElement("div");this._virtualPosition.innerText="mpv-fullscreen-virtual-position";l.addClass(this._virtualPosition,"mpv-fullscreen-virtual-position");this._virtualPosition.style.height=r.height+this.mobileDepthSize+"px";l.before(e,this._originPosition);l.before(s,this._virtualPosition);l.append(this._virtualPosition,e)}else{this.hasReplaceElement=!1;var a=this.__replaceFirstElement;for(i=0;i<a.length;i++)l.removeClass(a[i],"mpv-fullscreen-mob-none");this.__replaceFirstElement=null;if(this._originPosition){l.before(this._originPosition,e);l.remove(this._originPosition);this._originPosition=null}if(this._virtualPosition){l.remove(this._virtualPosition);this._virtualPosition=null}}},getScreenSize:function(){return{width:window.screen.width,height:window.screen.height}},viewportSize:function(){var e,t;if(l.b.ie&&l.b.ie<=8){e=document.documentElement.clientWidth;t=document.documentElement.clientHeight}else{e=window.outerWidth||window.innerWidth;t=window.outerHeight||window.innerHeight}return{width:e,height:t}},ieResizeWindow:function(e){var t=this.__ieResizeWindow;if(e)(function(){var e,t,i=this.getScreenSize(),n=i.width,r=i.height,s=this.viewportSize();if(l.b.ie&&l.b.ie<=8){e=window.screenLeft;t=window.screenTop}else{e=window.screenX;t=window.screenY}this.__ieResizeWindow={windowX:e,windowY:t,viewportWidth:s.width,viewportHeight:s.height};try{window.moveTo(0,0)}catch(a){}try{window.resizeTo(n,r)}catch(a){}}).call(this);else if(t){window.resizeTo(t.viewportWidth,t.viewportHeight);window.moveTo(t.windowX,t.windowY);this.__ieResizeWindow=null}},enable:function(e,t){var i=window.event;return!(l.b.iOS||!1===t||!i&&!l.b.firefox||this.fullscreenElement)&&((!l.b.ie||11!==l.b.ie||!i||"keydown"!=i.type&&"keyup"!=i.type)&&(!!e.webkitRequestFullscreen||(!!e.mozRequestFullScreen||(!!e.msRequestFullscreen||!!e.requestFullscreen))))},_fullscreen:function(e){if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else{if(!e.requestFullscreen)return!1;e.requestFullscreen()}return!0},_exit:function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else{if(!document.exitFullscreen)return!1;document.exitFullscreen()}return!0},fixSafariBug:function(e,t,i,n){if(t){var r,s;if(r=this.getBodyElement(e)){this.saved.body=r;this.saved.body_style={width:r.style.width?r.style.width:"",height:r.style.height?r.style.height:""};s=i?this.viewportSize().width:this.getScreenSize().width;r.style.width=s+"px"}}else n&&n.body&&n.body_style&&(n.body.style.width=n.body_style.width)},fullscreen:function(e,t){t||window.event||l.b.firefox||(t=!1);if(this.isFullscreen())throw new Error("current is fullscreen.");var i,n=this.enable(e,t);if(n){this.realElement=e;this._fullscreen(e);this.saved={element:{width:e.style.width,height:e.style.height,position:e.style.position}};e.style.width="100%";e.style.height="100%";l.addClass(e,"mpv-real-fullscreen");i=!1}else{var r=this.windowSize();this.fullscreenElement=e;this.fullscreenAttribute=t;this.saved={style:{margin:document.body.style.margin,padding:document.body.style.padding,overflow:document.body.style.overflow},scrollTop:l.scrollTop(),scrollLeft:l.scrollLeft(),ws:r,element:{width:e.style.width,height:e.style.height,position:e.style.position}};l.addClass(e,"mpv-virtual-fullscreen");document.body.style.margin="0px 0px";document.body.style.padding="0px 0px";this.isReplaceElement()&&this.replaceElement(e,!0);this.isReplaceCss()&&this.replaceCss(e,!0);this.isReplaceFixedCss()&&this.replaceFixedCss(e,!0);this.isReplaceHideElement()&&this.replaceHideElement(e,!0);!l.b.isMobile&&l.b.ie&&this.isResizeWindow()&&this.ieResizeWindow(!0);e.style.width="100%";l.b.isMobile?e.style.height=r.height+"px":e.style.height="100%";l.scrollTop(0);l.scrollLeft(0);document.body.style.overflow="hidden";8===l.b.ie&&"xp"==l.b.osAlias?e.style.position="absolute":e.style.position="fixed";i=!0}l.addClass(e,"mpv-fullscreen");l.removeClass(e,"mpv-nofullscreen");l.removeClass(e,"mpv-initfullscreen");l.b.safari&&!l.b.isMobile&&this.fixSafariBug(e,!0,i);return n},enableExit:function(){return this.isRealFullscreen()},exit:function(e){var t,i,n=this.realElement,r=this.saved,s=r?r.style:null;if(e)this.realElement=null;else if(!this.isFullscreen())throw new Error("current is not fullscreen.");if(n){e||this._exit();i=!(t=!0);n.style.width=r.element.width;n.style.height=r.element.height;this.realElement=null}else if(n=this.fullscreenElement){i=!(t=!1);document.body.style.margin=s.margin?s.margin:"";document.body.style.padding=s.padding?s.padding:"";document.body.style.overflow=s.overflow?s.overflow:"";document.body.style.position=s.position?s.position:"";l.scrollTop(r.scrollTop);l.scrollLeft(r.scrollLeft);l.removeClass(n,"mpv-virtual-fullscreen");n.style.width=r.element.width;n.style.height=r.element.height;n.style.position=r.element.position;this.saved={};this.fullscreenElement=null;this.fullscreenAttribute=null;this.isReplaceElement()&&this.replaceElement(n,!1);this.isReplaceCss()&&this.replaceCss(n,!1);this.isReplaceFixedCss()&&this.replaceFixedCss(n,!1);this.isReplaceHideElement()&&this.replaceHideElement(n,!1);!l.b.isMobile&&l.b.ie&&this.isResizeWindow()&&this.ieResizeWindow(!1)}l.removeClass(n,"mpv-real-fullscreen");l.removeClass(n,"mpv-fullscreen");l.addClass(n,"mpv-nofullscreen");l.removeClass(n,"mpv-initfullscreen");l.b.safari&&!l.b.isMobile&&this.fixSafariBug(n,!1,i,r);return t},toggle:function(e,t){return this.isFullscreen()?this.exit(e,t):this.fullscreen(e,t)},isRealFullscreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},isFullscreen:function(){return null!==this.fullscreenElement?this.fullscreenElement:this.isRealFullscreen()},isWindowFullscreen:function(e,t){return null!==this.fullscreenElement},windowSize:function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0];return{width:e.innerWidth||i.clientWidth||n.clientWidth,height:e.innerHeight||i.clientHeight||n.clientHeight}},resizeWindow:function(e){if(this.isFullscreen()){var t=this.windowSize();l.b.isMobile&&(e.style.height=t.height+"px")}}};return e})}();!function(){"use strict";var u=getDframework();u.define("imgtech.media.module.Moveable",function(){function e(e,t,i){if(t){this.repmod=e;this.mineElement=t;this.attr=i||{};this.changeListener=null;this.total=0;this.min=0;this.max=0;this.value=0;this.fixed=!1;var n=this;this.self_mousemove=function(e){return n.mousemove(e)};this.self_mouseup=function(e){return n.mouseup(e)};this.self_touchmove=function(e){return n.touchmove(e)};this.self_touchend=function(e){return n.touchend(e)};u.on(t,"mousedown",function(e){return n.mousedown(e)});u.on(t,"touchstart",function(e){return n.touchstart(e)})}}e.prototype={constructor:e,clean:function(){this.total=0;this.min=0;this.max=0;this.value=0},setOuterElement:function(e){this.outer=e},setChangeListener:function(e){this.changeListener=e},setFixed:function(e){var t=this.mineElement;(this.fixed=e)?t&&(t.style.cursor="default"):t&&(t.style.cursor="pointer")},setTotal:function(e){this.total=e},setMin:function(e){this.min=e},setMax:function(e){this.max=e},setValue:function(e){if(e!==undefined&&!1!==e){var t=this.mineElement,i=this.total,n=this.outer,r=n?u.getBoundingClientRect(n):null,s=r?r.width():0;e>this.max?e=this.max:e<this.min&&(e=this.min);if(s&&i){var a=s*e/i;t.style.left=Math.floor(a)+"px"}this.value=e}},draw:function(){if(this.value!==undefined){var e=this;setTimeout(function(){e.setValue(e.value)},1)}},drawing:function(e,t){var i=this.mineElement,n=this.outer,r=n?u.getBoundingClientRect(n):null,s=r?r.width():0;if(i&&s){var a=t.x-r.left;s<a?a=s:a<0&&(a=0);var o=a/s*this.total,l=this.changeListener?this.changeListener({type:e,event:t,value:o}):undefined;this.setValue(l)}},mousedown:function(e){if(!this.fixed){this.isMouseDown=e;if(this.changeListener){var t={x:e.clientX,y:e.clientY};u.on(document.body,"mousemove",this.self_mousemove);u.on(document.body,"mouseup",this.self_mouseup);this.changeListener({type:"down",event:t});return u.igEventAll(e)}}},mouseup:function(e){if(!this.fixed&&this.isMouseDown){var t={x:e.clientX,y:e.clientY};this.isMouseDown=!1;if(this.changeListener){u.off(document.body,"mousemove",this.self_mousemove);u.off(document.body,"mouseup",this.self_mouseup);this.drawing("up",t)}return u.igEventAll(e)}},mousemove:function(e){if(!this.fixed&&this.isMouseDown&&this.changeListener){var t={x:e.clientX,y:e.clientY};this.drawing("move",t);return u.igEventAll(e)}},touchstart:function(e){if(!this.fixed){this.isTouchStart=e;if(this.changeListener){var t=e.changedTouches,i=t&&t.length&&t[0],n=i?{x:i.pageX,y:i.pageY}:null,r=this.mineElement;u.on(r,"touchend",this.self_touchend);u.on(r,"touchmove",this.self_touchmove);this.changeListener({type:"touchstart",event:n});return u.igEventAll(e)}}},touchend:function(e){if(!this.fixed&&this.isTouchStart){this.isTouchStart=!1;if(this.changeListener){var t=e.changedTouches,i=t&&t.length&&t[0],n=i?{x:i.pageX,y:i.pageY}:null,r=this.mineElement;u.off(r,"touchend",this.self_touchend);u.off(r,"touchmove",this.self_touchmove);n&&this.drawing("touchend",n)}return u.igEventAll(e)}},touchmove:function(e){if(!this.fixed&&this.isTouchStart&&this.changeListener){var t=e.changedTouches,i=t&&t.length&&t[0],n=i?{x:i.pageX,y:i.pageY}:null;n&&this.drawing("touchmove",n);return u.igEventAll(e)}},init:function(){var e=this.mineElement;u.off(document.body,"mousemove",this.self_mousemove);u.off(document.body,"mouseup",this.self_mouseup);u.off(e,"touchend",this.self_touchend);u.off(e,"touchmove",this.self_touchmove);this.total=0;this.min=0;this.max=0;this.value=0;this.fixed=!1}};return e})}();!function(){"use strict";var n=getDframework();n.define("imgtech.media.module.Matrix",function(){function r(e,t){var i;if(e instanceof r){this.fromType=t;this.value=[];for(i=0;i<e.value.length;i++)this.value[i]=e.value[i]}else if(n.isArray(e)){this.fromType=t;this.value=[];for(i=0;i<e.length;i++)this.value[i]=e[i]}else if("number"==typeof e){this.fromType=undefined;t||(t=0);this.value=r.create(e,t)}else{this.fromType=undefined;this.value=r.create()}Object.defineProperty(this,"x",{configurable:!0,enumerable:!0,get:function(){return this.value[r.X]}});Object.defineProperty(this,"y",{configurable:!0,enumerable:!0,get:function(){return this.value[r.Y]}})}r.X=6;r.Y=7;r.create=function(e,t){return[1,0,0,0,1,0,e||0===e?e:0,t||0===t?t:0,1]};r.multiply=function(e,t){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],0,t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],0,t[6]*e[0]+t[7]*e[3]+e[6],t[6]*e[1]+t[7]*e[4]+e[7],1]};r.scale=function(e,t,i){i||(i=t);return this.multiply([t,0,0,0,i,0,0,0,1],e)};r.rotate=function(e,t){var i=Math.sin(t),n=Math.cos(t);return r.multiply([n,i,0,-i,n,0,0,0,1],e)};r.translate=function(e,t,i){return r.multiply(e,[1,0,0,0,1,0,t,i,1])};r.prototype={constructor:r,toDegrees:function(e){return 180*e/Math.PI},toRadians:function(e){return e*Math.PI/180},multiply:function(e){return new r(r.multiply(this.value,e),"multiply")},scale:function(e,t){return new r(r.scale(this.value,e,t),"scale")},rotate:function(e){return new r(r.rotate(this.value,e),"rotate")},translate:function(e,t){return new r(r.translate(this.value,e,t),"translate")}};function e(){}e.mat2d=r;e.prototype={constructor:e};return e})}();!function(){"use strict";var r=getDframework();r.module("imgtech.media.Media");r.define("imgtech.media.extends.Confirm",function(){function e(e){this.callback=null;this.element=null;if(e){var t=this;this.player=e.player;this.html="string"==typeof e.html&&e.html?e.html:"<div class='mpv-confirm-layer'>\n    <div class='mpv-confirm-cell'>\n        <div class='mpv-confirm-box'>\n            <div class='mpv-confirm-text'>\n            </div>\n            <div class='mpv-confirm-bottom'>\n                <div class='button cancel'>Cancel</div>\n                <div class='button ok'>OK</div>\n            </div>\n        </div>\n    </div>\n</div>\n";this.callback=e.callback?e.callback:null;this.element=r.element(this.html);if(!r.isElement(this.element))throw new Error("Not create element.");if(!this.player)throw new TypeError("Not found player for extends confirm module !!!");if(!(this.cancelBtn=r.query(this.element,".cancel")))throw new Error("Not found cancel button.");if(!(this.okBtn=r.query(this.element,".ok")))throw new Error("Not found ok button.");if(!(this.textElement=r.query(this.element,".mpv-confirm-text")))throw new Error("Not found ok button.");r.on(this.element,"click",function(e){return r.igEventAll(e)});r.on(this.element,"dblclick",function(e){return r.igEventAll(e)});r.on(this.cancelBtn,"click",function(e){t.callback&&t.callback(!1);t.hide()});r.on(this.okBtn,"click",function(e){t.callback&&t.callback(!0);t.hide()})}}e.prototype={constructor:e,getHTML:function(){return this.html},show:function(e,t,i){if(arguments.length<3){i=t;t=!1}var n=this.player.controller.resourceElement;e&&(t?this.textElement.innerHTML=e:this.textElement.innerText=e);i&&(this.callback=i);r.append(n,this.element)},hide:function(){r.remove(this.element);this.textElement.innerText=""}};return e})}();!function(e){"use strict";var d=window.getDframework();d.define("imgtech.media.Media",function(){function l(){}l.prototype={constructor:l};l.version=(l.majorVersion=2)+"."+(l.minorVersion=3)+"."+(l.updateVersion=21)+"."+(l.uniqueVersion=299);l.filename="mediaplayer.min.js";l.NAMESPACE="mediaplayer";l.D_INSTALLED=!1;l.D_SYNC_INTERVAL=null;l.S_VOLUME="ZONEMEDIA_VOL";l.S_MUTED="ZONEMEDIA_MUTE";l.DEFAULT_VOLUME=50;l.MIN_VOLUME=5;l.D_READIED=!1;l.D_MEDIA_GUID_PREFIX=(l.D_MEDIA_GUID_NM="ZONEMEDIA_GUID")+"_";l.D_MEDIA_GUID_ATTR=l.D_MEDIA_GUID_NM;l.D_DEFAULT_CONTROLLER="imgtech.media.Controller";l.D_VIDEO_CONTROLLER="imgtech.media.VideoController";l.D_MEDIA_LIST=[];l.EVENT={STATE_CHANGE:1,RATE_CHANGE:2,QUALITY_CHANGE:3,DURATION_CHANGE:4,CURRENT_TIME_CHANGE:5,WATCH_TIME_CHANGE:6,BUFFERING_CHANGE:7,VOLUME_CHANGE:8,SIZE_CHANGE:9,RESIZE_WINDOW:10,FULLSCREEN_CHANGE:11,VIDEO_SIZE_DATA:12,RESET:13,ON_SYNC:101,ON_READY:102,ON_BEFORE_PLAY:103,ON_BEFORE_DEVICE_PLAY:104,ON_BEFORE_ONCE_PLAY:105,ON_AFTER_DEVICE_PLAY:106,ON_AFTER_ONCE_PLAY:107,PLAY_MEDIA:108,PAUSE_MEDIA:109,STOP_MEDIA:110,PREVIOUS_MEDIA:111,NEXT_MEDIA:112,CURRENT_MEDIA:113,MUTE_MEDIA:114,SET_VOLUME:115,SEEKTO_MEDIA:116,SET_PLAYBACK_RATE:117,SET_PLAYBACK_QUALITY:118,SET_PLAYBACK_SUBTITLE:119,SET_SIZE:120,SET_RATE:121,SET_FULLSCREEN:122,EXIT_FULLSCREEN:123,CAN_PLAY:124,WAITTING:125,INDEX_MEDIA:126,SHOW_MESSAGE:127,CLEAN_MESSAGE:128,CONTINUE_TIME:129,SELECT_SOURCE:130,SELECTING_SOURCE:131,SELECTED_SOURCE:132,ON_ERROR:133,WIDE_CHANGE:134,SET_DISABLED:201,SHOW_QUALITY_LIST:202,SHOW_SUBTITLE_LIST:203,SUBTITLE_EVENT:204,CLICK_EVENT:205,CONTROL_EVENT:206,HIDE_LAYER:207};l.STATE={UNSTARTED:-1,SETSOURCE:1,CUED:2,PLAYING:3,BUFFERING:4,PAUSED:5,ENDED:6,NONE:7};l.getTypeName=function(e){var t=l.EVENT;switch(e){case t.STATE_CHANGE:return"STATE_CHANGE";case t.RATE_CHANGE:return"RATE_CHANGE";case t.QUALITY_CHANGE:return"QUALITY_CHANGE";case t.DURATION_CHANGE:return"DURATION_CHANGE";case t.CURRENT_TIME_CHANGE:return"CURRENT_TIME_CHANGE";case t.WATCH_TIME_CHANGE:return"WATCH_TIME_CHANGE";case t.BUFFERING_CHANGE:return"BUFFERING_CHANGE";case t.VOLUME_CHANGE:return"VOLUME_CHANGE";case t.SIZE_CHANGE:return"SIZE_CHANGE";case t.RESIZE_WINDOW:return"RESIZE_WINDOW";case t.FULLSCREEN_CHANGE:return"FULLSCREEN_CHANGE";case t.VIDEO_SIZE_DATA:return"VIDEO_SIZE_DATA";case t.RESET:return"RESET";case t.ON_SYNC:return"ON_SYNC";case t.ON_READY:return"ON_READY";case t.ON_BEFORE_PLAY:return"ON_BEFORE_PLAY";case t.ON_BEFORE_DEVICE_PLAY:return"ON_BEFORE_DEVICE_PLAY";case t.ON_BEFORE_ONCE_PLAY:return"ON_BEFORE_ONCE_PLAY";case t.ON_AFTER_DEVICE_PLAY:return"ON_AFTER_DEVICE_PLAY";case t.ON_AFTER_ONCE_PLAY:return"ON_AFTER_ONCE_PLAY";case t.PLAY_MEDIA:return"PLAY_MEDIA";case t.PAUSE_MEDIA:return"PAUSE_MEDIA";case t.STOP_MEDIA:return"STOP_MEDIA";case t.PREVIOUS_MEDIA:return"PREVIOUS_MEDIA";case t.NEXT_MEDIA:return"NEXT_MEDIA";case t.CURRENT_MEDIA:return"CURRENT_MEDIA";case t.MUTE_MEDIA:return"MUTE_MEDIA";case t.SET_VOLUME:return"SET_VOLUME";case t.SEEKTO_MEDIA:return"SEEKTO_MEDIA";case t.SET_PLAYBACK_RATE:return"SET_PLAYBACK_RATE";case t.SET_PLAYBACK_QUALITY:return"SET_PLAYBACK_QUALITY";case t.SET_PLAYBACK_SUBTITLE:return"SET_PLAYBACK_SUBTITLE";case t.SET_SIZE:return"SET_SIZE";case t.SET_RATE:return"SET_RATE";case t.SET_FULLSCREEN:return"SET_FULLSCREEN";case t.EXIT_FULLSCREEN:return"EXIT_FULLSCREEN";case t.CAN_PLAY:return"CAN_PLAY";case t.WAITTING:return"WAITTING";case t.WIDE_CHANGE:return"WIDE_CHANGE";case t.SET_DISABLED:return"SET_DISABLED";case t.SHOW_QUALITY_LIST:return"SHOW_QUALITY_LIST";case t.SHOW_SUBTITLE_LIST:return"SHOW_SUBTITLE_LIST";case t.SUBTITLE_EVENT:return"SUBTITLE_EVENT";case t.CLICK_EVENT:return"CLICK_EVENT";case t.CONTROL_EVENT:return"CONTROL_EVENT";case t.INDEX_MEDIA:return"INDEX_MEDIA";case t.SHOW_MESSAGE:return"SHOW_MESSAGE";case t.CLEAN_MESSAGE:return"CLEAN_MESSAGE";case t.CONTINUE_TIME:return"CONTINUE_TIME";case t.SELECT_SOURCE:return"SELECT_SOURCE";case t.SELECTING_SOURCE:return"SELECTING_SOURCE";case t.SELECTED_SOURCE:return"SELECTED_SOURCE";case t.ON_ERROR:return"ON_ERROR";case t.HIDE_LAYER:return"HIDE_LAYER"}return e},l.getStateName=function(e){var t=l.STATE;switch(e){case t.UNSTARTED:return"\uc2dc\uc791\ub418\uc9c0 \uc54a\uc74c";case t.SETSOURCE:return"\ubbf8\ub514\uc5b4 \uc18c\uc2a4 \uc785\ub825";case t.CUED:return"\uc7ac\uc0dd\uc900\ube44 \uc644\ub8cc\ub428";case t.PLAYING:return"\uc7ac\uc0dd \uc911";case t.PAUSED:return"\uc77c\uc2dc\uc911\uc9c0 \ub428";case t.BUFFERING:return"\ubc84\ud37c\ub9c1 \uc911";case t.ENDED:return"\uc885\ub8cc\ub428";default:return"\uc608\uc678"}};l.secondsToString=function(e){if(!e||window.Infinity&&e===Infinity)return"00:00";var t=Math.floor(e/3600),i=Math.floor(e%3600),n=Math.floor(i/60),r=i%60;r<10&&(r="0"+r);n<10&&(n="0"+n);return t?t+":"+n+":"+r:n+":"+r};l.getDocument=function(e){return e.contentDocument||e.contentWindow.document},l.createPlayerFrame=function(e,t,i,n,r){var s=document.createElement("div");s.setAttribute("src","about:blank");s.setAttribute("id",t);s.setAttribute("playerType",i);s.setAttribute("playerClassName",n);s.setAttribute("frameborder",0);s.style.position="absolute";s.style.width="100%";s.style.height="100%";s.style.margin="0px 0px";s.style.padding="0px 0px";if(e){e.appendChild(s);r&&s.appendChild(r)}return s};l.getSavedVolume=function(){var e=document.cookie.match("(^|;) ?"+l.S_VOLUME+"=([^;]*)(;|$)");return e?parseFloat(e[2]):l.DEFAULT_VOLUME};l.setSavedVolume=function(e){document.cookie=l.S_VOLUME+"="+e};l.getSavedMuted=function(e){var t=document.cookie.match("(^|;) ?"+l.S_MUTED+"=([^;]*)(;|$)");return!(!t||"1"!=t[2])};l.setSavedMuted=function(e){document.cookie=l.S_MUTED+"="+(e?"1":"0")};l.getStyleNumberValue=function(e,t){var i,n=t||"px";switch(typeof e){case"number":case"integer":case"float":case"double":return e+n;case"string":return(i=new RegExp("^([0-9]+)","i").exec(e))?e.substring(i[1].length)?e:i[1]+n:e}};l.AutoHeight=function(e){var t=this.module("layout"),i=this.userElement,n=d.getBoundingClientRect(i).width()*e.height/e.width;if(t&&t.getSeparate()){var r=this.element("bottom"),s=r?r.rect():null;n+=s?s.height():0}i.style.height=n+"px"};l.onDrawPlayer=function(t,i){var e=t?t.attr:null,n=e&&e.controller?e.controller:l.D_DEFAULT_CONTROLLER,r=typeof n,s="string"==r?d.module(n):"function"==r||"object"==r?n:null;t.log(" ## controller - className - "+("string"==r?n:"Function"));var a=s?new s(t):null;if(!(t.controller=a))throw new Error("Not found controller");t.controller.draw(function(){t.log(" ## controller - drawed");try{t.onReady()}catch(e){d.error("onDrawPlayer::",e)}i&&i()})};l.onPlayerSync=function(){var e,t;for(e=0;e<l.D_MEDIA_LIST.length;e++){t=l.D_MEDIA_LIST[e];try{t.onSync()}catch(i){d.error(i)}}};l.onPlayerResizeWindow=function(e){var t,i={type:l.EVENT.RESIZE_WINDOW,data:e,target:e.target};for(t=0;t<l.D_MEDIA_LIST.length;t++)try{l.D_MEDIA_LIST[t].callStateChange(i)}catch(n){d.error(n)}};l.install=function(e){if(!l.D_INSTALLED){l.D_INSTALLED=!0;e||(e={});var t=e.syncTimeout?e.syncTimeout:400;clearInterval(l.D_SYNC_INTERVAL);l.D_SYNC_INTERVAL=setInterval(l.onPlayerSync,t);d.on(window,"resize",function(e){l.onPlayerResizeWindow(e)})}};l.sufixGuid=function(e,t,i){return t&&i?e+"_rtmplive":t&&!i?e+"_rtmpvod":e+"_normal"};l.getRateValue=function(e){switch(typeof e){case"string":case"number":case"integer":case"float":case"double":return{value:e};case"object":if("number"!=typeof e.value)throw new Error("rate value is not number.");return e}},l.parseResource=function(e,t){if(!e)throw new Error("Not found player attributes.");e.namespace||(e.namespace=l.NAMESPACE);if(!e.resource&&!1!==e.resource){if("string"!=typeof e.skin)throw new Error("Not found skin attribute.");var i=e.namespace;t=t||"html";e.resource=t+"://"+i+"/skin/"+e.skin+"/"+e.skin+".html#mediaplayer"}return e.resource};l.getResourceText=function(e,t){l.parseResource(e,"text");d.require(e.resource,function(e){t&&t(null,e)},function(e){t&&t(e,null)})};l.getProgrameableHtml=function(o,e){l.getResourceText(e,function(e,t){if(e)return d.error(e);var i=d.isElement(o)?o:d.query(o);if(i){var n,r,s=t.split("\n"),a='function getHtmlResource() {\n    return ""\n';for(n=0;n<s.length;n++)a+='    + "'+(r=(r=(r=s[n])?r.replace(/\"/gi,"'"):"").replace(/\n|\r/g,""))+'"\n';a+='    + "";\n}';i.style.border="solid 1px green";i.innerText=a;d.log("--- start html text");d.log(a);d.log("--- end html text")}})};l.secondsToTimeString=function(e){function t(e){return e?e<9?"0"+e:e:"00"}var i=e%60,n=Math.floor(e/60),r=Math.floor(n/60);n%=60;var s="";r&&(s+=t(r)+"\uc2dc ");n?s+=t(n)+"\ubd84 ":s&&(s+="00\ubd84 ");return s+=i?t(i)+"\ucd08":"00\ucd08"};!function(){if(d.b.ie&&d.b.ie<9&&window.Element){var n=window.Element.prototype.attachEvent,s=window.Element.prototype.detachEvent;Element.prototype.attachEvent=function(){this.__zonemediaplayer_listener||(this.__zonemediaplayer_listener={});var e=arguments[0],t=arguments[1],i=this.__zonemediaplayer_listener;i[e]||(i[e]=[]);i[e].push(t);n.apply(this,arguments)};Element.prototype.detachEvent=function(){if(this.__zonemediaplayer_listener){var e=this.__zonemediaplayer_listener,t=arguments[0],i=arguments[1],n=e[t];if(n)for(var r=0;r<n.length;r++)if(n[r]===i){n.splice(r,1);break}}s.apply(this,arguments)}}}();l.callElementEvent=function(e,t,i){var n,r=document;if(d.b.ie&&d.b.ie<9){var s=e["on"+t];m=s?/[\s]*(javascript[\s]*:[\s]*|[\s]*)([a-zA-Z0-9\_]+)/i.exec(s):null;if(m){var a=m[2];try{if(!window[a])throw new Error("Not found "+a+" function.");window[a].call(e,i)}catch(h){d.error(h)}}var o=e.__zonemediaplayer_listener,l=o?o["on"+t]:null;if(l)for(var u=0;u<l.length;u++)try{l[u].call(e,i)}catch(h){d.error(h)}}else{if(r.createEvent)(n=r.createEvent("Event")).initEvent(t,!0,!0);else{if(!r.createEventObject)throw new Error("Not found create event function.");n=r.createEventObject()}for(var c in i)c&&i[c]&&("type"==c?n["__"+c]=i[c]:n[c]=i[c]);if(e.dispatchEvent)e.dispatchEvent(n);else{if(!e.fireEvent)throw new Error("Not found dispatch event function.");e.fireEvent("on"+t,n)}}};l.createMediaPlayer=function(e,t,i){if(!t)throw new TypeError("Not found attribute parameter");t.device="imgtech.media.MediaPlayer";return new(d.module("imgtech.media.Player"))(e,t,i)};l.createPlayer=function(e,t,i){return l.createMediaPlayer(e,t,i)};return l});d.ready(function(){setTimeout(function(){var n=d.module("imgtech.media.Media");n.D_READIED=!0;d.log(" ## version: "+n.version);n.D_INSTALLED||n.install();d.async.each(n.D_MEDIA_LIST,function(e,t){try{n.onDrawPlayer(e,t)}catch(i){d.error(i)}},function(){})},1)})}(window);!function(){"use strict";var i=window.getDframework();i.define("imgtech.media.ControllerInterface",function(){function e(){}e.prototype={constructor:e,draw:function(e){throw new Error("draw is abstract method.")},onAddEvent:function(e,t){throw new Error("onAddEvent is abstract method.")},onStateChange:function(e){throw new Error("onStateChange is abstract method.")}};return e});i.define("imgtech.media.ModuleInterface",function(){function e(e,t,i){if(e){this.p=e;this.c=t;this.attr=i}}e.prototype={construct:e,onAddEvent:function(){},onStateChange:function(e){},getElementObject:function(e){return this.c.e?this.c.e[e]:null},getModuleObject:function(e){return this.c.m?this.c.m[e]:null},getElement:function(e){var t;return(t=this.getElementObject(e))?t.element:null},setSelfElementObject:function(e,t){var i;if(!(i=this.getElementObject(e)))return this.p.warn("Not found "+e+" element.",this);t?this[t]=i:this[e]=i},setSelfAddElementObject:function(e,t,i){this.c.addElement(e,t,i);this.setSelfElementObject(e)},_autoUseInnerText:function(e,t){if(e){var i=!!e&&e.getAttribute("useinnertext"),n=typeof t;t||!0===i||"true"==i||(e.innerText="");"string"!=n||!0!==i&&"true"!=i||(e.innerText=t)}}};return e});i.define("imgtech.media.module.Sample",function(){var e=i.module("imgtech.media.ModuleInterface");function t(){e.apply(this,arguments)}i.extendClass(t,e,{onAddEvent:function(){},onStateChange:function(e){}});return t})}();!function(){var h=getDframework();h.define("imgtech.media.EventManager",function(){var c=h.module("imgtech.media.Media");function e(e,t){if(e){this.p=e;this.attr=t;this.stacks=[];this.playing=!1;this.is_destory=!1}}e.prototype={constructor:e,destroy:function(){this.is_destory=!0},push:function(e){if(!this.is_destory){if(!e)return h.error("Not found event data.");if("object"!=typeof e)return h.error("event is not object.");if(!e.type)return h.error("Not found event type.");var t,i,n=this.p,r=this.stacks;switch(e.type){case c.EVENT.CLICK_EVENT:if(h.b.ie&&h.b.ie<9){var s=e.event.srcElement||e.event.target;if(s&&s.dframework_igeventall)return}}try{t=n.device()}catch(u){if(e.type==c.EVENT.ON_SYNC)return;return h.error(u,c.getTypeName(e.type),e)}e.source||(e.source=t?t.currentMediaSource():null);e.device||(e.device=t&&t.deviceInstance?t.deviceInstance():null);e.player=n;var a=1,o=!1;if(h.b.ie&&11==h.b.ie||!h.b.ie){r.push(e);a=r.length;o=!0}if(i=n.isDisableEvent(e)){n.stateLog(e,"start",a,!0);n.stateLog(e,"end",a,!0);n.error(" ## "+i)}else{n.stateLog(e,"start",a);this.callEvent(e);n.stateLog(e,"end",a)}if(o&&0<r.length)for(var l=r.length-1;0<=l;l--)if(r[l]===e){r.splice(l);break}}},callEvent:function(e){function t(e){var t=this.p;if(h.b.ie){var i=e.description?e.description:e.message,n=typeof i;if("string"==n||"number"==n||"boolean"==n)t.error(" ## exception : "+i);else{t.error(" ## exception : ");for(var r in i)t.error(" ## exception: "+r+": "+i[r])}}else t.error(" ## exception: ",e);h.error(e)}var i=this.p,n=i.userElement,r=(this.stacks,c.EVENT),s=c.STATE,a=i.module("app");switch(e.type){case r.STATE_CHANGE:switch(e.data){case s.ENDED:c.callElementEvent(n,"ended",e);break;case s.PLAYING:c.callElementEvent(n,"play",e);break;case s.PAUSED:c.callElementEvent(n,"pause",e)}break;case r.DURATION_CHANGE:case r.CURRENT_TIME_CHANGE:c.callElementEvent(n,"timeupdate",e);break;case r.BUFFERING_CHANGE:c.callElementEvent(n,"progress",e);break;case r.VOLUME_CHANGE:c.callElementEvent(n,"volumechange",e);break;case r.CAN_PLAY:c.callElementEvent(n,"canplay",e);break;case r.WAITTING:e.data?c.callElementEvent(n,"waiting",e):c.callElementEvent(n,"canplay",e)}try{i.controller&&i.controller.onStateChange&&i.controller.onStateChange(e)}catch(o){t.call(this,o)}try{i.attr.event&&i.attr.event.callback&&i.attr.event.callback.apply(i,arguments)}catch(o){t.call(this,o)}a&&a.stateChange&&a.stateChange(e)}};return e})}();!function(){"use strict";var h=getDframework(),t=h.module("imgtech.media.Media");h.define("imgtech.media.SMI",function(){function c(e,t,i){if(e&&t){this.p=e;this.attr=i;this.list=[];this.timer=null;this.currentMS=null;this.index=null;this.parse(t)}}c.parseAttribute=function(e){if("string"!=typeof e)throw new TypeError("input parameter is not string.");for(var t,i,n,r,s,a=e,o={};;){if(!(a=a.trim()))break;if(!(t=/^([\S]+)[\s]*([\=]+)/.exec(a))&&!(t=/^([\S]+)/.exec(a)))break;r=t[1];a=a.substring(t[0].length);if(t[2])if(i=(t=/[\s]*([\'\"]*)/.exec(a))[1])if(-1===(n=(a=a.substring(t[0].length)).indexOf(i))){s=a;a=""}else{s=a.substring(0,n);a=a.substring(n+1)}else if(t=/[\s]*([\S]+)/.exec(a)){s=t[1];a=a.substring(t[0].length)}else{s=!0;a=""}else s=!0;o[r.toLowerCase()]=s}return o};c.prototype={constructor:c,parse:function(e){var t=e.split(/<sync /gi);if(t.length<2)throw new Error("Not found sync node");var i,n,r,s=t[0].split("\n").length-1,a=t[t.length-1],o=[];if((n=/(<\/body)/i.exec(a))&&-1!==(i=a.indexOf(n[1]))){t[t.length-1]=a.substring(0,i);a=a.substring(i)}for(var l=1;l<t.length;l++)if(-1!==(i=(r=t[l]).indexOf(">"))){var u={start:0,className:null,attr:c.parseAttribute(r.substring(0,i)),contents:r.substring(i+1)};if(u.attr&&u.attr.start){u.start=parseInt(u.attr.start);u.className=u.attr.className?u.attr.className:null;o.push(u)}else h.error("SMI parse error:: Not found start attribute. lineno: "+s+"\n    "+r)}else h.error("SMI parse error:: Not found '>'. lineno: "+s+"\n    "+r);if(!o.length)throw new Error("Not found sync element after parse !!!");this.list=o},data:function(){return null!==this.index?this.list[this.index]:null},search:function(t){var i=this.list.length;if(i){return function e(t,i,n){var r=i+Math.floor((n-i)/2),s=this.list[r];if(t<s.start){if(r!==n)return e.call(this,t,i,r)}else if(t>s.start&&r!==i)return e.call(this,t,r,n);return r}.call(this,t,0,i)}return null},stop:function(){if(this.timer){var e=this.attr;clearInterval(this.timer);this.timer=null;this.p.log(" ## SMI (stop) : "+(e&&e.source))}this.isPlaying=!1},play:function(){if(!this.isPlaying){var e=this,t=this.attr;this.stop();this.isPlaying=!0;this.p.log(" ## SMI (play) : "+(t&&t.source));this.timer=setInterval(function(){e.running(!1)},10)}},sendHide:function(){if(!this.isHide){this.isHide=!0;this.p.callStateChange({type:t.EVENT.SUBTITLE_EVENT,data:"hide",subtitle:this})}},sendShow:function(e){this.isHide=!1;this.p.callStateChange({type:t.EVENT.SUBTITLE_EVENT,data:"show",subtitle:this,subdata:e})},running:function(e){var t=this.p;if(e||t.isPlaying()){var i,n,r=Math.floor(1e3*t.currentTime(!0));if(!(this.currentMS=r))return this.sendHide();if(null===(n=this.search(r)))return this.sendHide();if(!((i=this.list[n]).start>r))if(n!==this.index){this.index=n;i.start<=r&&this.sendShow(i)}else e&&this.sendShow(i)}}};return c})}();!function(){"use strict";var u=getDframework(),s=u.module("imgtech.media.Media");u.define("imgtech.media.SRTParser",function(){function e(){}var l=e.status={INIT:0,NUMBER:1,STRING:2,APPEND:3,END:4},a=e.error={ZERO:0,NOT_INIT:1,ORDER_TIME:2,NOT_APPEND:3};e.prototype={constructor:e,type:"SRT",stringToNumber:function(e,t){var i;if(!(i=/^[\s]*([0-9]+)[\s]*$/.exec(e)))throw new Error("Wrong subtitle format ("+this.type+"). line: "+t+"\n    "+e);return parseInt(i[1])},repaireNumber:function(e,t){if(e.status===l.STRING){e.status=l.APPEND;e.contents.push(t.value)}else{if(e.status!==l.INIT)return a.NOT_INIT;e.status=l.NUMBER;e.number=t.value}return a.ZERO},repaireTime:function(e,t){if(e.status!==l.NUMBER&&e.status!==l.INIT)return a.ORDER_TIME;e.status=l.STRING;e.start=t.start;e.end=t.end;return a.ZERO},repaireString:function(e,t){if(e.status===l.STRING||e.status===l.APPEND){e.status=l.APPEND;e.contents.push(t.value)}return a.ZERO},repaireEnd:function(e,t){if(e.status===l.INIT);else{if(e.status!==l.APPEND)return a.NOT_APPEND;e.status=l.END}return a.ZERO},parseTime:function(e,t){var i;if(!(i=/^[\s]*([0-9\s\:]+)[\,\.]+[\s]*([0-9]+)[\s]*$/i.exec(e)))throw new Error("Wrong subtitle format ("+this.type+"). line: "+t+"\n    "+e);var n={seconds:0,micro:0,_hour:0,_min:0,_sec:0,_msec:parseInt(i[2])},r=i[1].split(":");if(!r.length||3<r.length)throw new Error("Wrong subtitle format ("+this.type+"). line: "+t+"\n    "+e);0<r.length&&(n._sec=this.stringToNumber(r[r.length-1],t));1<r.length&&(n._min=this.stringToNumber(r[r.length-2],t));2<r.length&&(n._hour=this.stringToNumber(r[r.length-3],t));n.seconds=3600*n._hour+60*n._min+n._sec;n.micro=1e3*n.seconds+n._msec;return n},execNumber:function(e,t){var i;return(i=/^[\s]*([0-9]+)[\s]*$/i.exec(e))?{type:"number",value:parseInt(i[1])}:null},execTime:function(e,t){var i;if(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)/.exec(e)){var n=i[1],r=(i[2],i[3]);return{type:"time",start:this.parseTime(n,t),end:this.parseTime(r,t)}}return null},execString:function(e,t){return e?{type:"string",value:e}:null},execEnd:function(e,t){return{type:"end"}},parseType:function(e,t){var i,n=e?e.trim():"";return(i=this.execTime(n,t))?i:(i=this.execNumber(n,t))?i:(i=this.execString(n,t))?i:this.execEnd(n,t)},parseLine:function(e,t,i,n,r){var s=0;switch(i.type){case"number":s=this.repaireNumber(t,i);break;case"time":s=this.repaireTime(t,i);break;case"string":s=this.repaireString(t,i);break;case"end":(s=this.repaireEnd(t,i))===a.ZERO&&t.status==l.END&&e.push(t);t={status:l.INIT,contents:[]}}if(s){u.error("Subtitle content parse("+this.type+") error("+s+"). line: "+r+"\n    "+n);t={status:l.INIT,contents:[]}}return t},parse:function(e){var t,i,n,r,s=e.split("\n"),a=[],o={status:l.INIT,contents:[]};for(t=0;t<s.length;t++){n=s[t];i=this.parseType(n,t+1);r=o;if(!(o=this.parseLine(a,o,i,n,t+1))){u.warn("parse ("+this.type+") ignore: ",r);o={status:l.INIT,contents:[]}}}a.length&&a[a.length-1]!==o&&o.status!==l.INIT&&a.push(o);return a}};return e});u.define("imgtech.media.SRT",function(){function e(e,t,i){if(e&&t){this.p=e;this.attr=i;this.list=[];this.timer=null;this.currentMS=null;this.index=null;this.indexData=null;this.parse(t)}}e.prototype={constructor:e,type:"SRT",parse:function(e){var t=new(u.module("imgtech.media.SRTParser"));this.list=t.parse(e)},data:function(){return null!==this.index?this.list[this.index]:null},search:function(t){var i=this.list.length;if(i){return function e(t,i,n){var r=i+Math.floor((n-i)/2),s=this.list[r];if(t<s.start.micro){if(r!==n)return e.call(this,t,i,r)}else if(t>s.start.micro&&r!==i)return e.call(this,t,r,n);return r}.call(this,t,0,i)}return null},stop:function(){if(this.timer){var e=this.attr;this.p.log(" ## stop Subtitle : "+e&&e.source);clearInterval(this.timer);this.timer=null;this.p.log(" ## "+this.type+"(stop)")}this.isPlaying=!1},play:function(){if(!this.isPlaying){var e=this;this.stop();this.isPlaying=!0;this.p.log(" ## "+this.type+"(play)");this.timer=setInterval(function(){e.running()},10)}},running:function(){function e(){if(!this.isHide){this.isHide=!0;this.p.callStateChange({type:s.EVENT.SUBTITLE_EVENT,data:"hide",subtitle:this})}}var t=this.p;if(t.isPlaying()){var i,n=Math.floor(1e3*t.currentTime(!0)),r=this.indexData;if(!(this.currentMS=n))return e.call(this);if(!(r&&r.start.micro<=n&&r.end.micro>n)){if(!(i=this.search(n)))return e.call(this);if(i!==this.index){r=this.list[i];this.index=i;return(this.indexData=r).end.micro<=n||n<r.start.micro?e.call(this):function(e){this.isHide=!1;this.p.callStateChange({type:s.EVENT.SUBTITLE_EVENT,data:"show",subtitle:this,subdata:e})}.call(this,r)}if(r.end.micro<=n)return e.call(this);this.index=null;this.indexData=null}}}};return e})}();!function(){"use strict";var r=getDframework(),n=(r.module("imgtech.media.Media"),r.module("imgtech.media.SRT"));r.define("imgtech.media.SimpleVTTParser",function(){var e=r.module("imgtech.media.SRTParser");function s(){e.apply(this,arguments);this.style=[]}var t=e.status,a={NOTE:100,STYLE:101},i=e.error;for(var n in t)n&&(a[n]=t[n]);r.extendClass(s,e,{type:"SimpleVTT",execTime:function(e,t){var i;(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)$/.exec(e))||(i=/^[\s]*([0-9\:\,\.\s]+)[\s]*([\-]*\>)[\s]*([0-9\:\,\.\s]+)[\s]+([\s\S]+)$/.exec(e));if(i){var n=i[1],r=(i[2],i[3]),s=4<i.length?i[4]:null;return{type:"time",start:this.parseTime(n,t),end:this.parseTime(r,t),css:s}}return null},execNumber:function(e){var t;(t=/^[\s]*([0-9]+)[\s]*$/i.exec(e))||(t=/^[\s]*([0-9]+)[\s]+([\s\S]+)$/i.exec(e));return t?{type:"number",value:parseInt(t[1]),text:2<t.length?t[2]:null}:null},execString:function(e,t){if(!e)return null;var i=e.toLowerCase();return 0===i.indexOf("note")?{type:"note",value:e.substring(4).trim()}:0===i.indexOf("style")?{type:"style",value:e.substring(5).trim()}:{type:"string",value:e}},repaireNote:function(e,t){e.oldstatus=e.status;e.status=a.NOTE;e.note=[];e.note.push(t.value)},repaireStyle:function(e,t){e.status=a.STYLE;e.style=[];t.value&&e.style.push(t.value)},repaireString:function(e,t){switch(e.status){case a.NOTE:e.note.push(t.value);return i.ZERO;case a.STYLE:t.value&&e.style.push(t.value);return i.ZERO}return s.__super.repaireString.apply(this,arguments)},parseLine:function(e,t,i,n,r){switch(i.type){case"note":this.repaireNote(t,i);return t;case"style":this.repaireStyle(t,i);return t;case"end":if(t.status==a.NOTE){delete t.contents;return null}if(t.status==a.STYLE){delete t.contents;this.style.push(t);return null}}return s.__super.parseLine.apply(this,arguments)}});return s});r.define("imgtech.media.SimpleVTT",function(){function e(e,t,i){n.apply(this,arguments)}r.extendClass(e,n,{type:"SimpleVTT",parse:function(e){var t=new(r.module("imgtech.media.SimpleVTTParser"));this.list=t.parse(e)}});return e})}();!function(){"use strict";var t=getDframework();t.module("imgtech.media.Media");t.define("imgtech.media.MozillaVTT",function(){function e(e,t,i){if(e&&t){this.parser=null;this.cues=[];this.regions=[];this.parse(t)}}e.prototype={constructor:e,oncue:function(e){this.cues.push(e)},onregion:function(e){this.regions.push(e)},onparsingerror:function(e){t.error(e)},parse:function(e){var t=this;this.parser=new WebVTT.Parser(window,WebVTT.StringDecoder());this.parser.oncue=function(e){t.oncue(e)};this.parser.onregion=function(e){t.onregion(e)};this.parser.onparsingerror=function(e){t.onparsingerror(e)};this.parser.parse(e);this.parser.flush();WebVTT.convertCueToDOMTree(window,this.cues[0].text),WebVTT.processCues(window,this.cues,document.getElementById("overlay"))},stop:function(){},play:function(){}};return e})}();!function(){"use strict";var o=getDframework(),l=o.module("imgtech.media.Media");o.define("imgtech.media.Subtitle",function(){function s(e,t,i){if(t&&i){this.source=e;this.p=t;this.list=[];this.selected=null;this.index=0;this.parse(i)}}s.sourceType=function(e){var t,i=-1!==(t=e.lastIndexOf("?"))?e.substring(0,t).trim():e.trim(),n=i&&-1!==(t=i.lastIndexOf("."))?i.substring(t+1).trim().toLowerCase():null;if(!i)throw new TypeError("Not found subtitle source");switch(n){case"smi":case"srt":case"vtt":return n;case"vtml":return null}return null};s.className=function(e){switch(e){case"smi":return"imgtech.media.SMI";case"srt":return"imgtech.media.SRT";case"vtt":return"imgtech.media.SimpleVTT"}return null};s.prototype={constructor:s,parse:function(e){if(!o.isArray(e))throw new Error("subtitle is not array.",e);if(!e.length)throw new Error("subtitle is empty",e);for(var t=0;t<e.length;t++)e[t]&&this.push(e[t]);this.index=null!==this.selected?this.selected:0},push:function(e){var t,i=this.list.length;if(e){if(!1!==e.code&&(!e.code||"string"!=typeof e.code))throw new Error("Not found subtitle or Not string.");if(!1!==e.code&&(!e.src||"string"!=typeof e.src))throw new Error("Not found subtitle src or Not string.");if(e.label&&"string"!=typeof e.label)throw new Error("Subtitle label is not string.");!1!==e.code||e.label||(e.label="None");(t=!(!e.select&&!e.selected))&&(this.selected=i);var n=!1===e.code?null:s.sourceType(e.src),r=!1===e.code?null:e.type?e.type:n;this.list.push({code:e.code,source:e.src,sourceType:n,userType:e.type,type:r,className:s.className(r),parser:e.parser,index:i,selected:t,label:e.label?e.label:e.code})}},setSubtitle:function(e){e||(e=this.index);switch(typeof e){case"number":case"integer":if(!(0<=e&&e<this.list.length))throw new Error("Not setting subtitle : max: "+this.list.length+", want: "+e);this.index=e;break;case"object":var t=!e.index&&0===e.index||0<e.index?e.index:-1;-1<t&&t<this.list.length&&(this.index=t)}this.loadSubtitle()},get:function(e){return 0===e||e?this.list[e]:this.list[this.index]},loadSubtitle:function(e){function t(e){a.p.log(" ## load subtitle source: "+s.source);if(!e)throw new Error("Empty "+s.source);var t;if(s.parser&&"string"!=typeof s.parser)t=s.parser(e);else{var i=s.parser?s.parser:s.className?s.className:"",n=i?o.module(i):null,r=n?new n(a.p,e,s):null;if(!i)throw new Error("Not found subtitle parser className");if(!n)throw new Error("Not found subtitle parser module");if(!r)throw new Error("Not found subtitle parser instance");t=r}t&&(s.instance=t);a.p.log(" ## loaded subtitle instance: "+s.source);a.p.callStateChange({type:l.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:s.instance})}var s=this.get(e),a=this;if(!1===s.code)return this.p.callStateChange({type:l.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:s.instance});if(!s.source)throw new Error("Not load subtitle. because empty subtitle source");if(s.instance)return this.p.callStateChange({type:l.EVENT.SUBTITLE_EVENT,data:"loaded",subtitle:s.instance});var i=this.source.currentSourceInfo();(!i||i&&"d"!=i.ajax)&&o.b.ie&&o.b.ie<9?o.jQuery.ajax({type:"GET",url:s.source,success:function(e){t(e)},error:function(e){o.error("Failed subtitle ajax");o.error("Failed subtitle ajax: "+s.source);o.error(arguments)}}):o.require("text://"+s.source,function(e){t(e)},function(e){o.error("Failed subtitle ajax");o.error("Failed subtitle ajax: "+s.source);o.error(arguments)},{headers:{ContentType:"application/x-www-form-urlencoded; charset=utf-8"}})},stop:function(){var e,t;for(e=0;e<this.list.length;e++)(t=this.list[e])&&t.instance&&t.instance.stop()},play:function(e){var t=this.get(e),i=t&&t.instance;this.stop();i&&i.play()}};return s})}();!function(){"use strict";var a=getDframework();a.define("imgtech.media.SourceInfo",function(){var i=null;function s(e,t){if(e){this.source=e;this.attr=t||{};this.deviceType=null;this.mediaType=null;this.className=null;this.isRTMP=!1;this.parse(e)}}s.getDeviceClassName=function(e){var t=a.b;switch(e){case"video":return"imgtech.media.VideoPlayer";case"hls":return t.safari?"imgtech.media.VideoPlayer":"imgtech.media.HlsPlayer";case"flash":return"imgtech.media.FlashPlayer";case"flash2":return"imgtech.media.FlashPlayer2";case"youtube":return"imgtech.media.Youtube";case"recorder":return"imgtech.recorder.Recorder";default:throw new TypeError("Not found device class name: "+e)}};s.isKnVersion=function(e){if(null!==i)return i;try{new Audio;return i=!1}catch(t){return i=!0}};s.getDeviceType=function(e){var t,i;if("string"!=typeof e)throw new Error("source is not string.");if(!(t=e.trim()))throw new Error("source is empty.");if(!(-1===(i=(t=t.toLowerCase()).lastIndexOf("?"))||(t=t.substring(0,i))&&(t=t.trim())))throw new Error("source is empty.");if("recorder"===t||0===t.indexOf("recorder://"))return{ptype:"recorder",type:"recorder"};var n=-1!==(i=t.lastIndexOf("."))?t.substring(i+1):"";if(0===t.indexOf("http://")||0===t.indexOf("https://")){if(-1!==(i=t.lastIndexOf(".m3u8"))){var r=t.substring(i);if(".m3u8"==r||0===r.indexOf(".m3u8?"))return a.b.isMobile||a.b.isMacosx&&a.b.safari?{ptype:"video",type:"hls"}:a.b.isWindows&&a.b.ie&&(a.b.ie<11||s.isKnVersion(e))?{ptype:"flash",type:"hls"}:window.Hls&&window.Hls.isSupported()?{ptype:"hls",type:"hls"}:{ptype:"flash",type:"hls"}}return a.b.ie&&(a.b.ie<9||s.isKnVersion(e))?{ptype:"flash",type:n}:{ptype:"video",type:n}}if(0===t.indexOf("rtmp://"))return{ptype:"flash",type:"rtmp",isRTMP:!0};if(0===t.indexOf("rtsp://")){if(a.b.android)return{ptype:"video",type:"rtsp"};throw new Error("Not support source type: rtsp")}if(0===t.indexOf("yt://")||0===t.indexOf("youtube://"))return{ptype:"youtube",type:"youtube"};throw new Error("Not support source type: unknown")};s.prototype={constructor:s,parse:function(e){var t=this.attr.playerType,i=s.getDeviceType(e);"flash"===i.ptype&&(this.attr.flashType?i.ptype=this.attr.flashType:i.ptype="flash2");this.mediaType=i.type;this.deviceType=t&&"string"==typeof t?t:i.ptype;this.className=s.getDeviceClassName(this.deviceType);this.isRTMP=!!i.isRTMP;this.isHLS="hls"===i.type}};return s})}();!function(){"use strict";var i=getDframework();i.define("imgtech.media.Quality",function(){var r=i.module("imgtech.media.SourceInfo");function e(e,t){if(e&&t){this.p=e;this.list=[];this.selected=null;this.currentIndex=this.index=0;this.parse(t)}}e.prototype={constructor:e,parse:function(e){if(!i.isArray(e))throw new Error("quality is not array.",e);if(!e.length)throw new Error("quality is empty",e);for(var t=0;t<e.length;t++)e[t]&&this.push(e[t]);this.index=null!==this.selected?this.selected:0},push:function(e){var t,i=this.list.length;if(e){if(!e.code||"string"!=typeof e.code)throw new Error("Not found quality code or Not string.");if(!e.src||"string"!=typeof e.src)throw new Error("Not found quality src or Not string.");if(e.label&&"string"!=typeof e.label)throw new Error("Quality label is not string.");(t=!(!e.select&&!e.selected))&&(this.selected=i);var n=new r(e.src,this.p.attr);this.list.push({code:e.code,sourceInfo:n,source:n.source,index:i,selected:t,label:e.label?e.label:e.code,isLive:!0===e.isLive||!1===e.isLive?e.isLive:null})}},setQuality:function(e){var t,i=this.index;switch(typeof e){case"number":case"integer":if(!(0<=e&&e<this.list.length))throw new Error("Not setting quality : max: "+this.list.length+", want: "+e);t=e;break;case"object":var n=!e.index&&0===e.index||0<e.index?e.index:-1;-1<n&&n<this.list.length&&(t=n)}if(t!==i){this.index=t;this.p.current({data:{currentTime:this.p.currentTime()}})}},current:function(){return this.get(this.currentIndex)},get:function(e){this.currentIndex=0===e||e?e:this.index;return this.list[this.currentIndex]},sourceInfo:function(e){return this.get(e).sourceInfo},source:function(e){return this.sourceInfo(e).source},isRTMP:function(e){return this.sourceInfo(e).isRTMP},isHLS:function(e){return this.sourceInfo(e).isHLS},isLive:function(e){return this.get(e).isLive},className:function(e){return this.sourceInfo(e).className},deviceType:function(e){return this.sourceInfo(e).deviceType}};return e})}();!function(){"use strict";var o=getDframework();o.define("imgtech.media.Source",function(){var r=o.module("imgtech.media.Quality"),s=o.module("imgtech.media.Subtitle"),a=o.module("imgtech.media.SourceInfo");function e(e,t){if(e){this.p=t;this.input=e;this.sourceInfo=null;this.__isLive=!1;this.__isHLS=!1;this.quality=null;this.subtitle=null;this.poster=null;this.switchSource=null;this.parse(e)}}e.prototype={constructor:e,isSwitchSource:function(){return!!this.switchSource},isRTMP:function(e){return this.quality?this.quality.isRTMP(e):!!this.sourceInfo&&this.sourceInfo.isRTMP},isLive:function(e){var t,i;return(i=this.quality)&&null!==(t=i.isLive(e))?t:this.__isLive},isHLS:function(e){return this.quality?this.quality.isHLS(e):!!this.sourceInfo&&this.sourceInfo.isHLS},className:function(e){return this.quality?this.quality.className(e):this.sourceInfo?this.sourceInfo.className:null},source:function(e){return this.quality?this.quality.source(e):this.sourceInfo?this.sourceInfo.source:null},currentSourceInfo:function(){if(this.quality){var e=this.quality.current();return e?e.sourceInfo:null}return this.sourceInfo?this.sourceInfo:null},deviceType:function(e){return this.quality?this.quality.deviceType(e):this.sourceInfo?this.sourceInfo.deviceType:null},parse:function(e){function t(e){this.__isLive="boolean"==typeof e.isLive?e.isLive:"boolean"==typeof this.p.attr.isLive&&this.p.attr.isLive}if(!e)throw new TypeError("Empty source.");var i;if(e.quality){this.quality=new r(this.p,e.quality);e.src&&("string"==typeof e.src?o.warn("Ignore input's src. because use quality. src: "+e.src):o.warn("Ignore input's src. because use quality. src: ",e.src));t.call(this,e)}else{if("string"==typeof e){if(!(i=e.trim()))throw new Error("Empty source.");this.__isLive=this.p.attr.isLive}else{if(e.switchSource){var n=o.module("imgtech.media.SwitchSource");this.switchSource=new n(e,this.p);return}if(!e.src)throw new Error("Not found input's src.");if("string"!=typeof e.src)throw new Error("Input's src is not string.");if(!(i=e.src.trim()))throw new Error("Empty source.");t.call(this,e)}this.sourceInfo=new a(i,this.p.attr)}e.subtitle&&(this.subtitle=new s(this,this.p,e.subtitle));e.poster&&(this.poster=e.poster)},getQualityList:function(){return this.quality?this.quality.list:null},getQuality:function(e){return this.quality?this.quality.get(e):null},setQuality:function(e){this.quality&&this.quality.setQuality(e)},getSubtitleList:function(){return this.subtitle?this.subtitle.list:null},getSubtitle:function(e){if(this.subtitle)return this.subtitle.get(e)},setSubtitle:function(e){if(this.subtitle)return this.subtitle.setSubtitle(e)},stop:function(){if(this.subtitle)return this.subtitle.stop()},play:function(){if(this.subtitle)return this.subtitle.play()},setAutoContinueTime:function(e){this.input.autoContinueTime=e},setErrorContinueTime:function(e,t){this.errorContinueTime=e;this.errorIsPlaying=t}};return e})}();!function(){"use strict";var r=getDframework();r.define("imgtech.media.SwitchSource",function(){function e(e,t){if(e){this.input=e;this.p=t;this.modName=null;this.ss=[];this.selected=-1;this.parse(e)}}e.prototype={constructor:e,selectedSource:function(){if(this.selected<0)throw new Error("Not select switch source");if(this.selected>=this.ss.length)throw new Error("Overflow selected switch source");return this.ss[this.selected]},select:function(e){},isRTMP:function(e){return this.selectedSource().isRTMP(e)},isLive:function(e){return this.selectedSource().isLive(e)},className:function(e){return this.selectedSource().className(e)},source:function(e){return this.selectedSource().source(e)},currentSourceInfo:function(){return this.selectedSource().currentSourceInfo()},deviceType:function(e){return this.selectedSource().deviceType()},parse:function(e){var t,i,n=r.module("imgtech.media.Source");this.modName=e.switchModule?e.switchModule:"imgtech.media.module.SwitchSource";if("string"!=typeof this.modName)throw new Error("switch module name is empty !!!");if(!r.module(this.modName))throw new Error("Not found switch module. module: "+this.modName);if(!e.switchSource)throw new TypeError("Not found switchSource !!!",e);if(!r.isArray(e.switchSource))throw new TypeError("switchSource is array !!!",e);if(!e.switchSource.length)throw new TypeError("switchSource is empty !!!",e);for(t=0;t<e.switchSource.length;t++){if("object"!=typeof(i=e.switchSource[t]))throw new TypeError("switchSource element is not object !!!",e);if("string"!=typeof i.name||!i.name)throw new TypeError("switchSource element name is not string or empty name!!!",e);if("string"!=typeof i.src||!i.src)throw new TypeError("switchSource element src is not string or empty src!!!",e);this.ss.push(new n(i,this.p))}if(!this.ss.length)throw new TypeError("switchSource is empty !!!",e)},getQualityList:function(){return this.selectedSource().getQualityList()},getQuality:function(e){return this.selectedSource().getQuality(e)},setQuality:function(e){return this.selectedSource().setQuality(e)},getSubtitleList:function(){return this.selectedSource().getSubtitleList()},getSubtitle:function(e){return this.selectedSource().getSubtitle(e)},setSubtitle:function(e){return this.selectedSource().setSubtitle(e)},stop:function(){return this.selectedSource().stop()},play:function(){return this.selectedSource().play()}};return e})}();!function(){"use strict";var E=getDframework();E.define("imgtech.media.Player",function(){var v=E.module("imgtech.media.Media"),y=(E.module("imgtech.media.SourceInfo"),E.module("imgtech.media.Source")),r=E.module("imgtech.media.EventManager");function t(e,t){var i="object"==typeof e,n=i?e:{};n.type=t;!i&&e&&(n.data=e);this.callStateChange(n)}function s(e,t){function i(e,t,i){try{t instanceof y?e.push(t):e.push(new y(t,i))}catch(n){E.error(n)}}var n,r=[];if(E.isArray(t))for(n=0;n<t.length;n++)t[n]&&i(r,t[n],e);else t&&i(r,t,e);return r}function e(e,t,i){if(e||t){t||(t={});t.debug||(t.debug={});v.D_INSTALLED||v.install();v.D_MEDIA_LIST.push(this);this.b=E.b;this.isMobile=E.b.isMobile;this.attr=t;this.flag=i;this.uuid=E.guid("");this.guid=v.D_MEDIA_GUID_PREFIX+this.uuid;(window[this.guid]=this).skin=t.skin;if(!E.isElement(this.userElement=E.isElement(e)?e:E.query(e)))throw new TypeError("Not found element from qid : "+e);this.userElement.zonemediaplayer=this;E.addClass(this.userElement,"skin-"+this.skin+"-user");t.disableUi&&E.ui.hide(this.userElement);if("string"!=typeof t.device)throw new TypeError("Not found device className");this.patchModule("device",{className:t.device,modType:"device"});this.controller=null;this.playlistIndex=-1;this.src=s(this,t.src);this.hasAttributeSource=this.src.length;this.debug=t.debug;this.sizeIndex=0;this.width=E.isArray(t.width)?t.width:t.width?[t.width]:["100%"];this.height=E.isArray(t.height)?t.height:t.height?[t.height]:["100%"];if(this.width.length!=this.height.length)throw new Error("Not equals width and height array length");this.__old_size_change_width=-1;this.__old_size_change_height=-1;this.eventManager=new r(this,this.attr);this.EVENT=v.EVENT;this.STATE=v.STATE;n=this,v.D_READIED&&setTimeout(function(){v.onDrawPlayer(n)},1)}var n}e.prototype={constructor:e,currentMediaSource:function(){var e=this.device();return e?e.currentMediaSource():null},getPlayerType:function(){var e=this.device();return e?e.getPlayerType():null},element:function(e){var t=this.controller,i=t?t.e:null,n=i?i[e]:null;if(!e)return i;if(!t)throw new Error("Not found control");if(!i)throw new Error("Not found control element");if(!n)throw new Error("Not found "+e+" element");return n},module:function(e){var t=this.controller,i=t?t.m:null,n=i?i[e]:null;if(!e)return i;if(!t)throw new Error("Not found control");if(!i)throw new Error("Not found control module");if(!n)throw new Error("Not found "+e+" module");return n},device:function(){return this.module("device")},sizeModule:function(){return this.module("size")},rect:function(){return E.getBoundingClientRect(this.userElement)},isInnerRect:function(e){var t=this.rect();return t.left>=e.x&&e.x<=t.right&&t.top<=e.y&&t.bottom>=e.y},sendSizeChange:function(e){var t=this,i=this.rect(),n=i&&i.width(),r=i&&i.height();if(n||r){var s=!1;n&&this.__old_size_change_width!=n&&(s=!0);r&&this.__old_size_change_height!=r&&(s=!0);if(s){this.__old_size_change_width=n;this.__old_size_change_height=r;this.callStateChange({type:v.EVENT.SIZE_CHANGE,data:{width:n,height:r,index:-1}})}}else e||setTimeout(function(){t.sendSizeChange(!0)},1)},getSwitchSourceData:function(){var e=this.device();return e&&e.getSwitchSourceData?e.getSwitchSourceData():null},getPlayerState:function(){var e=this.device();return e&&e.getPlayerState?e.getPlayerState():v.STATE.UNSTARTED},isPlaying:function(){return this.getPlayerState()===v.STATE.PLAYING},play:function(e){this.callStateChange({type:v.EVENT.PLAY_MEDIA,data:e})},pause:function(e){this.callStateChange({type:v.EVENT.PAUSE_MEDIA,data:e})},toggle:function(e){var t=this.isPlaying();return!0===t?this.pause(e):!1===t?this.play(e):void 0},stop:function(e){t.call(this,e,v.EVENT.STOP_MEDIA)},previous:function(e){t.call(this,e,v.EVENT.PREVIOUS_MEDIA)},next:function(e){t.call(this,e,v.EVENT.NEXT_MEDIA)},current:function(e){t.call(this,e,v.EVENT.CURRENT_MEDIA)},index:function(e){if(!this.src||!this.src.length)throw new Error("Not found source.");if(e>=this.src.length)throw new Error("Not play index. source-size: "+this.src.length+", index: "+e);this.callStateChange({type:v.EVENT.INDEX_MEDIA,data:e})},getVolume:function(){var e=this.device();return e&&e.getVolume?e.getVolume():0},setVolume:function(e){e<v.MIN_VOLUME&&(e=v.MIN_VOLUME);100<e&&(e=100);if((e=Math.floor(e))<=v.MIN_VOLUME)return this.mute();this.isMuted()&&this.unMute();v.setSavedVolume(e);this.callStateChange({type:v.EVENT.SET_VOLUME,data:e})},mute:function(){v.setSavedMuted(!0);this.callStateChange({type:v.EVENT.MUTE_MEDIA,data:!0})},unMute:function(){v.setSavedMuted(!1);this.callStateChange({type:v.EVENT.MUTE_MEDIA,data:!1})},isMuted:function(){var e=this.device();return e&&e.isMuted?e.isMuted():null},toggleMute:function(){return this.isMuted()?this.unMute():this.mute()},duration:function(e){var t=this.device();return t&&t.duration?t.duration(e):0},currentTime:function(e){var t=this.device();return t&&t.currentTime?t.currentTime(e):0},getBuffering:function(){var e=this.device();return e&&e.getBuffering?e.getBuffering():0},watchTime:function(){var e=this.device();return e&&e.watchTime?e.watchTime():0},seekTo:function(e,t){var i=this.duration();(!e||e<0)&&(e=0);i&&i<e&&(e=i);this.callStateChange({type:v.EVENT.SEEKTO_MEDIA,data:{value:e,seconds:t}})},getDefaultPlaybackRate:function(){var e=this.device();return e&&e.getDefaultPlaybackRate?e.getDefaultPlaybackRate():null},getSafePlaybackRate:function(e){var t,i,n=v.getRateValue(e),r=this.getAvailablePlaybackRates();for(t=0;t<r.length;t++)r[t].value==n.value&&(i=r[t]);if(!i)throw new Error("Not found available playback rate. value: "+n.value);return i},getPlaybackRate:function(){var e=this.device();return e&&e.getPlaybackRate?e.getPlaybackRate():null},setPlaybackRate:function(e){this.callStateChange({type:v.EVENT.SET_PLAYBACK_RATE,data:this.getSafePlaybackRate(e)})},getAvailablePlaybackRates:function(){var e=this.device();return e&&e.getAvailablePlaybackRates?e.getAvailablePlaybackRates():null},resetRate:function(){var e=this.getAvailablePlaybackRates();if(e&&e.length)for(var t=0;t<e.length;t++){var i=e[t];if(1==i.value)return this.setPlaybackRate(i)}},nextRate:function(){this.callStateChange({type:v.EVENT.SET_RATE,data:"increment"})},previousRate:function(){this.callStateChange({type:v.EVENT.SET_RATE,data:"decrement"})},getPlaybackQuality:function(e){var t=this.device();return t&&t.getPlaybackQuality?t.getPlaybackQuality(e):null},setPlaybackQuality:function(e){this.callStateChange({type:v.EVENT.SET_PLAYBACK_QUALITY,data:e})},getAvailableQualityLevels:function(){var e=this.device();return e&&e.getAvailableQualityLevels?e.getAvailableQualityLevels():null},getAvailableSubtitles:function(){var e=this.device();return e&&e.getAvailableSubtitles?e.getAvailableSubtitles():null},getPlaybackSubtitle:function(){var e=this.device();return e&&e.getPlaybackSubtitle?e.getPlaybackSubtitle():null},setPlaybackSubtitle:function(e){this.callStateChange({type:v.EVENT.SET_PLAYBACK_SUBTITLE,data:e})},fullscreen:function(e){this.callStateChange({type:v.EVENT.SET_FULLSCREEN,data:e})},exitFullscreen:function(e){this.callStateChange({type:v.EVENT.EXIT_FULLSCREEN,data:e})},toggleFullscreen:function(){this.isFullscreen()?this.exitFullscreen():this.fullscreen()},isFullscreen:function(){return this.sizeModule().isFullscreen()},setSize:function(e,t,i){this.userElement&&this.callStateChange({type:v.EVENT.SET_SIZE,data:{width:e,height:t,index:0===i||i?i:-1}})},setWidth:function(e){this.setSize(e,undefined,-1)},setHeight:function(e){this.setSize(undefined,e,-1)},getVideoSize:function(){var e=this.device();return e&&e.getVideoSize?e.getVideoSize():null},source:function(e,t){this.playlistIndex=0;this.src=s(this,e);this.current(t)},reset:function(){this.callStateChange({type:v.EVENT.RESET})},userKey:function(e){var t=this.module("key");t&&t.userKey(e)},setSphericalProperties:function(e){var t=this.device();return t&&t.setSphericalProperties?t.setSphericalProperties(e):null},getSphericalProperties:function(){var e=this.device();return e&&e.getSphericalProperties?e.getSphericalProperties():null},isSphericalProperties:function(){var e=this.device();return!(!e||!e.isSphericalProperties)&&e.isSphericalProperties()},isVR:function(){return this.isSphericalProperties()},showMessage:function(e,t,i){this.callStateChange({type:v.EVENT.SHOW_MESSAGE,data:{message:e,isHtml:t,attr:i}})},cleanMessage:function(){this.callStateChange({type:v.EVENT.CLEAN_MESSAGE})},isDisableEvent:function(e){var t=this.device();return!(!t||!t.isDisableEvent)&&t.isDisableEvent(e)},callStateChange:function(e){this.eventManager&&this.eventManager.push(e)},onReady:function(){if(!1!==this.attr.resource){var e=this.sizeIndex;this.setSize(this.width[e],this.height[e],e)}this.callStateChange({type:v.EVENT.ON_READY})},onSync:function(){this.callStateChange({type:v.EVENT.ON_SYNC})},patchModule:function(e,t){var i,n=this.attr?this.attr:this.attr={},r=n.module?n.module:n.module={};if(e)if(r[e])for(i in t)r[e][i]=t[i];else r[e]=t;return this},patchElement:function(e,t){var i,n=this.attr?this.attr:this.attr={},r=n.element?n.element:n.element={};if(e)if(r[e])for(i in t)r[e][i]=t[i];else r[e]=t;return this},isDestroy:function(){return this._is_destroy},destroy:function(){var e,t=this.device();t.destroy&&t.destroy();this._is_destroy=!0;this.stop();window[this.guid]=null;if(this.userElement&&E.isElement(this.userElement)){this.userElement.zonemediaplayer=null;this.userElement.innerText=""}if(this.eventManager){this.eventManager.destroy();this.eventManager=null}for(e=0;e<v.D_MEDIA_LIST.length;e++)if(v.D_MEDIA_LIST[e]===this){v.D_MEDIA_LIST.splice(e,1);break}},stateLog:function(e,t,i,n){var r,s=this.attr,a=s.debug,o=v.EVENT,l="",u="log",c=e?e.source:null,h=!!c&&c instanceof y;if(e.type!=o.ON_SYNC&&a.use){if(a.disable&&a.disable.length)for(r=0;r<a.disable.length;r++)if(e.type==a.disable[r])return;if(a.displayType||a.displayClassName){var d,f,p=c?c.deviceType():null,m="youtube"!=p&&"video"!=p&&s.playerType?s.playerType:p;l+=a.displayType?"["+(m||"*")+"]":"";1===a.displayClassName&&-1!==(f=(d=e.device&&e.device.getClassName?e.device.getClassName():"").lastIndexOf("."))&&(d=d.substring(f+1));l+=a.displayClassName?"["+(d||"*")+"]":""}i||(i=1);if(i&&(i-=1))for(var g=0;g<i;g++)l+="    ";l+="start"==t?" --\x3e ":" <-- ";l+=v.getTypeName(e.type);l+=e.type==o.STATE_CHANGE?" ("+v.getStateName(e.data)+")":"";h&&(l+=a.displaySource?" ("+c.source()+")":"");if("start"===t){u="log"==a.startType?"log":"warn";if(a.special&&E.isArray(a.special))for(r=0;r<a.special.length;r++)if(e.type===a.special[r]){u="warn";break}}n&&(u="warn");switch(u){case"warn":e.data!==undefined?this.warn(l,e.data,e):this.warn(l);break;case"error":e.data!==undefined?this.error(l,e.data,e):this.error(l);break;case"fatal":e.data!==undefined?this.fatal(l,e.data,e):this.fatal(l);break;default:e.data!==undefined?this.log(l,e.data,e):this.log(l)}}},sendLog:function(e,t,i){var n=t[0],r=t[1],s="",a="",o=this.attr.debug,l=o&&o.url?o.url:i;function u(e){var t,i,n,r="";if(e){if(e instanceof Error||e instanceof TypeError)return e.stack?e.stack.replace(/\?updateid\=[0-9]+/gi,""):""+e;switch(typeof e){case"number":case"integer":case"float":case"double":case"string":return e+"";case"function":return"[function]";case"boolean":return"true"}n=!(r="{ ");for(t in e){i=u(e[t]);if(n)r+=", "+t+": "+i;else{n=!0;r+=t+": "+i}}return r+=" }"}return!1===e?"false":0===e?"0":null===e?"null":e===undefined?"undefined":""}(o.element||l)&&(s=u(n),a=u(r));if(o.element){if(!E.isElement(o.element)&&!E.isElement(o.element=E.query(o.element)))return;var c=document.createElement("div");switch(e){case"warn":c.style.color="#00FF00";break;case"error":case"fatal":c.style.color="#FF0000";break;default:c.style.color="#000000"}c.innerText+=a&&"undefined"!==a?"["+e+"] "+s+" - "+a:"["+e+"] "+s;o.element.appendChild(c)}l&&E.ajax({url:l+"?replaceTime="+(new Date).getTime(),type:"POST",data:{type:e,log:s,data:a},error:function(e){},success:function(e,t,i){}})},log:function(e){var t=this.attr,i=t&&t.debug;if(i&&i.use){try{E.log.apply(this,arguments)}catch(n){}try{this.sendLog("log",arguments)}catch(n){}}},warn:function(e){var t=this.attr,i=t&&t.debug;if(i&&i.use){try{E.warn.apply(this,arguments)}catch(n){}try{this.sendLog("warn",arguments)}catch(n){}}},error:function(e){var t=this.attr;t&&t.debug;try{E.error.apply(this,arguments)}catch(i){}try{this.sendLog("error",arguments)}catch(i){}},fatal:function(e){var t=this.attr,i=t&&t.debug;if(i&&i.use){try{E.error.apply(this,arguments)}catch(n){}try{this.sendLog("fatal",arguments)}catch(n){}}},targetElement:function(e){var t=this.attr&&(this.attr["native"]||this.attr.nativeFullscreen);if(t&&E.b.isMobile){var i,n;if(this.isNativePlayer(t)&&(i=this.device())&&(n=i.deviceInstance()))return n.zonemediaelement}return this.userElement},isNativePlayer:function(e){var t=e||this.attr["native"];if(t&&E.b.isMobile){if((t.iOS||t.ios)&&E.b.iOS)return!0;if(t.android&&E.b.android)return!0}return!1},isNativeFullscreen:function(){var e=this.attr.nativeFullscreen;if(e&&E.b.isMobile){if((e.iOS||e.ios)&&E.b.iOS)return!0;if(e.android&&E.b.android)return!0}return!1}};return e})}();!function(){"use strict";var i=getDframework(),n=i.module("imgtech.media.Media");i.define("imgtech.media.module.Underplayer",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("underplayer")}i.extendClass(e,t,{onStateChange:function(e){switch(e.type){case n.EVENT.SET_DISABLED:"success"==e.data?this.showUnderPlayer():"testing"!=e.data&&"fatal"!=e.data||this.hideUnderPlayer()}},showUnderPlayer:function(){this.underplayer&&this.underplayer.show()},hideUnderPlayer:function(){this.underplayer&&this.underplayer.hide()}});return e})}();!function(){"use strict";var i=getDframework(),n=i.module("imgtech.media.Media");i.define("imgtech.media.module.Background",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("background")}i.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){switch(e.type){case n.EVENT.SET_DISABLED:"success"==e.data?this.showBackground():"testing"!=e.data&&"fatal"!=e.data||this.hideBackground()}},showBackground:function(){this.background&&this.background.show()},hideBackground:function(){this.background&&this.background.hide()}});return e})}();!function(){"use strict";var i=getDframework(),n=i.module("imgtech.media.Media");i.define("imgtech.media.module.Foreground",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("foreground")}i.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){switch(e.type){case n.EVENT.SET_DISABLED:"success"==e.data?this.showForeground():"testing"!=e.data&&"fatal"!=e.data||this.hideForeground()}},showForeground:function(){this.foreground&&this.foreground.show()},hideForeground:function(){this.foreground&&this.foreground.hide()}});return e})}();!function(){"use strict";var o=getDframework(),l=o.module("imgtech.media.Media");o.define("imgtech.media.module.Layout",function(){var n=o.module("imgtech.media.ModuleInterface");function e(e){n.apply(this,arguments);if(e){this.resourceElement=this.c.resourceElement;this.setSelfElementObject("osd");this.setSelfElementObject("osdLoading");this.setSelfElementObject("osdToggle");this.setSelfElementObject("control");this.setSelfElementObject("info");this.setSelfElementObject("subtitleDisplay");this.setSelfElementObject("extendControl");this.setSelfElementObject("exctrlAlayer");this.setSelfElementObject("exctrlBlayer");this.setSelfElementObject("exctrlClayer");this.setSelfElementObject("exctrlPreviousBtn");this.setSelfElementObject("exctrlNextBtn");this.setSelfElementObject("exctrlToggleBtn");this.setSelfElementObject("exctrlPlayerBtnLayer");this.appMod=null;this.sizeMod=null;this.progressMod=null;this.volumeMod=null;this.enableHide=!0;this.currentShowControl=0;this.__isOnMouseOver=!1;this.isShowedControl=!1;this.isShowedExtendControl=!1;this.isDisableHideCursor=!1;var t=this.attr;t.controlAutoHidePause=t.controlAutoHidePause?"hide":"show";t.controlAutoHide=t.controlAutoHide?t.controlAutoHide:0;if(!1!==t.useOsdPlayBtn&&this.osd){var i=document.createElement("div");this.setSelfAddElementObject("osdPlayBtn",i,{});this.osdPlayBtn.addClass("mpv-osd-play-btn");this.hideOsdPlayBtn();this.osd.after(i)}this.hideLoading();this.isUseOSD()||this.hideOSD();if(t.extend){t.extend.disableExctrlAlayer&&this.exctrlAlayer.hide();t.extend.disableExctrlBlayer&&this.exctrlBlayer.hide();t.extend.disableExctrlClayer&&this.exctrlClayer.hide();t.extend.disableExctrlPreviousBtn&&this.exctrlPreviousBtn.hide();t.extend.disableExctrlNextBtn&&this.exctrlNextBtn.hide();t.extend.disableExctrlToggleBtn&&this.exctrlToggleBtn.hide();t.extend.disableExctrlPlayerBtnLayer&&this.exctrlPlayerBtnLayer.hide()}}}o.extendClass(e,n,{onAddEvent:function(){var i=this,e=this.resourceElement,t=this.control,n=this.attr,r=this.p;this.appMod=this.p.module("app");this.progressMod=this.p.module("progress");this.volumeMod=this.p.module("volume");o.on(e,"click",function(e){if(o.b.ie&&o.b.ie<9){var t=i.c.getElement(e.srcElement);if(t&&t.attr&&t.attr.igEventAll)return!1}return i.onClickLayout(e)});o.on(e,"dblclick",function(e){if(o.b.ie&&o.b.ie<9){var t=i.c.getElement(e.srcElement);if(t&&t.attr&&t.attr.igEventAll)return!1}return i.onDblClickOSD(e)});t.on("click",function(e){return o.igEventAll(e)});t.on("dblclick",function(e){return o.igEventAll(e)});if(!o.b.isMobile){o.on(e,"mousemove",function(e){return i.onMouseMoveLayout(e)});o.on(e,"mouseover",function(e){return i.onMouseOverLayout(e)});o.on(e,"mouseout",function(e){return i.onMouseOutLayout(e)})}this.extendControl&&o.on(this.extendControl.element,"click",function(e){var t=n.isOnlyToggleButton;if(!0===t||"function"==typeof t&&t.apply(this))return o.igEventAll(e)});if(this.isDisableControl())this.hideControl();else if(n.controlAutoHide)if(o.b.ie&&o.b.ie<9||!n.controlAutoHideFirst){this.__is__on_add_event=!0;this.showControl()}else this.hideControl();this.autoHideExtendControl();this.separateControl(this.isFullscreen());this.osdPlayBtn&&this.osdPlayBtn.on("click",function(e){return i.onClickOsdPlayBtn(e)});o.on(document,"click",function(e){r.callStateChange({type:l.EVENT.CLICK_EVENT,data:"document",event:e,parent:null})});this.sizeMod=this.p.module("size")},onStateChange:function(e){var t,i,n,r=this,s=this.attr,a=this.p;switch(e.type){case l.EVENT.STATE_CHANGE:if(e.data==l.STATE.SETSOURCE){this.osdPlayBtn&&(this.__isContinueOsdPlayBtn=!1);this.hideLoading();t=a&&a.device&&a.device(),i=t&&t.currentDevice&&t.currentDevice.instance,n=i&&i.getPlayerType&&i.getPlayerType(),a.attr&&a.attr.youtube&&a.attr.youtube.useYoutubeOSD&&("youtube"==n?r.setDisableHideCursor(!0):r.setDisableHideCursor(!1))}if(this.isUseOSD()){this.showOSD();e.data!=l.STATE.PLAYING&&e.data!=l.STATE.PAUSED||this.showToggleOSD(e.data)}else this.hideOSD();break;case l.EVENT.SET_DISABLED:"success"==e.data?this.showLayout():"testing"!=e.data&&"fatal"!=e.data||this.hideLayout();break;case l.EVENT.FULLSCREEN_CHANGE:setTimeout(function(){r.separateControl(e.data);r.showControl()},1);break;case l.EVENT.STATE_CHANGE:if("show"==s.controlAutoHidePause)switch(e.data){case l.STATE.PLAYING:this.state=l.STATE.PLAYING;break;case l.STATE.PAUSED:this.state=l.STATE.PAUSED;this.showControl()}break;case l.EVENT.ON_BEFORE_PLAY:if(this.osdPlayBtn){this.__isContinueOsdPlayBtn=!0;setTimeout(function(){var t=window.setInterval(function(){function e(){window.clearInterval(t);t=null;r.__isContinueOsdPlayBtn=!1;r.hideOsdPlayBtn()}if(a.isPlaying())return e();if(!r.__isContinueOsdPlayBtn)return e();r.showOsdPlayBtn()},100)},2e3)}break;case l.EVENT.CAN_PLAY:this.hideLoading();break;case l.EVENT.WAITTING:e.data?this.showLoading():this.hideLoading()}},isNoEventOSD:function(){return this.attr.noeventOSD},autoHideExtendControl:function(){if(this.extendControl){var e=this.attr.isExtendControlHideFirst;e&&(!0===e||e.apply(this))&&this.extendControl.hide()}},getSeparate:function(){return this.isFullscreen()?this.attr.separateControlFs:this.attr.separateControlNormal},separateControl:function(e){var t=this.attr.separateControlNormal,i=this.attr.separateControlFs,n=this.c.resourceElement;n&&(e?i?o.addClass(n,"mpv-separate-control"):o.removeClass(n,"mpv-separate-control"):t?o.addClass(n,"mpv-separate-control"):o.removeClass(n,"mpv-separate-control"))},setAlwaysControlNormal:function(e){((this.attr.alwaysControlNormal=e)||this.isShowedControl)&&this.showControl()},setSeparateControlNormal:function(e){this.attr.separateControlNormal=e;this.separateControl(this.isFullscreen())},showClass:function(e){e&&e.removeClass("mpv-hide")},hideClass:function(e){e&&e.addClass("mpv-hide")},showLayout:function(){this.showClass(this.control);this.showClass(this.osd);this.showClass(this.info);this.showClass(this.subtitleDisplay)},hideLayout:function(){this.hideClass(this.control);this.hideClass(this.osd);this.hideClass(this.info);this.hideClass(this.subtitleDisplay)},isFullscreen:function(){return this.c.m.size.isFullscreen()},isAlwaysControl:function(){var e=this.attr;return this.isFullscreen()?e.alwaysControlFs:e.alwaysControlNormal},isDisableControl:function(){var e=this.attr;return this.isFullscreen()?e.disableControlFs:e.disableControlNormal},isMouseOutExtendControl:function(){var e=this.attr.isMouseOutExtendControl;return!!e&&e.apply(this)},isMouseOver:function(){var e=this.progressMod,t=this.volumeMod;return!!this.__isOnMouseOver||(!(!e||!e.isDownProgressHandler&&!e.isTouchProgressHandler)||!(!t||!t.isShowSlider||!t.isDownVolumeHandler&&!t.isTouchVolumeHandler))},onMouseOutLayout:function(e){var t=this._oldMouseOutEvent;if(!t||t.clientX!==e.clientX||t.clientY!==e.clientY||o.b.ie&&o.b.ie<9){this._oldMouseOutEvent=e;this.__isOnMouseOver=!1;this.isTouchControl()||this.isMouseOutExtendControl()&&this.hideExtendControl({isMouseOut:!0})}},onMouseOverLayout:function(e){var t=this._oldMouseOverEvent;if(!t||t.clientX!==e.clientX||t.clientY!==e.clientY||o.b.ie&&o.b.ie<9){this._oldMouseOverEvent=e;this.onMouseMoveLayout_l()}},onMouseMoveLayout_l:function(){this.__isOnMouseOver=!0;this.currentShowControl=(new Date).getTime();if(!this.isTouchControl()){this.isShowedControl?this.currentShowControl=(new Date).getTime():this.showControl();this.isShowedExtendControl?this.__extendCtrlTime=(new Date).getTime():this.showExtendControl()}},onMouseMoveLayout:function(e){var t=this._oldMouseMoveEvent;if(t&&t.clientX===e.clientX&&t.clientY===e.clientY){if(!(o.b.ie&&o.b.ie<9))return;if(t.srcElement===e.srcElement)return}this._oldMouseMoveEvent=e;this.onMouseMoveLayout_l()},onClickLayout:function(e){if(!this.isNoEventOSD()){var t=this.p,i=this.attr,n=t.device(),r=n?n.currentDevice:null,s=(r&&r.type,i.isOnlyToggleButton);if(!(!0===s||"function"==typeof s&&s.apply(this))||o.b.isMobile){this.__isOnMouseOver=!1;if(this.isTouchControl()){if(this.isEnableShowControl())return this.showControl()}else this.showControl();!0===s||"function"==typeof s&&s.apply(this)||t.toggle()}}},isTouchControl:function(){return!!this.attr.isTouchControl&&this.attr.isTouchControl.call(this)},hideCursor:function(){},setDisableHideCursor:function(e){},showCursor:function(){},hideUserControl:function(){this.__is_show_user_control=!0;this.hideRealControl()},hideExtendControl:function(e){var t;if(this.extendControl){if((t=this.isMouseOutExtendControl())&&!(e&&e.isMouseOut||1===t))return;this.isShowedExtendControl=!1;this.extendControl.hide()}},hideRealControl:function(){var e=this.c.resourceElement;this.isShowedControl=!1;this.control&&this.control.hide();this.hideExtendControl();o.removeClass(e,"mpv-show-control");o.addClass(e,"mpv-hide-control")},showUserControl:function(){this.__is_show_user_control=!0;this.showRealControl()},cancelUserControl:function(){this.__is_show_user_control=!1;this.isShowedControl&&this.showControl()},showExtendControl:function(e){var t=this,i=this.attr,n=i.controlAutoHide?i.controlAutoHide:2.5;function r(){if(t.__extendCtrlTimer){clearInterval(t.__extendCtrlTimer);t.__extendCtrlTimer=null;t.__extendCtrlTime=0}}if(this.extendControl){this.isShowedExtendControl=!0;this.extendControl.show()}if(this.__extendCtrlTimer)this.__extendCtrlTime=(new Date).getTime();else{if(!e)return r();this.__extendCtrlTime=(new Date).getTime();this.__extendCtrlTimer=setInterval(function(){var e=(new Date).getTime()-t.__extendCtrlTime;if(1e3*n<e)return function(){r();t.hideExtendControl()}()},150)}},showRealControl:function(){var e=this.c.resourceElement;this.__is__on_add_event?this.__is__on_add_event=!1:this.isShowedControl=!0;this.control&&this.control.show();this.showExtendControl();o.addClass(e,"mpv-show-control");o.removeClass(e,"mpv-hide-control")},hideControl:function(){var e=this.c.resourceElement,t=o.hasClass(e,"mpv-hide-control"),i=this;if(this.__is_show_user_control)return this.hideExtendControl();this.currentShowControl=0;if(this.isDisableControl())return this.hideRealControl();if(this.isAlwaysControl())return this.hideExtendControl();this.hideRealControl();this.hideCursor();t||setTimeout(function(){i.p.callStateChange({type:l.EVENT.CONTROL_EVENT,data:"hide"})},1)},isEnableShowControl:function(){return!this.isShowedControl||!!this.extendControl&&!this.isShowedExtendControl},showControl:function(){var n=this,r=(this.c.resourceElement,this.attr);function e(){n.currentShowControl=(new Date).getTime();if(n.isEnableShowControl()){n.showRealControl();n.showCursor();setTimeout(function(){n.p.callStateChange({type:l.EVENT.CONTROL_EVENT,data:"show"})},1)}}if(!this.__is_show_user_control){if(this.isDisableControl())return function(){n.hideRealControl();n.showExtendControl(!0)}();if(!r.controlAutoHide){this.p.warn("show(); <= !attr.controlAutoHide");return e()}if(this.isAlwaysControl()){this.p.warn("show(); <= isAlwaysControl()");return e()}e();t()}function s(){n.__is_show_timer=!1}function a(){setTimeout(function(){t(!0)},200)}function t(e){if(!e&&n.__is_show_timer)return n.showExtendControl(!0);if(n.__is_show_user_control)return n.showExtendControl(!0);n.__is_show_timer=!0;if(!r.controlAutoHide)return s();if("show"==r.controlAutoHidePause&&n.state==l.STATE.PAUSED)return s();if(!n.enableHide)return s();if(!1===r.controlAutoHideOver&&!o.isMobile&&n.isMouseOver()&&!n.isFullscreen())return a();var t=n.currentShowControl,i=(new Date).getTime();if(!t||i-t>1e3*r.controlAutoHide){n.hideControl();s()}else a()}},isUseYoutubeOSD:function(){var e,t=this.p;try{e=t&&t.device&&t.device()}catch(r){e=null}var i,n=e&&e.currentDevice?e.currentDevice.instance:e;return"youtube"==(n&&n.getPlayerType?n.getPlayerType():null)?!!((i=t.attr)&&i.youtube&&i.youtube.useYoutubeOSD):null},isUseOSD:function(){if(!this.osd)return!1;var e=this.isUseYoutubeOSD();return!0!==e&&(!1===e||!this.attr.unused)},showLoading:function(){var e=this.p.currentMediaSource(),t=this.p.device(),i=t&&t.deviceInstance();if(e&&e.___retryErrorLastCurrentTime)return this.hideLoading();if(i&&i.__disablePauseDisplayForStop){i.__disablePauseDisplayForStop=!1;return this.hideLoading()}this.osdLoading&&this.osdLoading.show()},hideLoading:function(){this.osdLoading&&this.osdLoading.hide()},showOSD:function(){this.osd&&this.osd.show()},hideOSD:function(){this.osd&&this.osd.hide()},showToggleOSD:function(e){var t=this.attr,i=this.osdToggle,n=this;if(t.disableToggleOSD)return i&&i.hide();if(i){this.hideToggleOSD();var r;if(this.p.currentMediaSource().___retryErrorLastCurrentTime)return;if(this.sizeMod&&this.sizeMod._beforeFullscreenHasReplaceElement)return;if(e==l.STATE.PAUSED&&(r=this.p.device())&&(r=r.deviceInstance())&&r.__disablePauseDisplayForStop){r.__disablePauseDisplayForStop=!1;return}if(e==l.STATE.PLAYING){i.addClass("mpv-state-paused");i.addClass("mpv-transform-show")}else if(e==l.STATE.PAUSED){i.addClass("mpv-state-playing");i.addClass("mpv-transform-show")}this.showToggleTimer&&clearInterval(this.showToggleTimer);this.showToggleTimerValue=(new Date).getTime();this.showToggleTimer=setInterval(function(){var e=n.showToggleTimerValue;if(400<=(new Date).getTime()-e){clearInterval(n.showToggleTimer);n.showToggleTimer=null;n.hideToggleOSD()}},100)}},hideToggleOSD:function(){var e=this.attr,t=this.osdToggle;if(e.disableToggleOSD)return t&&t.hide();if(t){t.removeClass("mpv-state-playing");t.removeClass("mpv-state-paused");t.removeClass("mpv-transform-show");t.addClass("mpv-transform-hide")}},showOsdPlayBtn:function(){this.osdPlayBtn&&this.osdPlayBtn.show()},hideOsdPlayBtn:function(){this.osdPlayBtn&&this.osdPlayBtn.hide()},onClickOsdPlayBtn:function(e){this.hideOsdPlayBtn();this.p.play();return o.igEventAll(e)},ignoreFullscreen:function(){function e(e){if(!0===e)return!0;try{return e.apply(this)}catch(t){}return!1}var t=this.attr;return e.call(this,t.ignoreFullscreen)||e.call(this,t.ignoreFullscreenAll)},ignoreFullscreenAll:function(){var e=this.attr;return function(e){if(!0===e)return!0;try{return e.apply(this)}catch(t){}return!1}.call(this,e.ignoreFullscreenAll)},onDblClickOSD:function(e){if(!this.isNoEventOSD()){var t=this.p,i=(this.attr,t.device()),n=i?i.currentDevice:null;n&&n.type;this.ignoreFullscreen()||t.toggleFullscreen()}}});return e})}();!function(){"use strict";var s=getDframework(),a=s.module("imgtech.media.Media"),i=s.module("imgtech.media.ModuleInterface");function t(e){e&&s.addClass(e,"mpv-hide")}function e(e){if(!0===e)return!0;try{return e.apply(this)}catch(t){}return!1}function n(e){this.parent=e;this.p=e.p;this.c=e.c;this.attr=e.attr;this.osdLoading=e.osdLoading;this.hideLoading()}n.prototype={constructor:n,onAddEvent:function(){},onStateChange:function(e){switch(e.type){case a.EVENT.STATE_CHANGE:e.data==a.STATE.SETSOURCE&&this.hideLoading();break;case a.EVENT.CAN_PLAY:this.hideLoading();break;case a.EVENT.WAITTING:e.data?this.showLoading():this.hideLoading()}},showLoading:function(){var e=this.p.currentMediaSource(),t=this.p.device(),i=t&&t.deviceInstance();if(e&&e.___retryErrorLastCurrentTime)return this.hideLoading();if(i&&i.__disablePauseDisplayForStop){i.__disablePauseDisplayForStop=!1;return this.hideLoading()}this.osdLoading&&this.osdLoading.show()},hideLoading:function(){this.osdLoading&&this.osdLoading.hide()}};function r(e,t){this.parent=e;this.iOSD=t;this.p=e.p;this.c=e.c;this.attr=e.attr;this.sizeMod=null;this.osdToggle=e.osdToggle}r.prototype={constructor:r,onAddEvent:function(){this.sizeMod=this.p.module("size")},onStateChange:function(e){this.attr,this.p;switch(e.type){case a.EVENT.STATE_CHANGE:this.iOSD.isUseOSD()&&(e.data!=a.STATE.PLAYING&&e.data!=a.STATE.PAUSED||this.showToggleOSD(e.data))}},showToggleOSD:function(e){var t=this.attr,i=this.osdToggle,n=this;if(t.disableToggleOSD)return i&&i.hide();if(i){this.hideToggleOSD();var r;if(this.p.currentMediaSource().___retryErrorLastCurrentTime)return;if(this.sizeMod&&this.sizeMod._beforeFullscreenHasReplaceElement)return;if(e==a.STATE.PAUSED&&(r=this.p.device())&&(r=r.deviceInstance())&&r.__disablePauseDisplayForStop){r.__disablePauseDisplayForStop=!1;return}if(e==a.STATE.PLAYING){i.addClass("mpv-state-paused");i.addClass("mpv-transform-show")}else if(e==a.STATE.PAUSED){i.addClass("mpv-state-playing");i.addClass("mpv-transform-show")}this.showToggleTimer&&clearInterval(this.showToggleTimer);this.showToggleTimerValue=(new Date).getTime();this.showToggleTimer=setInterval(function(){var e=n.showToggleTimerValue;if(400<=(new Date).getTime()-e){clearInterval(n.showToggleTimer);n.showToggleTimer=null;n.hideToggleOSD()}},100)}},hideToggleOSD:function(){var e=this.attr,t=this.osdToggle;if(e.disableToggleOSD)return t&&t.hide();if(t){t.removeClass("mpv-state-playing");t.removeClass("mpv-state-paused");t.removeClass("mpv-transform-show");t.addClass("mpv-transform-hide")}}};function o(e){this.parent=e;this.p=e.p;this.c=e.c;this.attr=e.attr;if(!1!==this.attr.useOsdPlayBtn&&this.osd){this.osdPlayBtnElement=document.createElement("div");s.addClass(this.osdPlayBtnElement,"mpv-osd-play-btn");t(this.osdPlayBtnElement);e.osd.after(this.osdPlayBtnElement)}}o.prototype={constructor:o,onAddEvent:function(){var t=this;this.osdPlayBtnElement&&s.on(this.osdPlayBtnElement,"click",function(e){return t.onClickOsdPlayBtn(e)})},onStateChange:function(e){switch(e.type){case a.EVENT.STATE_CHANGE:e.data==a.STATE.SETSOURCE&&this.osdPlayBtnElement&&(this.__isContinueOsdPlayBtn=!1);break;case a.EVENT.ON_BEFORE_PLAY:if(this.osdPlayBtnElement){this.__isContinueOsdPlayBtn=!0;setTimeout(function(){var t=window.setInterval(function(){function e(){window.clearInterval(t);t=null;thiz.__isContinueOsdPlayBtn=!1;thiz.hideOsdPlayBtn()}if(p.isPlaying())return e();if(!thiz.__isContinueOsdPlayBtn)return e();thiz.showOsdPlayBtn()},100)},2e3)}}},showOsdPlayBtn:function(){(e=this.osdPlayBtnElement)&&s.removeClass(e,"mpv-hide");var e},hideOsdPlayBtn:function(){t(this.osdPlayBtnElement)},onClickOsdPlayBtn:function(e){this.hideOsdPlayBtn();this.p.play();return s.igEventAll(e)}};function l(e){this.parent=e;this.p=e.p;this.c=e.c;this.attr=e.attr;this.osd=e.osd;this.iOsdLoading=new n(e,this);this.iOsdToggle=new r(e,this);this.iOsdPlayBtn=new o(e,this);this.isUseOSD()||this.hideOSD()}l.prototype={constructor:l,onAddEvent:function(){this.iOsdLoading.onAddEvent();this.iOsdToggle.onAddEvent();this.iOsdPlayBtn.onAddEvent()},onStateChange:function(e){switch(e.type){case a.EVENT.STATE_CHANGE:this.isUseOSD()?this.showOSD():this.hideOSD()}this.iOsdLoading.onStateChange(e);this.iOsdToggle.onStateChange(e);this.iOsdPlayBtn.onStateChange(e)},showOSD:function(){this.osd&&this.osd.show()},hideOSD:function(){this.osd&&this.osd.hide()},isUseOSD:function(){if(!this.osd)return!1;var e=this.isUseYoutubeOSD();return!0!==e&&(!1===e||!this.attr.unused)},isUseYoutubeOSD:function(){var e,t=this.p;try{e=t&&t.device&&t.device()}catch(r){e=null}var i,n=e&&e.currentDevice?e.currentDevice.instance:e;return"youtube"==(n&&n.getPlayerType?n.getPlayerType():null)?!!((i=t.attr)&&i.youtube&&i.youtube.useYoutubeOSD):null}};function u(e){this.parent=e;this.p=e.p;this.c=e.c;this.attr=e.attr;this.resourceElement=e.resourceElement;this.control=e.control}u.prototype={constructor:u,onAddEvent:function(){var i=this,e=this.resourceElement,t=this.control,n=this.p;t.on("click",function(e){return s.igEventAll(e)});t.on("dblclick",function(e){return s.igEventAll(e)});s.on(e,"click",function(e){if(s.b.ie&&s.b.ie<9){var t=i.c.getElement(e.srcElement);if(t&&t.attr&&t.attr.igEventAll)return!1}return i.onClickLayout(e)});s.on(e,"dblclick",function(e){if(s.b.ie&&s.b.ie<9){var t=i.c.getElement(e.srcElement);if(t&&t.attr&&t.attr.igEventAll)return!1}return i.onDblClickOSD(e)});s.on(document,"click",function(e){n.callStateChange({type:a.EVENT.CLICK_EVENT,data:"document",event:e,parent:null})})},onStateChange:function(e){},isNoEventOSD:function(){return this.attr.noeventOSD},onClickLayout:function(e){if(this.isNoEventOSD())return this.p.warn("No event OSD ...");var t=this.p,i=this.attr.isOnlyToggleButton;if((!0===i||"function"==typeof i&&i.apply(this))&&!s.b.isMobile)return this.p.log("isOnlyToggleButton(no mobile): Not show control area.");this.parent.__isOnMouseOver=!1;t.callStateChange({type:a.EVENT.CLICK_EVENT,data:"osd",event:e,parent:null});if(this.parent.isTouchControl())return this.parent.showControl();this.parent.showControl();if(!0===i||"function"==typeof i&&i.apply(this))return this.p.log("isOnlyToggleButton: Not toggle.");t.toggle()},onDblClickOSD:function(e){if(!this.isNoEventOSD()){var t=this.p,i=(this.attr,t.device()),n=i?i.currentDevice:null;n&&n.type;this.parent.ignoreFullscreen()||t.toggleFullscreen()}}};function c(e){i.apply(this,arguments);if(e){this.resourceElement=this.c.resourceElement;this.setSelfElementObject("osd");this.setSelfElementObject("osdLoading");this.setSelfElementObject("osdToggle");this.setSelfElementObject("control");this.setSelfElementObject("info");this.setSelfElementObject("subtitleDisplay");this.progressMod=null;this.volumeMod=null;this.state=a.STATE.PAUSED;this.__isOnMouseOver=!1;this.__is_show_user_control=!1;this.__is_no_auto_hide_first=!1;var t=this.attr;t.controlAutoHidePause=t.controlAutoHidePause?"hide":"show";if(!t.controlAutoHide)throw new Error("layout module attribute: has not controlAutoHide option.\nYou set alwaysControlNormal or alwaysControlFs option.");this.iOSD=new l(this);this.iEVENT=new u(this)}}s.extendClass(c,i,{onAddEvent:function(){var t=this,e=this.resourceElement,i=this.attr;this.progressMod=this.p.module("progress");this.volumeMod=this.p.module("volume");this.iOSD.onAddEvent();this.iEVENT.onAddEvent();this.separateControl(this.isFullscreen());if(this.isDisableControl())this.hideControl();else if(i.controlAutoHide)if(!i.controlAutoHideFirst||s.b.ie&&s.b.ie<9){this.__is_no_auto_hide_first=!0;this.showControl()}else this.hideControl();if(!s.b.isMobile){s.on(e,"mouseover",function(e){return t.onMouseOverLayout(e)});s.on(e,"mousemove",function(e){return t.onMouseMoveLayout(e)});s.on(e,"mouseout",function(e){return t.onMouseOutLayout(e)})}},onStateChange:function(e){var t=this.attr,i=this;switch(e.type){case a.EVENT.FULLSCREEN_CHANGE:setTimeout(function(){i.separateControl(e.data);i.showControl()},1);break;case a.EVENT.SET_DISABLED:"success"==e.data?this.showLayout():"testing"!=e.data&&"fatal"!=e.data||this.hideLayout();break;case a.EVENT.STATE_CHANGE:if("show"==t.controlAutoHidePause)switch(e.data){case a.STATE.PLAYING:this.state=a.STATE.PLAYING;break;case a.STATE.PAUSED:this.state=a.STATE.PAUSED;this.showControl()}}this.iOSD.onStateChange(e);this.iEVENT.onStateChange(e)},getSeparate:function(){return this.isFullscreen()?this.attr.separateControlFs:this.attr.separateControlNormal},isUseYoutubeOSD:function(){return this.iOSD.isUseYoutubeOSD()},showLayout:function(){function e(e){e&&e.removeClass("mpv-hide")}e(this.control);e(this.osd);e(this.info);e(this.subtitleDisplay)},hideLayout:function(){function e(e){e&&e.addClass("mpv-hide")}e(this.control);e(this.osd);e(this.info);e(this.subtitleDisplay)},isAlwaysControl:function(){var e=this.attr;return this.isFullscreen()?e.alwaysControlFs:e.alwaysControlNormal},isDisableControl:function(){var e=this.attr;return this.isFullscreen()?e.disableControlFs:e.disableControlNormal},setAlwaysControlNormal:function(e){((this.attr.alwaysControlNormal=e)||this.isShowedControl)&&this.showControl()},separateControl:function(e){var t=this.attr.separateControlNormal,i=this.attr.separateControlFs,n=this.c.resourceElement,r="mpv-separate-control";if(n)return e?i?s.addClass(n,r):s.removeClass(n,r):t?s.addClass(n,r):s.removeClass(n,r)},setSeparateControlNormal:function(e){this.attr.separateControlNormal=e;this.separateControl(this.isFullscreen())},showUserControl:function(e){this.__is_show_user_control=!0;if(e){e.extend&&this.showExtendControl();(e.base||e.baisc)&&this.showRealControl()}else this.showRealControl()},hideUserControl:function(e){this.__is_show_user_control=!0;if(e){e.extend&&this.hideExtendControl();(e.base||e.baisc)&&this.hideRealControl()}else this.hideRealControl()},cancelUserControl:function(){this.__is_show_user_control=!1;(this.isShowedControl||this.isShowedExtendControl)&&this.showControl()},isFullscreen:function(){return this.c.m.size.isFullscreen()},ignoreFullscreen:function(){return e.call(this,this.attr.ignoreFullscreen)||this.ignoreFullscreenAll()},ignoreFullscreenAll:function(){return e.call(this,this.attr.ignoreFullscreenAll)},isTouchControl:function(){return!!this.attr.isTouchControl&&this.attr.isTouchControl.call(this)},isEnableShowControl:function(){return!this.isShowedControl||!!this.extendControl&&!this.isShowedExtendControl},isMouseOver:function(){var e=this.progressMod,t=this.volumeMod;return!!this.__isOnMouseOver||(!(!e||!e.isDownProgressHandler&&!e.isTouchProgressHandler)||!(!t||!t.isShowSlider||!t.isDownVolumeHandler&&!t.isTouchVolumeHandler))},onMouseOverLayout:function(e){var t=this._oldMouseOverEvent;if(!t||t.clientX!==e.clientX||t.clientY!==e.clientY||s.b.ie&&s.b.ie<9){this._oldMouseOverEvent=e;this.onMouseMoveLayout_l()}},onMouseMoveLayout:function(e){var t=this._oldMouseMoveEvent;if(t&&t.clientX===e.clientX&&t.clientY===e.clientY){if(!(s.b.ie&&s.b.ie<9))return;if(t.srcElement===e.srcElement)return}this._oldMouseMoveEvent=e;this.onMouseMoveLayout_l()},onMouseMoveLayout_l:function(){this.__isOnMouseOver=!0;this.currentShowControl=(new Date).getTime();this.isTouchControl()||this.showControl()},onMouseOutLayout:function(e){var t=this._oldMouseOutEvent;if(!t||t.clientX!==e.clientX||t.clientY!==e.clientY||s.b.ie&&s.b.ie<9){this._oldMouseOutEvent=e;this.__isOnMouseOver=!1;this.isTouchControl()}}});s.define("imgtech.media.module.ActiveLayout",function(){function t(e){c.apply(this,arguments);e&&(this.enableHide=!0)}s.extendClass(t,c,{onAddEvent:function(){t.__super.onAddEvent.apply(this,arguments)},onStateChange:function(e){t.__super.onStateChange.apply(this,arguments)},showRealControl:function(){var e=this.c.resourceElement;this.__is_no_auto_hide_first?this.__is_no_auto_hide_first=!1:this.isShowedControl=!0;this.control&&this.control.show();s.addClass(e,"mpv-show-control");s.removeClass(e,"mpv-hide-control")},hideRealControl:function(){var e=this.c.resourceElement;this.isShowedControl=!1;this.control&&this.control.hide();s.removeClass(e,"mpv-show-control");s.addClass(e,"mpv-hide-control")},hideControl:function(){var e=this.c.resourceElement,t=s.hasClass(e,"mpv-hide-control"),i=this;this.currentShowControl=0;if(this.__is_show_user_control)return!0;if(!this.isAlwaysControl()){this.hideRealControl();t||setTimeout(function(){i.p.callStateChange({type:a.EVENT.CONTROL_EVENT,data:"hide"})},1)}},showControl:function(){var e=this,n=this.attr;function r(){setTimeout(function(){t.call(e,!0)},200)}function t(e){if((e||!this.__is_show_timer)&&!this.__is_show_user_control){this.__is_show_timer=!0;if("show"==n.controlAutoHidePause&&this.state==a.STATE.PAUSED)return r.call(this);if(!this.enableHide)return r.call(this);if(!1===n.controlAutoHideOver&&!s.isMobile&&this.isMouseOver()&&!this.isFullscreen())return r.call(this);var t=this.currentShowControl,i=(new Date).getTime();if(!t||i-t>1e3*n.controlAutoHide){this.hideControl();(function(){this.__is_show_timer=!1}).call(this)}else r.call(this)}}if(this.__is_show_user_control)return!0;(function(){if(this.isDisableControl())return this.hideRealControl();this.currentShowControl=(new Date).getTime();this.showExtendControl();if(!this.isShowedControl){this.showRealControl();setTimeout(function(){e.p.callStateChange({type:a.EVENT.CONTROL_EVENT,data:"show"})},1)}}).call(this);t.call(this)}});return t});s.define("imgtech.media.module.LayoutEx",function(){var i=s.module("imgtech.media.module.ActiveLayout");function t(e){i.apply(this,arguments);if(e){this.setSelfElementObject("extendControl");this.setSelfElementObject("exctrlAlayer");this.setSelfElementObject("exctrlBlayer");this.setSelfElementObject("exctrlClayer");this.setSelfElementObject("exctrlPreviousBtn");this.setSelfElementObject("exctrlNextBtn");this.setSelfElementObject("exctrlToggleBtn");this.setSelfElementObject("exctrlPlayerBtnLayer");var t=this.attr;this.isShowedExtendControl=!1;if(t.extend){t.extend.disableExctrlAlayer&&this.exctrlAlayer.hide();t.extend.disableExctrlBlayer&&this.exctrlBlayer.hide();t.extend.disableExctrlClayer&&this.exctrlClayer.hide();t.extend.disableExctrlPreviousBtn&&this.exctrlPreviousBtn.hide();t.extend.disableExctrlNextBtn&&this.exctrlNextBtn.hide();t.extend.disableExctrlToggleBtn&&this.exctrlToggleBtn.hide();t.extend.disableExctrlPlayerBtnLayer&&this.exctrlPlayerBtnLayer.hide()}}}s.extendClass(t,i,{onAddEvent:function(){var i=this.attr;t.__super.onAddEvent.apply(this,arguments);this.extendControl&&s.on(this.extendControl.element,"click",function(e){var t=i.isOnlyToggleButton;if(!0===t||"function"==typeof t&&t.apply(this))return s.igEventAll(e)});this.autoHideExtendControl()},onStateChange:function(e){t.__super.onStateChange.apply(this,arguments)},autoHideExtendControl:function(){if(this.extendControl){var e=this.attr.isExtendControlHideFirst;e&&(!0===e||e.apply(this))}},isMouseOutExtendControl:function(){var e=this.attr.isMouseOutExtendControl;return!!e&&e.apply(this)},hideExtendControl:function(){var e;if(this.extendControl){if((e=this.isMouseOutExtendControl())&&!(ia&&ia.isMouseOut||1===e))return;this.isShowedExtendControl=!1;this.extendControl.hide()}},hideControl:function(){t.__super.hideControl.apply(this,arguments)||this.hideExtendControl()},showExtendControl:function(){if(this.extendControl&&!this.isShowedExtendControl){this.isShowedExtendControl=!0;this.extendControl.show()}}});return t})}();!function(){"use strict";var n=getDframework(),i=n.module("imgtech.media.Media");n.define("imgtech.media.module.Toggle",function(){var t=n.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("playToggleBtn");this.setSelfElementObject("exctrlToggleBtn")}}n.extendClass(e,t,{onAddEvent:function(){var t=this.p,e=this.playToggleBtn,i=this.exctrlToggleBtn;(e||i)&&this.updatePause();e&&e.on("click",function(e){t.toggle();return n.igEventAll(e)});i&&i.on("click",function(e){t.toggle();return n.igEventAll(e)})},onStateChange:function(e){if(e.type==i.EVENT.STATE_CHANGE)switch(e.data){case i.STATE.PLAYING:this.updatePlay();break;case i.STATE.CUED:case i.STATE.PAUSED:case i.STATE.ENDED:this.updatePause()}},updatePlay:function(){function e(e){if(e){e.addClass("mpv-play");e.removeClass("mpv-pause")}}e(this.playToggleBtn);e(this.exctrlToggleBtn)},updatePause:function(){function e(e){if(e){e.removeClass("mpv-play");e.addClass("mpv-pause")}}e(this.playToggleBtn);e(this.exctrlToggleBtn)}});return e})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.Stop",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("stopBtn")}i.extendClass(e,t,{onAddEvent:function(){var e=this.p;this.stopBtn&&this.stopBtn.on("click",function(){e.stop()})},onStateChange:function(e){}});return e})}();!function(){"use strict";var c=getDframework(),n=c.module("imgtech.media.Media");c.define("imgtech.media.module.Quality",function(){var r=c.module("imgtech.media.ModuleInterface");function e(e){r.apply(this,arguments);if(e){this.attr;var t=this.p.userElement;this.setSelfElementObject("qualityLayout");this.setSelfElementObject("qualityBtn");var i=c.query(t,".mpv-quality-list");if(i){this.setSelfAddElementObject("qualityList",i,{openLayer:!0});var n;if(n=(i=this.qualityList).query(".mpv-view-ele")){this.qe=n;this.qeHTML=n.outerHTML;c.remove(n)}i.addClass("mpv-hide")}}}c.extendClass(e,r,{onAddEvent:function(){var t=this.p;this.layoutModule=this.c.m.layout;this.qualityBtn&&this.qualityBtn.on("click",function(e){t.callStateChange({type:n.EVENT.SHOW_QUALITY_LIST,event:e,parent:null})})},onStateChange:function(e){var t,i=this.p;this.qualityList;switch(e.type){case n.EVENT.CLICK_EVENT:this.hideQualityList();break;case n.EVENT.SHOW_SUBTITLE_LIST:this.hideQualityList(!1);break;case n.EVENT.STATE_CHANGE:if(e.data==n.STATE.SETSOURCE)if(t=i.getPlaybackQuality()){this.setCurrentQualityLabel(t.label);this.showQuality();this.showButton()}else if(!1!==this.attr.autohide){this.setCurrentQualityLabel(null);this.hideQuality();this.hideButton()}break;case n.EVENT.QUALITY_CHANGE:this.setCurrentQualityLabel(e.data.label);break;case n.EVENT.SHOW_QUALITY_LIST:this.showQualityList()}},showButton:function(){this.qualityBtn&&this.qualityBtn.show()},hideButton:function(){this.qualityBtn&&this.qualityBtn.hide()},showQuality:function(){this.qualityLayout&&this.qualityLayout.show()},hideQuality:function(){this.qualityLayout&&this.qualityLayout.hide()},setCurrentQualityLabel:function(e){var t,i=this.qualityBtn;if(i){e?t=e:(t=this.attr.defaultValue)||(t="");i.innerText(t)}},selectQuality:function(e){var t=this.p.getPlaybackQuality();this.qualityList;e!==t&&this.p.setPlaybackQuality(e);this.hideQualityList()},drawQualityElement:function(t,e){var i,n,r=c.element(this.qeHTML),s=this.qualityList,a=this,o="string"==typeof t?t:t.label?t.label:"",l=c.query(r,".mpv-view-checked"),u=c.query(r,".mpv-view-text");l.innerHTML="&nbsp;";if(e&&e.length)for(i=0;i<e.length;i++)if((n=e[i])&&n.code===t.code){c.addClass(r,"mpv-option-selected");break}u&&(u.innerText=o);"line"==t.view?c.addClass(r,"mpv-view-line"):c.on(u,"click",function(e){a.selectQuality(t,r,e)});s.element.appendChild(r)},hideQualityList:function(e){var t=this.qualityList;if(t){t.hide();!1!==e&&(this.layoutModule.enableHide=!0)}},showQualityList:function(){var e=this.qualityList,t=this.p;if(e&&this.qeHTML){var i,n,r=e.queryAll(".mpv-view-ele");for(var s in r)c.remove(r[s]);if(e.isHide()){if((i=t.getAvailableQualityLevels())&&i.length){n=t.getPlaybackQuality(!0);for(var a=0;a<i.length;a++)this.drawQualityElement(i[a],n);e.show();this.layoutModule.enableHide=!1;var o=e.rect(),l=this.attr.offsetY?this.attr.offsetY:0;e.top("-"+(o.height()+l)+"px")}}else this.hideQualityList()}}});return e})}();!function(){"use strict";var o=getDframework(),g=o.module("imgtech.media.Media");function t(e){return o.igEventAll(e)}o.define("imgtech.media.module.Volume",function(){var n=o.module("imgtech.media.ModuleInterface");function e(e){n.apply(this,arguments);if(e){this.layoutMod=null;this.disableAll=!1;this.isDownVolumeHandler=!1;this.isTouchVolumeHandler=!1;this.isShowSlider=null;this.sliderType=null;var t,i=this.attr;if(i.disable)for(t in i.disable)switch(i.disable[t]){case"android":o.b.android&&(this.disableAll=!0);break;case"iOS":o.b.iOS&&(this.disableAll=!0)}i.autoHideTime||(i.autoHideTime=1.9);this.type=i.type?i.type:"vertical";this.setSelfElementObject("volumeLayout");this.setSelfElementObject("muteToggleBtn");this.setSelfElementObject("volumeBackground");this.setSelfElementObject("volumeForeground");this.setSelfElementObject("volumeHandler");this.setSelfElementObject("volumeSlider");this.setSelfElementObject("volumeSliderLayout");this.init()}}o.extendClass(e,n,{isDisableVolume:function(){var e,t=this.attr;if(t.disableVolume)for(e in t.disableVolume)switch(t.disableVolume[e]){case"android":if(o.b.android)return!0;break;case"iOS":if(o.b.iOS)return!0}return!1},onAddEvent:function(){var e=this.p,t=this.muteToggleBtn,i=this.volumeBackground,n=this.volumeHandler,r=this.volumeLayout,s=this.volumeSliderLayout,a=this;this.layoutMod=e.module("layout");this.disableAll&&this.volumeLayout&&this.volumeLayout.hide();this.isDisableVolume()&&this.volumeSliderLayout&&o.remove(this.volumeSliderLayout.element);if(r){r.on("mouseover",function(e){return a.onMouseOverLayout(e)});r.on("mouseout",function(e){return a.onMouseOutLayout(e)})}if(t){t.on("click",function(e){return a.onClickVolumeButton(e)});t.on("mouseover",function(e){return a.onMouseOverMuteToggleBtn()})}if(n&&i){n.on("mouseover",function(e){a.mouseoverHandler(e)});n.on("mouseout",function(e){a.mouseoutHandler(e)});n.on("mousedown",function(e){a.mousedownHandler(e)});o.on(document,"mouseup",function(e){a.mouseupHandler(e)});o.on(document,"mousemove",function(e){a.mousemoveHandler(e)});n.on("touchstart",function(e){a.onTouchStartHandler(e)});n.on("touchmove",function(e){a.onTouchMoveHandler(e)});n.on("touchend",function(e){a.onTouchEndHandler(e)})}s&&s.on("click",function(e){a.selectVolume(e);return o.igEventAll(e)})},isMouseOutLayoutConfig:function(){var e=this.attr.isMouseOutLayout;return!0===e||!1!==e&&(1===e?1:!!e&&e.apply(this))},onMouseOverLayout:function(e){this.isMouseOverVolumeLayout=!0},onMouseOutLayout:function(e){this.isMouseOverVolumeLayout=!1},onMouseOverMuteToggleBtn:function(){this.attr.disableMouseOver||this.showSlider()},setDisableMouseOver:function(e){this.attr.disableMouseOver=e},onStateChange:function(e){switch(e.type){case g.EVENT.VOLUME_CHANGE:if(this.isDownVolumeHandler||this.isTouchVolumeHandler)return;var t=this.volumeSliderLayout;if(!0===this.attr.enableAutoControl){var i,n=this.p.device(),r=this.layoutMod;if(!n||!(i=n.deviceInstance()))return this.p.error("Not found device and device object on volume change");if(i.__isCompleteInitVolume){if(!i.__isCompleteInitMute){if(i.__isSetInitMute){i.__isCompleteInitMute=!0;if(r&&r.isShowedControl){r.currentShowControl=(new Date).getTime();this.drawVolume(e.data.volume,e.data.muted)}return}if(t&&t.isHide()||this.isVertical()&&!this.isShowSlider)return}}else{i.__isSetInitVolume&&(i.__isCompleteInitVolume=!0);if(t&&t.isHide()||this.isVertical()&&!this.isShowSlider)return}r&&(r.isShowedControl?r.currentShowControl=(new Date).getTime():r.showControl());if(t)return this.showSlider()}t&&t.isHide()?this.drawVolume(this.p.getVolume(),this.p.isMuted()):this.showSlider();break;case g.EVENT.CONTROL_EVENT:if("show"==e.data){if(this.isDownVolumeHandler||this.isTouchVolumeHandler)return;this.drawVolume(this.p.getVolume(),this.p.isMuted())}break;case g.EVENT.FULLSCREEN_CHANGE:this.isAutoHide()&&this.hideSlider()}},onClickVolumeButton:function(e){this.isShowSlider||this.isDisableVolume()?this.p.toggleMute():this.showSlider()},isVertical:function(){return"vertical"==this.type},isAutoHide:function(){return!(!this.isVertical()&&!this.attr.autoHide)},setVertical:function(){this.type="vertical";this.init()},setHorizontal:function(e){this.type="horizontal";this.attr.autoHide=!1!==e;this.init()},init:function(){var e;if(e=this.volumeLayout){if(this.isVertical()){e.addClass("mpv-up-vertical");e.removeClass("mpv-horizontal")}else{e.removeClass("mpv-up-vertical");e.addClass("mpv-horizontal")}this.isAutoHide()&&this.hideSlider()}},selectVolume:function(e){var t,i,n,r=this.p,s=this.volumeBackground,a=s&&s.rect(),o=e.clientX,l=e.clientY,u=r.isMuted();this.isVertical()?(t=a.height()-(l-a.top),i=a.height()):(t=o-a.left,i=a.width());(n=Math.floor(t/i*100))<g.MIN_VOLUME?n=g.MIN_VOLUME:100<n&&(n=100);if(n<=g.MIN_VOLUME)u||r.mute();else{u&&r.unMute();r.getVolume()!=n&&r.setVolume(n)}},completeHandler:function(e){this.isDownVolumeHandler=!1;this.isTouchVolumeHandler=!1;o.off(document,"selectstart",t)},mouseoverHandler:function(e){this.isVertical()&&this.setIsShowSlider()},mouseoutHandler:function(e){},mousedownHandler:function(e){this.isVertical()&&this.setIsShowSlider();this.isDownVolumeHandler=!0;o.on(document,"selectstart",t)},mouseupHandler:function(e){return this.completeHandler(e)},mousemoveHandler:function(e){var t,i,n,r,s=this.p,a=this.muteToggleBtn,o=this.volumeBackground,l=(this.volumeForeground,this.volumeHandler,this.volumeSliderLayout),u={x:e.clientX,y:e.clientY};if(this.isDownVolumeHandler||this.isTouchVolumeHandler){e.dataTransfer&&(e.dataTransfer.effectAllowed="pointer");if(this.isVertical())i=(t=o.rect()).height()-(u.y-t.top),n=t.height(),r=Math.floor(i/n*100);else{t=o.rect();i=u.x-t.left,n=t.width(),r=Math.floor(i/n*100)}r<g.MIN_VOLUME?r=g.MIN_VOLUME:100<r&&(r=100);var c=r<=g.MIN_VOLUME,h=s.isMuted(),d=s.getVolume();this.setIsShowSlider();c!==h&&(c?s.mute():s.unMute());c||d==r||s.setVolume(r);this.drawVolume(r,c)}else if(this.isShowSlider){var f=l.rect().contains(u),p=a.rect().contains(u),m=this.isMouseOutLayoutConfig();if(null===this.sliderType)f?this.sliderType=1:p||!0!==m||this.hideSlider({isMouseOut:!0});else if(1===this.sliderType&&!f){this.sliderType=null;m&&this.hideSlider({isMouseOut:!0})}}},onTouchStartHandler:function(e){o.on(document,"selectstart",t);e.dataTransfer&&(e.dataTransfer.effectAllowed="pointer");this.isTouchVolumeHandler=!0},onTouchMoveHandler:function(e){var t=e.changedTouches;if(t.length){var i=t[0],n={x:i.pageX,y:i.pageY};this.mousemoveHandler(n)}},onTouchEndHandler:function(e){return this.completeHandler(e)},onTouchCancelHandler:function(e){},setIsShowSlider:function(){this.isShowSlider=(new Date).getTime();this.layoutMod&&(this.layoutMod.currentShowControl=(new Date).getTime())},clearIsShowSlider:function(){this.isShowSlider=0},drawVolume:function(e,t){var i,n=t?0:e,r=this.volumeSliderLayout,s=this.volumeBackground,a=this.volumeForeground,o=this.volumeHandler,l=this.muteToggleBtn,u=s&&s.rect();if(u&&u.width()&&u.height()&&a&&o){r&&r.isShow()&&this.setIsShowSlider();if(this.isVertical()){i=Math.floor(u.height()*(n/100));var c=o.rect(),h=u.height()-i;a.element.style.width="";a.element.style.height=i+"px";a.element.style.top=h+"px";if(o){o.element.style.top=h-c.height()/2+"px";o.element.style.left=""}}else{i=Math.floor(u.width()*(n/100));a.element.style.top="";a.element.style.height="";a.element.style.width=(t?0:n)+"%";if(o){o.element.style.top="";o.element.style.left=(t?0:n)+"%"}}}if(l)if(t){l.addClass("mpv-muted");l.removeClass("mpv-unmuted")}else{l.removeClass("mpv-muted");l.addClass("mpv-unmuted")}},showSlider:function(){var e=this.p.getVolume(),t=this.p.isMuted();function i(){if(this.showSliderTimer){window.clearInterval(this.showSliderTimer);this.showSliderTimer=null}}var n=this,r=this.volumeSliderLayout,s=this.attr;if(r){r.show();this.drawVolume(e,t);this.setIsShowSlider();if(this.isAutoHide()){this.showSliderTimer&&i.call(this);this.showSliderTimer=setInterval(function(){if(o.b.isMobile||!n.isMouseOverVolumeLayout){var e=(new Date).getTime(),t=n.isShowSlider;if(!t)return i.call(this);if(e-t>1e3*s.autoHideTime){n.hideSlider();return i.call(this)}}},200)}}},hideSlider:function(e){var t=this.volumeSliderLayout;if(t){t.hide();this.clearIsShowSlider()}}});return e})}();!function(){"use strict";var f=getDframework(),p=f.module("imgtech.media.Media");f.define("imgtech.media.module.Size",function(){f.b.iOS&&f.b.ipad;var t=f.module("imgtech.media.ModuleInterface"),i=f.module("imgtech.media.Fullscreen");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("sizeToggleBtn");this.setSelfElementObject("fullscreenToggleBtn");this.setSelfElementObject("popupToggleBtn");this.fs=new i(this.attr,this.p);this.saveheight=null;this.sizeToggleBtn&&(this.p.width&&1<this.p.width.length||this.sizeToggleBtn.hide())}}f.extendClass(e,t,{onOrientationChange:function(e){},ignoreFullscreen:function(){var e=this.attr;if(!0===e.ignoreFullscreen)return!0;try{if(e.ignoreFullscreen.apply(this))return!0}catch(i){}var t=this.p.module("layout");return!(!t||!t.ignoreFullscreenAll())},onAddEvent:function(){var t=this,e=(this.attr,this.sizeToggleBtn),i=this.p,n=this.p.userElement,r=this.fullscreenToggleBtn;e&&e.on("click",function(){t.next()});if(n){if(f.b.firefox)f.on(document,"mozfullscreenchange",function(e){t.setOnFullscreenChange(e)});else if(f.b.ie)f.on(document,"MSFullscreenChange",function(e){t.setOnFullscreenChange(e)});else{f.on(n,"fullscreenchange",function(e){t.setOnFullscreenChange(e)});f.on(n,"webkitfullscreenchange",function(e){t.setOnFullscreenChange(e)});f.on(n,"ofullscreenchange",function(e){t.setOnFullscreenChange(e)})}this.fs.fullscreenchange=function(e){t.setOnFullscreenChange(e)}}r&&r.on("click",function(e){t.ignoreFullscreen()||i.toggleFullscreen()});f.b.isMobile&&f.on(window,"orientationchange",function(e){t.onOrientationChange(e)})},onStateChange:function(e){var t,i,n,r,s=this.sizeToggleBtn,a=(this.fullscreenToggleBtn,this.p.userElement),o=this.p;switch(e.type){case p.EVENT.ON_SYNC:o.sendSizeChange();break;case p.EVENT.STATE_CHANGE:s&&e.data==p.STATE.SETSOURCE&&(1<o.width.length||1<o.height.length?s&&s.show():s&&s.hide());break;case p.EVENT.RESIZE_WINDOW:this.fs.windowSize();this.isFullscreen()?this.fs.resizeWindow(a):(r=this.p.currentMediaSource())&&r.input.autoHeight&&r.input.autoHeightResizeable&&p.AutoHeight.call(this.p,this.p.getVideoSize());break;case p.EVENT.SET_SIZE:if(a){t=e.data.width,i=e.data.height,n=e.data.index;t&&("wide"==t?this.p.error("This is deprecate. Use wide module."):a.style.width=p.getStyleNumberValue(t));i&&(a.style.height=p.getStyleNumberValue(i));if(-1!=n&&s){if(o.attr.width.length)for(var l=0;l<o.attr.width.length;l++)s.removeClass("mpv-sel"+l);s.addClass("mpv-sel"+n)}o.sendSizeChange()}break;case p.EVENT.VIDEO_SIZE_DATA:(r=this.p.currentMediaSource())&&r.input.autoHeight&&p.AutoHeight.call(this.p,e.data);break;case p.EVENT.SIZE_CHANGE:this.setSizeClass();break;case p.EVENT.SET_FULLSCREEN:this.setFullscreen(e);break;case p.EVENT.EXIT_FULLSCREEN:this.exitFullscreen();break;case p.EVENT.FULLSCREEN_CHANGE:if(e.data){f.removeClass(a,"mpv-normalscreen");f.addClass(a,"mpv-fullscreen")}else{f.removeClass(a,"mpv-fullscreen");f.removeClass(a,"mpv-real-fullscreen");f.addClass(a,"mpv-normalscreen");var u,c,h=this.fs_fullscreen_saved,d=h&&h.element;this.fs_fullscreen_saved&&(this.fs_fullscreen_saved=null);if(!(u=d&&d.width)||!(c=d&&d.height))throw new Error("exit fullscreen change : Not found old size !!!");o.setSize(u,c)}if(f.b.ie&&this._beforeFullscreenHasReplaceElement)if(e.data)this._beforeFullscreenIsPlaying&&(this.p.isPlaying()||this.p.play());else{this._beforeFullscreenIsPlaying&&(this.p.isPlaying()||this.p.play());this._beforeFullscreenHasReplaceElement=!1}}},isReplaceElement:function(){return this.fs.isReplaceElement()},setSizeClass:function(){var e=this.attr,t=this.p.userElement,i=f.getBoundingClientRect(t),n="mpv-wsize-",r="mpv-wsize-no-",s=[200,300,500,600,700,800,1024],a=i?i.width():0;e.classList&&e.classList.length&&(s=e.classList);for(var o=0;o<s.length;o++)if(s[o]<=a){f.addClass(t,n+s[o]);f.removeClass(t,r+s[o])}else{f.addClass(t,r+s[o]);f.removeClass(t,n+s[o])}},next:function(){var e=this.p,t=e.sizeIndex;t=e.width.length-1==t?e.sizeIndex=0:++e.sizeIndex;e.setSize(e.width[t],e.height[t],t)},exitFullscreen:function(){if(!this.p.isNativePlayer()){if(this.ignoreFullscreen())return f.warn("ignore fullscreen.");if(this.isLockFullscreen)throw new Error("Lock fullscreen");this.isFullscreen()&&(this._exit()?this.__exit_real_fullscreen=!0:this.sendFullscreenChangeEvent(!1));var e,t=this;(e=this.p.currentMediaSource())&&e.input.autoHeight&&e.input.autoHeightResizeable&&setTimeout(function(){p.AutoHeight.call(t.p,t.p.getVideoSize())},1)}},_exit:function(e){if(this.p.isNativePlayer())return f.warn("This is native player on exited fullscreen.");var t,i=this.p.isPlaying();if(!this.fs.enableExit()&&(t=this.p.device())&&"flash"===t.getPlayerType()&&this.isReplaceElement())return f.error(" ## Not support exitFullscreen (fullscreenReplaceElement) on flash player in IE");if(f.b.ie&&this.fs.hasReplaceElement){this._beforeFullscreenHasReplaceElement=!0;this._beforeFullscreenIsPlaying=i}var n=this.fs.exit(e);try{this.p.module("app").exitFullscreen()}catch(s){}var r=this.p.targetElement();r!==this.p.userElement&&(this.p.isNativePlayer()||r.removeAttribute("controls"));return n},setFullscreen:function(e){if(this.p.isNativePlayer())return f.warn("This is native player. so not goto fullscreen");if(this.ignoreFullscreen())return f.warn("ignore fullscreen.");if(this.isLockFullscreen)throw new Error("Lock fullscreen");if(!this.isFullscreen()){var t,i=this.p.targetElement(),n=e?e.data:null,r=this.p.isPlaying();if(this.p.isNativeFullscreen()){var s;if((t=this.p.device())&&(s=t.deviceInstance())&&(i=s.zonemediaelement)){if(i.webkitEnterFullscreen)return i.webkitEnterFullscreen();if(i.enterFullscreen)return i.enterFullscreen()}return}this.__exit_real_fullscreen=!1;if(!this.fs.enable(i,!!(n||window.event||f.b.firefox)&&n)&&(t=this.p.device())&&"flash"===t.getPlayerType()&&this.isReplaceElement())return f.error(" ## Not support fullscreen (fullscreenReplaceElement) on flash player");if(f.b.ie&&this.isReplaceElement()){this._beforeFullscreenHasReplaceElement=!1;this._beforeFullscreenIsPlaying=r}try{this.p.module("app").useVirtualScreen()&&(n=!1)}catch(l){}var a=this.fs.fullscreen(i,n);try{this.p.module("app").fullscreen()}catch(l){}this.fs_fullscreen_saved=this.fs.saved;f.b.ie&&this.isReplaceElement()&&this.fs.hasReplaceElement&&(this._beforeFullscreenHasReplaceElement=!0);a||this.sendFullscreenChangeEvent(!0);var o=this.p.targetElement();o!==this.p.userElement&&o.setAttribute("controls","true")}},lockFullscreen:function(e){this.isLockFullscreen=e},isFullscreen:function(){return this.fs.isFullscreen()},isWindowFullscreen:function(){return this.fs.isWindowFullscreen(this.p.targetElement())},sendFullscreenChangeEvent:function(e){this.p.callStateChange({type:p.EVENT.FULLSCREEN_CHANGE,data:e})},setOnFullscreenChange:function(e){if(!this.p.isNativePlayer()){var t=e.target||e.srcElement,i=this.p.targetElement();if(t!==i){if(!f.b.ie)return this.p.warn("This not zonehtml5mediaplayer fullscreen.",e);if(this.fs.realElement!==i)return this.p.warn("This not real fullscreen.",e)}if(this.fs.isRealFullscreen())return this.sendFullscreenChangeEvent(!0);this.__exit_real_fullscreen||this._exit(!0);return this.sendFullscreenChangeEvent(!1)}}});return e})}();!function(){"use strict";var o=getDframework(),n=o.module("imgtech.media.Media");o.define("imgtech.media.module.Wide",function(){var t=o.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.setSelfElementObject("wideBtn");this.savedHeight=null;this.state="normal"}}o.extendClass(e,t,{onAddEvent:function(){var e=this,t=this.wideBtn;t&&t.on("click",function(){e.toggle()})},onStateChange:function(e){},isWide:function(){return!this.wideBtn.hasClass("mpv-sel0")},wide:function(){var e=this.wideBtn,a=(this.device,this.p.userElement),t=this.attr,i=this;if(e){this.state="wide";e.removeClass("mpv-sel0");e.addClass("mpv-sel1");o.addClass(a,"mpv-wide-screen");this.savedHeight=a.style.height;"auto"==t.height?setTimeout(function(){(function(){var e=this.p.module("layout"),t=o.getBoundingClientRect(a).width(),i=this.p.getVideoSize(),n=t*i.height/i.width;if("wide"==this.state){if(e&&e.getSeparate()){var r=this.p.element("bottom"),s=r?r.rect():null;n+=s?s.height():0}a.style.height=n+"px"}}).call(i)},1):a.style.height=t.height+"px";setTimeout(function(){i.p.callStateChange({type:n.EVENT.WIDE_CHANGE,data:i.state})},1)}},normal:function(){var e=this.wideBtn,t=this.p.userElement,i=(this.attr,this);if(e){this.state="normal";e.removeClass("mpv-sel1");e.addClass("mpv-sel0");o.removeClass(t,"mpv-wide-screen");if(null!==this.savedHeight){t.style.height=this.savedHeight;this.savedHeight=null}setTimeout(function(){i.p.callStateChange({type:n.EVENT.WIDE_CHANGE,data:i.state})},1)}},toggle:function(){this.isWide()?this.normal():this.wide()}});return e})}();!function(){"use strict";var l=getDframework(),c=l.module("imgtech.media.Media");function n(e){return l.igEventAll(e)}l.define("imgtech.media.module.Progress",function(){var i=l.module("imgtech.media.ModuleInterface");function e(e){i.apply(this,arguments);if(e){var t=this.attr;this.setSelfElementObject("control");this.setSelfElementObject("osd");this.setSelfElementObject("progress");this.setSelfElementObject("totalProgress");this.setSelfElementObject("bufferProgress");this.setSelfElementObject("currentProgress");this.setSelfElementObject("timeLayout");this.setSelfElementObject("currentTimeText");this.setSelfElementObject("durationText");this.setSelfElementObject("progressHandler");this.setSelfElementObject("previousSkipBtn");this.setSelfElementObject("nextSkipBtn");this.setSelfElementObject("skipInput");this.repMod=null;this.seekable=!0;this.isDownProgressHandler=!1;this.isTouchProgressHandler=!1;if(this.skipInput)if(!t.skipInputValue||!1!==t.skipInputIgnoreMobile&&(this.p.module("app").isMobileApp()||l.b.isMobile))this.skipInput.hide();else{this.setSkipDepth(t.skipInputValue);this.skipInput.show()}!function(t){var e=t.progress,i=e?e.element:null,n=i?i.getAttribute("seekable"):"true",r=typeof n,s="string"==r?n.toLowerCase():"boolean"!=r||n,a=!0===s||!1===s?s:"false"!=s;t.self_onseekto=function(e){return t.onSeekTo(e)};t.setSeekable(a)}(this)}}l.extendClass(e,i,{onAddEvent:function(){this.repMod=this.p.module("repeat");this.layoutMod=this.p.module("layout");var t=this,e=(this.control,this.osd,this.progress,this.totalProgress),i=(this.bufferProgress,this.currentProgress,this.progressHandler),n=this.previousSkipBtn,r=this.nextSkipBtn;if(e&&i){this.self_mouseuphandler=function(e){return t.onMouseUpHandler(e)};l.on(document.body,"mousemove",function(e){return t.onMouseMoveHandler(e)});l.on(document.body,"mouseup",this.self_mouseuphandler)}if(i){i.on("mousedown",function(e){return t.onMouseDownHandler(e)});i.on("touchstart",function(e){return t.onTouchStartHandler(e)});i.on("touchmove",function(e){return t.onTouchMoveHandler(e)});i.on("touchend",function(e){return t.onTouchEndHandler(e)})}n&&n.on("click",function(){return t.previousSkip()});r&&r.on("click",function(){return t.nextSkip()})},setSkipDepth:function(e){this.skipInput&&(this.skipInput.element.value=e);this.attr.skipDepth=e},getSkipDepth:function(){var e,t=10;if(this.skipInput)try{(e=parseInt(this.skipInput.element.value+""))&&(t=e)}catch(i){}else if(this.attr.skipDepth)return this.attr.skipDepth;return t},repairSkipValue:function(e){var t=this.getSkipDepth(),i=this.p,n=this.repMod,r=i.currentTime();if(0===r||r){0<e?r+=t:e<0&&(r-=t);r<0&&(r=0);n&&!n.enableSeekTo(r)&&(r=n.getEnableValue(r));return r}return!1},nextSkip:function(){var e=this.repairSkipValue(1);!1!==e&&this.p.seekTo(e)},previousSkip:function(){var e=this.repairSkipValue(-1);!1!==e&&this.p.seekTo(e)},onStateChange:function(e){var t,i,n,r=e.data,s=(this.totalProgress,this.currentProgress,this.bufferProgress,this.progressHandler,this.currentTimeText),a=this.durationText;switch(e.type){case c.EVENT.RESET:s&&s.innerText("00:00");a&&a.innerText("00:00");break;case c.EVENT.STATE_CHANGE:if(r==c.STATE.SETSOURCE){a&&a.innerText(c.secondsToString(0));this.updateProgressBar(0,0)}break;case c.EVENT.DURATION_CHANGE:a&&a.innerText(c.secondsToString(r.duration));break;case c.EVENT.CURRENT_TIME_CHANGE:var o=this.c.m.size;o&&o.checkResizePlayer&&setTimeout(function(){o.checkResizePlayer()},1);if(this.isDownProgressHandler||this.isTouchProgressHandler)return;t=this.repMod,i=r.currentTime;t.repaireCurrentTime(i);if(t.enableSeekTo(i)){this.updateProgressBar(i,r.duration);this.__safedStartValue=null}else{if(i>=t.endValue()&&!t.isRepeat())return this.p.stop();var l,u=t.startValue();this.__safedStartValue?this.__safedStartValue++:this.__safedStartValue=1;l=u+this.__safedStartValue;this.seekTo(l)}break;case c.EVENT.WATCH_TIME_CHANGE:break;case c.EVENT.BUFFERING_CHANGE:this.updateBufferingBar(e.data);break;case c.EVENT.SEEKTO_MEDIA:t=this.repMod;if(!(n=this.p.device()))return this.p.error("Not found device.");if(t&&!t.enableSeekTo(r.value)){this.p.error("Not enabled seekTo by repeat module.");return t.attr.repeatWatchTimeSeekable?n.seekTo(t.endValue()):n.seekTo(t.startValue())}n.seekTo(r.value,r.seconds);break;case c.EVENT.CONTROL_EVENT:"show"==e.data&&this.redraw();break;case c.EVENT.SIZE_CHANGE:case c.EVENT.RESIZE_WINDOW:this.redraw()}},redraw:function(){var e=this.p,t=this;setTimeout(function(){t.updateProgressBar(e.currentTime(),e.duration());t.updateBufferingBar(e.getBuffering())},1)},isSeekable:function(){if(!1===this.seekable)return!1;var e=this.p.currentMediaSource(),t=e&&e.input;return!t||!t.disableSeekable},setSeekable:function(e){var t=this.progress,i=this.totalProgress;if(this.seekable=e){t&&t.on("click",this.self_onseekto);i&&i.on("click",this.self_onseekto)}else{t&&t.off("click",this.self_onseekto);i&&i.off("click",this.self_onseekto)}},updateRepeat:function(){var e=this.p.currentTime(),t=this.repMod;t.enableSeekTo(e)||this.seekTo(t.startValue())},updateBufferingBar:function(e){var t,i=e,n=this.totalProgress,r=(this.currentProgress,this.bufferProgress);if(n&&r){t=n.rect().width()*i;r.element.style.width=t+"px"}},updateProgressBar:function(e,t){var i,n,r=t?e/t*100:0,s=this.totalProgress,a=this.currentProgress,o=this.progressHandler,l=this.currentTimeText;if(s&&a){i=s.rect();n=t?Math.floor(i.width()*(e/t)):0;a.element.style.width=n+"px"}l&&l.innerText(c.secondsToString(e));i&&o&&(o.element.style.left=r*i.width()/100+"px")},onSeekTo:function(e,t){if(this.isSeekable()){var i=this.totalProgress,n=i?i.rect():null,r=n?n.width():0,s={x:e.clientX,y:e.clientY};if(r){if(s.x<n.left-10||s.x>n.right+10||s.y<n.top-10||s.y>n.bottom+10)return;var a=this.p,o=((s.x<n.left?n.left:s.x>n.right?n.right:s.x)-n.left)/r*a.duration();this.seekTo(o)}}return l.igEventAll(e)},drawSeekHandler:function(e){var t=this.progressHandler,i=this.totalProgress,n=this.currentProgress,r=i&&i.rect(),s=e.x-r.left,a=r.width();a<s?s=a:s<0&&(s=0);this.layoutMod&&(this.layoutMod.currentShowControl=(new Date).getTime());var o=this.pixelToTime(s),l=this.repMod;if(l&&!l.enableSeekTo(o))!1!==(o=l.getEnableValue(o))&&this.updateProgressBar(o,this.p.duration());else{n&&(n.element.style.width=s+"px");t&&(t.element.style.left=s+"px")}},onMouseMoveHandler:function(e){var t=this.progressHandler;this.isSeekable()&&this.isDownProgressHandler&&t&&this.drawSeekHandler({x:e.clientX,y:e.clientY})},pixelToTime:function(e){var t=this.totalProgress.rect(),i=t?t.width():0,n=this.p.duration();return!!t&&(i?e/i*n:0)},seekTo:function(e){var t=this.repMod,i=this.p;if(t&&!t.enableSeekTo(e)){if(!1===(e=t.getEnableValue(e)))return;this.updateProgressBar(e,i.duration())}i.seekTo(e)},setIsDownProgressHandler:function(){this.isDownProgressHandler=!0},clearIsDownProgressHandler:function(){this.isDownProgressHandler=!1},setIsTouchProgressHandler:function(){this.isTouchProgressHandler=!0},clearIsTouchProgressHandler:function(){this.isTouchProgressHandler=!1},onCompleteHandler:function(){if(this.isSeekable()&&(this.isDownProgressHandler||this.isTouchProgressHandler)){var e=this.progressHandler;if(e){var t=this.pixelToTime(parseFloat(e.element.style.left));!1!==t&&this.seekTo(t)}}this.clearIsDownProgressHandler();this.clearIsTouchProgressHandler();l.off(document,"selectstart",n)},onMouseDownHandler:function(e){if(this.isSeekable()){l.on(document,"selectstart",n);this.setIsDownProgressHandler()}},onMouseUpHandler:function(e){if(this.isDownProgressHandler)return this.onCompleteHandler()},onMouseOutHandler:function(e){},onTouchStartHandler:function(e){if(this.isSeekable()){l.on(document,"selectstart",n);this.setIsTouchProgressHandler()}},onTouchMoveHandler:function(e){var t=e.changedTouches,i=this.progressHandler;if(this.isSeekable()&&this.isTouchProgressHandler&&t.length&&i){var n=t[0];this.drawSeekHandler({x:n.pageX,y:n.pageY})}},onTouchEndHandler:function(e){return this.onCompleteHandler()},onTouchCancelHandler:function(e){}});return e})}();!function(){"use strict";var m=getDframework(),i=m.module("imgtech.media.Media");m.define("imgtech.media.module.Repeat",function(){var r=m.module("imgtech.media.ModuleInterface"),n=m.module("imgtech.media.module.Moveable");function s(e){function t(e){e&&(e.hasClass("mpv-repeat-on")||e.hasClass("mpv-repeat-off")||e.addClass("mpv-repeat-off"))}r.apply(this,arguments);if(e){var i=this,n=this.attr;this.setSelfElementObject("totalProgress");this.setSelfElementObject("bufferProgress");this.setSelfElementObject("currentProgress");this.setSelfElementObject("repeatBtn");this.setSelfElementObject("repeatStart");this.setSelfElementObject("repeatEnd");this.setSelfElementObject("exctrlRepeatBtn");n.depthSeconds||(n.depthSeconds=5);this.init();if(this.totalProgress){t(this.repeatBtn);t(this.exctrlRepeatBtn);this.setIsShowRepeatMarker(!1);this.updateMarker()}n.unused&&this.hideButton();m.on(window,"scroll",function(e){i.onScroll(e)})}}s.EVENT={SHOW:"repeat-toggle",CHANGE_MIN:"repeat-change-min",CHANGE_MAX:"repeat-change-max",DEPTH_SECONDS_2:"repeat-depth_seconds_2",IS_LOGIN:"repeat-is-login"};m.extendClass(s,r,{EVENT:s.EVENT,setIsShowRepeatMarker:function(e){var i=this.repeatBtn,n=this.exctrlRepeatBtn;function t(t){function e(e){e&&e.addClass(t)}e(i);e(n)}!function(){function e(e,t){e&&e.removeClass(t)}e(i,"on off on1 on2");e(n,"on off on1 on2")}();!0===(this.isShowRepeatMarker=e)?t("on"):!1===e?t("off"):1==e?t("on1"):2==e&&t("on2")},init:function(){var t=this,e=this.totalProgress,i=e&&e.element;this.__isUsed=!1;this.__isDuration=!1;this.lastDuration=0;this.setIsShowRepeatMarker(!1);this.minValue=0;this.maxValue=0;if(this.startMoveable)this.startMoveable.init();else if(this.repeatStart){this.startMoveable=new n(this,this.repeatStart.element);this.startMoveable.setOuterElement(i);this.startMoveable.setChangeListener(function(e){return t.changeStartPoint(e)});this.repeatStart.hide()}if(this.endMoveable)this.endMoveable.init();else if(this.repeatEnd){this.endMoveable=new n(this,this.repeatEnd.element);this.endMoveable.setOuterElement(i);this.endMoveable.setChangeListener(function(e){return t.changeEndPoint(e)});this.repeatEnd.hide()}},onAddEvent:function(){var n=this;this.progressMod=this.p.module("progress");function e(e){e&&e.on("click",function(e){var t,i=!0;if(n.attr.isLogin&&!0!==(t=n.attr.isLogin())){i=!1;n.p.callStateChange({type:s.EVENT.IS_LOGIN,data:t})}!1!==i&&n.toggle();return m.igEventAll(e)})}e(this.repeatBtn);e(this.exctrlRepeatBtn)},onStateChange:function(e){var t=this;switch(e.type){case i.EVENT.STATE_CHANGE:if(e.data==i.STATE.SETSOURCE){this.init();this.currentProgress&&m.ui.show(this.currentProgress.element);this.bufferProgress&&m.ui.show(this.bufferProgress.element);this.updateMarker(!0)}break;case i.EVENT.DURATION_CHANGE:e.data.duration&&(this.__isDuration=!0);this.setDuration(e.data.duration);break;case i.EVENT.CONTROL_EVENT:"show"==e.data&&this.drawMarker();break;case i.EVENT.SIZE_CHANGE:case i.EVENT.RESIZE_WINDOW:this.drawMarker();break;case i.EVENT.FULLSCREEN_CHANGE:setTimeout(function(){t.drawMarker()},1);break;case s.EVENT.SHOW:if(e.data){this.setIsShowRepeatMarker(e.data);1===e.data?this.min(e.ctime?e.ctime:0):2===e.data&&this.max(e.ctime?e.ctime:0)}else this.setIsShowRepeatMarker(!1);this.updateMarker(!0)}},onScroll:function(){this.drawMarker()},toggle:function(e){var t=this.isShowRepeatMarker;if(2===t||!0===t)this.hide();else if(1===t)this.show(e);else{this.show(e);if(!this.__isUsed||this.attr.alwaysCurrentTime){this.__isUsed=!0;this.min(this.p.currentTime())}}},show:function(e){var t=!0,i=null,n=this.limitSeconds();if(!e&&2===this.attr.type)if(!1===this.isShowRepeatMarker){t=1;i=this.p.currentTime()}else{t=2;i=this.p.currentTime();if(!0!==this.attr.ignoreDepth&&this.minValue+this.attr.depthSeconds>i)return this.p.callStateChange({type:s.EVENT.DEPTH_SECONDS_2,data:t,ctime:i,limitTime:n})}this.p.callStateChange({type:s.EVENT.SHOW,data:t,ctime:i})},hide:function(){this.p.callStateChange({type:s.EVENT.SHOW,data:!1})},min:function(e){var t=this.startMoveable,i=this.endMoveable,n=this.limitSeconds();if(t&&i){var r=e+n<i.value?e:i.value-n;this.minValue=r;i.setMin(r);t.setValue(r);this.drawMarker();this.p.callStateChange({type:s.EVENT.CHANGE_MIN,data:r});return r}},max:function(e){var t=this.startMoveable,i=this.endMoveable,n=this.limitSeconds();if(t&&i){var r=e-n>t.value?e:t.value+n;this.maxValue=r;t.setMax(r);i.setValue(r);this.drawMarker();this.p.callStateChange({type:s.EVENT.CHANGE_MAX,data:r});return r}},drawMarker:function(){this.isShowRepeatMarker&&this.__drawMarker()},__drawMarker:function(e){var t,i,n,r,s=this,a=this.startMoveable,o=this.endMoveable,l=this.isShowRepeatMarker;a&&a.draw();2!==l&&!0!==l||o&&o.draw();if(this.attr.progressUi&&(i=this.bufferProgress)&&(n=i.element)&&(r=this.totalProgress&&this.totalProgress.element)){var u=m.getBoundingClientRect(r);if(u&&(u.width()||u.height())){this.currentProgress&&m.ui.hide(this.currentProgress.element);this.bufferProgress&&m.ui.hide(this.bufferProgress.element);if(2===l||!0===l){if(!(t=this.__progressUi)){t=this.__progressUi=document.createElement("div");m.addClass(t,"mpv-repeat-progressbar");m.addClass(t,"mpv-progressbar");m.after(n,t)}var c=a.value,h=o.value;if((0===c||c)&&h){var d=a.mineElement.style.left,f=o.mineElement.style.left,p=parseInt(f)-parseInt(d);t.style.left=d;t.style.width=p+"px"}}}else setTimeout(function(){s.__drawMarker(!0)},100)}},setDuration:function(e){var t=this.startMoveable,i=this.endMoveable,n=this.p.currentMediaSource(),r=n&&n.input;this.lastDuration=e;this.sourceAttr=null;if(t&&i){t.setFixed(!1);t.setMin(0);t.setMax(e);t.setTotal(e);t.setValue(0);this.minValue=0;i.setFixed(!1);i.setMin(0);i.setMax(e);i.setTotal(e);i.setValue(e);this.maxValue=e;if(r){var s=!1,a=!1;0===r.repeatEnd&&(r.repeatEnd=1);if(0===r.repeatStart||r.repeatStart){s=!0;this.min(r.repeatStart)}if(r.repeatEnd){a=!0;this.max(r.repeatEnd)}if(r.repeatFix){t.setFixed(!0);i.setFixed(!0)}if(s&&a){this.setIsShowRepeatMarker(!0);this.updateMarker(!0)}}}},updateMarker:function(e){var t=this.repeatStart,i=this.repeatEnd;function n(e){if(e){e.removeClass("mpv-repeat-on");e.removeClass("mpv-repeat-on1");e.removeClass("mpv-repeat-off")}}function r(e){e&&e.addClass("mpv-repeat-on")}function s(e){e&&e.addClass("mpv-repeat-on1")}function a(e){e&&e.addClass("mpv-repeat-off")}if(t&&i){n(this.repeatBtn);n(this.exctrlRepeatBtn);if(1===this.isShowRepeatMarker){this.max(this.lastDuration);t.show();s(this.repeatBtn);s(this.exctrlRepeatBtn)}else if(2===this.isShowRepeatMarker){i.show();r(this.repeatBtn);r(this.exctrlRepeatBtn)}else if(!0===this.isShowRepeatMarker){t.show();i.show();r(this.repeatBtn);r(this.exctrlRepeatBtn)}else{t.hide();i.hide();a(this.repeatBtn);a(this.exctrlRepeatBtn)}}e&&this.drawMarker()},changeDest:function(e,t){var i=this;if("down"==e.type||"touchstart"==e.type){this.oldProgressSeekable=this.progressMod.seekable;this.progressMod.setSeekable(!1)}else{if("up"==e.type||"touchend"==e.type){setTimeout(function(){i.progressMod.setSeekable(i.oldProgressSeekable);i.progressMod.updateRepeat()},1);return t.apply(this,arguments)}if("move"==e.type||"touchmove"==e.type)return t.apply(this,arguments)}},startValue:function(){return this.startMoveable.value},endValue:function(){return this.endMoveable.value},limitSeconds:function(){var e=this.totalProgress,t=e&&e.element,i=(this.startMoveable,this.endMoveable,this.repeatStart),n=(this.repeatEnd,t?m.getBoundingClientRect(t):null),r=i?i.rect():null,s=n?n.width():0,a=r?r.width()/2:0;return(a?a*this.p.duration()/s:0)+this.attr.depthSeconds},changeStartPoint:function(n){return this.changeDest(n,function(){this.startMoveable;var e=this.endMoveable,t=this.limitSeconds(),i=n.value+t<e.value?n.value:e.value-t;"up"!=n.type&&"touchend"!=n.type||(this.minValue=i);e.setMin(i);this.p.callStateChange({type:s.EVENT.CHANGE_MIN,data:i});return i})},changeEndPoint:function(n){return this.changeDest(n,function(){var e=this.startMoveable,t=(this.endMoveable,this.limitSeconds()),i=n.value-t>e.value?n.value:e.value+t;"up"!=n.type&&"touchend"!=n.type||(this.maxValue=i);e.setMax(i);this.p.callStateChange({type:s.EVENT.CHANGE_MAX,data:i});return i})},repaireCurrentTime:function(e){var t=this.p.currentMediaSource();if(t&&t.input&&t.input.repeatWatchTimeSeekable){this.endValue()<e&&this.max(e)}},enableSeekTo:function(e){var t=this.isShowRepeatMarker;if(1===t){if(this.minValue>e)return!1}else if(2===t||!0===t){if(this.minValue>e)return!1;if(this.maxValue<e)return!1}return!0},getEnableValue:function(e){var t=this.isShowRepeatMarker;if(1===t){if(this.minValue>e)return this.minValue}else if(2===t||!0===t){if(this.minValue>e)return this.minValue;if(this.maxValue<e)return this.maxValue}return e},enableRepeat:function(e){m.error("This is deprecate function !!!")},showButton:function(){this.repeatBtn&&this.repeatBtn.show();this.exctrlRepeatBtn&&this.exctrlRepeatBtn.show()},hideButton:function(){this.repeatBtn&&this.repeatBtn.hide();this.exctrlRepeatBtn&&this.exctrlRepeatBtn.hide()},isRepeat:function(e){(!e&&!1===e||e)&&(this.attr.isRepeat=e);var t=this.attr.isRepeat;return!(!t&&!1===t)}});return s})}();!function(){"use strict";var i=getDframework(),u=i.module("imgtech.media.Media");i.define("imgtech.media.module.Rate",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("rateLayout");this.setSelfElementObject("rateText");this.setSelfElementObject("rateUpBtn");this.setSelfElementObject("rateDownBtn");this.setSelfElementObject("exctrlPlusRateBtn");this.setSelfElementObject("exctrlMinusRateBtn");this.setSelfElementObject("exctrlCurrentRateText");this.initRateValue()}}i.extendClass(e,t,{onAddEvent:function(){var t=this.p;this.rateUpBtn&&this.rateUpBtn.on("click",function(){t.nextRate()});this.rateDownBtn&&this.rateDownBtn.on("click",function(){t.previousRate()});this.exctrlPlusRateBtn&&this.exctrlPlusRateBtn.on("click",function(e){t.nextRate();return i.igEventAll(e)});this.exctrlMinusRateBtn&&this.exctrlMinusRateBtn.on("click",function(e){t.previousRate();return i.igEventAll(e)})},onStateChange:function(e){var t,i=this.p,n=e.type,r=e.data;switch(n){case u.EVENT.ON_READY:break;case u.EVENT.STATE_CHANGE:e.data==u.STATE.SETSOURCE&&(!1!==this.attr.use&&(t=i.getAvailablePlaybackRates())&&t.length?this.showButton():!1!==this.attr.autohide&&this.hideButton());break;case u.EVENT.ON_BEFORE_PLAY:var s=i.getDefaultPlaybackRate();s&&this.updateRateView(s);break;case u.EVENT.SET_RATE:var a,o=i.getPlaybackRate(),l=i.getAvailablePlaybackRates();if(l)switch(r){case"increment":for(a=0;a<l.length;a++)if(o<l[a].value)return i.setPlaybackRate(l[a]);break;case"decrement":for(a=l.length-1;0<=a;a--)if(o>l[a].value)return i.setPlaybackRate(l[a])}break;case u.EVENT.RATE_CHANGE:this.updateRateView(r)}},addCallback:function(e){this.callbacks||(this.callbacks=[]);this.callbacks.push(e)},updateRateView:function(e){if(this.rateText||this.exctrlCurrentRateText){var t=(e.cvalue?e.cvalue:e.value)+"";this.rateText&&this.rateText.innerText(t);this.exctrlCurrentRateText&&this.exctrlCurrentRateText.innerText(t)}if(this.callbacks)for(var i=0;i<this.callbacks.length;i++)try{this.callbacks[i](e)}catch(n){}},showButton:function(){this.rateLayout&&this.rateLayout.show()},hideButton:function(){this.rateLayout&&this.rateLayout.hide()},initRateValue:function(){var e,t,i=this.p.attr.use_rates;if((this.rateText||this.exctrlCurrentRateText)&&i){for(var n=0;n<i.length;n++)if(1==(e=u.getRateValue(i[n])).value){t=e;break}if(t){this.rateText&&this.rateText.innerText((e.cvalue?e.cvalue:e.value)+"");this.exctrlCurrentRateText&&this.exctrlCurrentRateText.innerText((e.cvalue?e.cvalue:e.value)+"")}}}});return e})}();!function(){"use strict";var n=getDframework(),u=n.module("imgtech.media.Media");n.define("imgtech.media.module.BRate",function(){var i=n.module("imgtech.media.ModuleInterface");function e(e){i.apply(this,arguments);if(e){this.attr;var t=this.p.userElement;this._rateBtn=n.query(t,".mpv-rate-btn");this._area=n.query(t,".mpv-ratebstyle-area");this._layout=n.query(t,".mpv-ratebstyle-layout");this._closeBtn=n.query(t,".mpv-ratebstyle-layout .mpv-close-btn");this._rateText=n.query(t,".mpv-ratebstyle-text");this._downBtn=n.query(t,".mpv-ratebstyle-down-btn");this._upBtn=n.query(t,".mpv-ratebstyle-up-btn");this.setSelfAddElementObject("ratebstyleArea",this._area,{openLayer:!0});this.setSelfElementObject("exctrlPlusRateBtn");this.setSelfElementObject("exctrlMinusRateBtn");this.setSelfElementObject("exctrlCurrentRateText");this.initRateValue()}}n.extendClass(e,i,{onAddEvent:function(){var t=this,i=this.p;this._closeBtn&&n.on(this._closeBtn,"click",function(e){t.hideLayout();return n.igEventAll(e)});this._downBtn&&n.on(this._downBtn,"click",function(e){i.previousRate();return n.igEventAll(e)});this._upBtn&&n.on(this._upBtn,"click",function(e){i.nextRate();return n.igEventAll(e)});this._rateBtn&&n.on(this._rateBtn,"click",function(e){t.c.removeAllHistory();t.showLayout()});this.exctrlPlusRateBtn&&this.exctrlPlusRateBtn.on("click",function(e){i.nextRate();return n.igEventAll(e)});this.exctrlMinusRateBtn&&this.exctrlMinusRateBtn.on("click",function(e){i.previousRate();return n.igEventAll(e)})},onStateChange:function(e){var t,i=this.p,n=e.type,r=e.data;switch(n){case u.EVENT.STATE_CHANGE:e.data==u.STATE.SETSOURCE&&(!1!==this.attr.use&&(t=i.getAvailablePlaybackRates())&&t.length?this.showButton():!1!==this.attr.autohide&&this.hideButton());break;case u.EVENT.ON_BEFORE_PLAY:var s=i.getDefaultPlaybackRate();s&&this.updateRateView(s);break;case u.EVENT.SET_RATE:var a,o=i.getPlaybackRate(),l=i.getAvailablePlaybackRates();if(l)switch(r){case"increment":for(a=0;a<l.length;a++)if(o<l[a].value)return i.setPlaybackRate(l[a]);break;case"decrement":for(a=l.length-1;0<=a;a--)if(o>l[a].value)return i.setPlaybackRate(l[a])}break;case u.EVENT.RATE_CHANGE:this.updateRateView(r)}},addCallback:function(e){this.callbacks||(this.callbacks=[]);this.callbacks.push(e)},updateRateView:function(e){var t=e,i=this.p.attr.use_rates;if(i)for(r=0;r<i.length;r++)if(e.value===i[r].value){t=i[r];break}if(t){var n=(t.cvalue?t.cvalue:t.value)+"";this._rateBtn&&(this._rateBtn.innerText=n);this._rateText&&(this._rateText.innerText=n);this.exctrlCurrentRateText&&this.exctrlCurrentRateText.innerText(n);if(this.callbacks)for(var r=0;r<this.callbacks.length;r++)try{this.callbacks[r](t)}catch(s){}}},showButton:function(){this._rateBtn&&n.removeClass(this._rateBtn,"mpv-hide")},hideButton:function(){this._rateBtn&&n.addClass(this._rateBtn,"mpv-hide")},initRateValue:function(){var e,t,i=this.p.attr.use_rates;if(i){for(var n=0;n<i.length;n++)if(1==(e=u.getRateValue(i[n])).value){t=e;break}if(t){var r=(e.cvalue?e.cvalue:e.value)+"";this._rateBtn&&(this._rateBtn.innerText=r);this._rateText&&(this._rateText.innerText=r);this.exctrlCurrentRateText&&this.exctrlCurrentRateText.innerText(r)}}},showLayout:function(){this.ratebstyleArea&&this.ratebstyleArea.show()},hideLayout:function(){this.ratebstyleArea&&this.ratebstyleArea.hide()}});return e})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.PlayList",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("previousBtn");this.setSelfElementObject("nextBtn");this.setSelfElementObject("exctrlPreviousBtn");this.setSelfElementObject("exctrlNextBtn")}}i.extendClass(e,t,{onAddEvent:function(){var t=this;this.previousBtn&&this.previousBtn.on("click",function(e){t.previous();return i.igEventAll(e)});this.nextBtn&&this.nextBtn.on("click",function(e){t.next();return i.igEventAll(e)});this.exctrlPreviousBtn&&this.exctrlPreviousBtn.on("click",function(e){t.previous();return i.igEventAll(e)});this.exctrlNextBtn&&this.exctrlNextBtn.on("click",function(e){t.next();return i.igEventAll(e)})},onStateChange:function(e){},previous:function(){var t=this.p,e=this.attr;if(e.previous)return e.previous.call(t,function(e){t.source(e)});t.previous()},next:function(){var t=this.p,e=this.attr;if(e.next)return e.next.call(t,function(e){t.source(e)});t.next()}});return e})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.Popup",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("popupToggleBtn")}i.extendClass(e,t,{onAddEvent:function(){this.p;var e=this;this.popupToggleBtn&&this.popupToggleBtn.on("click",function(){e.popup()})},popup:function(){var e=this.attr;return e.callback?e.callback.apply(this):e.url?window.open(e.url):void 0}});return e})}();!function(){"use strict";var s=getDframework(),i=s.module("imgtech.media.Media");s.define("imgtech.media.module.Message",function(){var t=s.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}s.extendClass(e,t,{onStateChange:function(e){switch(e.type){case i.EVENT.SET_DISABLED:switch(e.data){case"success":case"testing":break;case"fatal":this.showMessage(e.message)}break;case i.EVENT.SHOW_MESSAGE:e.data&&("string"==typeof e.data?this.showMessage(e.data,!1,e.attr):this.showMessage(e.data.message,e.data.isHtml,e.data.attr));break;case i.EVENT.CLEAN_MESSAGE:this.clean()}},createMessageBox:function(e,t,i){var n,r=document.createElement("div");s.addClass(r,"mpv-message-layout");r.innerHTML="<table class='mpv-message-table'><tr><td align='center' valign='middle' class='mpv-message-td'>\n<div class='mpv-message-box'></div></td></tr></table>";n=s.query(r,".mpv-message-box");t?n.innerHTML=e:n.innerText=e;i&&i.style&&(n.style=i.style);return r},showMessage:function(e,t,i){e&&this.c.resourceElement.appendChild(this.createMessageBox(e,t,i))},clean:function(){var e=s.queryAll(this.p.userElement,".mpv-message-layout");if(e&&e.length)for(var t=0;t<e.length;t++)s.remove(e[t])}});return e})}();!function(){"use strict";var a=getDframework();a.module("imgtech.media.Media");a.define("imgtech.media.module.SimpleMessage",function(){var t=a.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}a.extendClass(e,t,{createMessageBox:function(e,t,i){var n,r=this,s=document.createElement("div");a.addClass(s,"mpv-simple-message-layout");s.innerHTML="<table class='mpv-simple-message-table'><tr><td align='center' valign='middle' class='mpv-simple-message-td'>\n<div class='mpv-simple-message-box'></div></td></tr></table>";n=a.query(s,".mpv-simple-message-box");t?n.innerHTML=e:n.innerText=e;i&&(i.style?n.style=i.style:!1===i.style&&(n.style=""));a.on(n,"click",function(e){r.clean();return a.igEventAll(e)});a.on(s,"click",function(e){return a.igEventAll(e)});return s},interval:function(e){var t=this,i=e&&e.dtime?e.dtime:this.attr.dtime?this.attr.dtime:2.5;if(!this.intervalId){if(!this.startTime)return this.clean();this.intervalId=window.setInterval(function(){if((new Date).getTime()-t.startTime>1e3*i)return t.clean()},200)}},show:function(e,t,i){this.clean();if(e){this.startTime=(new Date).getTime();this.c.resourceElement.appendChild(this.createMessageBox(e,t,i));!1!==i&&this.interval(i)}},clean:function(){if(this.intervalId){window.clearInterval(this.intervalId);this.intervalId=null}var e=a.queryAll(this.p.userElement,".mpv-simple-message-layout");if(e&&e.length)for(var t=0;t<e.length;t++)a.remove(e[t])}});return e})}();!function(){"use strict";var f=getDframework(),s=f.module("imgtech.media.Media");f.define("imgtech.media.module.Subtitle",function(){var n=f.module("imgtech.media.ModuleInterface");function e(e){n.apply(this,arguments);if(e){var t,i;this.attr;this.setSelfElementObject("subtitleLayout");this.setSelfElementObject("subtitleBtn");this.setSelfElementObject("subtitleList");this.setSelfElementObject("subtitleDisplay");this.setSelfElementObject("exctrlSubtitleBtn");if(t=this.subtitleList){if(i=f.query(t.element,".mpv-view-ele")){this.se=i;this.seHTML=i.outerHTML;f.remove(i)}f.addClass(t.element,"mpv-hide")}}}f.extendClass(e,n,{onAddEvent:function(){function e(e){e&&e.on("click",function(e){t.callStateChange({type:s.EVENT.SHOW_SUBTITLE_LIST,event:e,parent:null});return f.igEventAll(e)})}var t=this.p,i=this.attr;this.layoutMod=this.p.module("layout");(this.subtitleBtn||this.exctrlSubtitleBtn)&&(this.___isused=!0!==i.unusedButton);e(this.subtitleBtn);e(this.exctrlSubtitleBtn)},onStateChange:function(e){var t,i=this.p,n=this.subtitleBtn,r=this.exctrlSubtitleBtn;this.subtitleList;switch(e.type){case s.EVENT.CLICK_EVENT:this.hideList();break;case s.EVENT.SHOW_QUALITY_LIST:this.hideList(!1);break;case s.EVENT.SET_PLAYBACK_SUBTITLE:this.hideContent();break;case s.EVENT.STATE_CHANGE:switch(e.data){case s.STATE.SETSOURCE:if(n||r)if(t=i.getPlaybackSubtitle()){f.addClass(i.userElement,"mpv-on-subtitle");f.removeClass(i.userElement,"mpv-off-subtitle");this.setCurrentSubtitleLabel(t.label);i.device().currentMediaSource().setSubtitle();this.showLayout();this.showButton()}else if(!0===this.attr.autohide){f.addClass(i.userElement,"mpv-off-subtitle");f.removeClass(i.userElement,"mpv-on-subtitle");this.setCurrentSubtitleLabel(null);this.hideLayout();this.hideButton()}this.hideContent()}break;case s.EVENT.CURRENT_TIME_CHANGE:if(t=i.getPlaybackSubtitle()){t.instance&&t.instance.setCurrentTime&&t.instance.setCurrentTime(e.data);(n&&n.element.innerText!=t.label||r&&r.element.innerText!=t.label)&&this.setCurrentSubtitleLabel(t.label)}break;case s.EVENT.SHOW_SUBTITLE_LIST:this.attr.toggle?this.toggle():this.showList();break;case s.EVENT.SUBTITLE_EVENT:this.onSubtitleEvent(e)}},setStyle:function(e,t){for(var i in t)e.style[i]=t[i]},setLayoutStyle:function(e){if(e){var t=this.subtitleDisplay,i=t&&t.element;i&&this.setStyle(i,e)}},setContentStyle:function(e){this.contentStyle=e},setTextStyle:function(e){this.textStyle=e},onSubtitleEvent:function(e){var t,i,n,r,s,a=e.data,o=this.p;if("loaded"==a){this.hideContent();if(t=o.getPlaybackSubtitle()){this.setCurrentSubtitleLabel(t.label);e.subtitle&&e.subtitle.running(!0);(i=o.device().currentMediaSource())&&i.play()}else this.p.error("Not found playback subtitle : ",e)}else if("show"==a){r=(n=this.subtitleDisplay)&&n.element,s=e.subdata;if(r){this.hideContent();if(s){var l,u,c=[];if(f.isArray(s.contents))for(l=0;l<s.contents.length;l++)(u=(u=s.contents[l])?u.trim():"")&&c.push(u);else(u=(u=s.contents)?u.trim():"")&&c.push(u);var h=document.createElement("div");f.addClass(h,"mpv-subtitle-content");this.contentStyle&&this.setStyle(h,this.contentStyle);for(l=0;l<c.length;l++){var d=document.createElement("div");f.addClass(d,"mpv-subtitle-text");d.innerHTML=c[l];this.attr.onlyText&&(d.innerText=d.innerText.trim());this.textStyle&&this.setStyle(d,this.textStyle);h.appendChild(d)}r.appendChild(h);r.innerText.trim()?this.showContent():this.hideContent()}}}else"hide"==a&&this.hideContent()},showContent:function(){var e=this,t=this.subtitleDisplay;if(t){t.show();!function(){e.exctrlSubtitleBtn&&e.exctrlSubtitleBtn.addClass("on");e.subtitleBtn&&e.subtitleBtn.addClass("on")}()}},hideContent:function(){var e=this,t=this.subtitleDisplay;if(t){t.innerHTML("");t.hide();!function(){e.exctrlSubtitleBtn&&e.exctrlSubtitleBtn.removeClass("on");e.subtitleBtn&&e.subtitleBtn.removeClass("on")}()}},usedButton:function(e){var t=this.subtitleBtn,i=this.exctrlSubtitleBtn;if(t||i){this.___isused=!0;e&&this.showButton()}},unusedButton:function(){var e=this.subtitleBtn,t=this.exctrlSubtitleBtn;if(e||t){this.___isused=!1;this.hideButton()}},showButton:function(){var e=this.subtitleBtn,t=this.exctrlSubtitleBtn;if((e||t)&&this.___isused){e&&e.show();t&&t.show()}else this.___isused||this.hideButton()},hideButton:function(){var e=this.subtitleBtn,t=this.exctrlSubtitleBtn;e&&e.hide();t&&t.hide()},showLayout:function(){this.subtitleLayout&&this.subtitleLayout.show()},hideLayout:function(){this.subtitleLayout&&this.subtitleLayout.hide()},setCurrentSubtitleLabel:function(e){var t,i=this.subtitleBtn,n=this.exctrlSubtitleBtn;if(!1!==this.attr.enableLabelText&&(i||n)){e?t=e:(t=this.attr.defaultValue)||(t="");i&&i.innerText(t);n&&n.innerText(t)}},current:function(){var e=this.index();return null!==e?this.getSubtitle(e):null},index:function(){var e,t=this.p,i=t.getAvailableSubtitles(),n=t.getPlaybackSubtitle();if(i&&i.length)for(e=0;e<i.length;e++)if(i[e].code===n.code)return e;return null},getSubtitle:function(e){var t=this.p.getAvailableSubtitles(),i=t&&t.length;if(i&&0<=e&&e<i)return t[e]},setSubtitle:function(e){var t,i=this.p,n=i.getAvailableSubtitles(),r=i.getPlaybackSubtitle(),s=-1;if(n&&n.length){for(t=0;t<n.length;t++)if(n[t].code===r.code){s=t;break}s!==e&&(s=e);s>=n.length&&(s=0);i.setPlaybackSubtitle(n[s])}},toggle:function(){var e,t=this.p,i=t.getAvailableSubtitles(),n=t.getPlaybackSubtitle(),r=-1;if(i&&i.length){for(e=0;e<i.length;e++)if(i[e].code===n.code){r=e;break}++r>=i.length&&(r=0);t.setPlaybackSubtitle(i[r])}},hideList:function(e){var t=this.subtitleList;if(t){t.hide();!1!==e&&(this.layoutMod.enableHide=!0)}},showList:function(){function e(t,e){var i=f.element(this.seHTML),n=this.subtitleList,r=this,s="string"==typeof t?t:t.label?t.label:"",a=f.query(i,".mpv-view-checked"),o=f.query(i,".mpv-view-text");a.innerHTML="&nbsp;";e&&t.code===e.code&&f.addClass(i,"mpv-option-selected");o&&(o.innerText=s);"line"==t.view?f.addClass(i,"mpv-view-line"):f.on(o,"click",function(e){(function(e,t,i){var n=this.p.getPlaybackSubtitle();this.subtitleList;e!==n&&this.p.setPlaybackSubtitle(e);this.hideList()}).call(r,t,i,e)});n.element.appendChild(i)}if(this.seHTML){var t,i,n,r=this.p,s=this.subtitleList,a=s&&s.queryAll(".mpv-view-ele");for(t in a)f.remove(a[t]);if(s.isHide()){var o=r.getAvailableSubtitles();n=r.getPlaybackSubtitle();if(o&&o.length){for(i=0;i<o.length;i++)e.call(this,o[i],n);s.show();this.layoutMod.enableHide=!1;var l=s.rect(),u=this.attr.listOffsetY?this.attr.listOffsetY:0;s.top("-"+(l.height()+u)+"px")}}else this.hideList()}}});return e})}();!function(){"use strict";var l=getDframework(),i=l.module("imgtech.media.Media");l.define("imgtech.media.module.Version",function(){var t=l.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("background");this.setSelfElementObject("foreground");this.setSelfElementObject("osd");this.setSelfElementObject("device");this.rootUi=this.p.controller.resourceElement;this.versionUi=null;this.versionTdUi=null}}function s(e){var t=this.getName(),i=this.getVersion(),n=this.attr,r=n&&"number"==typeof n.wait&&1e3<n.wait?n.wait:2e3,s=this;if(!this.versionUi){var a=document.createElement("table");a.style.position="absolute";a.style.width="100%";a.style.height="100%";var o=document.createElement("td");o.setAttribute("align","center");o.setAttribute("valign","middle");a.appendChild(o);this.rootUi.appendChild(a);this.versionUi=a;this.versionTdUi=o}l.ui.show(this.versionUi);this.showVersion(this.versionTdUi,t,i);setTimeout(function(){s.hideVersion()},r);if(e)return l.igEventAll(e)}l.extendClass(e,t,{onAddEvent:function(){this.p;var t=this,e=this.background,i=this.foreground,n=this.osd,r=this.device;e&&e.on("contextmenu",function(e){return s.call(t,e)});i&&i.on("contextmenu",function(e){return s.call(t,e)});n&&n.on("contextmenu",function(e){return s.call(t,e)});r&&r.on("contextmenu",function(e){return s.call(t,e)})},onStateChange:function(e){switch(e.type){case i.EVENT.SET_DISABLED:}},getName:function(){return"Zone@html5player"},getVersion:function(){return i.version},hideVersion:function(){this.versionUi&&l.ui.hide(this.versionUi)},showVersion:function(e,t,i){var n=this.attr,r=!1;try{if(n&&n.callback){n.callback(e,t,i);r=!0}}catch(s){this.p.error(s)}r||(e.innerHTML="<div style='display: table-cell;         background-color: rgba(80,80,80, 0.3);          color: #f8f8f8; font-size: 14px;          width: 250px; height: 70px;          vertical-align: middle; text-align: center;          border: solid 1px #fff;          weight: bold;      '>     <div style='height: 18px;'>"+t+"         by <font color='#fff'>IMGTech</font>     </div>     <div style='height: 18px;'>         version "+i+"     </div></div>")}});return e})}();!function(){"use strict";var c=getDframework(),h=c.module("imgtech.media.Media");c.define("imgtech.media.module.Key",function(){var t=c.module("imgtech.media.ModuleInterface");function s(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.setSelfElementObject("background");this.setSelfElementObject("control");this.setSelfElementObject("osd");this.setSelfElementObject("info");this.setSelfElementObject("subtitleDisplay");this.isFocus=!1;this.keys={};this.keyvalues={};!function(e){var t,i,n=e.attr;for(t in s.KEYS)e.keys[t]=s.KEYS[t];if(n.keys)for(t in n.keys)e.keys[t]=n.keys[t];for(t in e.keys){i=e.keys[t];for(var r in i)i[r]&&(e.keyvalues[i[r]]=t)}}(this)}}s.KEYS={RESET_RATE:[13],EXIT_FS:[27],TOGGLE:[32,83],SEEK_MINUS:[37],SEEK_PLUS:[39],VOLUME_PLUS:[38],VOLUME_MINUS:[40],TOGGLE_FS:[70],TOGGLE_MUTE:[77],SIZE:[78],NEXT_RATE:[107,187,61,43],PREVIOUS_RATE:[109,189,45,95]};c.extendClass(s,t,{onAddEvent:function(){function e(e,t){if(e){c.on(e.element,"click",function(e){i.focus(e);if(t)return c.igEventAll(e)});c.on(e.element,"mouseover",function(e){i.focus(e)})}}this.repMod=this.p.module("repeat");this.progressMod=this.p.module("progress");this.c.resourceElement;var i=this;e(this.device);e(this.background);e(this.control);e(this.osd);e(this.info,!0);e(this.subtitleDisplay,!0);c.on(document,"keydown",function(e){if(!e){c.error("Not found keydown event !!!");e=window.event}i.onKeyDown(e)})},onStateChange:function(e){switch(e.type){case h.EVENT.CLICK_EVENT:var t=this.isFocus,i=e.event,n=!1;t&&"document"==e.data&&("click"==t.type&&t.clientX==i.clientX&&t.clientY==i.clientY||(n=!0));n&&(this.isFocus=!1)}},userKey:function(e){this.enableUserKey=e},focus:function(e){this.isFocus=e},isEnable:function(){return"boolean"==typeof this.enableUserKey?this.enableUserKey:this.isFocus},deleteKey:function(e){for(var t in this.keyvalues)t==e&&delete this.keyvalues[t]},deleteAllCode:function(e){for(var t in this.keyvalues)this.keyvalues[t]===e&&delete this.keyvalues[t]},addKey:function(e,t,i){i&&this.deleteAllCode(t);if(c.isArray(e))for(var n in e)this.keyvalues[e[n]]=t;else this.keyvalues[e]=t},getKey:function(e){return this.keyvalues[e.which||e.keyCode]},ignoreFullscreen:function(){var e=this.attr;if(!0===e.ignoreFullscreen)return!0;try{if(e.ignoreFullscreen.apply(this))return!0}catch(i){}var t=this.p.module("layout");return!(!t||!t.ignoreFullscreenAll())},onKeyDown:function(e,t){if(this.isEnable()){var i,n,r=this.p,s=this.getKey(e),a=!0,o=this.attr,l=o.ignoreKey||o.ignoreKeys;if(!l||!l[s]){switch(s){case"RESET_RATE":r.resetRate();break;case"EXIT_FS":(n=this.getModuleObject("size"))&&n.isWindowFullscreen()&&r.exitFullscreen();break;case"TOGGLE":r.toggle();break;case"SEEK_MINUS":this.progressMod&&this.progressMod.previousSkip();break;case"SEEK_PLUS":this.progressMod&&this.progressMod.nextSkip();break;case"VOLUME_PLUS":(i=r.getVolume()+(o.volumeStep?o.volumeStep:5))>h.MIN_VOLUME&&(r.isMuted()?r.unMute():r.setVolume(i));break;case"VOLUME_MINUS":(i=r.getVolume()-(o.volumeStep?o.volumeStep:5))<=h.MIN_VOLUME?r.isMuted()||r.mute():r.setVolume(i);break;case"TOGGLE_FS":if(this.ignoreFullscreen())return c.igEventAll(e);var u=!0;c.b.ie&&11==c.b.ie&&o.disableFullscreenIe11&&(u=!1);u&&r.toggleFullscreen();break;case"TOGGLE_MUTE":r.toggleMute();break;case"SIZE":(n=this.getModuleObject("size"))&&n.next();break;case"NEXT_RATE":r.nextRate();break;case"PREVIOUS_RATE":r.previousRate();break;default:a=!1}return a?c.igEventAll(e):void 0}}}});return s})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.media.module.KeyExample",function(){var t=n.module("imgtech.media.module.Key");function i(e){t.apply(this,arguments)}n.extendClass(i,t,{getKey:function(e){return i.__super.getKey.apply(this)},onKeyDown:function(e,t){if(this.isEnable()){switch(this.getKey(e)){case"TOGGLE":p.toggle();return n.igEventAll(e)}return i.__super.onKeyDown.apply(this)}}});return i})}();!function(){"use strict";var o=getDframework(),n=o.module("imgtech.media.Media");o.define("imgtech.media.module.Poster",function(){var t=o.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.setSelfElementObject("osd");this.posterType=1;this.posterElement=null}}o.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){var t,i;switch(e.type){case n.EVENT.ON_READY:(i=this.p.attr.poster)&&this.showPoster(i);break;case n.EVENT.STATE_CHANGE:switch(e.data){case n.STATE.SETSOURCE:(t=this.p.currentMediaSource())&&t.poster&&this.showPoster(t.poster);break;case n.STATE.ENDED:}break;case n.EVENT.CURRENT_TIME_CHANGE:2===this.posterType&&this.hidePoster();break;case n.EVENT.SET_DISABLED:"fatal"==e.data&&this.hidePoster()}},onClickPoster:function(e){var t=this.attr;this.hidePoster();this.p.callStateChange({type:"mod-poster-click",data:e});if(t.click)return t.click(e)},showPoster:function(e){var t,i=this,n=this.attr,r=document.createElement("div"),s=e&&e.where?e.where:n.where;"string"==typeof e?t=e:"string"==typeof e.poster&&(t=e.poster);if(!t)return o.error("Not found poster url.");o.addClass(r,"mpv-poster");if(o.b.ie&&o.b.ie<9){var a=document.createElement("img");a.src=t;a.style.width="100%";a.style.height="100%";r.appendChild(a)}else r.style.backgroundImage="url('"+t+"')";o.on(r,"click",function(e){return i.onClickPoster(e)});this.currentPoster=t;this.hidePoster();this.posterType=2;this.posterElement=r;switch(s){case"osd":this.osd&&this.osd.after(r);break;default:this.device&&this.device.after(r)}},hidePoster:function(){this.posterType=1;if(this.posterElement){o.remove(this.posterElement);this.posterElement=null}}});return e})}();!function(){"use strict";var u=getDframework(),r=u.module("imgtech.media.Media");u.define("imgtech.media.module.SwitchSource",function(){var i=u.module("imgtech.media.ModuleInterface");function n(e){i.apply(this,arguments);if(e){var t=this.p.userElement;this.__isSelectSwichSource=null;this._switchSourceUi=u.query(t,".mpv-switchsourcel-layout");this._switchSourceList=u.query(t,".mpv-switchsourcel-list");this._switchSourceCloseBtn=u.query(this._switchSourceUi,".mpv-close-btn");if(this._switchSourceList){this._switchSourceListHtml=this._switchSourceList.innerHTML;this._switchSourceList.innerText=""}this._switchSourceUi&&this.setSelfAddElementObject("switchSourcelLayout",this._switchSourceUi,{openLayer:!0});this.setSelfElementObject("switchSourceBtn")}}n.ERROR_CODE={E2001:"IE10 \uc774\uc0c1\uc5d0\uc11c \uc720\ud29c\ube0c\uc601\uc0c1\uc744 \uc7ac\uc0dd \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."};u.extendClass(n,i,{getErrorMessage:function(e){var t;if((t=this.attr.errorCode)&&t[e])return t[e];if((t=n.ERROR_CODE)&&t[e])return t[e];throw new Error("Not found error message (code: "+e+")")},onAddEvent:function(){var t=this,e=this.switchSourceBtn;e&&e.on("click",function(e){return t.onClickSwitchSource(e)});this._switchSourceCloseBtn&&u.on(this._switchSourceCloseBtn,"click",function(e){t.hideSwitchSourceList()})},onStateChange:function(e){var t=this;switch(e.type){case r.EVENT.STATE_CHANGE:if(e.data==r.STATE.SETSOURCE)if(this.p.getSwitchSourceData())this.showButton();else{this.hideSwitchSourceList();this.hideButton()}break;case r.EVENT.SELECT_SOURCE:this.autoSwitchSource(e.data);break;case r.EVENT.SELECTED_SOURCE:this.__isSelectSwichSource=null;this.hideSwitchSourceList();break;case r.EVENT.CONTROL_EVENT:"show"==e.data?this.showButton():"hide"==e.data&&this.hideButton();break;case r.EVENT.ON_BEFORE_PLAY:setTimeout(function(){var e=t.userSelectedSource;if(t.userSelectedSource){if(t.p.currentMediaSource()===e.source){t.p.seekTo(e.currentTime);t.p.setPlaybackRate(e.currentRate);t.p.setVolume(e.currentVolume);e.currentMuted?t.p.mute():t.p.unMute()}t.userSelectedSource=null}},1);break;case r.EVENT.ON_ERROR:this.errorSwitchSource(e)}},onClickSwitchSource:function(e){var t=this.switchSourcelLayout;if(t&&t.isHide()){this.c.removeAllHistory();this.showSwitchSourceList(null);return u.igEventAll(e)}this.hideSwitchSourceList()},hideButton:function(){this.switchSourceBtn&&this.switchSourceBtn.hide()},showButton:function(){this.p.getSwitchSourceData()&&this.switchSourceBtn&&this.switchSourceBtn.show()},hideSwitchSourceList:function(){var e=this.switchSourcelLayout;e&&e.hide()},cleanSelectedSource:function(e){for(var t=e.src.switchSource.ss,i=0;i<t.length;i++)t[i].input.select=!1},errorSwitchSource:function(i){var e;if(i&&i.source&&(e={src:this.p.getSwitchSourceData()})&&e.src){var n=e.src.switchSource.ss;if(!(n.length<2)){i.source.deviceType();var t=function(){for(var e=0;e<n.length;e++){var t=n[e];if(t.__is_failed_count);else{if(t!==i.source)return t;t.__is_failed_count?t.__is_failed_count++:t.__is_failed_count=1}}return null}();t?this.selectedSourceElement(t,e):u.error("Not found enable source !!!!")}}},autoSwitchSource:function(e){e||(e={src:this.p.getSwitchSourceData()});var n=e.src.switchSource.ss,t=function(){for(var e=0;e<n.length;e++){var t=n[e];if(!0===t.input.select){if(!(u.b.ie&&u.b.ie<10&&"youtube"===t.deviceType()))return t;for(var i=0;i<n.length;i++)if("youtube"!==n[i].deviceType())return n[i];return null}}}();t||(t=n[0]);this.selectedSourceElement(t,e)},showSwitchSourceList:function(e,t){if(t)return this.autoSwitchSource(e);e||(e={src:this.p.getSwitchSourceData()});var i=e.src,n=i&&i.switchSource,r=n&&n.ss,s=this.switchSourcelLayout;if(r){s&&s.show();this._switchSourceList.innerText="";for(var a=0;a<r.length;a++)this.drawSelectSourceElement(r[a],e);var o=s&&s.rect(),l=this.attr.offsetY?this.attr.offsetY:0;o&&s.top("-"+(o.height()+l)+"px")}},drawSelectSourceElement_l:function(e,t){var i=this,n=e.input,r=this.p.currentMediaSource()===e,s=u.element(this._switchSourceListHtml),a=u.query(s,".mpv-view-checked"),o=u.query(s,".mpv-view-text");e&&e.input&&e.input.selectedClass&&u.addClass(s,e.input.selectedClass);a.innerHTML="&nbsp;";o&&(o.innerText=n.name);r&&u.addClass(s,"mpv-option-selected");var l=u.b.ie&&u.b.ie<10&&"youtube"===e.deviceType();l&&u.addClass(s,"mpv-option-noselecting");u.on(s,"click",function(){if(l)return alert(i.getErrorMessage("E2001"));if(r)return i.hideSwitchSourceList();i.selectedSourceElement(e,t,!0)});this._switchSourceList.appendChild(s)},drawSelectSourceElement:function(e,t){this.drawSelectSourceElement_l(e,t)},selectedSourceElement:function(e,t,i){if(this.__isSelectSwichSource)return this.p.error("Already switch source.");i&&(this.userSelectedSource={currentTime:this.p.currentTime(),currentRate:this.p.getPlaybackRate(),currentVolume:this.p.getVolume(),currentMuted:this.p.isMuted(),source:e});this.__isSelectSwichSource={type:r.EVENT.SELECTING_SOURCE,data:{src:e,event:t.event,originData:t}};this.p.callStateChange(this.__isSelectSwichSource)}});return n})}();!function(){"use strict";var r=getDframework(),i=r.module("imgtech.media.Media");r.define("imgtech.media.module.ContinueTime",function(){var t=r.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}r.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){this.p,this.attr;switch(e.type){case i.EVENT.CONTINUE_TIME:if(e.isAuto)return this.continueTime(e.data,e.isPlaying);if(confirm("\uc774\uc5b4\ubcf4\uae30 ( "+i.secondsToTimeString(e.data)+" )\ub97c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))return this.continueTime(e.data,e.isPlaying);this.p.play()}},continueTime:function(e,t){var i=this.p;i.device();try{!function(){i.seekTo(e);if(!0===t)return!i.isPlaying()&&i.play();if(!1===t)return i.isPlaying()&&i.pause();i.attr.autoplay&&i.play()}()}catch(n){r.error(n)}}});return e})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.media.module.UI",function(){var t=n.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.buttons=[];this.setSelfElementObject("control");this.control&&(this.controlBottom=this.control.query(".mpv-control-bottom"))}}n.extendClass(e,t,{onAddEvent:function(){var e,t=this.attr;if(t.addControlButton)if(n.isArray(t.addControlButton))for(var i=0;i<t.addControlButton.length;i++)(e=t.addControlButton[i])&&this.addControlButton(e);else this.addControlButton(t.addControlButton)},onStateChange:function(e){},addControlButton:function(t){var e,i=this.controlBottom;if(!i)throw new TypeError("Not found controlBottom element.");if(!t)throw new TypeError("Not found parameter.");if(!t.name||"string"!=typeof t.name)throw new TypeError("Not found name on parameter.");if(!t.element)throw new TypeError("Not found element on parameter.");if(!t.callback)throw new TypeError("Not found callback on parameter.");"string"==typeof t.element?e=n.element(t.element):n.isElement(t.element)&&(e=t.element);if(!e)throw new TypeError("Not make element.");n.addClass(e,"mpv-user-button");n.on(e,"click",function(e){t.callback.call(this.p,{type:"click",event:e})});i.appendChild(e);t._player=this.p;t._uiModule=this;t._element=e;this.buttons[t.name]=t},getControlButton:function(e){return this.buttons[e]}});return e})}();!function(){"use strict";var s=getDframework(),r=s.module("imgtech.media.Media");s.define("imgtech.media.module.MediaError",function(){var i=s.module("imgtech.media.ModuleInterface");function n(e){i.apply(this,arguments);if(e){this.lastCurrentTime=0;var t=this.attr;t.maxRetryCount||(t.maxRetryCount=n.MAX_RETRY_COUNT);t.depthRetrySeconds||(t.depthRetrySeconds=n.DEPTH_RETRY_SECONDS)}}n.MAX_RETRY_COUNT=10;n.DEPTH_RETRY_SECONDS=1;n.ERROR={ES0003:"\uc601\uc0c1\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc5ec 3\ucd08\ud6c4\uc774\ud6c4 \uc601\uc0c1\uc744 \uc7ac\uc2dc\ub3c4 \ud569\ub2c8\ub2e4."};s.extendClass(n,i,{onAddEvent:function(){},onStateChange:function(e){switch(e.type){case r.EVENT.STATE_CHANGE:e.data==r.STATE.SETSOURCE&&(this.lastCurrentTime=0);break;case r.EVENT.CURRENT_TIME_CHANGE:var t=this.p.currentMediaSource(),i=t?t.___retryErrorLastCurrentTime:null;this.lastCurrentTime=e.data.currentTime;i&&i<this.lastCurrentTime&&(t.___retryErrorLastCurrentTime=0);break;case r.EVENT.ON_ERROR:this.retryError(e)}},retryError:function(e){var t,i,n,r=this.p.currentMediaSource();if(s.b.chrome&&e.data&&e.device&&r){i=(t=e.data.srcElement||e.data.target)&&t.error;if(t)if(i){if(3===i.code){s.error(i);if(r.___retryErrorLastCurrentTime){r.___retryError++;n=r.input.autoContinueTime}else{r.___retryError=1;n=this.lastCurrentTime}if(r.input.retryError>this.attr.maxRetryCount)return;n||(n=0);n+=this.attr.depthRetrySeconds;s.error("Retry error. autoContinueTime: "+n+", retryCount: "+r.___retryError);r.setAutoContinueTime(n);r.___retryErrorLastCurrentTime=n;this.p.current()}}else s.error("Not found event target error data..");else s.error("Not found event target.")}}});return n})}();!function(){"use strict";var i=getDframework(),n=i.module("imgtech.media.Media");i.define("imgtech.media.module.Subject",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("title")}i.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){switch(e.type){case n.EVENT.STATE_CHANGE:if(e.data==n.STATE.SETSOURCE){var t=this.p.currentMediaSource();t&&t.input&&t.input.title&&this.setTitle(t.input.title)}}},setTitle:function(e){this.title&&this.title.innerText(e)}});return e})}();!function(){"use strict";var s=getDframework();s.module("imgtech.media.Media");s.define("imgtech.media.module.App",function(){var t=s.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}s.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){},proc:function(e,t,i){var n;if(e){if(!(n=e[t]))return s.error("Not found seconds attribute name");if(!n.apply)return s.error("Seconds attribute name is not function");try{return i?n.apply(e):n.apply(e,i)}catch(r){return null}}return null},_applyAttribute:function(e,t){var i;if(this.attr&&(i=this.attr[e])){if(i.apply)try{return t?i.apply(this):i.apply(this,t)}catch(n){return null}s.error("Not found "+e+" function at app attribute")}return null},appName:function(){return this._applyAttribute("appName")},isApp:function(){return this._applyAttribute("isApp")},isMobileApp:function(){return this._applyAttribute("isMobileApp")},dissmiss:function(){return this._applyAttribute("dissmiss")},fullscreen:function(){return this._applyAttribute("fullscreen")},exitFullscreen:function(){return this._applyAttribute("exitFullscreen")},stateChange:function(e){return this._applyAttribute("stateChange",[e])},useVirtualScreen:function(){return this._applyAttribute("useVirtualScreen")}});return e})}();!function(){"use strict";var o=getDframework(),i=o.module("imgtech.media.Media");o.define("imgtech.media.module.Radio",function(){var t=o.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.oldsource=null;this.backgroundElement=null}}o.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){var t;switch(e.type){case i.EVENT.STATE_CHANGE:switch(e.data){case i.STATE.SETSOURCE:if(t=this.oldsource){t.input&&t.input.backgroundImage&&this.hideBackground();this.oldsource=null}(t=this.p.currentMediaSource())&&(this.oldsource=t).input&&t.input.backgroundImage&&this.showBackground(t.input.backgroundImage)}break;case i.EVENT.SET_DISABLED:"fatal"==e.data&&this.hideBackground()}},showBackground:function(e){var t=this.attr,i=document.createElement("div"),n=this.p.currentMediaSource(),r=n&&n.input,s=e&&"string"==typeof e?e:e&&e.backgroundImage?e.backgroundImage:r&&r.backgroundImage?r.backgroundImage:t.backgroundImage;if(!s)return o.error("Not found background image url.");o.addClass(i,"mpv-radio-background-image");if(o.b.ie&&o.b.ie<9){var a=document.createElement("img");a.src=s;a.style.width="100%";a.style.height="100%";i.appendChild(a)}else i.style.backgroundImage="url('"+s+"')";this.currentBackgroundImage=s;this.hideBackground();this.backgroundElement=i;this.device&&this.device.after(i)},hideBackground:function(){if(this.backgroundElement){o.remove(this.backgroundElement);this.backgroundElement=null}}});return e})}();!function(){"use strict";var r=getDframework();r.define("imgtech.media.History",function(){function t(e,t){this.parent=e;this.value=t;this.childs=[]}function n(e){var t=this.childs[e];this.childs.splice(e,1);t.removeAll();return t}t.prototype={constructor:t,push:function(e){if(!e)throw new TypeError("push dest element is empty");this.childs.push(new t(this,e))},pop:function(){var e=this.childs.length,t=null;if(e){t=this.childs[e-1];return n.call(this,e-1)}return t.value},position:function(e){return(0===e||e)&&this.childs.length>e?this.childs[e]:null},remove:function(e){for(var t=this.childs,i=0;i<t.length;i++)if(t[i].value===e)return n.call(this,i)},removeAll:function(){var e,t=this.childs,i=this.value;for(e=0;e<t.length;e++)t[e].removeAll();this.childs=[];i&&i.onRemoveHistory?i.onRemoveHistory():this.parent&&r.error("Not found onRemoveHistory method.",i)},end:function(){}};return t})}();!function(){"use strict";var u=getDframework();u.module("imgtech.media.Media");u.define("imgtech.media.Element",function(){function e(e,t,i,n){this.p=e;this.c=t;this.name=i;this.element=n.element;this.attr=n.attr?n.attr:{};this.callbacks=[];var r=this.attr;r.igEventAll||!1===r.igEventAll||(r.igEventAll=!1);r.visible||(r.visible="normal");r.use||!1===r.use||(r.use=!0);r.openLayer||!1===r.openLayer||(r.openLayer=!1);if(!u.isElement(this.element))throw new Error("This is not element.",this.attr);!function(e){switch(r.visible){case"always":return e.setAlways();case"disable":e.setDisable()}}(this);(this.element.zonemediaplayerElement=this)._isButton=!1;this.setIsButton(!1)}e.prototype={constructor:e,onRemoveHistory:function(){this.__private_hide()},setAlways:function(){this.attr.visible="always";this.show()},setDisable:function(){this.attr.visible="disable";this.hide()},setNormal:function(){this.attr.visible="normal"},isAlways:function(){return"always"==this.attr.visible},isDisable:function(){return"disable"==this.attr.visible},use:function(){this.attr.use=!0},unUse:function(){this.attr.use=!1},on:function(e,i,t){this.element&&e&&i||u.error("Not found element or name or callback.",this.element,e,i);for(var n,r=this.callbacks,s=0;s<r.length;s++)if((n=r[s]).name===e&&n.callback===i){t&&(n.userCallback=i);return}var a=this,o=this.attr,l=function(e){if(!o.use)return a.p.log(o.css+" is not use.");var t=i(e);return o.igEventAll?u.igEventAll(e):t};"click"!=e&&"dblclick"!=e||this.setIsButton(!0);n={name:e,userCallback:i,systemCallback:l};this.callbacks.push(n);u.on(this.element,e,l)},off:function(n,r){this.element&&n&&r||u.error("Not found element or name or callback.",this.element,n,r);var s=this,e=function(){for(var e=s.callbacks,t=0;t<e.length;t++){var i=e[t];if(i.name===n&&i.userCallback===r){e.splice(t,1);return i}}}(),t=e&&e.systemCallback;if(t){u.off(this.element,n,t);if(this._isButton&&("click"==n||"dblclick"==n)){var i=function(){for(var e=s.callbacks,t=0;t<e.length;t++){var i=e[t].name;if("click"==i||"dblclick"==i)return!0}return!1}();this.setIsButton(i)}}},setIsButton:function(e){this._isButton=e;this.element&&this.isButton()},isButton:function(){return!1!==this.attr.use&&this._isButton},offAll:function(){for(var e,t=this.callbacks,i=0;i<t.length;i++)(e=t[i]).name&&e.systemCallback&&u.off(this.element,e.name,e.systemCallback)},__private_show:function(e){this.isDisable()?u.addClass(this.element,"mpv-hide"):u.removeClass(this.element,"mpv-hide")},show:function(e,t){if(!this.isShow()){this.__private_show(e);if(this.isOpenLayer()){this.parent=t;this.parent?this.parent.history&&this.parent.history.push(this):this.c.pushHistory(this)}}},__private_hide:function(e){this.isAlways()?u.removeClass(this.element,"mpv-hide"):u.addClass(this.element,"mpv-hide")},hide:function(e){if(!this.isHide()){this.__private_hide(e);this.isOpenLayer()&&(this.parent?this.parent.history&&this.parent.history.remove(this):this.c.removeHistory(this))}},isHide:function(){return this.hasClass("mpv-hide")},isShow:function(){return!this.isHide()},isOpenLayer:function(){return this.attr.openLayer},open:function(e){if(!this.isOpenLayer())throw new Error("This element is not open layer");this.show(null,e)},close:function(){if(!this.isOpenLayer())throw new Error("This element is not open layer");this.hide(null)},addClass:function(e){return"mpv-hide"===e?this.hide():this.element&&u.addClass(this.element,e)},removeClass:function(e){return"mpv-hide"===e?this.show():this.element&&u.removeClass(this.element,e)},hasClass:function(e){return this.element&&u.hasClass(this.element,e)},rect:function(){return this.element&&u.getBoundingClientRect(this.element)},after:function(e){return this.element&&u.after(this.element,e)},before:function(e){return this.element&&u.before(this.element,e)},append:function(e){return this.element&&u.append(this.element,e)},first:function(e){return this.element&&u.first(this.element,e)},parent:function(e){return this.element&&u.parent(this.element,e)},remove:function(){this.element&&u.remove(this.element)},innerText:function(e){this.element&&(this.element.innerText=e)},innerHTML:function(e){this.element&&(this.element.innerHTML=e)},top:function(e){if(this.element){e!==undefined&&(this.element.style.top=e);return this.element.style.top}},left:function(e){if(this.element){e!==undefined&&(this.element.style.left=e);return this.element.style.left}},right:function(e){if(this.element){e!==undefined&&(this.element.style.right=e);return this.element.style.right}},bottom:function(e){if(this.element){e!==undefined&&(this.element.style.bottom=e);return this.element.style.bottom}},query:function(e){return this.element&&u.query(this.element,e)},queryAll:function(e){return this.element&&u.queryAll(this.element,e)},destroy:function(){this.offAll();if(this.element){this.element.zonemediaplayerElement&&delete this.element.zonemediaplayerElement;delete this.element}}};return e})}();!function(){"use strict";var u=getDframework(),o=u.module("imgtech.media.Media");u.define("imgtech.media.Controller",function(){var t=u.module("imgtech.media.ControllerInterface"),i=u.module("imgtech.media.History"),l=u.module("imgtech.media.Element");function n(e,t){for(var i in t)if("object"==typeof t[i]){"object"!=typeof e[i]&&(e[i]={});n(e[i],t[i])}else e[i]=t[i]}function r(e){t.apply(this,arguments);if(e){this.p=e;this.attr=e.attr;this.userElement=this.p.userElement;this.resourceElement;this.e={};this.m={};this.history=new i;this.currentSkinName;this.currentCssPath;this.__MODULE={};this.__CONTRIB={};this.__ELEMENT={};n(this.__MODULE,r.MODULE);n(this.__CONTRIB,r.CONTRIB);n(this.__ELEMENT,r.ELEMENT)}}r.MODULE={app:{className:"imgtech.media.module.App"},volume:{className:"imgtech.media.module.Volume"},progress:{className:"imgtech.media.module.Progress"},repeat:{className:"imgtech.media.module.Repeat"},toggle:{className:"imgtech.media.module.Toggle"},stop:{className:"imgtech.media.module.Stop"},rate:{className:"imgtech.media.module.Rate"},quality:{className:"imgtech.media.module.Quality"},subtitle:{className:"imgtech.media.module.Subtitle"},playList:{className:"imgtech.media.module.PlayList"},size:{className:"imgtech.media.module.Size"},wide:{className:"imgtech.media.module.Wide"},popup:{className:"imgtech.media.module.Popup"},subject:{className:"imgtech.media.module.Subject"},underplayer:{className:"imgtech.media.module.Underplayer"},background:{className:"imgtech.media.module.Background"},layout:{className:"imgtech.media.module.Layout"},foreground:{className:"imgtech.media.module.Foreground"},message:{className:"imgtech.media.module.Message"},version:{className:"imgtech.media.module.Version"},key:{className:"imgtech.media.module.Key"},poster:{className:"imgtech.media.module.Poster"},continueTime:{className:"imgtech.media.module.ContinueTime"},switchSource:{className:"imgtech.media.module.SwitchSource"},ui:{className:"imgtech.media.module.UI"},radio:{className:"imgtech.media.module.Radio"},error:{className:"imgtech.media.module.MediaError"},simpleMessage:{className:"imgtech.media.module.SimpleMessage"}};r.CONTRIB={confirm:{className:"imgtech.media.extends.Confirm"}};r.ELEMENT={underplayer:{css:"mpv-underplayer",buttonCursor:""},device:{css:"mpv-device",buttonCursor:""},background:{css:"mpv-background",buttonCursor:""},info:{css:"mpv-info"},title:{css:"mpv-title"},osd:{css:"mpv-osd",buttonCursor:""},osdLoading:{css:"mpv-osd-loading"},osdToggle:{css:"mpv-osd-toggle",buttonCursor:""},bottom:{css:"mpv-bottom",noButton:!0,igEventAll:!0},control:{css:"mpv-control",noButton:!0,igEventAll:!0},controlBottom:{css:"mpv-control-bottom",noButton:!0,igEventAll:!0},progress:{css:"mpv-progress",igEventAll:!0},totalProgress:{css:"mpv-total-progress",igEventAll:!0},bufferProgress:{css:"mpv-buffer-progress",igEventAll:!0},currentProgress:{css:"mpv-current-progress",igEventAll:!0},progressHandler:{css:"mpv-progress-handler",igEventAll:!0},previousBtn:{css:"mpv-previous-btn",igEventAll:!0},nextBtn:{css:"mpv-next-btn",igEventAll:!0},playToggleBtn:{css:"mpv-play-toggle-btn",igEventAll:!0},stopBtn:{css:"mpv-stop-btn",igEventAll:!0},previousSkipBtn:{css:"mpv-previous-skip-btn",igEventAll:!0},nextSkipBtn:{css:"mpv-next-skip-btn",igEventAll:!0},skipInput:{css:"mpv-skip-input"},volumeLayout:{css:"mpv-volume-layout",igEventAll:!0},muteToggleBtn:{css:"mpv-mute-toggle-btn",igEventAll:!0},volumeSliderLayout:{css:"mpv-volume-slider-layout",igEventAll:!0},volumeSlider:{css:"mpv-volume-slider",igEventAll:!0},volumeBackground:{css:"mpv-volume-background",igEventAll:!0},volumeForeground:{css:"mpv-volume-foreground",igEventAll:!0},volumeHandler:{css:"mpv-volume-handler",igEventAll:!0},timeLayout:{css:"mpv-time-layout",noButton:!0,igEventAll:!0},currentTimeText:{css:"mpv-currenttime-text",noButton:!0,igEventAll:!0},durationText:{css:"mpv-duration-text",noButton:!0,igEventAll:!0},rateLayout:{css:"mpv-rate-layout"},rateUpBtn:{css:"mpv-rate-up-btn",igEventAll:!0},rateText:{css:"mpv-rate-text"},rateDownBtn:{css:"mpv-rate-down-btn",igEventAll:!0},qualityLayout:{css:"mpv-quality-layout"},qualityBtn:{css:"mpv-quality-btn",igEventAll:!0},subtitleDisplay:{css:"mpv-subtitle-display"},subtitleLayout:{css:"mpv-subtitle-layout"},subtitleBtn:{css:"mpv-subtitle-btn",igEventAll:!0},subtitleList:{css:"mpv-subtitle-list"},sizeToggleBtn:{css:"mpv-size-toggle-btn",igEventAll:!0},wideBtn:{css:"mpv-wide-btn",igEventAll:!0},fullscreenToggleBtn:{css:"mpv-fullscreen-toggle-btn",igEventAll:!0},popupToggleBtn:{css:"mpv-popup-toggle-btn",igEventAll:!0},foreground:{css:"mpv-foreground"},repeatBtn:{css:"mpv-repeat-btn",igEventAll:!0},repeatStart:{css:"mpv-repeat-start-marker",igEventAll:!0},repeatEnd:{css:"mpv-repeat-end-marker",igEventAll:!0},exitBtn:{css:"mpv-exit-btn",igEventAll:!0},rbookmarkBtn:{css:"mpv-rbookmark-btn",igEventAll:!0},switchSourceBtn:{css:"mpv-switchsource-btn",igEventAll:!0},extendControl:{css:"mpv-extend-control"},exctrlAlayer:{css:"mpv-exctrl-alayer"},exctrlBlayer:{css:"mpv-exctrl-blayer"},exctrlClayer:{css:"mpv-exctrl-clayer"},exctrlPlayerBtnLayer:{css:"mpv-exctrl-player-btn-layer"},exctrlRepeatBtn:{css:"mpv-exctrl-repeat-btn",igEventAll:!0},exctrlPreviousBtn:{css:"mpv-exctrl-previous-btn",igEventAll:!0},exctrlToggleBtn:{css:"mpv-exctrl-toggle-btn",igEventAll:!0},exctrlNextBtn:{css:"mpv-exctrl-next-btn",igEventAll:!0},exctrlSubtitleBtn:{css:"mpv-exctrl-subtitle-btn",igEventAll:!0},exctrlRateLayer:{css:"mpv-exctrl-rate-layer"},exctrlPlusRateBtn:{css:"mpv-exctrl-plus-rate-btn",igEventAll:!0},exctrlCurrentRateText:{css:"mpv-exctrl-current-rate-text"},exctrlMinusRateBtn:{css:"mpv-exctrl-minus-rate-btn",igEventAll:!0}};u.extendClass(r,t,{addGlobalClass:function(e){u.addClass(this.userElement,e);u.addClass(this.resourceElement,e)},private_draw_l:function(e){this.resourceElement=e;this.userElement.appendChild(e);u.b.isWindows&&this.addGlobalClass("mpv-os-windows");u.b.isMacosx&&this.addGlobalClass("mpv-os-macosx");u.b.isLinux&&this.addGlobalClass("mpv-os-linux");if(u.b.isMobile){this.addGlobalClass("mpv-os-mobile");if(u.b.android)this.addGlobalClass("mpv-os-android");else if(u.b.iOS){this.addGlobalClass("mpv-os-ios");u.b.iphone?this.addGlobalClass("mpv-os-iphone"):u.b.ipad&&this.addGlobalClass("mpv-os-ipad")}}if(u.b.ie){this.addGlobalClass("mpv-b-ie");7==u.b.ie?this.addGlobalClass("mpv-b-ie7"):8==u.b.ie?this.addGlobalClass("mpv-b-ie8"):9==u.b.ie?this.addGlobalClass("mpv-b-ie9"):10==u.b.ie?this.addGlobalClass("mpv-b-ie10"):11==u.b.ie&&this.addGlobalClass("mpv-b-ie11");"xp"==u.b.osAlias&&this.addGlobalClass("mpv-os-xp")}u.b.chrome&&this.addGlobalClass("mpv-b-chrome");u.b.safari&&this.addGlobalClass("mpv-b-safari");u.b.firefox&&this.addGlobalClass("mpv-b-firefox");u.b.opera&&this.addGlobalClass("mpv-b-opera");this.attr.addClass&&this.addGlobalClass(this.attr.addClass)},private_link_element_l:function(e){var t,i,n,r,s=this.attr.element,a=this.__ELEMENT,o={};this.e={};for(n in a)o[n]=a[n];for(n in s)if(o[n])for(r in s[n])o[n][r]=s[n][r];else o[n]=s[n];for(n in o)if(t=o[n]){if(!t.css)throw new Error("Not found module element css : "+n);(i=u.query(e,"."+t.css))&&(this.e[n]=new l(this.p,this,n,{element:i,attr:t}))}},getElement:function(e){if(u.isElement(e))for(var t in this.e){var i=this.e[t];if(i.element===e)return i}else if("string"==typeof e)return this.e[e];return null},addElement:function(e,t,i){if(!e)throw new TypeError("empty name.");if(!u.isElement(t))throw new TypeError("element is not Element.");for(var n in this.e)if(n===e)throw new TypeError("already element.",e,t);i||(i={});i.css||(i.css=e);this.e[e]=new l(this.p,this,e,{element:t,attr:i})},removeElement:function(e){if(this.e[e]){this.e[e].destroy();delete this.e[e]}},replaceElement:function(e,t){var i=this.e[e];if(!i)throw new Error("Not found element: "+e);i.element=t},pushHistory:function(e){return this.history.push(e)},removeHistory:function(e){return this.history.remove(e)},removeAllHistory:function(){return this.history.removeAll()},private_link_module_l:function(){var e,t,i,n,r=this.attr.module,s=this.__MODULE,a={};this.m={};for(t in s)a[t]=s[t];for(t in r)if(a[t]&&!1!==r[t]){if(r[t])for(i in r[t])a[t][i]=r[t][i]}else a[t]=r[t];for(t in a)if(e=a[t]){if(e.className){if(!(n=u.module(e.className)))throw new Error("Not found control "+t+" module : "+e.className);this.m[t]=new n(this.p,this,e)}}else this.m[t]=!1;for(t in this.m)this.m[t].onAddEvent&&this.m[t].onAddEvent()},draw:function(i){function r(){this.private_link_module_l();var e,t=this.p.module("app");if(t&&t.isApp()){this.addGlobalClass("mpv-zoneplayer-app");"string"==typeof(e=t.appName())&&this.addGlobalClass("mpv-zoneplayer-"+e+"-app")}i&&i()}function t(e,t,i,n){this.currentSkinName="";this.currentCssPath="";if(i){if(t.skin){this.currentSkinName="skin-"+t.skin;u.addClass(i,this.currentSkinName);if(!this.p.flag){t.css?this.currentCssPath=t.css:this.currentCssPath=n?e+"/skin/"+t.skin+"/"+t.skin+".css":"";this.currentCssPath&&u.importCssStylsheet(this.currentCssPath)}}i.style.width="100%";i.style.height="100%";this.private_draw_l(i);this.private_link_element_l(i)}r.call(this)}if(null===this.userElement)return r.call(this);o.parseResource(this.attr);var n=this,s=this.attr,a=s.namespace;if(!1===s.resource)return t.call(this,a,s,null,!1);if(s.resourceText){var e=u.element(s.resourceText);t.call(this,a,s,e,!0)}else u.require(s.resource,function(e){t.call(n,a,s,e,!0)},function(e){throw new Error(e)})},onStateChange:function(e){for(var t in this.m){var i=this.m[t];if(i.onStateChange)try{i.onStateChange(e)}catch(n){u.error(n)}}e.type==o.EVENT.CLICK_EVENT&&this.removeAllHistory()}});return r})}();!function(){"use strict";var a=getDframework(),o=a.module("imgtech.media.Media");a.define("imgtech.media.module.Device",function(){var t=a.module("imgtech.media.ModuleInterface");function r(e){var t=this.p;if(!this.isBeforeFirstDevicePlay){t.callStateChange({type:o.EVENT.ON_BEFORE_DEVICE_PLAY,source:this.currentMediaSource(),device:this,parent:e});this.isBeforeFirstDevicePlay=!0}if(!this.isBeforeFirstPlay){t.callStateChange({type:o.EVENT.ON_BEFORE_ONCE_PLAY,source:this.currentMediaSource(),device:this,parent:e});this.isBeforeFirstPlay=!0}if(!this.isBeforePlay){t.callStateChange({type:o.EVENT.ON_BEFORE_PLAY,source:this.currentMediaSource(),device:this,parent:e});this.isBeforePlay=!0}}function s(e){var t=this.p;if(!this.isAfterFirstPlay){t.callStateChange({type:o.EVENT.ON_AFTER_ONCE_PLAY,source:this.currentMediaSource(),device:this,parent:e});this.isAfterFirstPlay=!0}if(!this.isAfterFirstDevicePlay){t.callStateChange({type:o.EVENT.ON_AFTER_DEVICE_PLAY,source:this.currentMediaSource(),device:this,parent:e});this.isAfterFirstDevicePlay=!0}}function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.__activeStatus="create";this.switchSourceData=null;this.isBeforeFirstDevicePlay=!1;this.isBeforeFirstPlay=!1;this.isAfterFirstDevicePlay=!1;this.isAfterFirstPlay=!1;this.lastVolume=0;this.lastMuted=!1;this.__disablePauseDisplayForStop=!1;this.__disableLoadingDisplayForStop=!1;this.clear()}}a.extendClass(e,t,{currentMediaSource:function(){throw new Error("currentMediaSource is abstract method.")},getClassName:function(){throw new Error("getClassName is abstract method.")},getPlayerType:function(){throw new Error("getPlayerType is abstract method.")},clear:function(){this.lastState=-1;this.lastStateText="";this.lastDuration=-1;this.lastCurrentTime=0;this.lastBuffering=0;this.lastWatchTime=0;this.__disablePauseDisplayForStop=!1;this.__disableLoadingDisplayForStop=!1},onAddEvent:function(){},onCurrentTimeSync:function(){var e=this,t=this.p,i=t.attr,n=this.currentTime(),r=this.duration();if(this.lastDuration!=r){if(this.is_temporary_removal)return 0<r?setTimeout(function(){e.stop()},1):void 0;this.lastDuration=r;t.callStateChange({type:o.EVENT.DURATION_CHANGE,data:{duration:r||0,currentTime:n||0},source:this.currentMediaSource(),device:this})}if(this.lastCurrentTime!=n){if(this.is_temporary_removal)return 0<n?setTimeout(function(){e.stop()},1):void 0;this.lastCurrentTime=n;t.callStateChange({type:o.EVENT.CURRENT_TIME_CHANGE,data:{duration:r||0,currentTime:n||0},source:this.currentMediaSource(),device:this})}i.watchTime&&this.onWatchTimeSync();if(this.lastDuration===this.lastCurrentTime&&this.virtualTime()){this.stop();setTimeout(function(){t.callStateChange({type:o.EVENT.STATE_CHANGE,data:o.STATE.ENDED})},1)}},onWatchTimeSync:function(){var e=this,t=this.p,i=t.attr,n=this.currentTime(),r=this.duration(),s="number"==typeof i.watchTime?i.watchTime:0;if(this.lastWatchTime+s<n){if(this.is_temporary_removal)return 0<n?setTimeout(function(){e.stop()},1):void 0;this.lastWatchTime=n;t.callStateChange({type:o.EVENT.WATCH_TIME_CHANGE,data:{duration:r,currentTime:n},source:this.currentMediaSource(),device:this})}},onBufferingSync:function(){var e=this,t=this.p,i=this.getBuffering();if(this.lastBuffering!=i){if(this.is_temporary_removal)return 0<i?setTimeout(function(){e.stop()},1):void 0;this.lastBuffering=i;t.callStateChange({type:o.EVENT.BUFFERING_CHANGE,data:i,source:this.currentMediaSource(),device:this})}},onVolumeSync:function(){if(!this.is_temporary_removal){var e,t,i=this.p;if(this.lastVolume!=(e=this.getVolume())||this.lastMuted!=(t=this.isMuted())){this.lastVolume=e||0;this.lastMuted=t||!1;var n=this;setTimeout(function(){i.callStateChange({type:o.EVENT.VOLUME_CHANGE,data:{volume:n.lastVolume,muted:n.lastMuted},source:n.currentMediaSource(),device:n})},1)}}},onSync:function(){var e=this.p.attr;e.useUpdateTimeSync&&this.onCurrentTimeSync();e.useBufferingSync&&this.onBufferingSync();e.useVolumeSync&&this.onVolumeSync()},onStateChange:function(e){var t=this.p,i=e.data,n=this;switch(e.type){case o.EVENT.ON_SYNC:return this.onSync();case o.EVENT.ON_BEFORE_DEVICE_PLAY:return this.autoplay(e);case o.EVENT.ON_BEFORE_ONCE_PLAY:this.setInitVolume({volume:o.getSavedVolume(),mute:o.getSavedMuted()});return;case o.EVENT.ON_BEFORE_PLAY:return this.beforePlay();case o.EVENT.CAN_PLAY:r.call(this,e);return setTimeout(function(){s.call(n,e)},1);case o.EVENT.STATE_CHANGE:this.lastState=e.data;this.lastStateText=o.getStateName(e.data);e.data!==o.STATE.PAUSED&&(this.__disablePauseDisplayForStop=!1);switch(e.data){case o.STATE.SETSOURCE:this.clear();break;case o.STATE.PLAYING:this.__disableLoadingDisplayForStop=!1;r.call(this,e);setTimeout(function(){s.call(n,e)},1);break;case o.STATE.PAUSED:r.call(this,e);setTimeout(function(){s.call(n,e)},1);break;case o.STATE.ENDED:this.__disableLoadingDisplayForStop=!1;setTimeout(function(){t.src&&t.src.length&&t.src.length>t.playlistIndex+1&&t.next()},1)}return;case o.EVENT.PLAY_MEDIA:return this.play(e);case o.EVENT.PAUSE_MEDIA:return this.pause(e);case o.EVENT.STOP_MEDIA:return this.stop();case o.EVENT.PREVIOUS_MEDIA:return this.previous();case o.EVENT.NEXT_MEDIA:return this.next();case o.EVENT.CURRENT_MEDIA:return this.current(e);case o.EVENT.INDEX_MEDIA:return this.index(e.data);case o.EVENT.MUTE_MEDIA:return i?this.mute():this.unMute();case o.EVENT.SET_VOLUME:return this.setVolume(i);case o.EVENT.SEEKTO_MEDIA:return;case o.EVENT.SET_PLAYBACK_RATE:return this.setPlaybackRate(i);case o.EVENT.SET_PLAYBACK_QUALITY:return this.setPlaybackQuality(i);case o.EVENT.SET_PLAYBACK_SUBTITLE:return this.setPlaybackSubtitle(i)}},setSwitchSourceData:function(e){this.switchSourceData=e},getSwitchSourceData:function(){return this.switchSourceData},isPlaying:function(){switch(this.getPlayerState()){case o.STATE.PLAYING:case o.STATE.BUFFERING:return!0}return!1},getPlayerState:function(){throw new Error("getPlayerState is abstract method.")},player:function(){throw new Error("player is abstract method.")},source:function(){},autoplay:function(){throw new Error("autoplay is abstract method.")},beforePlay:function(){var e=this,t=this.p,i=this.currentMediaSource(),n=!0,r=!1,s=null;this.virtualTime()&&setTimeout(function(){e.seekTo(0)},1);if(i){if(i.errorContinueTime){r=i.errorContinueTime;s=i.errorIsPlaying}else if(i.input&&i.input.autoContinueTime)r=i.input.autoContinueTime;else if(i.input&&i.input.continueTime){r=i.input.continueTime;n=!1}r&&setTimeout(function(){e.pause();setTimeout(function(){t.callStateChange({type:o.EVENT.CONTINUE_TIME,data:r,isAuto:n,isPlaying:s})},1)},100)}},play:function(){throw new Error("play is abstract method.")},pause:function(){throw new Error("pause is abstract method.")},stop:function(){throw new Error("stop is abstract method.")},beforeStop:function(){var e=!this.p.attr.enableStopDisplay;this.__disablePauseDisplayForStop=e;this.__disableLoadingDisplayForStop=e},info:function(e){if((e=e||0)<0)throw new Error("source index > 0. index: "+e);var t=this.p;return a.isArray(t.src)&&t.src.length&&t.src.length>e?t.src[e]:null},previous:function(){var e,t=this.p;if(a.isArray(t.src)&&t.src.length){0<t.playlistIndex?e=t.src[--t.playlistIndex]:-1!=t.playlistIndex&&(e=t.src[t.playlistIndex]);e&&this.source(e)}},next:function(){var e,t=this.p;a.isArray(t.src)&&t.src.length&&(e=-1==t.playlistIndex?t.src[++t.playlistIndex]:t.src.length>t.playlistIndex+1?t.src[++t.playlistIndex]:t.src.length>t.playlistIndex?t.src[t.playlistIndex]:t.src[t.playlistIndex=t.src.length-1])&&this.source(e)},current:function(e){var t,i=this.p;if(a.isArray(i.src)&&i.src.length){var n=i.playlistIndex;n<0?n=i.playlistIndex=0:0<=n&&n<i.src.length||(n=i.playlistIndex=0);t=i.src[n];this.source(t,e)}},index:function(e){if("number"!=typeof e)throw new Error("index argument is not number.");var t,i=this.p;if(!a.isArray(i.src)||!i.src.length)throw new Error("Not found source.");if(i.src.length<=e||e<0)throw new Error("Not found source. srclength: "+i.src.length+", index: "+e);i.playlistIndex=e;t=i.src[e];this.source(t)},isMuted:function(){throw new Error("isMuted is abstract method.")},mute:function(){throw new Error("mute is abstract method.")},unMute:function(){throw new Error("unMute is abstract method.")},getVolume:function(){throw new Error("getVolume is abstract method.")},setVolume:function(e){throw new Error("setVolume is abstract method.")},setInitVolume:function(e){this.__isSetInitVolume=!0;this.__isSetInitMute=!0;this.setVolume(e.volume);this.p.attr.enableInitMute&&e.mute?this.mute():this.unMute()},duration:function(){throw new Error("duration is abstract method.")},currentTime:function(){throw new Error("currentTime is abstract method.")},getBuffering:function(){throw new Error("getBuffering is abstract method.")},watchTime:function(){return this.lastWatchTime},seekTo:function(){throw new Error("seekTo is abstract method.")},getPlaybackRate:function(){throw new Error("getPlaybackRate is abstract method.")},getAvailablePlaybackRates:function(){var e=this.p.attr.use_rates;return a.isArray(e)&&e.length?e:[.25,.5,.75,1,1.25,1.5,1.75,2]},setPlaybackRate:function(){throw new Error("setPlaybackRate is abstract method.")},getPlaybackQuality:function(e){var t=this.currentMediaSource(),i=t?t.getQuality():null;return e&&i?[i]:i},getAvailableQualityLevels:function(){var e=this.currentMediaSource();return e?e.getQualityList():null},setPlaybackQuality:function(e){this.currentMediaSource().setQuality(e)},getAvailableSubtitles:function(){var e=this.currentMediaSource();return e?e.getSubtitleList():null},getPlaybackSubtitle:function(){var e=this.currentMediaSource();return e?e.getSubtitle():null},setPlaybackSubtitle:function(e){var t=this.currentMediaSource();t&&t.setSubtitle(e)},temporary_removal:function(){this.is_temporary_removal=!0},untemporary_removal:function(){this.is_temporary_removal=!1},virtualTime:function(){var e=this.p.currentMediaSource();return e&&e.input&&e.input.virtualTime},virtualCurrentTime:function(e){var t=this.virtualTime();if(t){(e=e||0)<t.start?e=t.start:e>t.end&&(e=t.end);return e-t.start}return e||0},virtualSeekToValue:function(e){var t=this.virtualTime();if(t){e=e||0;if((e+=t.start)>t.end)return t.end}return e},setSphericalProperties:function(e){throw new Error("setSphericalProperties is abstract method.")},getSphericalProperties:function(){return null},isSphericalProperties:function(){return!1}});return e})}();!function(){"use strict";var s=getDframework(),a=s.module("imgtech.media.Media");s.define("imgtech.media.VideoPlayer",function(){var i=s.module("imgtech.media.module.Device");s.module("imgtech.media.Source");function t(e){i.apply(this,arguments);if(e){var t;this.guid=this.getPlayerType()+"_"+s.guid("");this.de=this.device?this.device.element:null;this.currentVideoSource=null;this.firstVideoPlayForLive=!1;this.usePauseBtn=!1;this.usePlaybackRate=1;(t=this.p.attr)&&s.b.iOS&&(t.useVolumeSync=!0)}}s.extendClass(t,i,{currentMediaSource:function(){return this.currentVideoSource},getClassName:function(){return"imgtech.media.VideoPlayer"},getPlayerType:function(){return"video"},destroy:function(){var e=this.vp;try{e.pause()}catch(t){}try{e.removeAttribute("src")}catch(t){}try{e.load()}catch(t){}},onReady:function(e){if(this.de){var t=this.p;if(s.b.safari&&s.b.isWindows){var i="Not supported safari (video/hls).";"hls"==this.getPlayerType()&&(i+=" You can use flash for hls(m3u8) !!!");t.callStateChange({type:a.EVENT.SET_DISABLED,data:"fatal",parent:e,where:this.getPlayerType(),message:i});t.error(i);throw new Error(i)}var n=this.vp=document.createElement("video"),r=(e&&e.source&&e.source.source(),t.attr&&t.attr["native"]);n.style.width="100%";n.style.height="100%";n.style.margin="0px 0px";n.style.padding="0px 0px";n.style.textAlign="center";n.style.verticalAlign="middle";n.setAttribute("webkit-playsinline",!0);n.setAttribute("webkitplaysinline",!0);n.setAttribute("playsinline",!0);t.attr.crossOrigin&&n.setAttribute("crossOrigin",t.attr.crossOrigin);n.setAttribute("autoplay","true");r&&s.b.isMobile&&((r.iOS||r.ios)&&s.b.iOS&&s.b.safari?n.setAttribute("controls","true"):r.android&&s.b.android&&n.setAttribute("controls","true"));n.setAttribute("id",this.guid);n.setAttribute("playerType",this.getPlayerType());n.setAttribute("playerClassName",this.getClassName());this.de.appendChild(n);this.zonemediaelement=n;this.onReadyPatchEvent();return e&&e.callback?e.callback():this.next()}},onStateChange:function(e){this.p;switch(e.type){case a.EVENT.ON_READY:return this.onReady(e)}t.__super.onStateChange.apply(this,arguments)},getPlayerState:function(){var e=this.vp;return e?e.ended?a.STATE.ENDED:0===e.readyState?a.STATE.UNSTARTED:e.readyState<e.HAVE_FUTURE_DATA?a.STATE.CUED:e.paused?a.STATE.PAUSED:a.STATE.PLAYING:a.STATE.UNSTARTED},reset:function(){this.currentVideoSource=null},source:function(e){var t=this.vp,i=this.p,n=this;if(t&&e){this.isBeforePlay=!1;this.usePlaybackRate=1;this.currentVideoSource&&this.currentVideoSource.stop();setTimeout(function(){n.currentVideoSource=e;t.src=e.source();i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.SETSOURCE,source:e,device:n})},1)}},autoplay:function(){var e=this.vp,t=this.p;if(t.attr.autoplay)e&&e.play?s.b.isMobile?t.warn(" ## autoplay: maybe not play. Because this is mobile."):t.warn(" ## autoplay: maybe playing !!!"):t.warn(" ## autoplay: not found play method !!!");else if(e&&e.pause){t.log(" ## autoplay: call pause");e.pause()}else t.warn(" ## autoplay: Not found pause function.")},play:function(){var e=this.vp,t=this.p,i=this.currentVideoSource,n=this;if(!this.currentVideoSource)return t.warn("Not play: no source");if(i.isLive())if(t.isPlaying())e&&e.play?e.play():t.warn(" ## play: not play. Becase play function.");else if(this.__has_not_play||this.usePauseBtn)t.current();else{this.__has_not_play=!0;e.play()}else if(e&&e.play){e.play();setTimeout(function(){n.usePauseBtn&&s.b.ie&&1!==n.usePlaybackRate&&(e.playbackRate=n.usePlaybackRate)},1)}else t.warn(" ## play: not play. Becase play function.")},pause:function(){var e=this.vp;if(e&&e.pause){this.usePauseBtn=!0;e.pause()}},stop:function(){var e=this;setTimeout(function(){(function(){var e=this.vp;if(e&&e.pause){t.__super.beforeStop.apply(this,arguments);e.pause();this.seekTo(0)}}).call(e)})},isMuted:function(){var e=this.vp;return!!e&&e.muted},mute:function(){var e=this.vp;e&&(e.muted=!0)},unMute:function(){var e=this.vp;e&&(e.muted=!1)},getVolume:function(){var e=this.vp;return e&&e.volume?100*e.volume:0},setVolume:function(e){var t=this.vp;if(t){e=(5<e?e:5)/100;t.volume=e}},duration:function(e){var t=this.vp,i=t&&t.duration?t.duration:0;return e?i||0:this.virtualCurrentTime(i)},currentTime:function(e){var t=this.vp,i=t&&t.currentTime?t.currentTime:0;return e?i||0:this.virtualCurrentTime(i)},getBuffering:function(){var e=this.vp,t=this.duration(),i=e.buffered;return i&&i.length&&i.end&&t?this.virtualCurrentTime(i.end(0))/t:0},seekTo:function(e){var t=this.vp,i=this.currentVideoSource;if(t&&i&&!i.isLive())try{t.currentTime=this.virtualSeekToValue(e)}catch(n){s.error(n)}},getDefaultPlaybackRate:function(){var e,t=this.getAvailablePlaybackRates();if(t)for(e=0;e<t.length;e++)if(1==t[e].value)return t[e];return null},getPlaybackRate:function(){var e=this.vp;return e&&e.playbackRate?e.playbackRate:1},setPlaybackRate:function(e){var t,i=this.vp,n=this.p,r=a.getRateValue(e),s=this.currentVideoSource;if(i&&(t=i.playbackRate)!=r.value){i.playbackRate=r.value;this.usePlaybackRate=r.value;t!=i.playbackRate&&n.callStateChange({type:a.EVENT.RATE_CHANGE,data:r,source:s,device:this,parent:null})}},getVideoSize:function(){var e=this.vp;return{width:e.videoWidth,height:e.videoHeight}},onReadyPatchEvent:function(){var i=this.p,e=this.vp,n=this;s.on(e,"error",function(e){s.error(e);i.callStateChange({type:a.EVENT.ON_ERROR,data:e,source:n.currentMediaSource(),device:n})});s.on(e,"play",function(e){if(n.is_temporary_removal)return setTimeout(function(){n.stop()},1);i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.PLAYING,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"pause",function(e){if(n.is_temporary_removal)return setTimeout(function(){n.stop()},1);i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.PAUSED,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"timeupdate",function(e){if(n.is_temporary_removal)return setTimeout(function(){n.stop()},1);n.onCurrentTimeSync()});s.on(e,"progress",function(e){if(n.is_temporary_removal)return setTimeout(function(){n.stop()},1);n.onCurrentTimeSync();n.onBufferingSync()});s.on(e,"volumechange",function(e){n.is_temporary_removal||n.onVolumeSync()});s.on(e,"canplay",function(e){if(n.is_temporary_removal)return setTimeout(function(){n.stop()},1);i.callStateChange({type:a.EVENT.CAN_PLAY,stype:"canplay",source:n.currentVideoSource,device:n,parent:null})});s.on(e,"loadstart",function(e){n.is_temporary_removal||i.callStateChange({type:a.EVENT.WAITTING,stype:"loadstart",data:!0,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"waiting",function(e){n.is_temporary_removal||i.attr.wait&&i.attr.wait.disable&&s.b.isWindows&&s.b.edge||s.b.ie||i.callStateChange({type:a.EVENT.WAITTING,stype:"waiting",data:!0,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"seeking",function(e){n.is_temporary_removal||i.callStateChange({type:a.EVENT.WAITTING,stype:"seeking",data:!0,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"seeked",function(e){n.is_temporary_removal||i.callStateChange({type:a.EVENT.WAITTING,stype:"seeked",data:!1,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"ended",function(e){n.is_temporary_removal||i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.ENDED,source:n.currentVideoSource,device:n,parent:null})});s.on(e,"loadeddata",function(e){if(!n.is_temporary_removal){var t=n.getVideoSize();t.width&&t.height&&i.callStateChange({type:a.EVENT.VIDEO_SIZE_DATA,data:n.getVideoSize(),source:n.currentVideoSource,device:n,parent:null})}})}});return t})}();!function(){"use strict";var i=getDframework(),s=i.module("imgtech.media.Media");i.define("imgtech.media.HlsPlayer",function(){var t=i.module("imgtech.media.VideoPlayer"),r=i.module("imgtech.media.Source");function e(e){t.apply(this,arguments);e&&(this.guid="hls_"+i.guid(""))}i.extendClass(e,t,{getClassName:function(){return"imgtech.media.HlsPlayer"},getPlayerType:function(){return"hls"},source:function(e){if(!(e instanceof r))throw new TypeError("src is not instanceof Source");var t=this.vp,i=this.p,n=(this.hls,this);if(e)if(Hls.isSupported()){this.isBeforePlay=!1;this.currentVideoSource&&this.currentVideoSource.stop();this.hls=new window.Hls;this.hls.attachMedia(t);this.hls.on(Hls.Events.MEDIA_ATTACHED,function(){n.currentVideoSource=e;n.hls.loadSource(e.source());i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.SETSOURCE,source:e,device:n})})}else i.error(new Error("Not supported HLS !!!"))}});return e})}();!function(){"use strict";var f=getDframework(),s=f.module("imgtech.media.Media");f.define("imgtech.Flash",function(){function e(){}e.installPageElement=function(e){var t=e&&e.getnewflash?e.getnewflash:"getnewflash.png",i=document.createElement("div");f.addClass(i,"mpv-getnewflash");var n="<table><tr><td align='center' valign='middle'>\n<div>\n<a href='http://www.adobe.com/go/getflashplayer'>\n<img class='mpv-getnewflash-image' src='"+t+"' alt='Get Adobe Flash player'></a>\n</div>\n</td></tr></table>\n";i.innerHTML=n;return i};e.isInstalled=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes["application/x-shockwave-flash"]!==undefined)return!0}return!1};e.getFlashParameters=function(e){e||(e={});return{allowFullscreen:e.allowFullscreen?e.allowFullscreen:"true",allowNetworking:e.allowNetworking?e.allowNetworking:"all",allowScriptAccess:e.allowScriptAccess?e.allowScriptAccess:"always",quality:e.quality?e.quality:"high",wmode:e.wmode?e.wmode:"transparent",flashvars:e.flashvars?e.flashvars:"",movie:e.movie}};e.getFlashVars=function(e){e||(e={});if(!e.id)throw new Error("Not found flash id.");return{autoPlay:!0,continuerTime:e.continuerTime?e.continuerTime:0,debugMode:!!e.debugMode,domain:e.domain?e.domain:"",id:e.id,isLive:e.isLive,poster:e.poster?e.poster:"",skipInterval:e.skipInterval?e.skipInterval:5,source:e.source?e.source:"",tastingTime:e.tastingTime?e.tastingTime:0,useShortcuts:!0===e.useShortcuts||"true"==e.useShortcuts,volume:e.volume?e.volume:.5}};e.getFlashVarString=function(e){var t,i,n="";for(t in e){i=e[t];n+=n?"&"+t+"="+i:t+"="+i}return n};return e});f.define("imgtech.media.FlashPlayer",function(){var t=f.module("imgtech.media.module.Device"),h=f.module("imgtech.media.Source"),d=f.module("imgtech.Flash");function n(e){t.apply(this,arguments);if(e){this.deviceElement=this.device?this.device.element:null;this.currentFlashSource=null;this.guid="flash_"+f.guid("");this.isFlashFirstLoading=!1;this.isFlashAutoPlayLoaded=!1;this.isCalledFlashReady=!1;this.lastFlashState=s.STATE.UNSTARTED;this.lastFlashMuted=!1;this.lastFlashVolume=50;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastFlashBuffering=0}}f.extendClass(n,t,{currentMediaSource:function(){return this.currentFlashSource},getClassName:function(){return"imgtech.media.FlashPlayer"},getPlayerType:function(){return"flash"},repairFlashFirstLoading:function(){if(!this.isFlashFirstLoading){this.isFlashFirstLoading=!0;this.p.callStateChange({type:s.EVENT.SET_DISABLED,data:"success",where:"flash",source:this.currentFlashSource,device:this})}},onStateChange:function(e){var t=this.p,i=n.__super.onStateChange;switch(e.type){case s.EVENT.ON_READY:return this.onReady(e);case s.EVENT.ON_BEFORE_DEVICE_PLAY:break;case s.EVENT.ON_BEFORE_ONCE_PLAY:i.apply(this,arguments);this.isMuted()&&this.p.mute();return;case s.EVENT.STATE_CHANGE:switch(e.data){case s.STATE.PLAYING:this.repairFlashFirstLoading();this.isFlashAutoPlayLoaded||(this.isFlashAutoPlayLoaded=!0);t.callStateChange({type:s.EVENT.CAN_PLAY,stype:"playing",where:"flash",source:this.currentFlashSource,device:this,parent:e});break;case s.STATE.PAUSED:this.repairFlashFirstLoading();t.callStateChange({type:s.EVENT.CAN_PLAY,stype:"paused",where:"flash",source:this.currentFlashSource,device:this,parent:e})}break;case s.EVENT.WAITTING:e.data&&this.repairFlashFirstLoading()}i.apply(this,arguments)},getPlayerState:function(){return this.lastFlashState},reset:function(){this.lastFlashState=s.STATE.UNSTARTED;this.currentFlashSource=null},source:function(e){if(!(e instanceof h))throw new TypeError("source is not instanceof Source");var t=this.getFlashObject(),i=this.p;if(t&&t.setSource){this.isBeforePlay=!1;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastFlashBuffering=0;this.lastFlashState=s.STATE.SETSOURCE;this.currentFlashSource&&this.currentFlashSource.stop();this.currentFlashSource=e;i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.SETSOURCE,source:this.currentFlashSource,device:this,parent:null});t.setSource(e.source())}},autoplay:function(){var e=this.p;if(e.attr.autoplay)e.warn(" ## autoplay: maybe playing");else{e.log(" ## autoplay: call pause");this.pause()}},play:function(){var e=this.getFlashObject(),t=this.p,i=this.currentFlashSource;if(this.lastFlashState==s.STATE.UNSTARTED||!i)return t.warn("Not play: unstarted or no source");if(e&&e.togglePlay)if(this.isPlaying())t.warn(" ## current playing");else if(!i.isRTMP()&&i.isLive()){t.warn(" ## retry current source. rtmp: "+i.isRTMP());this.source(i)}else if(i.isLive()){t.log(" ## toggle flash. rtmp: "+i.isRTMP());this.source(i)}else{t.log(" ## toggle flash. rtmp: "+i.isRTMP()+", source: "+i.source());e.togglePlay()}else t.warn(" ## Not found play function.")},pause:function(){var e=this.getFlashObject(),t=this.p,i=this.currentFlashSource;e&&e.togglePlay?(!i.isRTMP()&&i.isLive(),e.togglePlay()):t.warn(" ## Not found pause function.")},stop:function(){var e=this;setTimeout(function(){(function(){var e=this.getFlashObject(),t=this.p,i=this.lastFlashState;this.currentFlashSource;if(e&&e.playerstop){t.log(" ## stop flash player");if(this.virtualTime())if(i==s.STATE.PLAYING){n.__super.beforeStop.apply(this,arguments);this.pause();this.seekTo(0)}else i==s.STATE.PAUSED&&this.seekTo(0);else if(i==s.STATE.PLAYING||i==s.STATE.PAUSED){n.__super.beforeStop.apply(this,arguments);e.playerstop()}}}).call(e)},1)},isMuted:function(){return this.lastFlashMuted},mute:function(){var e=this.getFlashObject();e&&e.toggleMute&&e.toggleMute()},unMute:function(){var e=this.getFlashObject();e&&e.toggleMute&&e.toggleMute()},getVolume:function(){return this.lastFlashVolume},setVolume:function(e){var t=this.getFlashObject();t&&t.setvolume&&t.setvolume((5<e?e:5)/100)},duration:function(e){var t=this.lastFlashDuration;return e?t||0:this.virtualCurrentTime(t)},currentTime:function(e){var t=this.lastFlashCurrentTime;return e?t||0:this.virtualCurrentTime(t)},getBuffering:function(){return this.lastFlashBuffering},seekTo:function(e){var t=this.getFlashObject(),i=this.p,n=this.currentFlashSource;t&&t.seek&&n&&(n.isLive()||(n.isRTMP()&&!this.isPlaying()?i.error(" ## Not seek on pause. because this source is vod rtmp."):t.seek(this.virtualSeekToValue(e))))},getPlaybackRate:function(){this.getFlashObject();this.p.error("Not support getPlaybackRate at flash !!!");return 1},getAvailablePlaybackRates:function(){this.p.error("Not support getAvailablePlaybackRates at flash !!!");return[]},setPlaybackRate:function(e){var t=this.getFlashObject();t&&t.playbackRate!=e&&this.p.error("Not support setPlaybackRate at flash !!!")},getVideoSize:function(){return{width:300,height:200}},onDrawIe8:function(e){if(!this.deviceElement)throw new Error("Not found player element.");var t,i,n,r;this.p;t="<object";for(r in this.flashObjectAttribute)t+=" "+r+'="'+this.flashObjectAttribute[r]+'"';t+=">";n="";for(r in this.flashParameters)n+='<param name="'+r+'" value="'+this.flashParameters[r]+'"></param>';i="<embed";for(r in this.flashEmbedAttribute)i+=" "+r+'="'+this.flashEmbedAttribute[r]+'"';var s=t+(i+="></embed>")+n+"</object>";e.innerHTML=s},__getStaticSwfName:function(){return"flashplayer.swf"},__getSwfPath:function(){if(this.p.attr.flashpath)return this.p.attr.flashpath;for(var e=f.queryAll("script"),t="js/source/source.js",i=0;i<e.length;i++){var n=e[i].src,r=n.lastIndexOf("?");-1!==r&&(n=n.substring(0,r));if(-1!==(r=n.lastIndexOf(s.filename))){if(n.substring(r)===s.filename)return n.substring(0,r)+this.__getStaticSwfName()}else if(-1!==(r=n.lastIndexOf(t))&&n.substring(r)===t)return n.substring(0,r)+"contrib/"+this.__getStaticSwfName()}void 0;return ns+"/js/"+this.__getStaticSwfName()},__getIsDebug:function(){var e=this.p.attr.debug;return!!(e&&e.use&&e.flash)},getFlashObject:function(){return this.flash},onDraw:function(e){if(!this.deviceElement)throw new Error("Not found player element.");if(!(e.source instanceof h))throw new Error("e.source is not instanceof Source");var t=f.b,i=this.p,n=(i.attr.namespace&&i.attr.namespace,e.source),r=this.guid,s=this.__getSwfPath(),a=this.__getIsDebug();this.flashObjectAttribute={data:s,id:r,name:r,width:"100%",height:"100%",type:"application/x-shockwave-flash"};this.flashEmbedAttribute={allowfullscreen:"true",pluginspage:"http://www.macromedia.com/go/getflashplayer",quality:"high",src:s,type:"application/x-shockwave-flash"};this.flashVars=d.getFlashVars({domain:i.attr.domain,id:r,debugMode:a,autoPlay:!!i.attr.autoplay,isLive:n.isLive()});this.flashVarString=d.getFlashVarString(this.flashVars);this.flashParameters=d.getFlashParameters({movie:s,flashvars:this.flashVarString});var o=document.createElement("div");o.setAttribute("playerType","flash");o.setAttribute("playerClassName",this.getClassName());o.style.position="absolute";o.style.width="100%";o.style.height="100%";o.style.margin="0px 0px";o.style.padding="0px 0px";if(t.isWindows&&t.ie&&t.ie<9){this.flashObjectAttribute.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";this.onDrawIe8(o);this.flash=f.query(o,"object");this.deviceElement.appendChild(o);this.onReadyPatchEvent(e)}else{var l,u,c=document.createElement("object");for(u in this.flashObjectAttribute)c.setAttribute(u,this.flashObjectAttribute[u]);for(u in this.flashParameters){(l=document.createElement("param")).setAttribute("name",u);l.setAttribute("value",this.flashParameters[u]);c.appendChild(l)}o.appendChild(c);this.deviceElement.appendChild(o);this.flash=c;this.onReadyPatchEvent(e)}this.zonemediaelement=o;f.addClass(this.flash,"mpv_video")},onReady:function(e){var t=this.p;if(f.b.isMobile||d.isInstalled()){if(f.b.isMobile){var i="Not supported mobile (flash).";t.callStateChange({type:s.EVENT.SET_DISABLED,data:"fatal",where:"flash",message:i,source:this.currentFlashSource,device:this,parent:null});t.error(i);throw new Error(i)}this.onDraw(e);t.callStateChange({type:s.EVENT.SET_DISABLED,data:"testing",where:"flash",source:this.currentFlashSource,device:this,parent:null})}else{f.error("Not installed flash !!!");var n=d.installPageElement({getnewflash:t.attr.imagePath+"/draft/getnewflash.png"});this.deviceElement.appendChild(n);t.callStateChange({type:s.EVENT.SET_DISABLED,data:"fatal",where:"flash",device:this,parent:null})}},onReadyPatchEvent:function(e){var t=this.p,i=this.getFlashObject();if(!i)throw new Error("Not found flash player.");f.on(i,"error",function(e){t.error(" ## flash-error",e)});var n=this.__flashHandler(e);i.player=n},onFlashMediaPlayerStateChange:function(e){var t=this,i=this.p;if(this.is_temporary_removal)return"ready"===e||"buffering"===e||"playing"===e?setTimeout(function(){t.stop()},1):void 0;switch(e){case"loading":i.callStateChange({type:s.EVENT.WAITTING,data:!0,stype:"loading/flash",source:this.currentFlashSource,device:this,parent:null});break;case"ready":this.lastFlashState=s.STATE.CUED;i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.CUED,source:this.currentFlashSource,device:this,parent:null});break;case"buffering":var n=this.duration(),r=this.currentTime();(0===n||3<n-r)&&i.callStateChange({type:s.EVENT.WAITTING,data:!0,stype:"buffering/flash",source:this.currentFlashSource,device:this,parent:null});break;case"playing":this.lastFlashState=s.STATE.PLAYING;i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.PLAYING,source:this.currentFlashSource,device:this,parent:null});break;case"paused":this.lastFlashState=s.STATE.PAUSED;i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.PAUSED,source:this.currentFlashSource,device:this,parent:null});break;case"end":this.lastFlashState=s.STATE.ENDED;i.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.ENDED,source:this.currentFlashSource,device:this,parent:null})}},__flashHandler:function(e){var i=this,t=this.p;return{flashPlayer:{onMediaError:function(e){f.error(e);t.callStateChange({type:s.EVENT.ON_ERROR,data:e,source:i.currentMediaSource(),device:i})},onMediaPlayerEnd:function(){if(!i.is_temporary_removal){i.lastFlashState=s.STATE.ENDED;t.callStateChange({type:s.EVENT.STATE_CHANGE,data:s.STATE.ENDED,source:i.currentFlashSource,device:i,parent:null})}},onMediaPlayerStateChange:function(e){if(f.isArray(e))for(var t in e)i.onFlashMediaPlayerStateChange(e[t]);else i.onFlashMediaPlayerStateChange(e)},onDurationChange:function(e){if(!i.is_temporary_removal){i.lastFlashDuration=Number(e);i.onCurrentTimeSync()}},onTimeUpdate:function(e){if(i.is_temporary_removal)return setTimeout(function(){i.pause()},1);i.lastFlashCurrentTime=Number(e);i.onCurrentTimeSync()},onBufferingChange:function(e){if(!i.is_temporary_removal){i.lastFlashBuffering=e||0;i.onBufferingSync()}},onMuteChange:function(e){if(!i.is_temporary_removal){f.isArray(e)&&(e=e[0]);i.lastFlashMuted=e;setTimeout(function(){t.callStateChange({type:s.EVENT.VOLUME_CHANGE,data:{volume:i.lastFlashVolume,muted:i.lastFlashMuted,where:"mutechange/flash",source:i.currentFlashSource,device:i,parent:null}})},1)}},onVolumeChange:function(e){if(!i.is_temporary_removal){i.lastFlashVolume=100*e;setTimeout(function(){t.callStateChange({type:s.EVENT.VOLUME_CHANGE,data:{volume:i.lastFlashVolume,muted:i.lastFlashMuted,where:"volumechange/flash",source:i.currentFlashSource,device:i,parent:null}})},1)}},isReady:function(){t.log("## isReady on flash");if(i.is_temporary_removal)return!1;if(i.isCalledFlashReady)return!0;i.isCalledFlashReady=!0;setTimeout(function(){e&&e.callback?e.callback():t.next()},1);return!0},canPlay:function(){if(!i.is_temporary_removal)return!0},canPause:function(){if(!i.is_temporary_removal)return!0},statusPlaying:function(){t.log("## statusPlaying on flash");if(i.is_temporary_removal)return!1;return!0},statusTime:function(){t.log("## statusTime on flash");return 0}}}}});return n})}();!function(){"use strict";var e=getDframework(),a=e.module("imgtech.media.Media");e.define("imgtech.media.FlashPlayer2",function(){e.module("imgtech.Flash");var n=e.module("imgtech.media.Source"),t=e.module("imgtech.media.FlashPlayer");function r(e){t.apply(this,arguments)}function s(e,t,i){var n=this.isPseudo(e);n&&this.p.log(" ## pseudo source: "+e.source());this.flash.flashSource(e.source(),n,t,i)}e.extendClass(r,t,{getClassName:function(){return"imgtech.media.FlashPlayer2"},getPlayerType:function(){return"flash"},onStateChange:function(e){return r.__super.onStateChange.apply(this,arguments)},isPseudo:function(e){var t=!(!e.input||!1!==e.input.isPseudo&&!0!==e.input.isPseudo)?e.input.isPseudo:null;null===t&&(e.isHLS()||e.isRTMP()||e.isLive()||(t=!0));return t},flashReconnected:function(){var e=this.currentFlashSource;if(!(e instanceof n))throw new TypeError("currentFlashSource is not instanceof Source");var t=this.flash,i=this.p;if(t&&t.flashSource){i.warn(" ## Flash reconnected");s.call(this,e,!0,this.lastFlashCurrentTime)}else i.error(" ## Flash reconnect failed !!!")},source:function(e){if(!(e instanceof n))throw new TypeError("source is not instanceof Source");var t=this.flash,i=this.p;if(!t)throw new Error("Has not flash object.");if(!t.flashSource)throw new Error("Not found source method on flash");if(t&&t.flashSource){this.isBeforePlay=!1;this.lastFlashCurrentTime=0;this.lastFlashDuration=0;this.lastSendVideoSizeData=!1;this.lastFlashState=a.STATE.SETSOURCE;this.currentFlashSource&&this.currentFlashSource.stop();this.currentFlashSource=e;i.callStateChange({type:a.EVENT.STATE_CHANGE,data:a.STATE.SETSOURCE,source:this.currentFlashSource,device:this,parent:null});s.call(this,e,!1,0)}},appVersion:function(){var e=this.flash;if(e&&e.flashAppVersion)return e.flashAppVersion()},play:function(){var e=this.flash,t=this.p,i=this.currentFlashSource;if(e&&e.flashPlay)if(this.isPlaying())t.warn(" ## current playing");else if(i.isLive()){t.log(" ## source");this.source(i)}else{t.log(" ## play");e.flashPlay()}else t.warn(" ## Not found play function.")},pause:function(){var e=this.flash,t=this.p;this.currentFlashSource;e&&e.flashPause?e.flashPause():t.warn(" ## Not found pause function.")},stop:function(){var e=this;setTimeout(function(){(function(){var e=this.flash,t=this.p,i=this.lastFlashState;this.currentFlashSource;if(e&&e.flashStop){t.log(" ## stop flash player");if(this.virtualTime())if(i==a.STATE.PLAYING){r.__super.beforeStop.apply(this,arguments);this.pause();this.seekTo(0)}else i==a.STATE.PAUSED&&this.seekTo(0);else if(i==a.STATE.PLAYING||i==a.STATE.PAUSED){r.__super.beforeStop.apply(this,arguments);this.pause();this.seekTo(0)}}}).call(e)},1)},setVolume:function(e){var t=this.flash;t&&t.flashVolume&&t.flashVolume((5<e?e:5)/100)},mute:function(){var e=this.flash;e&&e.flashMute&&e.flashMute()},unMute:function(){var e=this.flash;e&&e.flashUnmute&&e.flashUnmute()},seekTo:function(e){var t=this.flash,i=this.p,n=this.currentFlashSource;t&&t.flashSeek&&n&&(n.isLive()||(n.isRTMP()&&!this.isPlaying()?i.error(" ## Not seek on pause. because this source is vod rtmp."):t.flashSeek(this.virtualSeekToValue(e))))},canPlay:function(){var e=this.flash;if(e&&e.flashCanPlay)return e.flashCanPlay()},canPause:function(){var e=this.flash;if(e&&e.flashCanPause)return e.flashCanPause()},canSeek:function(e){var t=this.flash;if(t&&t.flashCanSeek)return t.flashCanSeek(e)},getVideoSize:function(){var e=this.flash;return e&&e.flashMediaWidth&&e.flashMediaHeight?{width:e.flashMediaWidth(),height:e.flashMediaHeight()}:{width:0,height:0}},__getStaticSwfName:function(){return"flashplayer2.swf"},onReadyPatchEvent:function(e){},onDraw:function(e){var t=this,i=this.__flashHandler(e).flashPlayer,n=this.p;delete i.statusPlaying;delete i.statusTime;delete i.isReady;i.start=function(){n.log("## start on flash");if(t.isCalledFlashReady){t.flashReconnected();return!0}t.isCalledFlashReady=!0;if((!e||e&&!e.callback)&&t.is_temporary_removal)return!0;setTimeout(function(){e&&e.callback?e.callback():n.next()},1);return!0};window[this.guid]={flash:i};return r.__super.onDraw.call(this,e)},onFlashMediaPlayerStateChange:function(e){var t=this,i=this.p;if(0!==e.indexOf("seeked:")){if(!this.lastSendVideoSizeData){var n=this.getVideoSize();if(n.width&&n.height){this.repairFlashFirstLoading();this.lastSendVideoSizeData=!0;i.callStateChange({type:a.EVENT.VIDEO_SIZE_DATA,data:this.getVideoSize(),source:this.currentFlashSource,device:this,parent:null})}}return r.__super.onFlashMediaPlayerStateChange.apply(this,arguments)}this.repairFlashFirstLoading();if(!this.isPlaying()){this.play();setTimeout(function(){t.pause()},1)}}});return r})}();!function(e){"use strict";var c=window.getDframework(),h=c.module("imgtech.media.Media");c.define("imgtech.media.Youtube",function(){var n=!1;var r=c.module("imgtech.media.module.Device"),i=e.onYouTubeIframeAPIReady,s=[],a=!1,l=function(e){switch(e){case YT.PlayerState.UNSTARTED:return h.STATE.UNSTARTED;case YT.PlayerState.ENDED:return h.STATE.ENDED;case YT.PlayerState.PLAYING:return h.STATE.PLAYING;case YT.PlayerState.PAUSED:return h.STATE.PAUSED;case YT.PlayerState.BUFFERING:return h.STATE.BUFFERING;case YT.PlayerState.CUED:return h.STATE.CUED;default:return h.STATE.NONE}};e.onYouTubeIframeAPIReady=function(){a=!0;try{i&&i()}catch(t){c.error(t)}for(var e=0;e<s.length;e++)s[e].onYoutubeApiReady()};function u(e){r.apply(this,arguments);if(!n){n=!0;!function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.src="https://www.youtube.com/iframe_api";t.parentNode.insertBefore(e,t)}()}if(e){s.push(this);this.guid="youtube_"+c.guid("");var t;if(t=this.p.attr){t.youtube||(t.youtube={});t.useUpdateTimeSync=!0;t.useBufferingSync=!0;t.useVolumeSync=!0;t.youtube.use_youtube_control&&(t.no_controls=!0);this.youtube=t.youtube;this.playerVars=t.youtube.playerVars?t.youtube.playerVars:{};!function(e){e.autoplay=1;e.rel||(e.rel=0);1!==e.iv_load_policy&&(e.iv_load_policy=3);e.controls||(e.controls=0);e.showinfo||(e.showinfo=0);e.modestbranding=1}(this.playerVars)}this.isYoutubeAutoPlayLoaded=!1;this.currentYoutubeSource=null;this.youtubeDeviceElement=null;this.currentPlaybackSubtitleData=null;this.isAutoHideExtendControl=!1;i=this,a&&setTimeout(function(){i.onYoutubeApiReady()},1)}var i}c.extendClass(u,r,{currentMediaSource:function(){return this.currentYoutubeSource},getClassName:function(){return"imgtech.media.Youtube"},getPlayerType:function(){return"youtube"},setBreakYoutubeOSD:function(){},isUseYoutubeOSD:function(){var e=this.p.module("layout");if(e)return e.isUseYoutubeOSD()},onReady:function(e){this.showPlayerLogo();this.___called_onready=e||!0;this.___called_onyoutubeapiready&&this.___called_onready&&this.onYoutubeInit(e)},onYoutubeApiReady:function(){this.___called_onyoutubeapiready=!0;this.___called_onyoutubeapiready&&this.___called_onready&&this.onYoutubeInit(this.___called_onready)},showControlInYoutubeOSD:function(){var e=this.p.module("layout");if(e){this.isUseYoutubeOSD()&&e.showControl();if(!this.isAutoHideExtendControl){this.isAutoHideExtendControl=!0;e.autoHideExtendControl()}}},showPlayerLogo:function(){var e;if(this.p.attr.usePlayerLogo&&(e=this.p.element("osd"))){var t=this.playerLogoElement=document.createElement("div");c.addClass(t,"mpv-logo");c.before(e.element,t)}},hidePlayerLogo:function(){var e;if(this.p.attr.usePlayerLogo&&(e=this.playerLogoElement)){c.remove(e);this.playerLogoElement=null}},onStateChange:function(e){var t=this.p;e.data;e.type!=h.EVENT.STATE_CHANGE||e.data!=h.STATE.PLAYING&&e.data!=h.STATE.PAUSED||this.hidePlayerLogo();switch(e.type){case h.EVENT.ON_READY:return this.onReady(e);case h.EVENT.STATE_CHANGE:switch(e.data){case h.STATE.PLAYING:this.showControlInYoutubeOSD();if(!this.youtube.use_youtube_playlist&&!this.isYoutubeAutoPlayLoaded){this.isYoutubeAutoPlayLoaded=!0;if(t.attr.autoplay)t.warn(" ## autoplay: maybe playing");else{t.log(" ## autoplay: call pause");t.pause()}}t.callStateChange({type:h.EVENT.CAN_PLAY,stype:"playing",where:"youtube",source:this.currentMediaSource(),device:this,parent:e});break;case h.STATE.PAUSED:this.showControlInYoutubeOSD();break;case h.STATE.ENDED:this.youtube.use_youtube_playlist||c.isArray(t.src)&&t.src.length&&t.src.length>t.playlistIndex+1&&t.next();break;case h.STATE.SETSOURCE:this.isAutoHideExtendControl=!1}}u.__super.onStateChange.apply(this,arguments)},getPlayerState:function(){return this.yp?l(this.yp.getPlayerState()):h.STATE.UNSTARTED},patchSourceId:function(e){var t=e.source(),i=t?t.toLowerCase():null;return i?0===i.indexOf("yt://")?t.substring("yt://".length):0===i.indexOf("youtube://")?t.substring("youtube://".length):t:null},loadVideoById:function(e){var t=this.yp,i=this.patchSourceId(e),n=this.p,r=this;if(t&&t.loadVideoById){this.isBeforePlay=!1;this.currentPlaybackSubtitleData=null;setTimeout(function(){r.currentYoutubeSource=e;t.loadVideoById(i);n.callStateChange({type:h.EVENT.STATE_CHANGE,data:h.STATE.SETSOURCE,source:e,device:r})},1)}},reset:function(){this.currentYoutubeSource=null},source:function(e){this.loadVideoById(e)},autoplay:function(){},play:function(){var e=this.yp,t=this.p;if(!this.currentYoutubeSource)return t.warn("Not play: unstarted or no source");e&&e.playVideo&&e.playVideo()},pause:function(){var e=this.yp;e&&e.pauseVideo&&e.pauseVideo()},stop:function(){var e=this.p,t=this.yp;if(t&&t.stopVideo){u.__super.beforeStop.apply(this,arguments);this.pause();this.seekTo(0);e.callStateChange({type:h.EVENT.WAITTING,data:!1,stype:"stop/youtube",source:this.currentMediaSource(),device:this})}},previous:function(){var e=this.p,t=this.yp;if(t&&c.isArray(e.src)){if(this.youtube.use_youtube_playlist&&t.previousVideo)return t.previousVideo();u.__super.previous.apply(this)}},next:function(){var e=this.p,t=this.yp;if(t&&c.isArray(e.src)){if(this.youtube.use_youtube_playlist&&t.nextVideo)return t.nextVideo();u.__super.next.apply(this)}},current:function(){var e=this.p;if(this.yp&&c.isArray(e.src)){if(this.youtube.use_youtube_playlist)return;u.__super.next.apply(this)}},isMuted:function(){var e=this.yp;return e&&e.isMuted?e.isMuted():null},mute:function(){var e=this.yp;e&&e.mute&&e.mute()},unMute:function(){var e=this.yp;e&&e.unMute&&e.unMute()},getVolume:function(){var e=this.yp;return e&&e.getVolume?e.getVolume():0},setVolume:function(e){var t=this.yp;t&&t.setVolume&&t.setVolume(5<e?e:5)},duration:function(e){var t=this.yp,i=t&&t.getDuration?t.getDuration():0;return e?i||0:this.virtualCurrentTime(i)},currentTime:function(e){var t=this.yp,i=t&&t.getCurrentTime?t.getCurrentTime():0;return e?i||0:this.virtualCurrentTime(i)},getBuffering:function(){var e=this.yp,t=e&&e.getVideoLoadedFraction?e.getVideoLoadedFraction():0;return t||0},seekTo:function(e,t){var i=this.yp,n=this.currentMediaSource();i&&i.seekTo&&n&&i.seekTo(this.virtualSeekToValue(e),t)},getPlaybackRate:function(){var e=this.yp,t=e&&e.getPlaybackRate?e.getPlaybackRate():null;return t||null},setPlaybackRate:function(e){var t=this.yp;t&&t.setPlaybackRate&&e&&e.value&&t.setPlaybackRate(e.value)},getAvailablePlaybackRates:function(){var e,t=this.yp,i=t&&t.getAvailablePlaybackRates?t.getAvailablePlaybackRates():null,n=[];if(i)for(e=0;e<i.length;e++)n.push({value:i[e]});return n},_getPlaybackQualityCode:function(e){switch(e){case"large":return"480p";case"medium":return"360p";case"small":case"tiny":return"240p";case"tiny":return"144p"}return e},_getPlaybackQualityData:function(e){return{code:this._getPlaybackQualityCode(e),label:e}},getPlaybackQuality:function(e){var t,i=this.yp,n=[];if(i&&i.getPlaybackQuality&&(t=i.getPlaybackQuality())){t=this._getPlaybackQualityData(t);if(!e)return t;n.push(t)}t=u.__super.getPlaybackQuality.call(this);if(!e)return t;t&&n.push(t);return n.length?n:null},getAvailableQualityLevels:function(e){var t=this.p.attr.youtube,i=this.yp,n=[];if(i&&i.getAvailableQualityLevels){var r,s=i.getAvailableQualityLevels();if(s)for(r in s)s[r]&&n.push(this._getPlaybackQualityData(s[r]))}if(!e&&t&&("all"==t.quality||"all"==t.quality)){var a=u.__super.getAvailableQualityLevels.call(this);if(a&&a.length){n.length&&n.push({view:"line"});for(var o=0;o<a.length;o++)a[o]&&n.push(a[o])}}return n},setPlaybackQuality:function(e){var t=this.p.attr.youtube,i=this.yp,n=!1;if(e&&e.code){var r=this.getAvailableQualityLevels(!0);if(r&&r.length)for(var s=0;s<r.length;s++)r[s].code===e.code&&(n=!0)}n&&i&&i.setPlaybackQuality?i.setPlaybackQuality(e.code):n||!t||"all"!=t.quality&&"all"!=t.quality||u.__super.setPlaybackQuality.call(this,e)},_getAvailableSubtitle:function(e){return{code:e.languageCode,label:e.displayName?e.displayName:e.languageName?e.languageName:e.languageCode,view:e.view,youtubeData:e}},getAvailableSubtitles:function(e){this.loadModule("captions");this.unloadModule("captions");var t,i=this.p.attr.youtube,n=this.getOptions("captions"),r=(n&&this.getOption("captions","track"),n?this.getOption("captions","tracklist"):null),s=n?this.getOption("captions","translationLanguages"):null,a=[];if(r&&r.length)for(t=0;t<r.length;t++)a.push(r[t]);if(this.useAutoLanguage&&s&&s.length){o.push({view:"line"});for(t=0;t<s.length;t++)a.push(s[t])}var o=[];for(t=0;t<a.length;t++)o.push(this._getAvailableSubtitle(a[t]));if(!e&&i&&("all"==i.subtitle||"all"==i.subtitle)){var l=u.__super.getAvailableSubtitles.call(this);if(l&&l.length){o.length&&o.push({view:"line"});for(t=0;t<l.length;t++)l[t]&&o.push(l[t])}}return o},getPlaybackSubtitle:function(){if(this.currentPlaybackSubtitleData)return this.currentPlaybackSubtitleData;var e=this.getOptions("captions")?this.getOption("captions","track"):null;return e?this._getAvailableSubtitle(e):u.__super.getPlaybackSubtitle.call(this)},setPlaybackSubtitle:function(e){var t=this.p.attr.youtube,i=(this.yp,!1);if(e&&e.code){var n=this.getAvailableSubtitles(!0);if(n&&n.length)for(var r=0;r<n.length;r++)n[r].code===e.code&&(i=!0)}if(i){this.currentPlaybackSubtitleData=null;this.setOption("captions","track",{languageCode:e.code});var s=this.currentMediaSource();s&&s.stop()}else if(!i&&t&&("all"==t.subtitle||"all"==t.subtitle)){this.currentPlaybackSubtitleData=e;u.__super.setPlaybackSubtitle.call(this,e)}},loadModule:function(e){return this.yp&&this.yp.loadModule?this.yp.loadModule(e):null},unloadModule:function(e){return this.yp&&this.yp.unloadModule?this.yp.unloadModule(e):null},getOptions:function(e){if(!this.yp||!this.yp.getOptions)return null;var t,i=this.yp.getOptions();if(i&&i.length)for(t=0;t<i.length;t++)if(i[t]==e)return this.yp.getOptions(e);return null},getOption:function(e,t){return this.yp&&this.yp.getOption?this.yp.getOption(e,t):null},setOption:function(e,t,i){return this.yp&&this.yp.setOption?this.yp.setOption(e,t,i):null},getVideoData:function(){return this.yp&&this.yp.getVideoData?this.yp.getVideoData():null},getTitle:function(){var e=this.getVideoData();return e&&e.title?e.title:""},setSphericalProperties:function(e){return this.yp&&this.yp.setSphericalProperties?this.yp.setSphericalProperties(e):null},getSphericalProperties:function(){return this.yp&&this.yp.getSphericalProperties?this.yp.getSphericalProperties():null},isSphericalProperties:function(){var e=this.getSphericalProperties();return!(!e||e.fov===undefined)},onYoutubeReady:function(e){var t,i=this.p;if(c.isArray(i.src)&&this.youtube.use_youtube_playlist){t={playlist:i.src};this.playerVars.autoplay?this.yp.loadPlaylist(t):this.yp.cuePlaylist(t)}if(e&&!0!==e&&e.callback)return e.callback()},onYoutubeInit:function(t){var i=this,n=this.p,e=this.device,r=e?e.element:null;this.attr;if(!this.yp){if(!r)throw new Error("Not found controller device element");var s=document.createElement("div");s.style.width="100%";s.style.height="100%";var a={id:this.guid,playerType:"youtube",playerClassName:this.getClassName(),src:"about:blank",width:"100%",height:"100%",frameborder:"0"};if(c.b.safari){a.allowFullscreen=!1;a.webkitallowFullscreen=!1;this.playerVars.allowFullScreen=0;this.playerVars.webkitallowFullScreen=0}else{a.allowFullScreen=0;a.webkitallowFullScreen=0;this.playerVars.allowFullScreen=0;this.playerVars.webkitallowFullScreen=0}var o=document.createElement("div");o.style.width="100%";o.style.height="100%";o.setAttribute("id",this.guid);o.setAttribute("playerType","youtube");o.setAttribute("playerClassName",this.getClassName());o.setAttribute(h.D_MEDIA_GUID_ATTR,this.guid);o.appendChild(s);r.appendChild(o);this.zonemediaelement=o;this.p.log(" ## playerVars: ",this.playerVars);this.yp=new YT.Player(s,{height:"100%",width:"100%",videoId:c.isArray(n.src)?"":n.src,playerVars:this.playerVars,events:{onReady:function(){var e=c.query(o,"iframe");if(c.b.safari){e.allowFullscreen=!1;e.webkitallowFullscreen=!1}else{e.removeAttribute("allowFullscreen",0);e.removeAttribute("webkitallowFullscreen",0);e.removeAttribute("webkitAllowFullscreen",0)}e.setAttribute("playsinline",1);i.ytiframe=e;i.p.ytiframe=e;i.onYoutubeReady(t)},onStateChange:function(e){var t=l(e.data);if(i.is_temporary_removal)return t===h.STATE.PLAYING?setTimeout(function(){i.stop()},1):void 0;n.callStateChange({type:h.EVENT.STATE_CHANGE,data:t,source:i.currentMediaSource(),device:i})},onPlaybackQualityChange:function(e){i.is_temporary_removal||n.callStateChange({type:h.EVENT.QUALITY_CHANGE,data:i._getPlaybackQualityData(e.data),source:i.currentMediaSource(),device:i})},onPlaybackRateChange:function(e){i.is_temporary_removal||n.callStateChange({type:h.EVENT.RATE_CHANGE,data:n.getSafePlaybackRate(e.data),source:i.currentMediaSource(),device:i})},onError:function(e){c.error(e);n.callStateChange({type:h.EVENT.ON_ERROR,data:e,source:i.currentMediaSource(),device:i})},onApiChange:function(e){}}})}}});return u})}(window||this);!function(){"use strict";var S=getDframework(),_=S.module("imgtech.media.Media");S.define("imgtech.media.MediaPlayer",function(){var t=S.module("imgtech.media.module.Device"),T=S.module("imgtech.media.SourceInfo"),w=S.module("imgtech.media.Source");function s(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.use_first_source=!1;this.currentDevice=null;this.currentSource=null;this.currentSourceAttribute=null;var n=[];this.getUsedDevices=function(){var e,t=[];for(e=0;e<n.length;e++)t.push(n[e]);return t};this.getUsedDevice=function(e){var t,i;for(t=0;t<n.length;t++)if((i=n[t]).className==e)return i;return null};this.addUsedDevice=function(e){if(!e)throw new TypeError("Not found used device object.");if(!e.className)throw new TypeError("Not found used device className.");if(this.getUsedDevice(e.className))throw new Error("Exist used device. : "+e.className);n.push(e)};this.destroyUsedDevice=function(){var e,t;for(e=0;e<n.length;e++)if((t=n[e]).instance&&t.instance.destroy)try{t.instance.destroy()}catch(i){}n=[]}}}S.extendClass(s,t,{getClassName:function(){return"imgtech.media.MediaPlayer"},getPlayerType:function(){var e=this.deviceInstance();if(e&&e.getPlayerType)return e.getPlayerType()},onReady:function(){var e=this,t=this.p;if(!this.info(0))return t.log(" ## onready: empty next media data");t.hasAttributeSource&&setTimeout(function(){t.next({device:e})},1)},deviceInstance:function(){var e=this.currentDevice;return e?e.instance:null},destroy:function(){this.destroyUsedDevice()},activeDevice:function(t,s,a){function o(e,t,i){var n=this;setTimeout(function(){n.__is_active_device_src=null;n.__is_active_device_timer=null},1);t&&(this.currentDevice=e);if(i)try{i()}catch(r){S.error(r)}}var e=this.__is_active_device_timer,i=this.__is_active_device_src,l=this,u=this.p,n=this.currentDevice;if(!(t instanceof w))throw new Error("src is not instanceof Source");if(i){if(i===t)return S.warn("Ignore current source");throw new Error("Active source : ",i)}if(e)throw new Error("Active device timer : ",e);var r=u.attr,c=t.deviceType(),h="youtube"!=c&&"video"!=c&&r.playerType?r.playerType:c,d=T.getDeviceClassName(h),f=d?S.module(d):null;if("video"==h){if(S.b.ie&&S.b.ie<9)throw new Error("Not support video on IE8 !!!")}else if("youtube"==h){if(S.b.ie&&S.b.ie<10)throw new Error("Not support youtube on IE8 and IE9 !!!")}else if(("flash"==h||"flash2"==h)&&S.b.isMobile)throw new Error("Not supported mobile on flash");if(!f)throw new Error("Not found "+d+" module.");(this.__is_active_device_src=t).source();var p,m,g,v,y=this.getUsedDevice(d),E=this.getUsedDevices();if(y&&"create"==y.instance.__activeStatus)return S.warn("Ignore:: current device is created.");if(y){p=y.instance;u.log(" ## device (exist) - className: "+d+", devType: "+c+", type: "+h)}else{p=new f(u,this.c,this.attr);(y={deviceType:c,type:h,className:d,instance:p,status:"create"}).instance.__activeStatus="create";this.addUsedDevice(y);u.log(" ## device (create) - className: "+d+", devType: "+c+", type: "+h+", source: "+t.source())}this.__is_active_device_holder=null;p.untemporary_removal();if(n){var b=n.instance;if(n!==y){this.__is_active_device_holder=n;b.temporary_removal();b.stop()}}for(m=0;m<E.length;m++)(g=E[m])&&(v=g&&g.instance?g.instance.zonemediaelement:null)&&(y===g?S.ui.show(v):S.ui.hide(v));setTimeout(function(){if("create"==y.status){var e={type:_.EVENT.ON_READY,source:t,callback:function(){y.status="ready";y.instance.__activeStatus="ready";o.call(l,y,s,a)},device:y.instance};u.stateLog(e,"start",1);y.instance.onStateChange(e);u.stateLog(e,"end",1)}else if("flash"==y.type){var n=(new Date).getTime(),r=y.instance.getPlayerState();l.__is_active_device_timer&&u.error(" ## device has timer !!!!!!");u.log(" ## start wait flash. time: "+n+", state: "+r);l.__is_active_device_timer=setInterval(function(){var e=(new Date).getTime(),t=y.instance,i=t?t.getPlayerState():null;if(null===i||i!==r||1500<e-n||!n){u.log(" ## end wait flash. state: "+i+", ctime: "+e+", otime: "+n+", dtime: "+(e-n));clearInterval(l.__is_active_device_timer);return o.call(l,y,s,a)}},50)}else o.call(l,y,s,a)},1)},isDisableEvent:function(e){var t=this.__is_active_device_holder;if(t&&t.instance&&t.instance===e.device)switch(e.type){case _.EVENT.STATE_CHANGE:case _.EVENT.RATE_CHANGE:case _.EVENT.DURATION_CHANGE:case _.EVENT.CURRENT_TIME_CHANGE:case _.EVENT.WATCH_TIME_CHANGE:case _.EVENT.BUFFERING_CHANGE:case _.EVENT.VOLUME_CHANGE:case _.EVENT.PLAY_MEDIA:case _.EVENT.PAUSE_MEDIA:case _.EVENT.STOP_MEDIA:case _.EVENT.MUTE_MEDIA:case _.EVENT.WAITTING:case _.EVENT.CAN_PLAY:var i=t.className,n=i.lastIndexOf(".");return"Ignore ["+(-1!==n?i.substring(n+1):i)+"] "+_.getTypeName(e.type)+" event."}return!1},onStateChange:function(e){var t=s.__super.onStateChange,i=this.p;switch(e.type){case _.EVENT.RESET:this.reset();break;case _.EVENT.ON_READY:return this.onReady();case _.EVENT.ON_BEFORE_PLAY:var n;if((n=this.currentSourceAttribute)&&n.data&&n.data.currentTime){this.currentSource.isLive()||i.seekTo(n.data.currentTime);this.currentSourceAttribute=null}break;case _.EVENT.PREVIOUS_MEDIA:case _.EVENT.NEXT_MEDIA:case _.EVENT.CURRENT_MEDIA:case _.EVENT.INDEX_MEDIA:return t.apply(this,arguments);case _.EVENT.SELECTING_SOURCE:return this.selectingSwitchSource(e.data)}var r=this.deviceInstance();return r&&r.onStateChange?r.onStateChange(e):t.apply(this,arguments)},getPlayerState:function(){var e=this.deviceInstance();return e&&e.getPlayerState?e.getPlayerState():null},sourceCallback:function(e,t,i){var n=this.deviceInstance(),r=this.currentDevice,s=this.p,a=s.attr;if(n){this.isBeforePlay=!1;this.currentSource=e;this.currentSourceAttribute=t;s.log(" ## source: "+e.source());s.log(" ## isLive: "+e.isLive());s.log(" ## configure: ",a);n.source(e);n.setSwitchSourceData(i&&i.src?i.src:null);var o=s.controller.resourceElement;if(o){S.removeClass(o,"mpv-devicetype-video");S.removeClass(o,"mpv-devicetype-hls");S.removeClass(o,"mpv-devicetype-flash");S.removeClass(o,"mpv-devicetype-youtube");S.addClass(o,"mpv-devicetype-"+r.type)}i&&this.p.callStateChange({type:_.EVENT.SELECTED_SOURCE,data:i})}},setSwitchSourceData:function(e){throw new Error("Not supported setSwitchSourceData")},getSwitchSourceData:function(){var e=this.deviceInstance();return e?e.getSwitchSourceData():null},selectingSwitchSource:function(e){var t=this,i=e.src;this.activeDevice(i,!0,function(){t.sourceCallback(i,e.event,e&&e.originData)})},currentMediaSource:function(){var e=this.deviceInstance();return e?e.currentMediaSource():null},reset:function(){var e,t,i,n=this.getUsedDevices();this.stop();this.__is_active_device_src=null;for(e=0;e<n.length;e++)if((t=n[e])&&(i=t&&t.instance?t.instance.zonemediaelement:null)){t.instance.reset();S.ui.hide(i)}},source:function(e,t){if(e){if(!(e instanceof w))throw new Error("src is not instanceof Source");if(e.isSwitchSource()){this.p.callStateChange({type:_.EVENT.SELECT_SOURCE,data:{src:e,event:t}});return}var i=this;this.activeDevice(e,!0,function(){i.sourceCallback(e,t)})}},isPlaying:function(){switch(this.getPlayerState()){case _.STATE.PLAYING:case _.STATE.BUFFERING:return!0}return!1},beforePlay:function(){var e=this.deviceInstance();return e&&e.beforePlay?e.beforePlay():null},play:function(e){var t=this.deviceInstance();return t&&t.play?t.play(e):null},pause:function(e){var t=this.deviceInstance();return t&&t.pause?t.pause(e):null},stop:function(){var e=this.deviceInstance();return e&&e.stop?e.stop():null},isMuted:function(){var e=this.deviceInstance();return e&&e.isMuted?e.isMuted():null},mute:function(){var e=this.deviceInstance();return e&&e.mute?e.mute():null},unMute:function(){var e=this.deviceInstance();return e&&e.unMute?e.unMute():null},getVolume:function(){var e=this.deviceInstance();return e&&e.getVolume?e.getVolume():0},setInitVolume:function(e){var t=this.deviceInstance();t&&t.setInitVolume&&t.setInitVolume(e)},setVolume:function(e){var t=this.deviceInstance();t&&t.setVolume&&t.setVolume(e)},duration:function(e){var t=this.deviceInstance();return t&&t.duration?t.duration(e):0},currentTime:function(e){var t=this.deviceInstance();return t&&t.currentTime?t.currentTime(e):0},getBuffering:function(){var e=this.deviceInstance();return e&&e.getBuffering?e.getBuffering():0},watchTime:function(){var e=this.deviceInstance();return e&&e.watchTime?e.watchTime():0},seekTo:function(e,t){var i=this.deviceInstance();return i&&i.seekTo?i.seekTo(e,t):null},getVideoSize:function(){var e=this.deviceInstance();return e&&e.getVideoSize?e.getVideoSize():null},getDefaultPlaybackRate:function(){var e=this.deviceInstance();return e&&e.getDefaultPlaybackRate?e.getDefaultPlaybackRate():null},getPlaybackRate:function(){var e=this.deviceInstance();return e&&e.getPlaybackRate?e.getPlaybackRate():null},getAvailablePlaybackRates:function(){var e=this.deviceInstance();return e&&e.getAvailablePlaybackRates?e.getAvailablePlaybackRates():null},setPlaybackRate:function(e){var t=this.deviceInstance();return t&&t.setPlaybackRate?t.setPlaybackRate(e):null},getPlaybackQuality:function(e){var t=this.deviceInstance();return t&&t.getPlaybackQuality?t.getPlaybackQuality(e):null},getAvailableQualityLevels:function(){var e=this.deviceInstance();return e&&e.getAvailableQualityLevels?e.getAvailableQualityLevels():null},setPlaybackQuality:function(e){var t=this.deviceInstance();return t&&t.setPlaybackQuality?t.setPlaybackQuality(e):null},getAvailableSubtitles:function(){var e=this.deviceInstance();return e&&e.getAvailableSubtitles?e.getAvailableSubtitles():null},getPlaybackSubtitle:function(){var e=this.deviceInstance();return e&&e.getPlaybackSubtitle?e.getPlaybackSubtitle():null},setPlaybackSubtitle:function(e){var t=this.deviceInstance();return t&&t.setPlaybackSubtitle?t.setPlaybackSubtitle(e):null},setSphericalProperties:function(e){var t=this.deviceInstance();return t&&t.setSphericalProperties?t.setSphericalProperties(e):null},getSphericalProperties:function(){var e=this.deviceInstance();return e&&e.getSphericalProperties?e.getSphericalProperties():null},isSphericalProperties:function(){var e=this.deviceInstance();return!(!e||!e.isSphericalProperties)&&e.isSphericalProperties()},onCurrentTimeSync:function(){var e=this.deviceInstance();e&&donCurrentTimeSync&&e.onCurrentTimeSync()},onWatchTimeSync:function(){var e=this.deviceInstance();e&&e.onCurrentTimeSync&&e.onWatchTimeSync()},onBufferingSync:function(){var e=this.deviceInstance();e&&e.onCurrentTimeSync&&e.onBufferingSync()},onVolumeSync:function(){var e=this.deviceInstance();e&&e.onCurrentTimeSync&&e.onVolumeSync()}});return s})}();!function(){"use strict";var u=getDframework(),c=u.module("imgtech.media.Media");u.define("imgtech.media.module.OpenLayer",function(){var i=u.module("imgtech.media.ModuleInterface");function e(e){i.apply(this,arguments);if(e){!function(e){var t=e.attr;t.mobile&&t.mobile.width&&(u.isArray(t.mobile.width)||(t.mobile.width=[t.mobile.width]));t.mobile&&t.mobile.height&&(u.isArray(t.mobile.height)||(t.mobile.height=[t.mobile.height]));t.width&&!u.isArray(t.width)&&(t.width=[t.width]);t.height&&!u.isArray(t.height)&&(t.height=[t.height])}(this);this.isDisabled=!1;this.showOpenLayer=!1;this.resource=this.p.userElement;this.skinName=this.c.attr.skin?this.c.attr.skin:"draft";this.currentSkinName="skin-"+this.skinName+"-openlayer";this.layoutAttr={controlAutoHide:1.5,controlAutoHidePause:!1,controlAutoHideFirst:!0,controlAutoHideOver:!0,separateControlNormal:!1,separateControlFs:!1,alwaysControlNormal:!1,alwaysControlFs:!1};this.closeBtn=u.query(this.resource,".mpv-close-openlayer-btn");this.closeWideBtn=u.query(this.resource,".mpv-close-openlayer-widebtn");this.hideCloseBtn();if(u.b.isMobile){u.remove(this.closeBtn);this.closeBtn=null}else{u.remove(this.closeWideBtn);this.closeWideBtn=null}var t=this.savedElement=document.createElement("div");u.addClass(t,"mpv-saved-blanked-openlayer")}}u.extendClass(e,i,{onAddEvent:function(){var t=this,e=this.attr,i=this.closeBtn,n=this.closeWideBtn,r=e.target&&e.target();r||(r=window);u.on(r,"scroll",function(e){t.onScroll(e)});i&&u.on(i,"click",function(e){t.onClickCloseBtn(e)});n&&u.on(n,"click",function(e){t.onClickCloseBtn(e)});this.sizeMod=this.p.module("size");this.layoutMod=this.p.module("layout");this.volumeMod=this.p.module("volume")},onStateChange:function(e){var t=this;this.p.userElement;switch(e.type){case c.EVENT.FULLSCREEN_CHANGE:this.onFullscreenChange(e.data);break;case c.EVENT.SIZE_CHANGE:this.resize();break;case c.EVENT.RESIZE_WINDOW:this.onLandscapeChange();this.resize();break;case c.EVENT.ON_READY:setTimeout(function(){t.onScroll()},1)}},setDisable:function(e){if(!(this.isDisabled=e))return this.onScroll();this.showOpenLayer&&this._closeOpenLayer(!1)},isDisable:function(){return this.isDisabled},onFullscreenChange:function(e){if(this.showOpenLayer){var t=this.resource;if(e){u.removeClass(t,this.currentSkinName);this.convertLayoutAttribute(this.layoutMod.attr,this.savedData.layout,!0)}else{u.addClass(t,this.currentSkinName);this.convertLayoutAttribute(this.layoutMod.attr,this.layoutAttr,!0)}}this.onScroll();e?this.hideCloseBtn():this.showCloseBtn()},onLandscapeChange:function(){if(this.showOpenLayer&&this.isMobileLayoutAuto()){if(this.p.module("app").isApp()&&!0!==this.attr.enableApp)return;var e=this.p.userElement;if(window.innerWidth>window.innerHeight){if(!this.is_fullscreen&&!this.sizeMod.isFullscreen()){this.is_fullscreen=!0;this.p.fullscreen(!1);u.addClass(e,"mpv-fullscreen-openlayer");this.sizeMod.lockFullscreen(!0)}}else if(this.is_fullscreen){this.sizeMod.lockFullscreen(!1);this.is_fullscreen=!1;this.p.exitFullscreen();u.removeClass(e,"mpv-fullscreen-openlayer")}}},showCloseBtn:function(){if(!this.showOpenLayer)return this.hideCloseBtn();if(this.closeBtn){u.removeClass(this.closeBtn,".mpv-hide");u.ui.show(this.closeBtn)}if(this.closeWideBtn){u.removeClass(this.closeWideBtn,".mpv-hide");u.ui.show(this.closeWideBtn)}},hideCloseBtn:function(){if(this.closeBtn){u.addClass(this.closeBtn,".mpv-hide");u.ui.hide(this.closeBtn)}if(this.closeWideBtn){u.addClass(this.closeWideBtn,".mpv-hide");u.ui.hide(this.closeWideBtn)}},onClickCloseBtn:function(e){if(!this.sizeMod.isFullscreen()&&this.showOpenLayer){this.is_onclick_close_openlayer_btn=!0;this.attr.pauseOnCloseBtn&&this.p.pause();this.closeOpenLayer(!0)}},isMobileLayoutAuto:function(){var e=this.attr;return!(!u.b.isMobile||!e.mobile||"auto"!=e.mobile.layout)},getConfigWidth:function(e){var t=this.attr,i=320;e||(e=0);u.b.isMobile&&t.mobile&&t.mobile.width&&t.mobile.width.length?i=t.mobile.width[e]:t.width&&t.width.length&&(i=t.width[e]);return i},getConfigHeight:function(e){var t,i=this.attr;e||(e=0);if("auto"===(t=u.b.isMobile&&i.mobile&&i.mobile.height&&i.mobile.height.length?i.mobile.height[e]:i.height&&i.height.length?i.height[e]:200)){var n,r,s=this.p.getVideoSize(),a=this.windowSize();if(!s||!s.height||!s.width)return 200;if(u.b.isMobile)t=(r=s.height*a.width/s.width)>a.height/2?Math.floor(a.height/2):Math.floor(r);else{n=this.getConfigWidth(e);t=s.height*n/s.width}s.height<t&&(t=s.height)}return t},getConfigOffsetWidth:function(){var e=this.attr;return u.b.isMobile&&e.mobile&&(e.mobile.offsetWidth||0===e.mobile.offsetWidth)?e.mobile.offsetWidth:e.offsetWidth?e.offsetWidth:0},onScroll:function(){if(this.p.isDestroy())return u.remove(this.savedElement);if(!this.sizeMod.isFullscreen()&&!this.isDisable()){var e,t=this.p,i=(this.c,this.attr),n=this.savedElement,r=this.resource;if(!u.b.isMobile||!1!==i.mobile)if(this.showOpenLayer){if(this.isEnableCloseOpenLayer()){this.closeOpenLayer(!1);this.defaultElements()}}else{if(this.is_onclick_close_openlayer_btn){if(i.hideOnClose)return;if(this.isEnableCloseOpenLayer()){this.is_onclick_close_openlayer_btn=!1;n&&u.remove(n)}return}if(!(e=u.isElement(r)?u.getBoundingClientRect(r):null))return u.warn("Not found open layer user element");if(!e.width()||!e.height())return u.warn("Not found video element bounding rect.");if(this.isEnableOpen(e)){var s=this.getConfigOffsetWidth(),a=this.getConfigWidth(0),o=this.getConfigHeight(0),l=this.windowSize();l.width<a+s&&(a=l.width-s);this.showOpenLayer=!0;this.savedData={rect:e,eleWidth:r.style.width?r.style.width:"",eleHeight:r.style.height?r.style.height:"",layout:{}};this.convertLayoutAttribute(this.savedData.layout,this.layoutMod.attr);this.convertLayoutAttribute(this.layoutMod.attr,this.layoutAttr,!0);this.sizeMod.isWide&&u.removeClass(this.resource,"mpv-wide-screen");u.addClass(r,this.currentSkinName);this.openlayer_width=c.getStyleNumberValue(a);this.setSize(this.openlayer_width,c.getStyleNumberValue(o));if(n){n.style.width=e.width()+"px";n.style.height=e.height()+"px";n.style.margin=r.style.margin;u.before(r,n)}this.showCloseBtn();this.defaultElements();t.sendSizeChange()}}}},defaultElements:function(){this.volumeMod&&this.volumeMod.isAutoHide()&&this.volumeMod.hideSlider()},type:function(){var e=this.attr;if(u.b.isMobile&&e.mobile){if("top"==e.mobile.type)return"top";if("bottom"==e.mobile.type)return"bottom";if("auto"==e.mobile.layout)return"top"}return"bottom"},isEnableOpen:function(e){return"top"==this.type()?e.top<0:e.bottom<0},windowSize:function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0];return{width:e.innerWidth||i.clientWidth||n.clientWidth,height:e.innerHeight||i.clientHeight||n.clientHeight}},isEnableCloseOpenLayer:function(){var e=this.savedElement,t=e&&u.isElement(e)?u.getBoundingClientRect(e):null;t&&(!t||t.width()&&t.height())||(t=u.getBoundingClientRect(this.resource));return t?t.width()&&t.height()?"top"==this.type()?0<=t.top:0<=t.bottom:u.error("Not found save element bounding rect."):u.error("Not found openlayer save element")},convertLayoutAttribute:function(e,t,i){e.controlAutoHide=t.controlAutoHide;e.controlAutoHidePause=t.controlAutoHidePause;e.controlAutoHideFirst=t.controlAutoHideFirst;e.controlAutoHideOver=t.controlAutoHideOver;e.separateControlNormal=t.separateControlNormal;e.separateControlFs=t.separateControlFs;e.alwaysControlNormal=t.alwaysControlNormal;e.alwaysControlFs=t.alwaysControlFs;if(i){var n=this.layoutMod;n.separateControl();n.showControl()}},closeOpenLayer:function(e){if(!this.sizeMod.isFullscreen())return this._closeOpenLayer(e)},_closeOpenLayer:function(e){var t=this.resource,i=this.savedElement,n=this.savedData,r=this.attr;this.sizeMod.isWide&&u.addClass(this.resource,"mpv-wide-screen");u.removeClass(t,this.currentSkinName);this.showOpenLayer=!1;this.openlayer_width=0;if(n){this.setSize(n.eleWidth,n.eleHeight);this.convertLayoutAttribute(this.layoutMod.attr,n.layout,!0)}!i||e&&r.hideOnClose||u.remove(i);this.hideCloseBtn()},setSize:function(e,t){var i=this.resource;i.style.width=e;i.style.height=t},resize:function(){if(this.showOpenLayer){if(this.sizeMod.isFullscreen())return;var e,t=this.p,i=(this.attr,this.getConfigOffsetWidth()),n=this.getConfigWidth(0),r=this.getConfigHeight(0),s=this.windowSize();if(this.isMobileLayoutAuto()&&this.sizeMod.isFullscreen())return;s.width<n+i&&(n=s.width-i);if(this.openlayer_width!==(e=c.getStyleNumberValue(n))){this.openlayer_width=e;this.setSize(this.openlayer_width,c.getStyleNumberValue(r));t.sendSizeChange()}}}});return e})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.AD",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}i.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){}});return e})}();!function(){"use strict";var y=getDframework(),i=y.module("imgtech.media.Media");function r(){this.index=-1;this.position=null;this.seconds=0}r.prototype={constructor:r};function s(e,t){this.name=e;this.seconds=t}s.prototype={constructor:s};function a(){this.list=[]}a.prototype={constructor:a,size:function(){return this.list.length},get:function(e){return this.list[e]},push:function(e){this.list.push(e)},hasPosition:function(e){for(var t=this.list.length,i=0;i<t;i++){if(this.get(i).position===e.position)return!0}return!1},computedClone:function(){for(var e=new a,t=0;t<this.size();t++){var i=this.get(t);i.seconds--;0<i.seconds&&e.push(i)}return e}};function n(e){if(e){this.attr=e;this.alpha;this.color;this.font;this.lineHeight;this.letterSpacing;this.margin;this.message;this.position=[];this.random;this.rotate;this.multi;this.density;this.hasFontWeight=!1;this.setData(e)}}n.prototype={constructor:n,setData:function(e){if(e){this.alpha=e.alpha;this.color=e.color;this.font=e.font;this.lineHeight=e.lineHeight;this.letterSpacing=e.letterSpacing;this.margin=e.margin;this.message=e.message?e.message.trim():"";this.position=[];this.random=e.random;this.rotate=e.rotate;this.multi=e.multi;this.density=e.density;this.margin&&(this.marginRect=this.getRoundStyle(this.margin));for(var t in e.position)if(t){var i=e.position[t];switch(t){case"TL":case"TC":case"TR":case"ML":case"MC":case"MR":case"BL":case"BC":case"BR":case"NO":this.position.push(new s(t,i))}}}},setAlpha:function(e){this.alpha=e},setColor:function(e){this.color=e},setFont:function(e){this.font=e},setLineHeight:function(e){this.lineHeight=e},setLetterSpacing:function(e){this.letterSpacing=e},setMargin:function(e){this.margin=e;this.marginRect=this.getRoundStyle(this.margin)},setMessage:function(e){this.message=e?e.trim():""},getAlpha:function(){return this.alpha},getColor:function(){return this.color},getFont:function(){return this.font},getLineHeight:function(){return this.lineHeight},getLetterSpacing:function(){return this.letterSpacing},getMargin:function(){return this.margin},getMessage:function(){return this.message},getPosition:function(e){return 0<=e&&e<this.position.length?this.position[e]:null},getPositionSize:function(){return this.position.length},getRotate:function(){return this.rotate},hasMessage:function(){return!!(this.message&&0<this.message.length)},isFontWeight:function(){return this.hasFontWeight},isRotate:function(){return 0!==this.rotate},isRandom:function(){return this.random},getMarginRect:function(){return this.marginRect},getRoundStyle:function(e){var t,i,n,r,s=[],a=e.split(" ");for(var o in a)o&&(r=a[o])&&(r=r.trim())&&s.push(r);if(!s.length)return{top:0,right:0,bottom:0,left:0};t=parseInt(s[0]);if(1==s.length)return{top:t,right:t,bottom:t,left:t};i=parseInt(s[1]);if(2==s.length)return{top:t,right:i,bottom:t,left:i};n=parseInt(s[2]);return 3==s.length?{top:t,right:i,bottom:n,left:n}:{top:t,right:i,bottom:n,left:parseInt(s[3])}}};y.define("imgtech.media.module.Watermark",function(){var t=y.module("imgtech.media.ModuleInterface");function l(e){try{e&&y.remove(e)}catch(t){}e=document.createElement("div");y.addClass(e,"mpv-watermark");e.style.visible="visibility";e.style.display="";e.style.margin="0px 0px";e.style.padding="0px 0px";e.style.overflow="hidden";y.after(this.device.element,e);this.element=e;this.elementDataList=null;return e}function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("device");this.videoSize=null;this.canvas;this.element;this.timeout=1e3;this.watermarkData=new n(this.attr);this.roundPosition=-1;this.currentDisplayList}}y.extendClass(e,t,{onAddEvent:function(){l.call(this);this.autoPlay()},onStateChange:function(e){switch(e.type){case i.EVENT.SIZE_CHANGE:case i.EVENT.RESIZE_WINDOW:this.onResize();break;case i.EVENT.VIDEO_SIZE_DATA:this.videoSize=e.data;break;case i.EVENT.STATE_CHANGE:e.data==i.STATE.SETSOURCE&&(this.videoSize=null)}},onResize:function(){var e=this.device,t=y.getBoundingClientRect(e.element);t.width()&&t.height()&&this.update()},createData:function(e){var t,i=new r;e.isRandom()?t=Math.floor(Math.random()*e.getPositionSize()):(t=this.roundPosition)>=e.getPositionSize()&&(t=this.roundPosition=0);var n=e.getPosition(t);n||(n=new s("TL",1));i.index=t;i.seconds=n.seconds;i.position=n.name;this.roundPosition++;return i},createDataWithCDL:function(e,t){for(var i=this.roundPosition;;){var n=this.createData(e);if(!e.isRandom())return n;if(!t.hasPosition(n))return n;if(i===this.roundPosition)return n}},createCDL:function(e){var t=this.currentDisplayList;t||(t=new a);var i=t.computedClone(),n=(e.multi?e.multi:1)-i.size();if(0<n)for(var r=0;r<n&&!(i.size()>=e.getPositionSize());r++){var s=this.createDataWithCDL(e,i);s&&i.push(s)}return i},drawWatermarkText:function(e,t){var i,n;this.element;if((i=t&&t.hasMessage()?t.getMessage():null)&&(n=function(e){var t="T",i="L";if(e){if(2!=e.length||"NO"==e){"NO"!=e&&y.error("Unknown current position: "+e);return}t=e.charAt(0);i=e.charAt(1);switch(t){case"T":case"M":case"B":break;default:y.warn("Unknown current position vertical method: "+t);return}switch(i){case"L":case"C":case"R":break;default:y.warn("Unknown current position horizon method: "+i);return}}return{vertical:t,horizon:i}}(e))){var r=this.attr,s=t.getFont(),a=t.getColor(),o=t.marginRect,l=t.getAlpha(),u=t.isRotate()?t.getRotate():0,c=(t.isRotate()&&Math.PI,document.createElement("div")),h=(y.math.rect,"");c.style.visible="visibility";c.style.position="relative";c.style.display="inline-block";c.style.whiteSpace="nowrap";c.style.textAlign=r.textAlign?r.textAlign:"center";for(var d=i.split("\n"),f="",p=0;p<d.length;p++)0===p?f=d[p]:f+="<p>"+d[p];c.innerHTML=f;r.border&&(c.style.border=r.border);s&&(c.style.font=s);a&&(c.style.color=a);r.lineHeight&&(c.style.lineHeight=r.lineHeight);r.letterSpacing&&(c.style.letterSpacing=r.letterSpacing);if(u)if(y.b.ie&&y.b.ie<9){var m;m=0<=u?Math.PI*u/180:Math.PI*(360+u)/180;var g=Math.cos(m),v=Math.sin(m);h="progid:DXImageTransform.Microsoft.Matrix(M11="+v+",M12="+-g+",M21="+g+",M22="+v+",SizingMethod='auto expand')"}else{c.style.transform="rotate("+u+"deg)";c.style.msTransform="rotate("+u+"deg)";c.style.MozTransform="rotate("+u+"deg)";c.style.WebkitTransform="rotate("+u+"deg)";c.style.OTransform="rotate("+u+"deg)"}if(l){c.style.opacity=l;if(y.b.ie&&y.b.ie<9){h&&(h+="; ");h+="alpha(opacity="+Math.floor(100*l)+");"}}if(h){c.style.filter=h;c.style.msFilter=h;c.style.MSFilter=h}return{uele:c,method:n,margin:o}}},drawWatermarkOffset:function(e){var t=this.element,i=e.uele,n=e.method,r=e.margin,s=this.videoSize;if(s&&s.width&&s.height){var m=y.getBoundingClientRect(i),g=y.getBoundingClientRect(t),a=function(e,t,i,n,r){var s=i&&i.top?i.top:0,a=i&&i.left?i.left:0,o=i&&i.bottom?i.bottom:0,l=i&&i.right?i.right:0,u=0,c=0,h=Math.abs(n.bottom-n.top),d=Math.abs(n.right-n.left),f={left:0,top:0};if(e&&e.width&&e.height){var p={};if(e.width>e.height){p.width=r.width();p.height=e.height*p.width/e.width;if(r.height()<p.height){p.height=r.height();p.width=e.width*p.height/e.height}}else{p.height=r.height();p.width=e.width*p.height/e.height;if(r.width()<p.width){p.width=r.width();p.height=e.height*p.width/e.width}}f.left=(r.width()-p.width)/2;f.top=(r.height()-p.height)/2}switch(t.vertical){case"T":u+=s+f.top;break;case"M":u+=r.height()/2-h/2;break;case"B":u+=r.height()-h-o-f.top}switch(t.horizon){case"L":c+=a+f.left;break;case"C":c+=r.width()/2-d/2;break;case"R":c+=r.width()-d-l-f.left}return{left:-(m.left-g.left)+c,top:-(m.top-g.top)+u}}(s,n,r,m,g);i.style.top=a.top+"px";i.style.left=a.left+"px"}},clear:function(){this.element.innerText="";this.elementDataList=null},update:function(e){var t,i=this,n=this.elementDataList;if(n){if(y.b.ie&&y.b.ie<9&&!e)return setTimeout(function(){i.update(!0)},1);for(t=0;t<n.length;t++)this.drawWatermarkOffset(n[t])}},draw:function(){var e=this.watermarkData;if(e){var t,i=this.currentDisplayList;if(i){for(var n,r,s=this.element,a=[],o=0;o<i.size();o++)(t=i.get(o))&&(n=this.drawWatermarkText(t.position,e))&&a.push(n);this.clear();for(r=0;r<a.length;r++)s.appendChild(a[r].uele);this.elementDataList=a;this.update()}}},running:function(){var e=this.p,t=this.watermarkData;if(e.isPlaying()&&t){var i=this.device.element,n=y.parent(i),r=this.element,s=y.parent(r);r=n&&n!==s?l.call(this,r):function(e){if(!e||!e.style)return l.call(this,e);var t=this.device.element,i=y.getBoundingClientRect(t),n=i.width(),r=i.height();if(!n||!r)return e;var s=y.getBoundingClientRect(e),a=s.width(),o=s.height();if(!(a<n+10&&n-10<a&&o<r+10&&r-10<o))return l.call(this,e);y.addClass(e,"mpv-watermark");e.style.visible="visibility";e.style.display="";e.style.margin="0px 0px";e.style.padding="0px 0px";e.style.overflow="hidden";return e}.call(this,r);var a=(new Date).getTime();if(!(a-this.lastTime<1e3)){this.roundPosition<0&&(this.roundPosition=0);this.lastTime=a;this.currentDisplayList=this.createCDL(t);this.draw()}}},autoPlay:function(){var e=this;this.timer&&clearInterval(this.timer);this.lastTime=(new Date).getTime();this.timer=setInterval(function(){e.running()},200)}});return e})}();!function(){"use strict";var i=getDframework();i.module("imgtech.media.Media");i.define("imgtech.media.module.Bookmark",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments)}i.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){}});return e})}();!function(){"use strict";var i=getDframework(),n=i.module("imgtech.media.Media");i.define("imgtech.media.module.Exit",function(){var t=i.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.setSelfElementObject("exitBtn");this.isUse()?this.show():this.hide()}}i.extendClass(e,t,{onAddEvent:function(){var t=this,e=this.exitBtn;e&&e.on("click",function(e){t.onclick(e)})},onStateChange:function(e){switch(e.type){case n.EVENT.CONTROL_EVENT:"show"==e.data?this.show():"hide"==e.data&&this.hide()}},isUse:function(){return!1!==this.attr.use},onclick:function(){var e=this.p.module("app");e&&e.dissmiss()},show:function(){if(!this.isUse())return this.hide();var e=this.exitBtn;e&&e.show()},hide:function(){var e=this.exitBtn;e&&e.hide()}});return e})}();!function(){"use strict";var u=getDframework(),c=u.module("imgtech.media.Media");u.define("imgtech.media.module.RepeatBookmark",function(){var n=u.module("imgtech.media.ModuleInterface");function r(e){n.apply(this,arguments);if(e){var t=this.attr,i=this.p.userElement;this.setSelfElementObject("control");this.setSelfElementObject("rbookmarkBtn");this._bookmarkListUi=u.query(i,".mpv-rbookmark");this._bookmarkLayoutUi=u.query(i,".mpv-rbookmarkl-layout");this._bookmarkListRootUi=u.query(i,".mpv-rbookmarkl-list");this._bookmarkListUl=u.query(i,".mpv-rbookmarkl-list ul");this._bookmarkHtml=this._bookmarkListUl?this._bookmarkListUl.innerHTML:"";this._bookmarkAddUi=u.query(i,".mpv-rbookmarkb");this._addBtn=u.query(i,".mpv-rbookmarkl-add-btn");this._fullBtn=u.query(i,".mpv-rbookmarkl-full-btn");this._closeAddUiBtn=u.query(i,".mpv-rbookmarkb-close-btn");this._auTitle=u.query(i,".mpv-rbookmarkb-title");this._auTimes=u.queryAll(i,".mpv-rbookmarkb-time");this._auSaveBtn=u.query(i,".mpv-rbookmarkb-save-btn");this._auCurrentBtn=u.query(i,".mpv-rbookmarkb-current-btn");this._bookmarkListUl.innerText="";this.hideBookmarkListUi();this.maxDepthSeconds=t.maxDepthSeconds?t.maxDepthSeconds:r.MAX_DEPTH_SECONDS}}r.MAX_DEPTH_SECONDS=5;u.extendClass(r,n,{onAddEvent:function(){var e=this;this._addBtn&&u.on(this._addBtn,"click",function(){e.addBtn()});this._fullBtn&&u.on(this._fullBtn,"click",function(){e.fullBtn()});this.rbookmarkBtn&&this.rbookmarkBtn.on("click",function(){e.toggleBookmarkListUi()});this._closeAddUiBtn&&u.on(this._closeAddUiBtn,"click",function(){e.hideAddBookmarkUi()});this._auCurrentBtn&&u.on(this._auCurrentBtn,"click",function(){e.currentAddBookmarkUi()});this._auSaveBtn&&u.on(this._auSaveBtn,"click",function(){e.saveAddBookmarkUi()});this.repeatMod=this.p.module("repeat")},onStateChange:function(e){switch(e.type){case c.EVENT.STATE_CHANGE:if(e.data==c.STATE.SETSOURCE){var t=this.p.currentMediaSource(),i=t&&t.input,n=i&&i.repeatBookmark;if(n)for(var r in n)this.addBookmark(n[r]);break}break;case c.EVENT.SIZE_CHANGE:this.sizeChange()}},sizeChange:function(){if(u.b.ie&&u.b.ie<9){var t=this;if(this.control){var i=this.control.rect();if(i&&i.height()){this._bookmarkListRootUi&&setTimeout(function(){var e=u.getBoundingClientRect(t.p.userElement);e&&e.height()&&(t._bookmarkListRootUi.style.height=e.height()-i.height()-65+"px")},1);this._bookmarkLayoutUi&&setTimeout(function(){var e=u.getBoundingClientRect(t.p.userElement);e&&e.height()&&(t._bookmarkLayoutUi.style.height=e.height()-i.height()+"px")},1)}}else this._bookmarkListRootUi.style.height="100%"}},addBtn:function(){this.showAddBookmarkUi()},fullBtn:function(){this.showFullVideo()},hideBookmarkListUi:function(){this._bookmarkListUi&&u.addClass(this._bookmarkListUi,"mpv-hide")},showBookmarkListUi:function(){if(this._bookmarkListUi){u.removeClass(this._bookmarkListUi,"mpv-hide");this.sizeChange()}},toggleBookmarkListUi:function(){var e=this._bookmarkListUi;e&&u.hasClass(e,"mpv-hide")?this.showBookmarkListUi():this.hideBookmarkListUi()},getAddBookmarkCurrentTime:function(){function i(e){try{return e.value?parseInt(e.value):0}catch(t){alert("\uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}}function e(e,t){return 3600*i(e[t+0])+60*i(e[t+1])+i(e[t+2])}return this._auTimes?{start:e(this._auTimes,0),end:e(this._auTimes,3)}:null},enableAddBookmarkCurrentTime:function(){function i(e){return!!e.value&&(!!/(^[0-9]+$)/.exec(e.value)&&parseInt(e.value))}function e(e,t){return!1!==i(e[t+0])&&(!1!==i(e[t+1])&&!1!==i(e[t+2]))}return this._auTimes?e(this._auTimes,0)?!!e(this._auTimes,3)||alert("\uc885\ub8cc \uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("\uc2dc\uc791 \uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("Not enable add bookmark ui.")},setAddBookmarkCurrentTime:function(e){if(this._auTimes){var t=this.p.currentTime(),i=c.secondsToString(t).split(":");this._auTimes[e+0].value=2<i.length?i[0]:"00";this._auTimes[e+1].value=2<i.length?i[1]:1<i.length?i[0]:"00";this._auTimes[e+2].value=2<i.length?i[2]:1<i.length?i[1]:0<i.length?i[0]:"00"}},currentAddBookmarkUi:function(){this.setAddBookmarkCurrentTime(3)},showAddBookmarkUi:function(){var e=this._bookmarkListUi,t=this._bookmarkAddUi;if(e&&t){this.setAddBookmarkCurrentTime(0);if(this._auTimes){this._auTimes[3].value="--";this._auTimes[4].value="--";this._auTimes[5].value="--"}this._auTitle&&(this._auTitle.value="\ubd81\ub9c8\ud06c "+(this.getBookmarkLis().length+1));u.removeClass(t,"mpv-hide")}},hideAddBookmarkUi:function(){var e=this._bookmarkListUi,t=this._bookmarkAddUi;e&&t&&u.addClass(t,"mpv-hide")},getBookmarkLis:function(){return this._bookmarkListUl?u.queryAll(this._bookmarkListUl,"li"):[]},addBookmark:function(e){if(this._bookmarkHtml&&this._bookmarkListUl){var t=u.element(this._bookmarkHtml),i=this,n=u.query(t,".sel_btn"),r=u.query(t,".btn_del"),s=e&&e.name,a=e&&e.start,o=e&&e.end,l=e&&e.thumbnail;u.query(t,".num").innerText=this.getBookmarkLis().length+1;u.query(t,".cover img").src=l;u.query(t,".info .name").innerText=s;u.query(t,".info .time").innerText=c.secondsToString(a)+" ~ "+c.secondsToString(o);t.getUserData=function(){return e};r&&u.on(r,"click",function(){i.deleteAddBookmark(t,e)});n&&u.on(n,"click",function(){i.selectBookmark(t,e)});u.first(this._bookmarkListUl,t);this.repairAddBookmarkNumber()}},selectBookmark:function(e){for(var t=this.getBookmarkLis(),i=this.repeatMod,n=0;n<t.length;n++){var r=t[n];u.removeClass(r,"mpv-select")}this.repairAddBookmarkNumber();u.query(e,".num").innerText="";u.addClass(e,"mpv-select");var s=e.getUserData();i.min(s.start);i.max(s.end);i.show()},showFullVideo:function(){this.repeatMod.hide()},repairAddBookmarkNumber:function(){for(var e=this.getBookmarkLis(),t=0;t<e.length;t++){var i=e[t];u.query(i,".num").innerText=t+1}},saveAddBookmarkUi:function(){if(!0===this.enableAddBookmarkCurrentTime()){var i=this.getAddBookmarkCurrentTime(),e=this.attr,n=this,r=this._auTitle?this._auTitle.value:"Noname";if(!e.onAdd)return alert("Not found onAdd callback function");if(i.end-i.start<this.maxDepthSeconds)return alert("\uc885\ub8cc\uc2dc\uac04\uc740 \uc2dc\uc791\uc2dc\uac04\ubcf4\ub2e4 "+this.maxDepthSeconds+"\ucd08 \uc774\uc0c1 \ucee4\uc57c \ud569\ub2c8\ub2e4.");var t={start:i.start,end:i.end,name:r};e.onAdd.call(this,t,function(e,t){if(e){!0===e&&(e={});e.name||(e.name=r);e.start||(e.start=i.start);e.end||(e.end=i.end);n.addBookmark(e);n.hideAddBookmarkUi()}})}},deleteAddBookmark:function(i){var e=this.attr;if(!e.onDelete)return alert("Not found onDelete callback function");if(confirm("\uc774 \ubd81\ub9c8\ud06c\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){var n=this;e.onDelete.call(this,i,function(e,t){if(!t){u.remove(i);n.repairAddBookmarkNumber()}})}}});return r})}();!function(){"use strict";var s=getDframework(),a=s.module("imgtech.media.Media");s.define("imgtech.media.module.RepeatInput",function(){var n=s.module("imgtech.media.ModuleInterface");function r(e){n.apply(this,arguments);if(e){var t=this.attr,i=this.p.userElement;if(this._inputUi=s.query(i,".mpv-repeatinputl")){this._auTitle=s.query(i,".mpv-repeatinputl-title");this._auTimes=s.queryAll(i,".mpv-repeatinputl-time");this._auSaveBtn=s.query(i,".mpv-repeatinputl-save-btn");this._auCurrentBtn=s.query(i,".mpv-repeatinputl-current-btn");this._auCloseBtn=s.query(i,".mpv-repeatinputl-close-btn")}this.maxDepthSeconds=t.maxDepthSeconds?t.maxDepthSeconds:r.MAX_DEPTH_SECONDS;this.lastCallback=null}}r.MAX_DEPTH_SECONDS=5;s.extendClass(r,n,{onAddEvent:function(){var e=this;this._auCloseBtn&&s.on(this._auCloseBtn,"click",function(){e.hide()});this._auCurrentBtn&&s.on(this._auCurrentBtn,"click",function(){e.currentAddBookmarkUi()});this._auSaveBtn&&s.on(this._auSaveBtn,"click",function(){e.save()});this.repeatMod=this.p.module("repeat")},onStateChange:function(e){switch(e.type){case a.EVENT.STATE_CHANGE:if(e.data==a.STATE.SETSOURCE){var t=this.p.currentMediaSource(),i=t&&t.input,n=i&&i.repeatBookmark;if(n)for(var r in n)this.addBookmark(n[r]);break}}},hide:function(){var e=this._inputUi;e&&s.addClass(e,"mpv-hide")},show:function(e,t){var i=this._inputUi;if(i){this.setCurrentTime(0);if(this._auTimes){this._auTimes[3].value="--";this._auTimes[4].value="--";this._auTimes[5].value="--"}if(this._auTitle){e||(e=this._auTitle.value);this._auTitle.value=e||"\ubd81\ub9c8\ud06c"}s.removeClass(i,"mpv-hide")}this.lastCallback=t},full:function(){this.showFullVideo()},getCurrentTime:function(){function i(e){try{return e.value?parseInt(e.value):0}catch(i){var t="\uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.";alert(t);throw new Error(t)}}function e(e,t){return 3600*i(e[t+0])+60*i(e[t+1])+i(e[t+2])}return this._auTimes?{start:e(this._auTimes,0),end:e(this._auTimes,3)}:null},enableCurrentTime:function(){function i(e){return!!e.value&&(!!/(^[0-9]+$)/.exec(e.value)&&parseInt(e.value))}function e(e,t){return!1!==i(e[t+0])&&(!1!==i(e[t+1])&&!1!==i(e[t+2]))}return this._auTimes?e(this._auTimes,0)?!!e(this._auTimes,3)||alert("\uc885\ub8cc \uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("\uc2dc\uc791 \uc2dc\uac04\uc774 \uc798\ubabb \uc9c0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("Not enable add bookmark ui.")},setCurrentTime:function(e){if(this._auTimes){var t=this.p.currentTime(),i=a.secondsToString(t).split(":");this._auTimes[e+0].value=2<i.length?i[0]:"00";this._auTimes[e+1].value=2<i.length?i[1]:1<i.length?i[0]:"00";this._auTimes[e+2].value=2<i.length?i[2]:1<i.length?i[1]:0<i.length?i[0]:"00"}},currentAddBookmarkUi:function(){this.setCurrentTime(3)},showFullVideo:function(){this.repeatMod.hide()},save:function(e){if(!0===this.enableCurrentTime()){var t=this.getCurrentTime(),i=this.attr,n=this._auTitle?this._auTitle.value:"Noname",r=e||(this.lastCallback?this.lastCallback:i.callback);if(!r)return alert("Not found callback function");if(t.end-t.start<this.maxDepthSeconds)return alert("\uc885\ub8cc\uc2dc\uac04\uc740 \uc2dc\uc791\uc2dc\uac04\ubcf4\ub2e4 "+this.maxDepthSeconds+"\ucd08 \uc774\uc0c1 \ucee4\uc57c \ud569\ub2c8\ub2e4.");var s={start:t.start,end:t.end,name:n};r.call(this,s)}}});return r})}();!function(){"use strict";var d=getDframework(),f=d.module("imgtech.media.Media");d.define("imgtech.media.module.Thumbnail",function(){var t=d.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);if(e){this.enableThumbnail=!1;this.is_error=!0;this.is_draw_thumbnail=!1;this.current_thumbnail=0;this.setSelfElementObject("totalProgress");this.setSelfElementObject("currentProgress");this.thumbnailLayout=d.query(this.p.userElement,".mpv-thumbnail");this.thumbnailImage=d.query(this.p.userElement,".mpv-thumbnail .mpv-thumbnail-image");this.thumbnailTime=d.query(this.p.userElement,".mpv-thumbnail .mpv-thumbnail-time");this.hideThumbnail()}}d.extendClass(e,t,{onAddEvent:function(){var e=this.totalProgress,t=(e&&e.element,this.thumbnailLayout),i=this.thumbnailImage,n=this;if(e){e.on("mousemove",function(e){return n.mousemove(e)});e.on("mouseout",function(e){return n.mouseout(e)})}if(this.currentProgress){this.currentProgress.on("mousemove",function(e){return n.mousemove(e)});this.currentProgress.on("mouseout",function(e){return n.mouseout(e)})}i&&d.on(i,"error",function(e){if(!n.is_error){n.is_error=!0;d.ui.hide(t)}})},onStateChange:function(e){switch(e.type){case f.EVENT.RESET:this.hideThumbnail();break;case f.EVENT.STATE_CHANGE:if(e.data===f.STATE.SETSOURCE){var t=e.source&&e.source.input;this.enableThumbnail=t&&t.enableThumbnail;this.is_error=!1}}},mouseout:function(e){this.hideThumbnail()},mousemove:function(e){if(!this.enableThumbnail)return this.hideThumbnail();if(!this.p.currentMediaSource())return this.hideThumbnail();var t=e.clientX,i=e.clientY,n=this.totalProgress,r=n&&d.getBoundingClientRect(n.element),s=r&&r.width(),a=s?t-r.left:0;if(!a||s<a||a<0)return this.hideThumbnail();if(!(r.top-5<=i&&i<=r.bottom+5&&r.left<=t&&t<=r.right))return this.hideThumbnail();var o=a/s*this.p.duration();this.drawTime(o)},showThumbnail:function(e,t){this.attr;var i=this.thumbnailLayout,n=this.thumbnailImage,r=this.thumbnailTime,s=this.p.duration(),a=this.totalProgress,o=a&&d.getBoundingClientRect(a.element);if(o&&i&&n&&s){var l=f.secondsToString(e),u=e/s*100*o.width()/100,c=(Math.floor(o.width()*(e/s)),i.offsetWidth),h=(i.offsetHeight,u-c/2);h<0?h=0:h+c>o.width()&&(h=o.width()-c);i.style.left=h+"px";r&&(r.innerText=l);n.src=t;d.ui.show(i)}else d.ui.hide(i)},hideThumbnail:function(){var e=this.thumbnailLayout;e&&d.ui.hide(e)},drawTime:function(t){if(this.enableThumbnail&&!this.is_draw_thumbnail&&(!this.is_error||e.is_always_hide_onerror)){this.is_draw_thumbnail=!0;var e=this.attr,i=this;if(e.callback){var n=this.thumbnailLayout;e.callback.call(this,t,function(e){i.is_draw_thumbnail=!1;if(!e)return d.ui.hide(n);i.showThumbnail(t,e)})}}}});return e})}();!function(){"use strict";var s=getDframework(),r=s.module("imgtech.media.Media");s.define("imgtech.media.module.WatchTime",function(){var n=s.module("imgtech.media.ModuleInterface");function e(e){n.apply(this,arguments);if(e){this.init();var t=this.attr;t.depthSeconds||(t.depthSeconds=10);(t.allTime||t.overlapedPlayingRealTime||t.overlapedPlayingTime||t.playingTime)&&(i=this,s.on(window,"beforeunload",function(){i.beforeunload()}))}var i}s.extendClass(e,n,{onAddEvent:function(){},onStateChange:function(e){switch(e.type){case r.EVENT.STATE_CHANGE:switch(e.data){case r.STATE.SETSOURCE:this.init();var t=this.p.currentMediaSource(),i=t&&t.input;if(i){this.allTimeOld=i.allTime?i.allTime:0;this.overlapedPlayingRealTimeOld=i.overlapedPlayingRealTime?i.overlapedPlayingRealTime:0;this.overlapedPlayingTimeOld=i.overlapedPlayingTime?i.overlapedPlayingTime:0;this.playingTimeOld=i.playingTime?i.playingTime:0;if("number"==typeof this.playingTimeOld&&this.playingTimeOld){this.playingTimeOldX=this.playingTimeOld;this.repairRange(0,this.playingTimeOld);this.playingTimeOld=0}}break;case r.STATE.PLAYING:this._startPlayTime||(this._startPlayTime=(new Date).getTime());this._onPlayingTime=(new Date).getTime();this._isEnded&&(this._isEnded=!1);break;case r.STATE.PAUSED:this.onPlayingChange();break;case r.STATE.ENDED:try{this.ended()}catch(n){}this.onPlayingChange();this._isEnded=!0}break;case r.EVENT.SEEKTO_MEDIA:this.seekData=e.data.value;break;case r.EVENT.CURRENT_TIME_CHANGE:try{this.currentTimeChange(e.data)}catch(n){}try{this.createEvent(e.data)}catch(n){}}},onPlayingChange:function(){if(this._onPlayingTime){this._playingTime+=(new Date).getTime()-this._onPlayingTime;this._onPlayingTime=0}},init:function(){this._overlapRange=[];this._range=[];this._startPlayTime=0;this._playingTime=0;this._onPlayingTime=0;this._startTime=0;this._endTime=0;this.seekData=null;this._isEnded=!1;this.__allTime_old=0;this.__overlapedPlayingRealTime_old=0;this.__overlapedPlayingTime_old=0;this.__playingTime_old=0;this.allTimeOld=0;this.overlapedPlayingRealTimeOld=0;this.overlapedPlayingTimeOld=0;this.playingTimeOld=0;this.allTimeOldx=0;this.overlapedPlayingRealTimeOldx=0;this.overlapedPlayingTimeOldx=0;this.playingTimeOldx=0},allTime:function(e){var t=this._startPlayTime?((new Date).getTime()-this._startPlayTime)/1e3:0;if(e){var i=this.allTimeOld;return{value:i+t,old:i,current:t}}return t},useTime:function(e){return this.allTime(e)},overlapedPlayingRealTime:function(e){var t=0;t=this.p.getPlayerState()===r.STATE.PLAYING&&this._onPlayingTime?this._playingTime+((new Date).getTime()-this._onPlayingTime):this._playingTime;t/=1e3;if(e){var i=this.overlapedPlayingRealTimeOld;return{value:i+t,old:i,current:t}}return t},overlapedPlayingTime:function(e){for(var t=this._overlapRange,i=0,n=0;n<t.length;n++){var r=t[n];i+=r.end-r.start}this._endTime&&(i+=this._endTime-this._startTime);if(e){var s=this.overlapedPlayingTimeOld;return{value:s+i,old:s,current:i}}return i},playingTime:function(e){this.repairRange(this._startTime,this._endTime);for(var t=this._range,i=0,n=0;n<t.length;n++){var r=t[n];i+=r.end-r.start}return e?{value:i}:i},beforeunload:function(){var e=this.p.currentTime();e&&this.createEvent({currentTime:e},{isBeforeUnload:!0})},ended:function(){var e=this.p.currentTime();e&&this.createEvent({currentTime:e},{isEnded:!0})},createEvent:function(e,u){u||(u={});function t(e,t,i){try{this.attr;var n="__"+t+"_old",r=this[t].call(this),s=this[n],a=this[t+"Old"]?this[t+"Old"]:0,o=r-s;if(!r)return;if(o>=this.attr.depthSeconds||o<0||u.isBeforeUnload||u.isEnded){this[n]=r;this.attr[t].call(this,{currentTime:c,value:r+a,currentValue:r,oldValue:this[t+"OldX"]?this[t+"OldX"]:a,param:e,beforeUnload:u.isBeforeUnload,ended:u.isEnded,data:i})}}catch(l){this.p.error(l)}}function i(e,t){if(this.attr[t]){var i="__"+t+"_old",n=this[t].call(this),r=this[i],s=this[t+"Old"]?this[t+"Old"]:0,a=n-r;n||(n=0);this[i]=n;e[t]||(e[t]={});e[t].value=n+s;e[t].current=n;e[t].old=this[t+"OldX"]?this[t+"OldX"]:s;e[t].depth=a;e[t].lastValue=r}}var n=this.p.currentMediaSource().input,r=this.attr,c=e.currentTime,s={};if(n)if(r.callback){this.__timer||(this.__timer=(new Date).getTime());var a=(new Date).getTime();if(Math.floor((a-this.__timer)/1e3)>=r.depthSeconds||u.isBeforeUnload||u.isEnded){i.call(this,s,"allTime");i.call(this,s,"overlapedPlayingRealTime");i.call(this,s,"overlapedPlayingTime");i.call(this,s,"playingTime");this.__timer=a;try{r.callback.call(this,{currentTime:c,param:n,beforeUnload:u.isBeforeUnload,ended:u.isEnded,data:s})}catch(o){this.p.error(o)}}}else{r.allTime&&t.call(this,n,"allTime",s);r.overlapedPlayingRealTime&&t.call(this,n,"overlapedPlayingRealTime",s);r.overlapedPlayingTime&&t.call(this,n,"overlapedPlayingTime",s);r.playingTime&&t.call(this,n,"playingTime",s)}},repairRange:function(e,t){if(!(t<=e)&&t){for(var i,n,r,s,a=this._range,o=0;o<a.length;o++){var l=a[o];if(l.start<=e&&e<=l.end)return s=t,void((r=l).end<s&&(r.end=s));if(l.start<=t&&t<=l.end)return n=e,void((i=l).start>n&&(i.start=n))}a.push({start:e,end:t})}},repairOverlapRange:function(e,t){t<=e||!t||this._overlapRange.push({start:e,end:t})},currentTimeChange:function(e){var t=e.currentTime,i=null,n=this.attr.seekDepth?this.attr.seekDepth:1.5;if(this.seekData){var r=Math.abs(t-this.seekData);n<r&&s.warn("seek seekDepth: "+n+", depth => "+r+" = abs("+t+" - "+this.seekData+")");i=t;this.seekData=null}if(null!==i){this.repairRange(this._startTime,this._endTime);this.repairOverlapRange(this._startTime,this._endTime);this._startTime=i;this._endTime=t}else this._endTime=t}});return e})}();!function(){"use strict";var o=getDframework();o.module("imgtech.media.Media");o.define("imgtech.media.module.ClipbankLayout",function(){var t=o.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.initLayout()}o.extendClass(e,t,{onAddEvent:function(){},onStateChange:function(e){},initLayout:function(){var e=this.p,t=this.attr,i=e.userElement,n=document.createElement("div");o.addClass(n,"mpv-clipbank-layout");var r=document.createElement("div");o.addClass(r,"mpv-clipbank-left");o.addClass(r,"mpv-clipbank-fix");var s=document.createElement("div");o.addClass(s,"mpv-clipbank-center");var a=document.createElement("div");o.addClass(a,"mpv-clipbank-right");o.addClass(a,"mpv-clipbank-fix");t.maxHeight&&(n.style.maxHeight=t.maxHeight+"px");o.before(i,n);o.append(n,r);o.append(n,s);o.append(n,a);o.append(s,i)}});return e})}();!function(){"use strict";var o=getDframework(),t=o.module("imgtech.media.Media");o.define("imgtech.media.module.YoutubeConfig",function(){var i=o.module("imgtech.media.ModuleInterface");function e(e){i.apply(this,arguments);if(e){this.attr;var t=this.p.userElement;this._configBtn=o.query(t,".mpv-ytconfig-btn");this._configLayer=o.query(t,".mpv-ytconfig-layer");this._configTable=o.query(t,".mpv-ytconfig-table");if(this._configTable){this._configRowHtml=this._configTable.innerHTML;this._configTable.innerText=""}this._modules=[{modName:"youtubeRate"}];this._configLayer&&this.setSelfAddElementObject("youtubeConfigLayer",this._configLayer,{openLayer:!0})}}o.extendClass(e,i,{onAddEvent:function(){var e,t,i=this;for(e=0;e<this._modules.length;e++){(t=this._modules[e]).instance=this.p.module(t.modName);t.name=t.instance.attr.name;t.instance.configMod=this}this._configBtn&&o.on(this._configBtn,"click",function(e){return i.onClickConfigBtn(e)})},onStateChange:function(e){switch(e.type){case t.EVENT.STATE_CHANGE:e.data===t.STATE.SETSOURCE&&this.hide();break;case t.EVENT.CLICK_EVENT:}},isEnable:function(){return!(!this._configLayer||!this._configTable)},onClickConfigBtn:function(e){var t=this.youtubeConfigLayer;if(t){var i,n=!1;for(i=0;i<this._modules.length&&!(n=this._modules[i].instance.isShow());i++);if(n)return this.hideAll();if(t.isHide())return this.show(e);this.hide()}},selectElement:function(e,t){this.hide();t.instance.selected()},update:function(){var e,t;for(e=0;e<this._modules.length;e++)(t=this._modules[e]).element&&(o.query(t.element,".mpv-ytconfig-value").innerText=t.instance.value())},drawElement:function(t){var i=this,n=o.element(this._configRowHtml),e=t.instance,r=e.value(),s=e.isExtends(),a=o.query(n,".mpv-ytconfig-extends");t.element=n;o.query(n,".mpv-ytconfig-name").innerText=t.name;o.query(n,".mpv-ytconfig-value").innerText=r;s?o.addClass(a,"mpv-ytconfig-yes-extends"):o.addClass(a,"mpv-ytconfig-no-extends");o.on(n,"click",function(e){i.selectElement(n,t);return o.igEventAll(e)});return n},show:function(e){if(this.isEnable()){var t,i=this.youtubeConfigLayer;if(i){this._configTable.innerText="";for(t=0;t<this._modules.length;t++)this._configTable.appendChild(this.drawElement(this._modules[t]));this.c.removeAllHistory();i.show();var n=i.rect(),r=this.attr.offsetY?this.attr.offsetY:0;i.top("-"+(n.height()+r)+"px");if(e)return o.igEventAll(e)}}},hideAll:function(){for(var e=0;e<this._modules.length;e++)this._modules[e].instance.hide()},hide:function(){var e=this.youtubeConfigLayer;e&&e.hide()}});return e})}();!function(){"use strict";var a=getDframework(),t=a.module("imgtech.media.Media");a.define("imgtech.media.module.YoutubeRate",function(){var i=a.module("imgtech.media.ModuleInterface");function e(e){i.apply(this,arguments);if(e){this.attr;var t=this.p.userElement;this._defValue="\ubcf4\ud1b5";this._layout=a.query(t,".mpv-ytconfig-rate-layout");this._list=a.query(t,".mpv-ytconfig-rate-list");this._top=a.query(t,".mpv-ytconfig-rate-top");if(this._list){this._listHtml=this._list.innerHTML;this._list.innerText=""}this._layout&&this.setSelfAddElementObject("youtubeRateLayer",this._layout,{openLayer:!0})}}a.extendClass(e,i,{onAddEvent:function(){var e=this;this._top&&a.on(this._top,"click",function(){e.close()})},onStateChange:function(e){switch(e.type){case t.EVENT.STATE_CHANGE:e.data===t.STATE.SETSOURCE&&this.hide();break;case t.EVENT.RATE_CHANGE:this.configMod&&this.configMod.update();break;case t.EVENT.CLICK_EVENT:}},close:function(){this.hide();this.configMod&&this.configMod.show()},value:function(){var e=this.p.getPlaybackRate();return 1===e?this._defValue:e},isExtends:function(){return!0},isShow:function(){return this.youtubeRateLayer&&this.youtubeRateLayer.isShow()},selected:function(){this.show()},hide:function(){this.youtubeRateLayer&&this.youtubeRateLayer.hide()},drawElement:function(t,e){var i=this,n=this.p,r=a.element(this._listHtml),s=1===t.value?this._defValue:t.value;a.query(r,".mpv-view-text").innerText=s;e==t.value&&a.addClass(r,"mpv-option-selected");a.on(r,"click",function(e){n.setPlaybackRate(t.value);i.lastCallback&&i.lastCallback(t);i.close();return a.igEventAll(e)});return r},show:function(e){var t,i,n=this.p,r=n.getPlaybackRate(),s=n.getAvailablePlaybackRates(),a=this._list;this.lastCallback=e;if(a){this._list.innerText="";for(t=0;t<s.length;t++)(i=this.drawElement(s[t],r))&&this._list.appendChild(i);this.youtubeRateLayer&&this.youtubeRateLayer.show()}}});return e})}();!function(){"use strict";var l=window.getDframework(),u=l.module("imgtech.media.Media"),e=!1;l.define("imgtech.recorder.Recorder",function(){var t=l.module("imgtech.media.module.Device");l.module("imgtech.media.SourceInfo"),l.module("imgtech.media.Source");function r(e){r.install();t.apply(this,arguments);if(e){this.currentState=u.STATE.UNSTARTED;this.audioContext=r.createAudioContext();!function(i){i.p.test=function(e){return i.test(e)};i.p.cancel=function(){return i.cancel()};i.p.record=function(){return i.play()};i.p.loadRecorded=function(e,t){return i.loadRecorded(e,t)};i.p.playRecorded=function(){return i.playRecorded()};i.p.pauseRecorded=function(){return i.pauseRecorded()};i.p.stopRecorded=function(){return i.stopRecorded()};i.p.download=function(){return i.download()};i.p.clear=function(e){return i.clearData(e)}}(this)}}r.install=function(){if(!e){e=!0;navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia);navigator.cancelAnimationFrame||(navigator.cancelAnimationFrame=navigator.webkitCancelAnimationFrame||navigator.mozCancelAnimationFrame||navigator.msCancelAnimationFrame||navigator.oCancelAnimationFrame);navigator.requestAnimationFrame||(navigator.requestAnimationFrame=navigator.webkitRequestAnimationFrame||navigator.mozRequestAnimationFrame||navigator.msRequestAnimationFrame||navigator.oRequestAnimationFrame)}};r.createAudioContext=function(){return window.webkitAudioContext?new window.webkitAudioContext:window.mozAudioContext?new window.mozAudioContext:window.msAudioContext?new window.msAudioContext:window.oAudioContext?new window.oAudioContext:window.AudioContext?new window.AudioContext:null};r.getMediaParam=function(e){var t,i=typeof e;if(!e)return!1;if("boolean"==i)e={};else if("object"!=i)throw new Error("getMediaParam parameter is boolean or object.");e.mandatory||(e.mandatory={});e.optional||(e.optional=[]);t=e.mandatory;e.optional;t.googEchoCancellation||(t.googEchoCancellation=!1);t.googAutoGainControl||(t.googAutoGainControl=!1);t.googNoiseSuppression||(t.googNoiseSuppression=!1);t.googHighpassFilter||(t.googHighpassFilter=!1);return e};r.audioTest=function(t){r.install();var e={audio:!0};e.audio=r.getMediaParam(e.audio);navigator.getUserMedia(e,function(e){t(!0)},function(e){t(!1)})};l.extendClass(r,t,{getClassName:function(){return"imgtech.recorder.Recorder"},getPlayerType:function(){return"recorder"},currentMediaSource:function(){return null},onReady:function(e){this.p.callStateChange({type:u.EVENT.SET_DISABLED,data:"testing",where:"recorder",source:null,device:this,parent:null});e.callback&&e.callback()},onStateChange:function(e){var t=this,i=this.p;switch(e.type){case u.EVENT.ON_READY:this.onReady(e);break;case u.EVENT.STATE_CHANGE:switch(e.data){case u.STATE.CUED:if(!this.is_called_cued){this.is_called_cued=!0;setTimeout(function(){i.callStateChange({type:u.EVENT.SET_DISABLED,data:"success",where:"recorder",source:t.currentMediaSource(),device:t,parent:e})},1)}setTimeout(function(){i.callStateChange({type:u.EVENT.CAN_PLAY,parent:e})},2);if(this.is_called_record){this.is_called_record=!1;setTimeout(function(){t.is_called_autoplay_recorded=!0;t.record(e)},3)}}}r.__super.onStateChange.apply(this,arguments)},autoplay:function(e){var t=this;this.p.attr.autoplay&&setTimeout(function(){t.is_called_autoplay_recorded||t.record(e);t.is_called_autoplay_recorded=!1},1)},getVolume:function(){},setVolume:function(){},currentTime:function(){},duration:function(){},isMuted:function(){},getBuffering:function(){},source:function(e){var t=this.p.attr;t.autoplay?this.record():t.onloadPermission&&this.permission()},getPlayerState:function(){return this.currentState},permission:function(i){var n=this;if(!this.audioRecorder&&!this.is_called_getusermedia){n=this;(function(t){if(!this.is_called_getusermedia){this.is_called_getusermedia=!0;var i=this,e=this.p.attr.data;if(!e||!e.audio)throw new Error("Not found audio configure.");e.audio&&(e.audio=r.getMediaParam(e.audio));if(e.video){e.video=!1;l.log("AudioCapture:: video configure is ignored.")}this.lastUseData=e;navigator.getUserMedia(e,function(e){i.p.log("## Access capture media OK.");t&&t(e)},function(e){t?t(null,e):l.error(e)});return this}}).call(this,function(e,t){if(t){l.error(t);p.callStateChange({type:u.EVENT.ON_ERROR,data:t})}else e?n.onReadyStream(e,i):p.callStateChange({type:u.EVENT.ON_ERROR,data:"Not found stream"})})}},record:function(e){if(!this.audioRecorder){this.is_called_record=!0;return this.permission(e)}this.audioRecorder&&this.audioRecorder.record(e)},play:function(e){this.record(e)},cancel:function(){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.cancel()},pause:function(e){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.pause(e)},stop:function(){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.pause();return this.clearData()},onReadyStream:function(e,t){var i=this,n=this.p,r=n.controller.m;if(this.currentState!=u.STATE.UNSTARTED)throw new Error("Wrong recorder life cycle.");if(!this.audioContext)throw new Error("Not found AudioContext");if(!(this.inputPoint=this.audioContext.createGain()))throw new Error("Not found input point");if(!(this.streamSource=this.audioContext.createMediaStreamSource(e)))throw new Error("Not found stream source");this.streamSource.connect(this.inputPoint);var s=l.module("imgtech.recorder.DeviceRecorder"),a=r.soundAnalyser,o=this.p.attr;a&&a.connect(this.audioContext,this.inputPoint);this.audioRecorder=new s(this.inputPoint,{arrayRecord:o.arrayRecord,onStateChange:function(e){t&&(e.recorder_parent_event=t);e.type==u.EVENT.STATE_CHANGE&&(i.currentState=e.data);n.callStateChange(e)}})},getBLOBData:function(e,t){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.p;if(0===e||e){if(!this.audioRecorder.indexWAV)throw new Error("Not found audio recorder indexWAV !");this.audioRecorder.indexWAV(e,function(e){e.blob&&t(e.blob)})}else{if(!this.audioRecorder.exportWAV)throw new Error("Not found audio recorder exportWAV!");this.audioRecorder.exportWAV(function(e){e.blob&&t(e.blob)})}},getAudioRecorded:function(e,n){this.getBLOBData(e,function(e){var t=(window.URL||window.webkitURL).createObjectURL(e),i=new Audio(t);n(i)})},loadRecorded:function(e,t){var i=this,n=this.p;this.__audio=null;this.getAudioRecorded(e,function(e){(i.__audio=e).onended=function(){n.callStateChange({type:"record-listen-ended"})};i.playRecorded();t&&t()})},playRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.play()},pauseRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.pause()},stopRecorded:function(){if(!this.__audio)throw new Error("Not load recorded autio.");this.__audio.pause();this.__audio.currentTime=0},download:function(){var s=this;if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.exportWAV(function(e){var t="recording-"+s.filenameIndex+".wav",i=(window.URL||window.webkitURL).createObjectURL(e),n=s.downloadNode,r=n?null:document.createElement("a");if(r){r.style.display="none";document.body.appendChild(r);n=r}n.href=i;n.download=t||"output.wav";n.click();window.URL.revokeObjectURL(i)})},clearData:function(e){if(!this.audioRecorder)throw new Error("Not found audio recorder !");this.audioRecorder.clear(e)},test:function(e){r.audioTest(e)}});return r})}();!function(){var a=window.getDframework(),o=a.module("imgtech.media.Media");a.define("imgtech.recorder.DeviceRecorder",function(){function r(e,t){this.config=t||{};var i=this.config.bufferLen||4096,n=r.getDeviceRecorderWorkerPath();if(!n)throw new Error("Not found worker path.");this.context=e.context;this.context.createScriptProcessor?this.node=this.context.createScriptProcessor(i,2,2):this.node=this.context.createJavaScriptNode(i,2,2);this.is_started=!1;this.is_recording=!1;this.is_recorded=!1;this.callbackId=0;this.callbacks=[];this.recordData=[];this.config.arrayRecord;this.worker=new Worker(n);this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});!function(t){t.node.onaudioprocess=function(e){t.onaudioprocess(e)};t.worker.onmessage=function(e){t.onworkermessage(e)}}(this);e.connect(this.node);this.node.connect(this.context.destination)}r.getDeviceRecorderWorkerPath=function(){for(var e,t=a.queryAll("script"),i="js/source/source.js",n=0;n<t.length;n++){var r=t[n].src,s=r.lastIndexOf("?");-1!==s&&(r=r.substring(0,s));if(-1!==(s=r.lastIndexOf(o.filename))){if(r.substring(s)===o.filename)return r.substring(0,s)+"worker/DeviceRecorderWorker.js"}else-1!==(s=r.lastIndexOf(i))&&r.substring(s)===i&&(e=r.substring(0,s)+"js/recorder/worker/DeviceRecorderWorker.js")}return e||null};r.prototype={constructor:r,configure:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t])},cancel:function(){if(this.is_recording){this.is_recording=!1;this.clearWorker();this.onstatechange({type:"record-cancel",data:this.recordData.length-1})}},record:function(t){var i=this;if(this.is_started&&!this.is_recording){!function(){for(var e=t;e.recorder_parent_event;)e=e.recorder_parent_event;e.data&&e.data.limitSeconds&&"number"==typeof e.data.limitSeconds&&setTimeout(function(){i.pause()},1e3*e.data.limitSeconds)}();this.is_recording=!0}},pause:function(){var t=this;if(this.is_started&&this.is_recording){this.is_recording=!1;this.exportWAV(function(e){if(e&&e.blob){t.recordData.push(e);t.clearWorker();t.onstatechange({type:"record-pause",data:t.recordData.length-1})}})}},clearWorker:function(){this.worker.postMessage({command:"clear"})},clear:function(e){if(e||0===e){var t=this.recordData;return t&&t.length>e?t.splice(e,1):a.warn("Not found index value for clear")}this.recordData=[];this.clearWorker()},onaudioprocess:function(e){if(this.is_started){if(this.is_recording){if(!this.is_recorded){this.is_recorded=!0;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PLAYING})}this.worker.postMessage({command:"record",buffer:[e.inputBuffer.getChannelData(0),e.inputBuffer.getChannelData(1)]})}else if(this.is_recorded){this.is_recorded=!1;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.PAUSED})}}else{this.is_started=!0;this.onstatechange({type:o.EVENT.STATE_CHANGE,data:o.STATE.CUED})}},onworkermessage:function(e){var t,i=e.data;if(i.id)for(var n=0;n<this.callbacks.length;n++){var r=this.callbacks[n];if(r.id===i.id){this.callbacks.splice(n,1);t=r.callback;break}}return t?t(i):this.config.callback?this.config.callback(i):void 0},onstatechange:function(e){this.config.onStateChange&&this.config.onStateChange(e)},createCallbackData:function(e,t){var i=++this.callbackId;e.id=i;e.ctime=(new Date).getTime();t&&this.callbacks.push({id:i,ctime:e.ctime,callback:t});return e},getBuffers:function(e){var t=this.createCallbackData({command:"getBuffers",type:type},e);this.worker.postMessage(t)},indexWAV:function(e,t){var i=this.recordData.length;if(i&&e<i&&(e||0===e))return t(this.recordData[e]);a.warn("Not found index wave data.")},exportWAV:function(e,t){t=t||this.config.type||"audio/wav";var i=this.createCallbackData({command:"exportWAV",type:t},e);this.worker.postMessage(i)},exportMonoWAV:function(e,t){t=t||this.config.type||"audio/wav";var i=this.createCallbackData({command:"exportMonoWAV",type:t},e);this.worker.postMessage(i)}};return r})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.SoundAnalyser",function(){var r=n.module("imgtech.media.ModuleInterface");function e(e){r.apply(this,arguments);if(e){this.setSelfElementObject("analyserCurrentCanvas");var t=this.analyserCurrentCanvas,i=t&&t.element,n=this.attr;if(i){n.width&&(i.width=n.width);n.height&&(i.height=n.height)}}}n.extendClass(e,r,{onAddEvent:function(){var e=this.analyserCurrentCanvas,t=e?e.element:null,i=t?n.getBoundingClientRect(e.element):null;if(t){t.width=i.width();t.height=i.height();this.context2d=t.getContext("2d")}},onStateChange:function(e){},connect:function(e,t){if(!(this.analyser=e.createAnalyser?e.createAnalyser():null))throw new Error("Not found create analyser at audio context.");this.analyser.fftSize=2048;t.connect(this.analyser);this.update()},update:function(e){var t,i,n,r,s=this,a=this.analyserCurrentCanvas,o=a?a.element:null,l=o?o.width:0,u=o?o.height:0,c=Math.round(l/3),h=new Uint8Array(this.analyser.frequencyBinCount),d=this.analyser.frequencyBinCount/c;this.analyser.getByteFrequencyData(h);this.context2d.clearRect(0,0,l,u);this.context2d.fillStyle="#F6D565";this.context2d.lineCap="round";for(t=0;t<c;++t){n=0;r=Math.floor(t*d);for(i=0;i<d;i++)n+=h[r+i];n/=d;h[t*d];this.context2d.fillStyle="hsl( "+Math.round(360*t/c)+", 100%, 50%)";this.context2d.fillRect(3*t,u,1,-n)}window.requestAnimationFrame?this.lastAnimationFrameId=window.requestAnimationFrame(function(e){s.update(e)}):this.lastAnimationFrameId=window.setTimeout(function(){s.update()},Math.floor(1e3/60))}});return e})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.ListenRecorded",function(){var t=n.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("listenRecordedBtn")}n.extendClass(e,t,{onAddEvent:function(){var e=this.listenRecordedBtn,t=e?e.element:null,i=this.p;t&&n.on(t,"click",function(){i.toggleListenRecorded()})}});return e})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.Download",function(){var t=n.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("downloadBtn")}n.extendClass(e,t,{onAddEvent:function(){var e=this.downloadBtn,t=e?e.element:null,i=this.p;t&&n.on(t,"click",function(){i.download()})}});return e})}();!function(){"use strict";var n=getDframework();n.module("imgtech.media.Media");n.define("imgtech.recorder.module.Clear",function(){var t=n.module("imgtech.media.ModuleInterface");function e(e){t.apply(this,arguments);e&&this.setSelfElementObject("clearBtn")}n.extendClass(e,t,{onAddEvent:function(){var e=this.clearBtn,t=e?e.element:null,i=this.p;t&&n.on(t,"click",function(){i.clear()})}});return e})}();!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,function(){return function(i){function n(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var r={};return n.m=i,n.c=r,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=8)}([function(e,t,i){"use strict";function r(){}function n(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];i.forEach(function(e){o[e]=t[e]?t[e].bind(t):(s=e,(a=self.console[s])?function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0]&&(t[0]=(n=s,r=t[0],"["+n+"] > "+r)),a.apply(self.console,t);var n,r}:r);var s,a})}i.d(t,"a",function(){return l}),i.d(t,"b",function(){return u});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a={trace:r,debug:r,log:r,warn:r,info:r,error:r},o=a,l=function(e){if(!0===e||"object"===(void 0===e?"undefined":s(e))){n(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=a}}else o=a},u=a},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return r});var n={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,i){"use strict";i.d(t,"b",function(){return r});var n=function(){function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o)}return o.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.getID3Data=function(e,t){for(var i=t,n=0;o.isHeader(e,t);){n+=10;n+=o._readSize(e,t+6),o.isFooter(e,t+10)&&(n+=10),t+=n}if(0<n)return e.subarray(i,i+n)},o._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},o.getTimeStamp=function(e){for(var t=o.getID3Frames(e),i=0;i<t.length;i++){var n=t[i];if(o.isTimeStampFrame(n))return o._readTimeStamp(n)}},o.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},o._getFrameData=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=o._readSize(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}},o.getID3Frames=function(e){for(var t=0,i=[];o.isHeader(e,t);){for(var n=o._readSize(e,t+6),r=(t+=10)+n;t+8<r;){var s=o._getFrameData(e.subarray(t)),a=o._decodeFrame(s);a&&i.push(a),t+=s.size+10}o.isFooter(e,t)&&(t+=10)}return i},o._decodeFrame=function(e){return"PRIV"===e.type?o._decodePrivFrame(e):"T"===e.type[0]?o._decodeTextFrame(e):"W"===e.type[0]?o._decodeURLFrame(e):void 0},o._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},o._decodePrivFrame=function(e){if(!(e.size<2)){var t=o._utf8ArrayToStr(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}}},o._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,i=o._utf8ArrayToStr(e.data.subarray(t));t+=i.length+1;var n=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:i,data:n}}var r=o._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:r}}},o._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,i=o._utf8ArrayToStr(e.data.subarray(t));t+=i.length+1;var n=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:i,data:n}}var r=o._utf8ArrayToStr(e.data);return{key:e.type,data:r}},o._utf8ArrayToStr=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=e.length,n=void 0,r=void 0,s=void 0,a="",o=0;o<i;){if(0===(n=e[o++])&&t)return a;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:r=e[o++],a+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=e[o++],s=e[o++],a+=String.fromCharCode((15&n)<<12|(63&r)<<6|(63&s)<<0)}}return a},o}(),r=n._utf8ArrayToStr;t.a=n},function(e,t,i){"use strict";var o=function(){function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.subtle=e,this.aesIV=t}return i.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},i}(),l=function(){function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.subtle=e,this.key=t}return i.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},i}(),u=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),n=0;n<4;n++)i[n]=t.getUint32(4*n);return i},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],r=i[1],s=i[2],a=i[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],h=o[3],d=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99;var v=d[t[e[f]=g]=f],y=d[v],E=d[y],b=257*d[g]^16843008*g;n[f]=b<<24|b>>>8,r[f]=b<<16|b>>>16,s[f]=b<<8|b>>>24,a[f]=b,b=16843009*E^65537*y^257*v^16843008*f,l[g]=b<<24|b>>>8,u[g]=b<<16|b>>>16,c[g]=b<<8|b>>>24,h[g]=b,f?(f=v^d[d[d[E^v]]],p^=d[d[p]]):f=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,n=0;n<t.length&&i;)i=t[n]===this.key[n],n++;if(!i){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var s=this.ksRows=4*(r+6+1),a=void 0,o=void 0,l=this.keySchedule=new Uint32Array(s),u=this.invKeySchedule=new Uint32Array(s),c=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],m=d[2],g=d[3],v=void 0,y=void 0;for(a=0;a<s;a++)a<r?v=l[a]=t[a]:(y=v,a%r==0?(y=c[(y=y<<8|y>>>24)>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=h[a/r|0]<<24):6<r&&a%r==4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?l[a]:l[a-4],u[o]=o<4||a<=4?y:f[c[y>>>24]]^p[c[y>>>16&255]]^m[c[y>>>8&255]]^g[c[255&y]],u[o]=u[o]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,i){for(var n,r,s=this.keySize+6,a=this.invKeySchedule,o=this.invSBox,l=this.invSubMix,u=l[0],c=l[1],h=l[2],d=l[3],f=this.uint8ArrayToUint32Array_(i),p=f[0],m=f[1],g=f[2],v=f[3],y=new Int32Array(e),E=new Int32Array(y.length),b=void 0,T=void 0,w=void 0,S=void 0,_=void 0,C=void 0,A=void 0,x=void 0,k=void 0,R=void 0,N=void 0,L=void 0,D=this.networkToHostOrderSwap;t<y.length;){for(k=D(y[t]),R=D(y[t+1]),N=D(y[t+2]),L=D(y[t+3]),_=k^a[0],C=L^a[1],A=N^a[2],x=R^a[3],n=4,r=1;r<s;r++)b=u[_>>>24]^c[C>>16&255]^h[A>>8&255]^d[255&x]^a[n],T=u[C>>>24]^c[A>>16&255]^h[x>>8&255]^d[255&_]^a[n+1],w=u[A>>>24]^c[x>>16&255]^h[_>>8&255]^d[255&C]^a[n+2],S=u[x>>>24]^c[_>>16&255]^h[C>>8&255]^d[255&A]^a[n+3],_=b,C=T,A=w,x=S,n+=4;b=o[_>>>24]<<24^o[C>>16&255]<<16^o[A>>8&255]<<8^o[255&x]^a[n],T=o[C>>>24]<<24^o[A>>16&255]<<16^o[x>>8&255]<<8^o[255&_]^a[n+1],w=o[A>>>24]<<24^o[x>>16&255]<<16^o[_>>8&255]<<8^o[255&C]^a[n+2],S=o[x>>>24]<<24^o[_>>16&255]<<16^o[C>>8&255]<<8^o[255&A]^a[n+3],n+=3,E[t]=D(b^p),E[t+1]=D(S^m),E[t+2]=D(w^g),E[t+3]=D(T^v),p=k,m=R,g=N,v=L,t+=4}return E.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=i(2),c=i(0),n=function(){function n(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.observer=e,this.config=t,this.logEnabled=!0;try{var i=crypto||self.crypto;this.subtle=i.subtle||i.webkitSubtle}catch(n){}this.disableWebCrypto=!this.subtle}return n.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},n.prototype.decrypt=function(t,i,n,r){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(c.b.log("JS AES decrypt"),this.logEnabled=!1);var e=this.decryptor;e||(this.decryptor=e=new u),e.expandKey(i),r(e.decrypt(t,0,n))}else{this.logEnabled&&(c.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var a=this.subtle;this.key!==i&&(this.key=i,this.fastAesKey=new l(a,i)),this.fastAesKey.expandKey().then(function(e){new o(a,n).decrypt(t,e)["catch"](function(e){s.onWebCryptoError(e,t,i,n,r)}).then(function(e){r(e)})})["catch"](function(e){s.onWebCryptoError(e,t,i,n,r)})}},n.prototype.onWebCryptoError=function(e,t,i,n,r){this.config.enableSoftwareAES?(c.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,n,r)):(c.b.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},n.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},n}();t.a=n},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((e.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!("number"==typeof e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,s,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error('Uncaught, unspecified "error" event. ('+t+")");throw o.context=t,o}if(c(i=this._events[e]))return!1;if(l(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(u(i))for(r=Array.prototype.slice.call(arguments,1),n=(a=i.slice()).length,s=0;s<n;s++)a[s].apply(this,r);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(i=c(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.trace),this},n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!l(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,r,s;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,n=-1,i===t||l(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(i)){for(s=r;0<s--;)if(i[s]===t||i[s].listener&&i[s].listener===t){n=s;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,i){n=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,h={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=this.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");return n.path=h.normalizePath(n.path),h.buildURLFromParts(n)}var r=this.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=h.normalizePath(r.path),h.buildURLFromParts(r)):t;var s=this.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var a=c.exec(s.path);s.netLoc=a[1],s.path=a[2]}s.netLoc&&!s.path&&(s.path="/");var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var l=s.path,u=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=h.normalizePath(u)}else o.path=s.path,r.params||(o.params=s.params,r.query||(o.query=s.query));return null===o.path&&(o.path=i.alwaysNormalize?h.normalizePath(r.path):r.path),h.buildURLFromParts(o)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=h;var n,c,r,s,h},function(e,t,i){"use strict";function r(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function h(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function g(e,t){return!!(t+1<e.length&&r(e,t))}function s(e,t){if(t+1<e.length&&r(e,t)){var i=c(e,t);t+5<e.length&&(i=h(e,t));var n=t+i;if(n===e.length||n+1<e.length&&r(e,n))return!0}return!1}function v(e,t,i,n,r){if(!e.samplerate){var s=(a=t,o=i,l=n,u=r,m=navigator.userAgent.toLowerCase(),g=u,v=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=1+((192&o[l+2])>>>6),(h=(60&o[l+2])>>>2)>v.length-1?void a.trigger(Event.ERROR,{type:te.b.MEDIA_ERROR,details:te.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+h}):(f=(1&o[l+2])<<2,f|=(192&o[l+3])>>>6,ie.b.log("manifest codec:"+u+",ADTS data:type:"+c+",sampleingIndex:"+h+"["+v[h]+"Hz],channelConfig:"+f),/firefox/i.test(m)?6<=h?(c=5,p=new Array(4),d=h-3):(c=2,p=new Array(2),d=h):-1!==m.indexOf("android")?(c=2,p=new Array(2),d=h):(c=5,p=new Array(4),u&&(-1!==u.indexOf("mp4a.40.29")||-1!==u.indexOf("mp4a.40.5"))||!u&&6<=h?d=h-3:((u&&-1!==u.indexOf("mp4a.40.2")&&(6<=h&&1===f||/vivaldi/i.test(m))||!u&&1===f)&&(c=2,p=new Array(2)),d=h)),p[0]=c<<3,p[0]|=(14&h)>>1,p[1]|=(1&h)<<7,p[1]|=f<<3,5===c&&(p[1]|=(14&d)>>1,p[2]=(1&d)<<7,p[2]|=8,p[3]=0),{config:p,samplerate:v[h],channelCount:f,codec:"mp4a.40."+c,manifestCodec:g}));e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,ie.b.log("parsed codec:"+e.codec+",rate:"+s.samplerate+",nb channel:"+s.channelCount)}var a,o,l,u,c,h,d,f,p,m,g,v}function y(e){return 9216e4/e}function E(e,t,i,n,r){var s=function(e,t,i,n,r){var s,a,o=e.length;if(s=c(e,t),a=h(e,t),0<(a-=s)&&t+s+a<=o)return{headerLength:s,frameLength:a,stamp:i+n*r}}(t,i,n,r,y(e.samplerate));if(s){var a=s.stamp,o=s.headerLength,l=s.frameLength,u={unit:t.subarray(i+o,i+o+l),pts:a,dts:a};return e.samples.push(u),e.len+=l,{sample:u,length:l+o}}}var ee=i(1),te=i(2),m=i(4),ie=i(0),p=i(3),S=function(){function n(e,t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.observer=e,this.config=i,this.remuxer=t}return n.prototype.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},n.prototype.resetTimeStamp=function(){},n.probe=function(e){if(!e)return!1;for(var t=(p.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(s(e,t))return ie.b.log("ADTS sync word found !"),!0;return!1},n.prototype.append=function(e,t,i,n){for(var r=this._audioTrack,s=p.a.getID3Data(e,0)||[],a=p.a.getTimeStamp(s),o=a?90*a:9e4*t,l=0,u=o,c=e.length,h=s.length,d=[{pts:u,dts:u,data:s}];h<c-1;)if(g(e,h)&&h+5<c){v(r,this.observer,e,h,r.manifestCodec);var f=E(r,e,h,o,l);if(!f){ie.b.log("Unable to parse AAC frame");break}h+=f.length,u=f.sample.pts,l++}else p.a.isHeader(e,h)?(s=p.a.getID3Data(e,h),d.push({pts:u,dts:u,data:s}),h+=s.length):h++;this.remuxer.remux(r,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},t,i,n)},n.prototype.destroy=function(){},n}(),o=Math.pow(2,32)-1,_=function(){function d(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,d),this.observer=e,this.remuxer=t}return d.prototype.resetTimeStamp=function(e){this.initPTS=e},d.prototype.resetInitSegment=function(e,t,i,n){if(e&&e.byteLength){var r=this.initData=d.parseInitSegment(e);null==t&&(t="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:n?e:null}:(r.audio&&(s.audio={container:"audio/mp4",codec:t,initSegment:n?e:null}),r.video&&(s.video={container:"video/mp4",codec:i,initSegment:n?e:null})),this.observer.trigger(ee.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else t&&(this.audioCodec=t),i&&(this.videoCodec=i)},d.probe=function(e){return 0<d.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length},d.bin2str=function(e){return String.fromCharCode.apply(null,e)},d.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},d.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},d.findBox=function(e,t){var i,n,r,s,a,o,l=[];if(e.data?(a=e.start,r=e.end,e=e.data):(a=0,r=e.byteLength),!t.length)return null;for(i=a;i<r;)o=1<(n=d.readUint32(e,i))?i+n:r,d.bin2str(e.subarray(i+4,i+8))===t[0]&&(1===t.length?l.push({data:e,start:i+8,end:o}):(s=d.findBox({data:e,start:i+8,end:o},t.slice(1))).length&&(l=l.concat(s))),i=o;return l},d.parseInitSegment=function(e){var h=[];return d.findBox(e,["moov","trak"]).forEach(function(e){var t=d.findBox(e,["tkhd"])[0];if(t){var i=t.data[t.start],n=0===i?12:20,r=d.readUint32(t,n),s=d.findBox(e,["mdia","mdhd"])[0];if(s){i=s.data[s.start];var a=d.readUint32(s,n=0===i?12:20),o=d.findBox(e,["mdia","hdlr"])[0];if(o){var l={soun:"audio",vide:"video"}[d.bin2str(o.data.subarray(o.start+8,o.start+12))];if(l){var u=d.findBox(e,["mdia","minf","stbl","stsd"]);if(u.length){u=u[0];var c=d.bin2str(u.data.subarray(u.start+12,u.start+16));ie.b.log("MP4Demuxer:"+l+":"+c+" found")}h[r]={timescale:a,type:l},h[l]={timescale:a,id:r}}}}}}),h},d.getStartDTS=function(r,e){var t,i,n;return t=d.findBox(e,["moof","traf"]),i=[].concat.apply([],t.map(function(n){return d.findBox(n,["tfhd"]).map(function(e){var t,i;return t=d.readUint32(e,4),i=r[t].timescale||9e4,d.findBox(n,["tfdt"]).map(function(e){var t,i;return t=e.data[e.start],i=d.readUint32(e,4),1===t&&(i*=Math.pow(2,32),i+=d.readUint32(e,8)),i})[0]/i})})),n=Math.min.apply(null,i),isFinite(n)?n:0},d.offsetStartDTS=function(n,e,a){d.findBox(e,["moof","traf"]).map(function(i){return d.findBox(i,["tfhd"]).map(function(e){var t=d.readUint32(e,4),s=n[t].timescale||9e4;d.findBox(i,["tfdt"]).map(function(e){var t=e.data[e.start],i=d.readUint32(e,4);if(0===t)d.writeUint32(e,4,i-a*s);else{i*=Math.pow(2,32),i+=d.readUint32(e,8),i-=a*s,i=Math.max(i,0);var n=Math.floor(i/(o+1)),r=Math.floor(i%(o+1));d.writeUint32(e,4,n),d.writeUint32(e,8,r)}})})})},d.prototype.append=function(e,t,i,n){var r=this.initData;r||(this.resetInitSegment(e,this.audioCodec,this.videoCodec),r=this.initData);var s,a=this.initPTS;if(void 0===a){var o=d.getStartDTS(r,e);this.initPTS=a=o-t,this.observer.trigger(ee.a.INIT_PTS_FOUND,{initPTS:a})}d.offsetStartDTS(r,e,a),s=d.getStartDTS(r,e),this.remuxer.remux(r.audio,r.video,null,null,s,i,n,e)},d.prototype.destroy=function(){},d}(),b={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,n,r){if(!(i+24>t.length)){var s=this.parseHeader(t,i);if(s&&i+s.frameLength<=t.length){var a=n+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(i,i+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),e.len+=s.frameLength,{sample:o,length:s.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,n=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3,a=e[t+2]>>1&1;if(1!==i&&0!==r&&15!==r&&3!==s){var o=3===i?3-n:3===n?3:4,l=1e3*b.BitratesMap[14*o+r-1],u=3===i?0:2===i?1:2,c=b.SamplingRateMap[3*u+s],h=e[t+3]>>6==3?1:2,d=b.SamplesCoefficients[i][n],f=b.BytesInSlot[n],p=8*d*f;return{sampleRate:c,channelCount:h,frameLength:parseInt(d*l/c+a,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),n=4;i&&i.frameLength&&(n=i.frameLength);var r=t+n;if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}},T=b,C=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return t.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");n.set(e.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},t.prototype.skipBits=function(e){var t;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},t.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return 32<e&&ie.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?i<<t|this.readBits(t):i},t.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.prototype.readBoolean=function(){return 1===this.readBits(1)},t.prototype.readUByte=function(){return this.readBits(8)},t.prototype.readUShort=function(){return this.readBits(16)},t.prototype.readUInt=function(){return this.readBits(32)},t.prototype.skipScalingList=function(e){var t,i=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(i+this.readEG()+256)%256),i=0===n?i:n},t.prototype.readSPS=function(){var e,t,i,n,r,s,a,o=0,l=0,u=0,c=0,h=this.readUByte.bind(this),d=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),e=h(),d(5),m(3),h(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=f();if(3===E&&m(1),v(),v(),m(1),p())for(s=3!==E?8:12,a=0;a<s;a++)p()&&y(a<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(m(1),g(),g(),t=f(),a=0;a<t;a++)g();v(),m(1),i=f(),n=f(),0===(r=d(1))&&m(1),m(1),p()&&(o=f(),l=f(),u=f(),c=f());var T=[1,1];if(p()&&p())switch(h()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(i+1)-2*o-2*l),height:(2-r)*(n+1)*16-(r?2:4)*(u+c),pixelRatio:T}},t.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),n=function(){function r(e,t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this.decryptdata=i,this.discardEPB=n,this.decrypter=new m.a(e,t)}return r.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},r.prototype.decryptAacSample=function(t,i,n,r){var s=t[i].unit,e=s.subarray(16,s.length-s.length%16),a=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),o=this;this.decryptBuffer(a,function(e){e=new Uint8Array(e),s.set(e,16),r||o.decryptAacSamples(t,i+1,n)})},r.prototype.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,n),!n)return}}},r.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),n=0,r=32;r<=e.length-16;r+=160,n+=16)i.set(e.subarray(r,r+16),n);return i},r.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,n=32;n<=e.length-16;n+=160,i+=16)e.set(t.subarray(i,i+16),n);return e},r.prototype.decryptAvcSample=function(t,i,n,r,s,a){var o=this.discardEPB(s.data),e=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(e.buffer,function(e){s.data=l.getAvcDecryptedUnit(o,e),a||l.decryptAvcSamples(t,i,n+1,r)})},r.prototype.decryptAvcSamples=function(e,t,i,n){for(;;t++,i=0){if(t>=e.length)return void n();for(var r=e[t].units;!(i>=r.length);i++){var s=r[i];if(!(s.length<=48||1!==s.type&&5!==s.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,n,s,a),!a)return}}}},r}(),a={video:0,audio:1,id3:2,text:3},A=function(){function L(e,t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,L),this.observer=e,this.config=i,this.typeSupported=n,this.remuxer=t,this.sampleAes=null}return L.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new n(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},L.probe=function(e){var t=L._syncOffset(e);return!(t<0||(t&&ie.b.warn("MPEG2-TS detected but first sync word found @ offset "+t+", junk ahead ?"),0))},L._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},L.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:a[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},L.prototype.resetInitSegment=function(e,t,i,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=L.createTrack("video",n),this._audioTrack=L.createTrack("audio",n),this._id3Track=L.createTrack("id3",n),this._txtTrack=L.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=i,this._duration=n},L.prototype.resetTimeStamp=function(){},L.prototype.append=function(e,t,i,n){var r,s,a,o,l,u=e.length,c=!1;this.contiguous=i;var h=this.pmtParsed,d=this._avcTrack,f=this._audioTrack,p=this._id3Track,m=d.pid,g=f.pid,v=p.pid,y=this._pmtId,E=d.pesData,b=f.pesData,T=p.pesData,w=this._parsePAT,S=this._parsePMT,_=this._parsePES,C=this._parseAVCPES.bind(this),A=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),k=this._parseID3PES.bind(this),R=L._syncOffset(e);for(u-=(u+R)%188,r=R;r<u;r+=188)if(71===e[r]){if(s=!!(64&e[r+1]),a=((31&e[r+1])<<8)+e[r+2],1<(48&e[r+3])>>4){if((o=r+5+e[r+4])===r+188)continue}else o=r+4;switch(a){case m:s&&(E&&(l=_(E))&&C(l,!1),E={data:[],size:0}),E&&(E.data.push(e.subarray(o,r+188)),E.size+=r+188-o);break;case g:s&&(b&&(l=_(b))&&(f.isAAC?A(l):x(l)),b={data:[],size:0}),b&&(b.data.push(e.subarray(o,r+188)),b.size+=r+188-o);break;case v:s&&(T&&(l=_(T))&&k(l),T={data:[],size:0}),T&&(T.data.push(e.subarray(o,r+188)),T.size+=r+188-o);break;case 0:s&&(o+=e[o]+1),y=this._pmtId=w(e,o);break;case y:s&&(o+=e[o]+1);var N=S(e,o,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(m=N.avc)&&(d.pid=m),0<(g=N.audio)&&(f.pid=g,f.isAAC=N.isAAC),0<(v=N.id3)&&(p.pid=v),c&&!h&&(ie.b.log("reparse from beginning"),c=!1,r=R-188),h=this.pmtParsed=!0;break;case 17:case 8191:break;default:c=!0}}else this.observer.trigger(ee.a.ERROR,{type:te.b.MEDIA_ERROR,details:te.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(l=_(E))?(C(l,!0),d.pesData=null):d.pesData=E,b&&(l=_(b))?(f.isAAC?A(l):x(l),f.pesData=null):(b&&b.size&&ie.b.log("last AAC PES packet truncated,might overlap between fragments"),f.pesData=b),T&&(l=_(T))?(k(l),p.pesData=null):p.pesData=T,null==this.sampleAes?this.remuxer.remux(f,d,p,this._txtTrack,t,i,n):this.decryptAndRemux(f,d,p,this._txtTrack,t,i,n)},L.prototype.decryptAndRemux=function(e,t,i,n,r,s,a){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,i,n,r,s,a)})}else this.decryptAndRemuxAvc(e,t,i,n,r,s,a)},L.prototype.decryptAndRemuxAvc=function(e,t,i,n,r,s,a){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,i,n,r,s,a)})}else this.remuxer.remux(e,t,i,n,r,s,a)},L.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},L.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},L.prototype._parsePMT=function(e,t,i,n){var r,s,a={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<r;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){ie.b.log("unkown stream type:"+e[t]);break}case 15:-1===a.audio&&(a.audio=s);break;case 21:-1===a.id3&&(a.id3=s);break;case 219:if(!n){ie.b.log("unkown stream type:"+e[t]);break}case 27:-1===a.avc&&(a.avc=s);break;case 3:case 4:i?-1===a.audio&&(a.audio=s,a.isAAC=!1):ie.b.log("MPEG audio found, not supported in this browser for now");break;case 36:ie.b.warn("HEVC stream type found, not supported for now");break;default:ie.b.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return a},L.prototype._parsePES=function(e){var t,i,n,r,s,a,o,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(i=t[7])&&(4294967295<(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)&&(a-=8589934592),64&i?(4294967295<(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(o-=8589934592),54e5<a-o&&(ie.b.warn(Math.round((a-o)/9e4)+"s delta between PTS and DTS, align them"),a=o)):o=a),l=(r=t[8])+9,e.size-=l,s=new Uint8Array(e.size);for(var d=0,f=c.length;d<f;d++){var p=(t=c[d]).byteLength;if(l){if(p<l){l-=p;continue}t=t.subarray(l),p-=l,l=0}s.set(t,u),u+=p}return n&&(n-=r+3),{data:s,pts:a,dts:o,len:n}}return null},L.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,n=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,i.push(e)):t.dropped++}e.debug.length&&ie.b.log(e.pts+"/"+e.dts+":"+e.debug)},L.prototype._parseAVCPES=function(p,e){var m,g,v,y=this,E=this._avcTrack,t=this._parseAVCNALu(p.data),b=this.avcSample,T=!1,w=this.pushAccesUnit.bind(this),S=function(e,t,i,n){return{key:e,pts:t,dts:i,units:[],debug:n}};p.data=null,b&&t.length&&!E.audFound&&(w(b,E),b=this.avcSample=S(!1,p.pts,p.dts,"")),t.forEach(function(e){switch(e.type){case 1:g=!0,b||(b=y.avcSample=S(!0,p.pts,p.dts,"")),b.frame=!0;var t=e.data;if(T&&4<t.length){var i=new C(t).readSliceType();2!==i&&4!==i&&7!==i&&9!==i||(b.key=!0)}break;case 5:g=!0,b||(b=y.avcSample=S(!0,p.pts,p.dts,"")),b.key=!0,b.frame=!0;break;case 6:g=!0,(m=new C(y.discardEPB(e.data))).readUByte();for(var n=0,r=0,s=!1,a=0;!s&&1<m.bytesAvailable;){n=0;for(;n+=a=m.readUByte(),255===a;);r=0;for(;r+=a=m.readUByte(),255===a;);if(4===n&&0!==m.bytesAvailable){s=!0;if(181===m.readUByte()&&49===m.readUShort()&&1195456820===m.readUInt()&&3===m.readUByte()){var o=m.readUByte(),l=31&o,u=[o,m.readUByte()];for(v=0;v<l;v++)u.push(m.readUByte()),u.push(m.readUByte()),u.push(m.readUByte());y._insertSampleInOrder(y._txtTrack.samples,{type:3,pts:p.pts,bytes:u})}}else if(r<m.bytesAvailable)for(v=0;v<r;v++)m.readUByte()}break;case 7:if(T=g=!0,!E.sps){var c=(m=new C(e.data)).readSPS();E.width=c.width,E.height=c.height,E.pixelRatio=c.pixelRatio,E.sps=[e.data],E.duration=y._duration;var h=e.data.subarray(1,4),d="avc1.";for(v=0;v<3;v++){var f=h[v].toString(16);f.length<2&&(f="0"+f),d+=f}E.codec=d}break;case 8:g=!0,E.pps||(E.pps=[e.data]);break;case 9:g=!1,E.audFound=!0,b&&w(b,E),b=y.avcSample=S(!1,p.pts,p.dts,"");break;case 12:g=!1;break;default:g=!1,b&&(b.debug+="unknown NAL "+e.type+" ")}b&&g&&b.units.push(e)}),e&&b&&(w(b,E),this.avcSample=null)},L.prototype._insertSampleInOrder=function(e,t){var i=e.length;if(0<i){if(t.pts>=e[i-1].pts)e.push(t);else for(var n=i-1;0<=n;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},L.prototype._getLastNalUnit=function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var i=this._avcTrack.samples;e=i[i.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t},L.prototype._parseAVCNALu=function(e){var t,i,n,r,s=0,a=e.byteLength,o=this._avcTrack,l=o.naluState||0,u=l,c=[],h=-1;for(-1===l&&(r=31&e[h=0],l=0,s=1);s<a;)if(t=e[s++],l)if(1!==l)if(t)if(1===t){if(0<=h)n={data:e.subarray(h,s-l-1),type:r},c.push(n);else{var d=this._getLastNalUnit();if(d&&(u&&s<=4-u&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-u)),0<(i=s-l-1))){var f=new Uint8Array(d.data.byteLength+i);f.set(d.data,0),f.set(e.subarray(0,i),d.data.byteLength),d.data=f}}s<a?(r=31&e[h=s],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(0<=h&&0<=l&&(n={data:e.subarray(h,a),type:r,state:l},c.push(n)),0===c.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+e.byteLength);m.set(p.data,0),m.set(e,p.data.byteLength),p.data=m}}return o.naluState=l,c},L.prototype.discardEPB=function(e){for(var t,i,n=e.byteLength,r=[],s=1;s<n-2;)0===e[s]&&0===e[s+1]&&3===e[s+2]?(r.push(s+2),s+=2):s++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var a=0;for(s=0;s<t;a++,s++)a===r[0]&&(a++,r.shift()),i[s]=e[a];return i},L.prototype._parseAACPES=function(e){var t,i,n,r,s,a=this._audioTrack,o=e.data,l=e.pts,u=this.aacOverFlow,c=this.aacLastPTS;if(u){var h=new Uint8Array(u.byteLength+o.byteLength);h.set(u,0),h.set(o,u.byteLength),o=h}for(n=0,s=o.length;n<s-1&&!g(o,n);n++);if(n){var d,f;if(n<s-1?(d="AAC PES did not start with ADTS header,offset:"+n,f=!1):(d="no ADTS header found in AAC PES",f=!0),ie.b.warn("parsing error:"+d),this.observer.trigger(ee.a.ERROR,{type:te.b.MEDIA_ERROR,details:te.a.FRAG_PARSING_ERROR,fatal:f,reason:d}),f)return}if(v(a,this.observer,o,n,this.audioCodec),i=0,t=y(a.samplerate),u&&c){var p=c+t;1<Math.abs(p-l)&&(ie.b.log("AAC: align PTS for overlapping frames by "+Math.round((p-l)/90)),l=p)}for(;n<s;)if(g(o,n)&&n+5<s){var m=E(a,o,n,l,i);if(!m)break;n+=m.length,r=m.sample.pts,i++}else n++;u=n<s?o.subarray(n,s):null,this.aacOverFlow=u,this.aacLastPTS=r},L.prototype._parseMPEGPES=function(e){for(var t=e.data,i=t.length,n=0,r=0,s=e.pts;r<i;)if(T.isHeader(t,r)){var a=T.appendFrame(this._audioTrack,t,r,s,n);if(!a)break;r+=a.length,n++}else r++},L.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},L}(),x=function(){function n(e,t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.observer=e,this.config=i,this.remuxer=t}return n.prototype.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},n.prototype.resetTimeStamp=function(){},n.probe=function(e){var t,i,n=p.a.getID3Data(e,0);if(n&&void 0!==p.a.getTimeStamp(n))for(t=n.length,i=Math.min(e.length-1,t+100);t<i;t++)if(T.probe(e,t))return ie.b.log("MPEG Audio sync word found !"),!0;return!1},n.prototype.append=function(e,t,i,n){for(var r=p.a.getID3Data(e,0),s=p.a.getTimeStamp(r),a=s?90*s:9e4*t,o=r.length,l=e.length,u=0,c=0,h=this._audioTrack,d=[{pts:a,dts:a,data:r}];o<l;)if(T.isHeader(e,o)){var f=T.appendFrame(h,e,o,a,u);if(!f)break;o+=f.length,c=f.sample.pts,u++}else p.a.isHeader(e,o)?(r=p.a.getID3Data(e,o),d.push({pts:c,dts:c,data:r}),o+=r.length):o++;this.remuxer.remux(h,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},t,i,n)},n.prototype.destroy=function(){},n}(),W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),l=Math.pow(2,32)-1,ne=function(){function d(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d)}return d.init=function(){d.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e;for(e in d.types)d.types.hasOwnProperty(e)&&(d.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);d.HDLR_TYPES={video:t,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);d.STTS=d.STSC=d.STCO=r,d.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),d.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),d.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),d.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);d.FTYP=d.box(d.types.ftyp,s,o,s,a),d.DINF=d.box(d.types.dinf,d.box(d.types.dref,n))},d.box=function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,s=r;r--;)n+=i[r].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),r=0,n=8;r<s;r++)t.set(i[r],n),n+=i[r].byteLength;return t},d.hdlr=function(e){return d.box(d.types.hdlr,d.HDLR_TYPES[e])},d.mdat=function(e){return d.box(d.types.mdat,e)},d.mdhd=function(e,t){t*=e;var i=Math.floor(t/(l+1)),n=Math.floor(t%(l+1));return d.box(d.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},d.mdia=function(e){return d.box(d.types.mdia,d.mdhd(e.timescale,e.duration),d.hdlr(e.type),d.minf(e))},d.mfhd=function(e){return d.box(d.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},d.minf=function(e){return"audio"===e.type?d.box(d.types.minf,d.box(d.types.smhd,d.SMHD),d.DINF,d.stbl(e)):d.box(d.types.minf,d.box(d.types.vmhd,d.VMHD),d.DINF,d.stbl(e))},d.moof=function(e,t,i){return d.box(d.types.moof,d.mfhd(e),d.traf(i,t))},d.moov=function(e){for(var t=e.length,i=[];t--;)i[t]=d.trak(e[t]);return d.box.apply(null,[d.types.moov,d.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(d.mvex(e)))},d.mvex=function(e){for(var t=e.length,i=[];t--;)i[t]=d.trex(e[t]);return d.box.apply(null,[d.types.mvex].concat(i))},d.mvhd=function(e,t){t*=e;var i=Math.floor(t/(l+1)),n=Math.floor(t%(l+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return d.box(d.types.mvhd,r)},d.sdtp=function(e){var t,i,n=e.samples||[],r=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)t=n[i].flags,r[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return d.box(d.types.sdtp,r)},d.stbl=function(e){return d.box(d.types.stbl,d.stsd(e),d.box(d.types.stts,d.STTS),d.box(d.types.stsc,d.STSC),d.box(d.types.stsz,d.STSZ),d.box(d.types.stco,d.STCO))},d.avc1=function(e){var t,i,n,r=[],s=[];for(t=0;t<e.sps.length;t++)n=(i=e.sps[t]).byteLength,r.push(n>>>8&255),r.push(255&n),r=r.concat(Array.prototype.slice.call(i));for(t=0;t<e.pps.length;t++)n=(i=e.pps[t]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(i));var a=d.box(d.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return d.box(d.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,d.box(d.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),d.box(d.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},d.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},d.mp4a=function(e){var t=e.samplerate;return d.box(d.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),d.box(d.types.esds,d.esds(e)))},d.mp3=function(e){var t=e.samplerate;return d.box(d.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},d.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?d.box(d.types.stsd,d.STSD,d.mp4a(e)):d.box(d.types.stsd,d.STSD,d.mp3(e)):d.box(d.types.stsd,d.STSD,d.avc1(e))},d.tkhd=function(e){var t=e.id,i=e.duration*e.timescale,n=e.width,r=e.height,s=Math.floor(i/(l+1)),a=Math.floor(i%(l+1));return d.box(d.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,r>>8&255,255&r,0,0]))},d.traf=function(e,t){var i=d.sdtp(e),n=e.id,r=Math.floor(t/(l+1)),s=Math.floor(t%(l+1));return d.box(d.types.traf,d.box(d.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),d.box(d.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),d.trun(e,i.length+16+20+8+16+8+8),i)},d.trak=function(e){return e.duration=e.duration||4294967295,d.box(d.types.trak,d.tkhd(e),d.mdia(e))},d.trex=function(e){var t=e.id;return d.box(d.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},d.trun=function(e,t){var i,n,r,s,a,o,l=e.samples||[],u=l.length,c=12+16*u,h=new Uint8Array(c);for(t+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),i=0;i<u;i++)r=(n=l[i]).duration,s=n.size,a=n.flags,o=n.cts,h.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,s>>>24&255,s>>>16&255,s>>>8&255,255&s,a.isLeading<<2|a.dependsOn,a.isDependedOn<<6|a.hasRedundancy<<4|a.paddingValue<<1|a.isNonSync,61440&a.degradPrio,15&a.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*i);return d.box(d.types.trun,h)},d.initSegment=function(e){d.types||d.init();var t,i=d.moov(e);return(t=new Uint8Array(d.FTYP.byteLength+i.byteLength)).set(d.FTYP),t.set(i,d.FTYP.byteLength),t},d}(),k=function(){function s(e,t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,s),this.observer=e,this.config=t,this.typeSupported=i;var r=navigator.userAgent;this.isSafari=n&&-1<n.indexOf("Apple")&&r&&!r.match("CriOS"),this.ISGenerated=!1}return s.prototype.destroy=function(){},s.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},s.prototype.resetInitSegment=function(){this.ISGenerated=!1},s.prototype.remux=function(e,t,i,n,r,s,a){if(this.ISGenerated||this.generateIS(e,t,r),this.ISGenerated){var o=e.samples.length,l=t.samples.length,u=r,c=r;if(o&&l){var h=(e.samples[0].dts-t.samples[0].dts)/t.inputTimeScale;u+=Math.max(0,h),c+=Math.max(0,-h)}if(o){e.timescale||(ie.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,r));var d=this.remuxAudio(e,u,s,a);if(l){var f=void 0;d&&(f=d.endPTS-d.startPTS),t.timescale||(ie.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,r)),this.remuxVideo(t,c,s,f,a)}}else{var p=void 0;l&&(p=this.remuxVideo(t,c,s,a)),p&&e.codec&&this.remuxEmptyAudio(e,u,s,p)}}i.samples.length&&this.remuxID3(i,r),n.samples.length&&this.remuxText(n,r),this.observer.trigger(ee.a.FRAG_PARSED)},s.prototype.generateIS=function(e,t,i){var n,r,s=this.observer,a=e.samples,o=t.samples,l=this.typeSupported,u="audio/mp4",c={},h={tracks:c},d=void 0===this._initPTS;if(d&&(n=r=1/0),e.config&&a.length&&(e.timescale=e.samplerate,ie.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(u="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:ne.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(n=r=a[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&o.length){var f=t.inputTimeScale;t.timescale=f,c.video={container:"video/mp4",codec:t.codec,initSegment:ne.initSegment([t]),metadata:{width:t.width,height:t.height}},d&&(n=Math.min(n,o[0].pts-f*i),r=Math.min(r,o[0].dts-f*i),this.observer.trigger(ee.a.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(c).length?(s.trigger(ee.a.FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,d&&(this._initPTS=n,this._initDTS=r)):s.trigger(ee.a.ERROR,{type:te.b.MEDIA_ERROR,details:te.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},s.prototype.remuxVideo=function(e,t,i,n,r){var s,a,o,l,u,c,h,d=8,f=e.timescale,p=e.samples,m=[],g=p.length,v=this._PTSNormalize,y=this._initDTS,E=this.nextAvcDts,b=this.isSafari;b&&(i|=p.length&&E&&(r&&Math.abs(t-E/f)<.1||Math.abs(p[0].pts-E-y)<f/5)),i||(E=t*f),p.forEach(function(e){e.pts=v(e.pts-y,E),e.dts=v(e.dts-y,E)}),p.sort(function(e,t){var i=e.dts-t.dts,n=e.pts-t.pts;return i||n||e.id-t.id});var T=p.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(T<0){ie.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(T/90)+" ms to overcome this issue");for(var w=0;w<p.length;w++)p[w].dts+=T}var S=p[0];u=Math.max(S.dts,0),l=Math.max(S.pts,0);var _=Math.round((u-E)/90);i&&_&&(1<_?ie.b.log("AVC:"+_+" ms hole between fragments detected,filling it"):_<-1&&ie.b.log("AVC:"+-_+" ms overlapping between fragments detected"),u=E,p[0].dts=u,l=Math.max(l-_,E),p[0].pts=l,ie.b.log("Video/PTS/DTS adjusted: "+Math.round(l/90)+"/"+Math.round(u/90)+",delta:"+_+" ms")),S=p[p.length-1],h=Math.max(S.dts,0),c=Math.max(S.pts,0,h),b&&(s=Math.round((h-u)/(p.length-1)));for(var C=0,A=0,x=0;x<g;x++){for(var k=p[x],R=k.units,N=R.length,L=0,D=0;D<N;D++)L+=R[D].data.length;A+=L,C+=N,k.length=L,k.dts=b?u+x*s:Math.max(k.dts,u),k.pts=Math.max(k.pts,k.dts)}var M=A+4*C+8;try{a=new Uint8Array(M)}catch(e){return void this.observer.trigger(ee.a.ERROR,{type:te.b.MUX_ERROR,details:te.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var O=new DataView(a.buffer);O.setUint32(0,M),a.set(ne.types.mdat,4);for(var P=0;P<g;P++){for(var I=p[P],F=I.units,B=0,U=void 0,V=0,H=F.length;V<H;V++){var j=F[V],G=j.data,q=j.data.byteLength;O.setUint32(d,q),d+=4,a.set(G,d),d+=q,B+=4+q}if(b)U=Math.max(0,s*Math.round((I.pts-I.dts)/s));else{if(P<g-1)s=p[P+1].dts-I.dts;else{var W=this.config,z=I.dts-p[0<P?P-1:P].dts;if(W.stretchShortVideoTrack){var Y=W.maxBufferHole,K=W.maxSeekHole,X=Math.floor(Math.min(Y,K)*f),Q=(n?l+n*f:this.nextAudioPts)-I.pts;X<Q?((s=Q-z)<0&&(s=z),ie.b.log("It is approximately "+Q/90+" ms to the next segment; using duration "+s/90+" ms for the last video frame.")):s=z}else s=z}U=Math.round(I.pts-I.dts)}m.push({size:B,duration:s,cts:U,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:I.key?2:1,isNonSync:I.key?0:1}})}this.nextAvcDts=h+s;var J=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,m.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var $=m[0].flags;$.dependsOn=2,$.isNonSync=0}e.samples=m,o=ne.moof(e.sequenceNumber++,u,e),e.samples=[];var Z={data1:o,data2:a,startPTS:l/f,endPTS:(c+s)/f,startDTS:u/f,endDTS:this.nextAvcDts/f,type:"video",nb:m.length,dropped:J};return this.observer.trigger(ee.a.FRAG_PARSING_DATA,Z),Z},s.prototype.remuxAudio=function(e,t,i,n){var r,s,a,o,l,u,c,h=e.inputTimeScale,d=e.timescale,f=h/d,p=(e.isAAC?1024:1152)*f,m=this._PTSNormalize,g=this._initDTS,v=!e.isAAC&&this.typeSupported.mpeg,y=e.samples,E=[],b=this.nextAudioPts;if(i|=y.length&&b&&(n&&Math.abs(t-b/h)<.1||Math.abs(y[0].pts-b-g)<20*p),y.forEach(function(e){e.pts=e.dts=m(e.pts-g,t*h)}),0!==(y=y.filter(function(e){return 0<=e.pts})).length){if(i||(b=n?t*h:y[0].pts),e.isAAC)for(var T=this.config.maxAudioFramesDrift,w=0,S=b;w<y.length;){var _,C=y[w];_=C.pts-S;var A=Math.abs(1e3*_/h);if(_<=-T*p)ie.b.warn("Dropping 1 audio frame @ "+(S/h).toFixed(3)+"s due to "+Math.round(A)+" ms overlap."),y.splice(w,1),e.len-=C.unit.length;else if(T*p<=_&&A<1e4&&S){var x=Math.round(_/p);ie.b.warn("Injecting "+x+" audio frame @ "+(S/h).toFixed(3)+"s due to "+Math.round(1e3*_/h)+" ms gap.");for(var k=0;k<x;k++){var R=Math.max(S,0);(a=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(ie.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=C.unit.subarray()),y.splice(w,0,{unit:a,pts:R,dts:R}),e.len+=a.length,S+=p,w++}C.pts=C.dts=S,S+=p,w++}else Math.abs(_),C.pts=C.dts=S,S+=p,w++}for(var N=0,L=y.length;N<L;N++){var D=y[N],M=D.unit,O=D.pts;if(void 0!==c)s.duration=Math.round((O-c)/f);else{var P=Math.round(1e3*(O-b)/h),I=0;if(i&&e.isAAC&&P){if(0<P&&P<1e4)I=Math.round((O-b)/p),ie.b.log(P+" ms hole between AAC samples detected,filling it"),0<I&&((a=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(a=M.subarray()),e.len+=I*a.length);else if(P<-12){ie.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(b/h).toFixed(3)+"s/"+(O/h).toFixed(3)+"s/"+-P+"ms"),e.len-=M.byteLength;continue}O=b}if(u=O,!(0<e.len))return;var F=v?e.len:e.len+8;r=v?0:8;try{o=new Uint8Array(F)}catch(e){return void this.observer.trigger(ee.a.ERROR,{type:te.b.MUX_ERROR,details:te.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating audio mdat "+F})}v||(new DataView(o.buffer).setUint32(0,F),o.set(ne.types.mdat,4));for(var B=0;B<I;B++)(a=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(ie.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=M.subarray()),o.set(a,r),r+=a.byteLength,s={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(s)}o.set(M,r);var U=M.byteLength;r+=U,s={size:U,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(s),c=O}var V=0,H=E.length;if(2<=H&&(V=E[H-2].duration,s.duration=V),H){this.nextAudioPts=b=c+f*V,e.len=0,e.samples=E,l=v?new Uint8Array:ne.moof(e.sequenceNumber++,u/f,e),e.samples=[];var j=u/h,G=b/h,q={data1:l,data2:o,startPTS:j,endPTS:G,startDTS:j,endDTS:G,type:"audio",nb:H};return this.observer.trigger(ee.a.FRAG_PARSING_DATA,q),q}return null}},s.prototype.remuxEmptyAudio=function(e,t,i,n){var r=e.inputTimeScale,s=r/(e.samplerate?e.samplerate:r),a=this.nextAudioPts,o=(void 0!==a?a:n.startDTS*r)+this._initDTS,l=n.endDTS*r+this._initDTS,u=1024*s,c=Math.ceil((l-o)/u),h=W.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(ie.b.warn("remux empty Audio"),h){for(var d=[],f=0;f<c;f++){var p=o+f*u;d.push({unit:h,pts:p,dts:p}),e.len+=h.length}e.samples=d,this.remuxAudio(e,t,i)}else ie.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},s.prototype.remuxID3=function(e,t){var i,n=e.samples.length,r=e.inputTimeScale,s=this._initPTS,a=this._initDTS;if(n){for(var o=0;o<n;o++)(i=e.samples[o]).pts=(i.pts-s)/r,i.dts=(i.dts-a)/r;this.observer.trigger(ee.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t},s.prototype.remuxText=function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var i,n=e.samples.length,r=e.inputTimeScale,s=this._initPTS;if(n){for(var a=0;a<n;a++)(i=e.samples[a]).pts=(i.pts-s)/r;this.observer.trigger(ee.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t},s.prototype._PTSNormalize=function(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=i;return e},s}(),R=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.observer=e}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(){},t.prototype.resetInitSegment=function(){},t.prototype.remux=function(e,t,i,n,r,s,a,o){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(ee.a.FRAG_PARSING_DATA,{data1:o,startPTS:r,startDTS:r,type:u,nb:1,dropped:0}),l.trigger(ee.a.FRAG_PARSED)},t}(),u=function(){function r(e,t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this.observer=e,this.typeSupported=t,this.config=i,this.vendor=n}return r.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},r.prototype.push=function(e,i,n,r,s,a,o,l,u,c,h,d){if(0<e.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var t=this.decrypter;null==t&&(t=this.decrypter=new m.a(this.observer,this.config));var f,p=this;try{f=performance.now()}catch(e){f=Date.now()}t.decrypt(e,i.key.buffer,i.iv.buffer,function(e){var t;try{t=performance.now()}catch(e){t=Date.now()}p.observer.trigger(ee.a.FRAG_DECRYPTED,{stats:{tstart:f,tdecrypt:t}}),p.pushDecrypted(new Uint8Array(e),i,new Uint8Array(n),r,s,a,o,l,u,c,h,d)})}else this.pushDecrypted(new Uint8Array(e),i,new Uint8Array(n),r,s,a,o,l,u,c,h,d)},r.prototype.pushDecrypted=function(e,t,i,n,r,s,a,o,l,u,c,h){var d=this.demuxer;if(!d||a&&!this.probe(e)){for(var f=this.observer,p=this.typeSupported,m=this.config,g=[{demux:A,remux:k},{demux:_,remux:R},{demux:S,remux:k},{demux:x,remux:k}],v=0,y=g.length;v<y;v++){var E=g[v],b=E.demux.probe;if(b(e)){var T=this.remuxer=new E.remux(f,m,p,this.vendor);d=new E.demux(f,T,m,p),this.probe=b;break}}if(!d)return void f.trigger(ee.a.ERROR,{type:te.b.MEDIA_ERROR,details:te.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=d}var w=this.remuxer;(a||o)&&(d.resetInitSegment(i,n,r,u),w.resetInitSegment()),a&&(d.resetTimeStamp(h),w.resetTimeStamp(h)),"function"==typeof d.setDecryptData&&d.setDecryptData(t),d.append(e,s,l,c)},r}();t.a=u},function(e,t,i){"use strict";function c(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)return null;for(var i=null,n=0;n<e.length;n++){var r=e[n];r.id===t&&(i=r)}return i}function s(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}function f(e,t,i){var n=e[t],r=e[i],s=r.startPTS;isNaN(s)?r.start=t<i?n.start+n.duration:Math.max(n.start-r.duration,0):t<i?(n.duration=s-n.start,n.duration<0&&F.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-s,r.duration<0&&F.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}function p(e,t,i,n,r,s){var a=i;if(!isNaN(t.startPTS)){var o=Math.abs(t.startPTS-i);isNaN(t.deltaPTS)?t.deltaPTS=o:t.deltaPTS=Math.max(o,t.deltaPTS),a=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),n=Math.max(n,t.endPTS),r=Math.min(r,t.startDTS),s=Math.max(s,t.endDTS)}var l=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=a,t.endPTS=n,t.startDTS=r,t.endDTS=s,t.duration=n-i;var u,c,h,d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;for(u=d-e.startSN,(c=e.fragments)[u]=t,h=u;0<h;h--)f(c,h,h-1);for(h=u;h<c.length-1;h++)f(c,h,h+1);return e.PTSKnown=!0,l}function u(e,t){var i,n=Math.max(e.startSN,t.startSN)-t.startSN,r=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,a=e.fragments,o=t.fragments,l=0;if(r<n)t.PTSKnown=!1;else{for(var u=n;u<=r;u++){var c=a[s+u],h=o[u];h&&c&&(l=c.cc-h.cc,isNaN(c.startPTS)||(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,h.backtracked=c.backtracked,h.dropped=c.dropped,i=h))}if(l)for(F.b.log("discontinuity sliding from playlist, take drift into account"),u=0;u<o.length;u++)o[u].cc+=l;if(i)p(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else if(0<=s&&s<a.length){var d=a[s].start;for(u=0;u<o.length;u++)o[u].start+=d}t.PTSKnown=e.PTSKnown}}function d(i,e){e.fragments.forEach(function(e){if(e){var t=e.start+i;e.start=e.startPTS=t,e.endPTS=t+e.duration}}),e.PTSKnown=!0}function m(e,t,i){if(r=e,a=i,o=!1,(s=t)&&s.details&&a&&(a.endCC>a.startCC||r&&r.cc<a.startCC)&&(o=!0),o){var n=function(e,t){var i=e.fragments,n=t.fragments;if(n.length&&i.length){var r=function(e,t){for(var i=null,n=0;n<e.length;n+=1){var r=e[n];if(r&&r.cc===t){i=r;break}}return i}(i,n[0].cc);return!r||r&&!r.startPTS?void F.b.log("No frag in previous level to align on"):r}F.b.log("No fragments to align")}(t.details,i);n&&(F.b.log("Adjusting PTS using last level due to CC increase within current level"),d(n.start,i))}var r,s,a,o;if(!1===i.PTSKnown&&t&&t.details){var l=t.details.programDateTime,u=(i.programDateTime-l)/1e3+t.details.fragments[0].start;isNaN(u)||(F.b.log("adjusting PTS using programDateTime delta, sliding:"+u.toFixed(3)),d(u,i))}}function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new We,this.regionList=[]}function o(){this.values=Object.create(null)}function l(e,t,i,n){var r=n?e.split(n):[e];for(var s in r)if("string"==typeof r[s]){var a=r[s].split(i);if(2===a.length){t(a[0],a[1])}}}function g(t,e,a){function i(){var e=function(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(t);if(null===e)throw new Error("Malformed timestamp: "+r);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function n(){t=t.replace(/^\s+/,"")}var r=t;if(n(),e.startTime=i(),n(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);t=t.substr(3),n(),e.endTime=i(),n(),function(e,t){var s=new o;l(e,function(e,t){switch(e){case"region":for(var i=a.length-1;0<=i;i--)if(a[i].id===t){s.set(e,a[i].region);break}break;case"vertical":s.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),r=n[0];s.integer(e,r),s.percent(e,r)&&s.set("snapToLines",!1),s.alt(e,r,["auto"]),2===n.length&&s.alt("lineAlign",n[1],["start",Ye,"end"]);break;case"position":n=t.split(","),s.percent(e,n[0]),2===n.length&&s.alt("positionAlign",n[1],["start",Ye,"end","line-left","line-right","auto"]);break;case"size":s.percent(e,t);break;case"align":s.alt(e,t,["start",Ye,"end","left","right"])}},/:/,/\s/),t.region=s.get("region",null),t.vertical=s.get("vertical","");var i=s.get("line","auto");"auto"===i&&-1===ze.line&&(i=-1),t.line=i,t.lineAlign=s.get("lineAlign","start"),t.snapToLines=s.get("snapToLines",!0),t.size=s.get("size",100),t.align=s.get("align",Ye);var n=s.get("position","auto");"auto"===n&&50===ze.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(t,e)}function v(e){return e.replace(/<br(?: \/)?>/gi,"\n")}function a(e,t,i,n){for(var r,s,a,o,l,u=window.VTTCue||window.TextTrackCue,c=0;c<n.rows.length;c++)if(a=!0,o=0,l="",!(r=n.rows[c]).isEmpty()){for(var h=0;h<r.chars.length;h++)r.chars[h].uchar.match(/\s/)&&a?o++:(l+=r.chars[h].uchar,a=!1);(r.cueStartTime=t)===i&&(i+=1e-4),s=new u(t,i,v(l.trim())),16<=o?o--:o++,navigator.userAgent.match(/Firefox\//)?s.line=c+1:s.line=7<c?c-2:c+1,s.align="left",s.position=Math.max(0,Math.min(100,o/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(s)}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e){if(e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}function b(e){for(var t=[],i=0;i<e.length;i++)"subtitles"===e[i].kind&&t.push(e[i]);return t}Object.defineProperty(t,"__esModule",{value:!0});var T={};i.d(T,"newCue",function(){return a});var w=i(6),S=i.n(w),P=i(1),I=i(2),F=i(0),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C=function(){function r(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}return r.prototype.destroy=function(){this.unregisterListeners()},r.prototype.isEventHandler=function(){return"object"===_(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},r.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)},this)},r.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},r.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},r.prototype.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){F.b.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(P.a.ERROR,{type:I.b.OTHER_ERROR,details:I.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},r}(),A=/^(\d+)x(\d+)$/,x=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,k=function(){function i(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),"string"==typeof e&&(e=i.parseAttrList(e));for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}return i.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},i.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null},i.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},i.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},i.prototype.enumeratedString=function(e){return this[e]},i.prototype.decimalResolution=function(e){var t=A.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},i.parseAttrList=function(e){var t,i={};for(x.lastIndex=0;null!==(t=x.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i},i}(),R={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},N=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),L=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,D=/#EXT-X-MEDIA:(.*)/g,M=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),O=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,B=function(){function e(){r(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return N(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=S.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),U=function(){function e(){r(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return e.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},e.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new B).method=e.method,i.baseuri=e.baseuri,i.reluri=e.reluri,i.iv=this.createInitializationVector(t)),i},e.prototype.cloneObj=function(e){return JSON.parse(JSON.stringify(e))},N(e,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=S.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var i=this.lastByteRangeEndOffset;e[0]=i||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),V=function(i){function n(e){r(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MANIFEST_LOADING,P.a.LEVEL_LOADING,P.a.AUDIO_TRACK_LOADING,P.a.SUBTITLE_TRACK_LOADING));return t.loaders={},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},C.prototype.destroy.call(this)},n.prototype.onManifestLoading=function(e){this.load(e.url,{type:"manifest"})},n.prototype.onLevelLoading=function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})},n.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:"audioTrack",id:e.id})},n.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})},n.prototype.load=function(e,t){var i=this.loaders[t.type];if(void 0!==i){var n=i.context;if(n&&n.url===e)return void F.b.trace("playlist request ongoing");F.b.warn("abort previous loader for type:"+t.type),i.abort()}var r=this.hls.config,s=void 0,a=void 0,o=void 0,l=void 0;"manifest"===t.type?(s=r.manifestLoadingMaxRetry,a=r.manifestLoadingTimeOut,o=r.manifestLoadingRetryDelay,l=r.manifestLoadingMaxRetryTimeout):"level"===t.type?(s=0,a=r.levelLoadingTimeOut):(s=r.levelLoadingMaxRetry,a=r.levelLoadingTimeOut,o=r.levelLoadingRetryDelay,l=r.levelLoadingMaxRetryTimeout,F.b.log("loading playlist for "+t.type+" "+(t.level||t.id))),i=this.loaders[t.type]=t.loader=void 0!==r.pLoader?new r.pLoader(r):new r.loader(r),t.url=e,t.responseType="";var u,c;u={timeout:a,maxRetry:s,retryDelay:o,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},i.load(t,u,c)},n.prototype.resolve=function(e,t){return S.a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},n.prototype.parseMasterPlaylist=function(e,t){var i=[],n=void 0;for(L.lastIndex=0;null!=(n=L.exec(e));){var r={},s=r.attrs=new k(n[1]);r.url=this.resolve(n[2],t);var a=s.decimalResolution("RESOLUTION");a&&(r.width=a.width,r.height=a.height),r.bitrate=s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),r.name=s.NAME,function(i,r){["video","audio"].forEach(function(n){var t=i.filter(function(e){return t=e,!!(i=R[n])&&!0===i[t.slice(0,4)];var t,i});if(t.length){var e=t.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});r[n+"Codec"]=0<e.length?e[0]:t[0],i=i.filter(function(e){return-1===t.indexOf(e)})}}),r.unknownCodecs=i}([].concat((s.CODECS||"").split(/[ ,]+/)),r),r.videoCodec&&-1!==r.videoCodec.indexOf("avc1")&&(r.videoCodec=this.avc1toavcoti(r.videoCodec)),i.push(r)}return i},n.prototype.parseMasterPlaylistMedia=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],r=void 0,s=[],a=0;for(D.lastIndex=0;null!==(r=D.exec(e));){var o={},l=new k(r[1]);if(l.TYPE===i){if(o.groupId=l["GROUP-ID"],o.name=l.NAME,o.type=i,o["default"]="YES"===l.DEFAULT,o.autoselect="YES"===l.AUTOSELECT,o.forced="YES"===l.FORCED,l.URI&&(o.url=this.resolve(l.URI,t)),o.lang=l.LANGUAGE,o.name||(o.name=o.lang),n.length){var u=h(n,o.groupId);o.audioCodec=u?u.codec:n[0].codec}o.id=a++,s.push(o)}}return s},n.prototype.avc1toavcoti=function(e){var t,i=e.split(".");return 2<i.length?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},n.prototype.parseLevelPlaylist=function(e,t,i,n){var r,s,a=0,o=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},u=new B,c=0,h=null,d=new U;for(M.lastIndex=0;null!==(r=M.exec(e));){var f=r[1];if(f){d.duration=parseFloat(f);var p=(" "+r[2]).slice(1);d.title=p||null,d.tagList.push(p?["INF",f,p]:["INF",f])}else if(r[3]){if(!isNaN(d.duration)){var m=a++;d.type=n,d.start=o,d.levelkey=u,d.sn=m,d.level=i,d.cc=c,d.baseurl=t,d.relurl=(" "+r[3]).slice(1),l.fragments.push(d),o+=(h=d).duration,d=new U}}else if(r[4]){if(d.rawByteRange=(" "+r[4]).slice(1),h){var g=h.byteRangeEndOffset;g&&(d.lastByteRangeEndOffset=g)}}else if(r[5])d.rawProgramDateTime=(" "+r[5]).slice(1),d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]),void 0===l.programDateTime&&(l.programDateTime=new Date(new Date(Date.parse(r[5]))-1e3*o));else{for(r=r[0].match(O),s=1;s<r.length&&void 0===r[s];s++);var v=(" "+r[s+1]).slice(1),y=(" "+r[s+2]).slice(1);switch(r[s]){case"#":d.tagList.push(y?[v,y]:[v]);break;case"PLAYLIST-TYPE":l.type=v.toUpperCase();break;case"MEDIA-SEQUENCE":a=l.startSN=parseInt(v);break;case"TARGETDURATION":l.targetduration=parseFloat(v);break;case"VERSION":l.version=parseInt(v);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":c++,d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(v);break;case"KEY":var E=new k(v),b=E.enumeratedString("METHOD"),T=E.URI,w=E.hexadecimalInteger("IV");b&&(u=new B,T&&0<=["AES-128","SAMPLE-AES"].indexOf(b)&&(u.method=b,u.baseuri=t,u.reluri=T,u.key=null,u.iv=w));break;case"START":var S=new k(v).decimalFloatingPoint("TIME-OFFSET");isNaN(S)||(l.startTimeOffset=S);break;case"MAP":var _=new k(v);d.relurl=_.URI,d.rawByteRange=_.BYTERANGE,d.baseurl=t,d.level=i,d.type=n,d.sn="initSegment",l.initSegment=d,d=new U;break;default:F.b.warn("line parsed but not handled: "+r)}}}return(d=h)&&!d.relurl&&(l.fragments.pop(),o-=d.duration),l.totalduration=o,l.averagetargetduration=o/l.fragments.length,l.endSN=a-1,l.startCC=l.fragments[0]?l.fragments[0].cc:0,l.endCC=c,l},n.prototype.loadsuccess=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=e.data,s=e.url,a=i.type,o=i.id,l=i.level,u=this.hls;if((this.loaders[a]=void 0)!==s&&0!==s.indexOf("data:")||(s=i.url),t.tload=performance.now(),0===r.indexOf("#EXTM3U"))if(0<r.indexOf("#EXTINF:")){var c="audioTrack"!==a&&"subtitleTrack"!==a,h=isNaN(l)?isNaN(o)?0:o:l,d=this.parseLevelPlaylist(r,s,h,"audioTrack"===a?"audio":"subtitleTrack"===a?"subtitle":"main");d.tload=t.tload,"manifest"===a&&u.trigger(P.a.MANIFEST_LOADED,{levels:[{url:s,details:d}],audioTracks:[],url:s,stats:t,networkDetails:n}),t.tparsed=performance.now(),d.targetduration?c?u.trigger(P.a.LEVEL_LOADED,{details:d,level:l||0,id:o||0,stats:t,networkDetails:n}):"audioTrack"===a?u.trigger(P.a.AUDIO_TRACK_LOADED,{details:d,id:o,stats:t,networkDetails:n}):"subtitleTrack"===a&&u.trigger(P.a.SUBTITLE_TRACK_LOADED,{details:d,id:o,stats:t,networkDetails:n}):u.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"invalid targetduration",networkDetails:n})}else{var f=this.parseMasterPlaylist(r,s);if(f.length){var p=f.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),m=this.parseMasterPlaylistMedia(r,s,"AUDIO",p),g=this.parseMasterPlaylistMedia(r,s,"SUBTITLES");if(m.length){var v=!1;m.forEach(function(e){e.url||(v=!0)}),!1===v&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(F.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main"}))}u.trigger(P.a.MANIFEST_LOADED,{levels:f,audioTracks:m,subtitles:g,url:s,stats:t,networkDetails:n})}else u.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"no level found in manifest",networkDetails:n})}else u.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.MANIFEST_PARSING_ERROR,fatal:!0,url:s,reason:"no EXTM3U delimiter",networkDetails:n})},n.prototype.loaderror=function(e,t){var i,n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=t.loader;switch(t.type){case"manifest":i=I.a.MANIFEST_LOAD_ERROR,n=!0;break;case"level":i=I.a.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":i=I.a.AUDIO_TRACK_LOAD_ERROR,n=!1}s&&(s.abort(),this.loaders[t.type]=void 0),this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:i,fatal:n,url:s.url,loader:s,response:e,context:t,networkDetails:r})},n.prototype.loadtimeout=function(e,t){var i,n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=t.loader;switch(t.type){case"manifest":i=I.a.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":i=I.a.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":i=I.a.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}s&&(s.abort(),this.loaders[t.type]=void 0),this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:i,fatal:n,url:s.url,loader:s,context:t,networkDetails:r})},n}(C),H=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.FRAG_LOADING));return t.loaders={},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){var e=this.loaders;for(var t in e){var i=e[t];i&&i.destroy()}this.loaders={},C.prototype.destroy.call(this)},n.prototype.onFragLoading=function(e){var t=e.frag,i=t.type,n=this.loaders[i],r=this.hls.config;t.loaded=0,n&&(F.b.warn("abort previous fragment loader for type:"+i),n.abort()),n=this.loaders[i]=t.loader=void 0!==r.fLoader?new r.fLoader(r):new r.loader(r);var s,a,o=void 0;o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,u=t.byteRangeEndOffset;isNaN(l)||isNaN(u)||(o.rangeStart=l,o.rangeEnd=u),s={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(o,s,a)},n.prototype.loadsuccess=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=e.data,s=i.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(P.a.FRAG_LOADED,{payload:r,frag:s,stats:t,networkDetails:n})},n.prototype.loaderror=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},n.prototype.loadtimeout=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},n.prototype.loadprogress=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=t.frag;r.loaded=e.loaded,this.hls.trigger(P.a.FRAG_LOAD_PROGRESS,{frag:r,stats:e,networkDetails:n})},n}(C),j=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.KEY_LOADING));return t.loaders={},t.decryptkey=null,t.decrypturl=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},C.prototype.destroy.call(this)},n.prototype.onKeyLoading=function(e){var t=e.frag,i=t.type,n=this.loaders[i],r=t.decryptdata,s=r.uri;if(s!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;n&&(F.b.warn("abort previous key loader for type:"+i),n.abort()),t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=s,this.decryptkey=null;var o,l,u;o={url:s,frag:t,responseType:"arraybuffer"},l={timeout:a.fragLoadingTimeOut,maxRetry:a.fragLoadingMaxRetry,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(o,l,u)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(P.a.KEY_LOADED,{frag:t}))},n.prototype.loadsuccess=function(e,t,i){var n=i.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(P.a.KEY_LOADED,{frag:n})},n.prototype.loaderror=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},n.prototype.loadtimeout=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(P.a.ERROR,{type:I.b.NETWORK_ERROR,details:I.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},n}(C),G={search:function(e,t){for(var i=0,n=e.length-1,r=null,s=null;i<=n;){var a=t(s=e[r=(i+n)/2|0]);if(0<a)i=r+1;else{if(!(a<0))return s;n=r-1}}return null}},q={isBuffered:function(e,t){try{if(e)for(var i=e.buffered,n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0}catch(e){}return!1},bufferInfo:function(e,t,i){try{if(e){var n,r=e.buffered,s=[];for(n=0;n<r.length;n++)s.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(s,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,i){var n,r,s,a,o,l=[];for(e.sort(function(e,t){return e.start-t.start||t.end-e.end}),o=0;o<e.length;o++){var u=l.length;if(u){var c=l[u-1].end;e[o].start-c<i?e[o].end>c&&(l[u-1].end=e[o].end):l.push(e[o])}else l.push(e[o])}for(n=o=0,r=s=t;o<l.length;o++){var h=l[o].start,d=l[o].end;if(h<=t+i&&t<d)r=h,n=(s=d)-t;else if(t+i<h){a=h;break}}return{len:n,start:r,end:s,nextStart:a}}},W=i(7),z=i(5),Y=i.n(z),K=i(9),X=i.n(K),Q=s(),J=function(){function l(i,e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,l),this.hls=i,this.id=e;var r=this.observer=new Y.a,t=i.config;r.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))};var n=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,i.trigger(e,t)}.bind(this);r.on(P.a.FRAG_DECRYPTED,n),r.on(P.a.FRAG_PARSING_INIT_SEGMENT,n),r.on(P.a.FRAG_PARSING_DATA,n),r.on(P.a.FRAG_PARSED,n),r.on(P.a.ERROR,n),r.on(P.a.FRAG_PARSING_METADATA,n),r.on(P.a.FRAG_PARSING_USERDATA,n),r.on(P.a.INIT_PTS_FOUND,n);var s={mp4:Q.isTypeSupported("video/mp4"),mpeg:Q.isTypeSupported("audio/mpeg"),mp3:Q.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(t.enableWorker&&"undefined"!=typeof Worker){F.b.log("demuxing in webworker");var o=void 0;try{o=this.w=X()(10),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(e){i.trigger(P.a.ERROR,{type:I.b.OTHER_ERROR,details:I.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:s,vendor:a,id:e,config:JSON.stringify(t)})}catch(l){F.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&URL.revokeObjectURL(o.objectURL),this.demuxer=new W.a(r,s,t,a),this.w=void 0}}else this.demuxer=new W.a(r,s,t,a)}return l.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},l.prototype.push=function(e,t,i,n,r,s,a,o){var l=this.w,u=isNaN(r.startDTS)?r.start:r.startDTS,c=r.decryptdata,h=this.frag,d=!(h&&r.cc===h.cc),f=!(h&&r.level===h.level),p=h&&r.sn===h.sn+1,m=!f&&p;if(d&&F.b.log(this.id+":discontinuity detected"),f&&F.b.log(this.id+":switch detected"),this.frag=r,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:i,videoCodec:n,timeOffset:u,discontinuity:d,trackSwitch:f,contiguous:m,duration:s,accurateTimeOffset:a,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var g=this.demuxer;g&&g.push(e,c,t,i,n,u,d,f,m,s,a,o)}},l.prototype.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case P.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},l}(),$={toString:function(e){for(var t="",i=e.length,n=0;n<i;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}},Z=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),ee="STOPPED",te="IDLE",ie="KEY_LOADING",ne="FRAG_LOADING",re="FRAG_LOADING_WAITING_RETRY",se="WAITING_LEVEL",ae="PARSING",oe="PARSED",le="BUFFER_FLUSHING",ue="ENDED",ce="ERROR",he=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHED,P.a.MEDIA_DETACHING,P.a.MANIFEST_LOADING,P.a.MANIFEST_PARSED,P.a.LEVEL_LOADED,P.a.KEY_LOADED,P.a.FRAG_LOADED,P.a.FRAG_LOAD_EMERGENCY_ABORTED,P.a.FRAG_PARSING_INIT_SEGMENT,P.a.FRAG_PARSING_DATA,P.a.FRAG_PARSED,P.a.ERROR,P.a.AUDIO_TRACK_SWITCHING,P.a.AUDIO_TRACK_SWITCHED,P.a.BUFFER_CREATED,P.a.BUFFER_APPENDED,P.a.BUFFER_FLUSHED));return t.config=e.config,t.audioCodecSwap=!1,t.ticks=0,t._state=ee,t.ontick=t.tick.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),C.prototype.destroy.call(this),this.state=ee},n.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}0<t&&-1===e&&(F.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=te,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=ee},n.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ee,this.forceStartLoad=!1},n.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},n.prototype.doTick=function(){switch(this.state){case ce:break;case le:this.fragLoadError=0;break;case te:this._doTickIdle();break;case se:var e=this.levels[this.level];e&&e.details&&(this.state=te);break;case re:var t=performance.now(),i=this.retryDate;(!i||i<=t||this.media&&this.media.seeking)&&(F.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=te)}this._checkBuffer(),this._checkFragmentChanged()},n.prototype._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var n;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,s=this.levels[r];if(s){var a=s.bitrate,o=void 0;o=a?Math.max(8*t.maxBufferSize/a,t.maxBufferLength):t.maxBufferLength,o=Math.min(o,t.maxMaxBufferLength);var l=q.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,t.maxBufferHole),u=l.len;if(!(o<=u)){F.b.trace("buffer length of "+u.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var c=s.details;if(void 0===c||!0===c.live&&this.levelLastLoaded!==r)return void(this.state=se);var h=this.fragPrevious;if(!c.live&&h&&!h.backtracked&&h.sn===c.endSN&&!l.nextStart&&Math.min(i.duration,h.start+h.duration)-Math.max(l.end,h.start)<=Math.max(.2,h.duration)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(P.a.BUFFER_EOS,d),void(this.state=ue)}this._fetchPayloadOrEos(n,l,c)}}}},n.prototype._fetchPayloadOrEos=function(e,t,i){var n=this.fragPrevious,r=this.level,s=i.fragments,a=s.length;if(0!==a){var o=s[0].start,l=s[a-1].start+s[a-1].duration,u=t.end,c=void 0;if(i.initSegment&&!i.initSegment.data)c=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(a<h)return void F.b.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+h);if(null===(c=this._ensureFragmentAtLivePoint(i,u,o,l,n,s,a)))return}else u<o&&(c=s[0]);c||(c=this._findFragment(o,n,a,s,u,l,i)),c&&this._loadFragmentOrKey(c,r,i,e,u)}},n.prototype._ensureFragmentAtLivePoint=function(e,t,i,n,r,s,a){var o=this.hls.config,l=this.media,u=void 0,c=void 0!==o.liveMaxLatencyDuration?o.liveMaxLatencyDuration:o.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-o.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);F.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&n<t&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(r){var d=r.sn+1;if(d>=e.startSN&&d<=e.endSN){var f=s[d-e.startSN];r.cc===f.cc&&(u=f,F.b.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=G.search(s,function(e){return r.cc-e.cc}))&&F.b.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=s[Math.min(a-1,Math.round(a/2))],F.b.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u},n.prototype._findFragment=function(e,t,i,n,r,s,a){var o=this.hls.config,l=void 0,u=void 0,c=o.maxFragLookUpTolerance,h=t?n[t.sn-n[0].sn+1]:void 0,d=function(e){var t=Math.min(c,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-t<=r?1:e.start-t>r&&e.start?-1:0};if(r<s?(s-c<r&&(c=0),u=h&&!d(h)?h:G.search(n,d)):u=n[i-1],u){var f=(l=u).sn-a.startSN,p=t&&l.level===t.level,m=n[f-1],g=n[f+1];if(t&&l.sn===t.sn)if(p&&!l.backtracked)if(l.sn<a.endSN){var v=t.deltaPTS;v&&v>o.maxBufferHole&&t.dropped&&f?(l=m,F.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(l=g,F.b.log("SN just loaded, load next one: "+l.sn))}else l=null;else l.backtracked&&(g&&g.backtracked?(F.b.warn("Already backtracked from fragment "+g.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+g.sn),l=g):(F.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,m?(m.loadCounter&&m.loadCounter--,(l=m).backtracked=!0):f&&(l=null)))}return l},n.prototype._loadFragmentOrKey=function(e,t,i,n,r){var s=this.hls,a=s.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(F.b.log("Loading "+e.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t+", currentTime:"+n.toFixed(3)+",bufferEnd:"+r.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var o=a.fragLoadingLoopThreshold;if(e.loadCounter>o&&Math.abs(this.fragLoadIdx-e.loadIdx)<o)return void s.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,e.autoLevel=s.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||e.bitrateTest||(this.nextLoadPosition=e.start+e.duration),s.trigger(P.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new J(s,"main")),void(this.state=ne)}F.b.log("Loading key for "+e.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t),this.state=ie,s.trigger(P.a.KEY_LOADING,{frag:e})},n.prototype.getBufferedFrag=function(t){return G.search(this._bufferedFrags,function(e){return t<e.startPTS?-1:t>e.endPTS?1:0})},n.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},n.prototype._checkFragmentChanged=function(){var e,t,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),q.isBuffered(i,t)?e=this.getBufferedFrag(t):q.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(P.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(P.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},n.prototype.immediateLevelSwitch=function(){if(F.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},n.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,q.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},n.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i=void 0,n=void 0;if(void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),(t=this.getBufferedFrag(e.currentTime))&&1<t.startPTS&&this.flushMainBuffer(0,t.startPTS-1),e.paused)i=0;else{var r=this.hls.nextLoadLevel,s=this.levels[r],a=this.fragLastKbps;i=a&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*a)+1:0}if((n=this.getBufferedFrag(e.currentTime+i))&&(n=this.followingBufferedFrag(n))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},n.prototype.flushMainBuffer=function(e,t){this.state=le;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(P.a.BUFFER_FLUSHING,i)},n.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition)},n.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(F.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0,e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},n.prototype.onMediaSeeking=function(){var e=this.media,t=e?e.currentTime:void 0,i=this.config;isNaN(t)||F.b.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,r=q.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===ne){var s=this.fragCurrent;if(0===r.len&&s){var a=i.maxFragLookUpTolerance,o=s.start-a,l=s.start+s.duration+a;t<o||l<t?(s.loader&&(F.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=te):F.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===ue&&(0===r.len&&(this.fragPrevious=0),this.state=te);e&&(this.lastCurrentTime=t),this.state!==ne&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()},n.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||F.b.log("media seeked to "+t.toFixed(3)),this.tick()},n.prototype.onMediaEnded=function(){F.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},n.prototype.onManifestLoading=function(){F.b.log("trigger BUFFER_RESET"),this.hls.trigger(P.a.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0},n.prototype.onManifestParsed=function(e){var t,i=!1,n=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&F.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},n.prototype.onLevelLoaded=function(e){var t=e.details,i=e.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],s=t.totalduration,a=0;if(F.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+s),t.live){var o=r.details;o&&0<t.fragments.length?(u(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown&&!isNaN(a)?F.b.log("live playlist sliding:"+a.toFixed(3)):(F.b.log("live playlist - outdated PTS, unknown sliding"),m(this.fragPrevious,n,t))):(F.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,m(this.fragPrevious,n,t))}else t.PTSKnown=!1;if(r.details=t,this.levelLastLoaded=i,this.hls.trigger(P.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=t.startTimeOffset;isNaN(l)?t.live?(this.startPosition=this.computeLivePosition(a,t),F.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(l<0&&(F.b.log("negative start time offset "+l+", count from end of last fragment"),l=a+s+l),F.b.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===se&&(this.state=te),this.tick()},n.prototype.onKeyLoaded=function(){this.state===ie&&(this.state=te,this.tick())},n.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===ne&&t&&"main"===i.type&&i.level===t.level&&i.sn===t.sn){var n=e.stats,r=this.levels[t.level],s=r.details;if(F.b.log("Loaded  "+t.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=n,!0===i.bitrateTest&&this.hls.nextLoadLevel)this.state=te,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(P.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=te,n.tparsed=n.tbuffered=performance.now(),s.initSegment.data=e.payload,this.hls.trigger(P.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=ae;var a=s.totalduration,o=t.level,l=t.sn,u=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(F.b.log("swapping playlist audio codec"),void 0===u&&(u=this.lastAudioCodec),u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,F.b.log("Parsing "+l+" of ["+s.startSN+" ,"+s.endSN+"],level "+o+", cc "+t.cc);var c=this.demuxer;c||(c=this.demuxer=new J(this.hls,"main"));var h=this.media,d=!(h&&h.seeking)&&(s.PTSKnown||!s.live),f=s.initSegment?s.initSegment.data:[];c.push(e.payload,f,u,r.videoCodec,t,a,d,void 0)}}this.fragLoadError=0},n.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ae){var n,r,s=e.tracks;if(s.audio&&this.altAudio&&delete s.audio,r=s.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(F.b.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===o.indexOf("firefox")&&(a="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==r.container&&(a="mp4a.40.2",F.b.log("Android: force audio codec to "+a)),r.levelCodec=a,r.id=e.id}(r=s.video)&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),this.hls.trigger(P.a.BUFFER_CODECS,s);for(n in s){r=s[n],F.b.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var l=r.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(P.a.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},n.prototype.onFragParsingData=function(t){var i=this,e=this.fragCurrent,n=t.frag;if(e&&"main"===t.id&&n.sn===e.sn&&n.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===ae){var r=this.levels[this.level],s=e;if(isNaN(t.endPTS)&&(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),F.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(s.dropped=t.dropped,s.dropped)if(s.backtracked)F.b.warn("Already backtracked on this fragment, appending with the gap");else{var a=r.details;if(!a||s.sn!==a.startSN)return F.b.warn("missing video frame(s), backtracking fragment"),s.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=te,this.fragPrevious=s,void this.tick();F.b.warn("missing video frame(s) on first frag, appending with gap")}else s.backtracked=!1;var o=p(r.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(P.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:o,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&i.state===ae&&(i.appended=!0,i.pendingBuffering=!0,l.trigger(P.a.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},n.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===ae&&(this.stats.tparsed=performance.now(),this.state=oe,this._checkAppendedParsed())},n.prototype.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){F.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(F.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=te}var r=this.hls;r.trigger(P.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(P.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},n.prototype.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(F.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},n.prototype.onBufferCreated=function(e){var t=e.tracks,i=void 0,n=void 0,r=!1;for(var s in t){var a=t[s];"main"===a.id?(i=a,"video"===(n=s)&&(this.videoBuffer=t[s].buffer)):r=!0}r&&i?(F.b.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},n.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==ae&&t!==oe||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},n.prototype._checkAppendedParsed=function(){if(!(this.state!==oe||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;F.b.log("main buffered : "+$.toString(t.buffered));var i=this._bufferedFrags.filter(function(e){return q.isBuffered(t,(e.startPTS+e.endPTS)/2)});i.push(e),this._bufferedFrags=i.sort(function(e,t){return e.startPTS-t.startPTS}),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(P.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=te}this.tick()}},n.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&q.isBuffered(this.media,this.media.currentTime)&&q.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case I.a.FRAG_LOAD_ERROR:case I.a.FRAG_LOAD_TIMEOUT:case I.a.KEY_LOAD_ERROR:case I.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);t.loadCounter=0,F.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=re}else F.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ce;break;case I.a.FRAG_LOOP_LOADING_ERROR:e.fatal||(i?(this._reduceMaxBufferLength(t.duration),this.state=te):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=ce));break;case I.a.LEVEL_LOAD_ERROR:case I.a.LEVEL_LOAD_TIMEOUT:this.state!==ce&&(e.fatal?(this.state=ce,F.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==se||(this.state=te));break;case I.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==ae&&this.state!==oe||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=te):(F.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},n.prototype._reduceMaxBufferLength=function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,F.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*t.fragLoadingLoopThreshold))},n.prototype._checkBuffer=function(){var e=this.media,t=this.config;if(e&&e.readyState){var i=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,r=n.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var s=e.seeking?i:this.startPosition,a=q.isBuffered(n,s),o=r.start(0),l=!a&&Math.abs(s-o)<t.maxSeekHole;(i!==s||l)&&(F.b.log("target start position:"+s),l&&(s=o,F.b.log("target start position not buffered, seek to buffered.start(0) "+s)),F.b.log("adjust currentTime from "+i+" to "+s),e.currentTime=s)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var u=q.bufferInfo(e,i,0),c=!(e.paused||e.ended||0===e.buffered.length);if(i!==this.lastCurrentTime)this.stallReported&&(F.b.warn("playback not stuck anymore @"+i+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var h=performance.now(),d=this.hls;if(this.stalled){var f=h-this.stalled,p=u.len,m=this.nudgeRetry||0;if(p<=.5&&f>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,F.b.warn("playback stalling in low buffer @"+i),d.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p}));var g=u.nextStart,v=g-i;if(g&&v<t.maxSeekHole&&0<v){this.nudgeRetry=++m;var y=m*t.nudgeOffset;F.b.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+g+" + nudge "+y),e.currentTime=g+y,this.stalled=void 0,d.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:g+y-i})}}else if(.5<p&&f>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,F.b.warn("playback stalling in high buffer @"+i),d.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p})),this.stalled=void 0,this.nudgeRetry=++m,m<t.nudgeMaxRetry){var E=e.currentTime,b=E+m*t.nudgeOffset;F.b.log("adjust currentTime from "+E+" to "+b),e.currentTime=b,d.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else F.b.error("still stuck in high buffer @"+i+" after "+t.nudgeMaxRetry+", raise fatal error"),d.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=h,this.stallReported=!1}}}},n.prototype.onFragLoadEmergencyAborted=function(){this.state=te,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},n.prototype.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(e){return q.isBuffered(t,(e.startPTS+e.endPTS)/2)}),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.state=te,this.fragPrevious=null},n.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},n.prototype.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},Z(n,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,F.b.log("main stream:"+t+"->"+e),this.hls.trigger(P.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),n}(C),de=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),fe=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MANIFEST_LOADED,P.a.LEVEL_LOADED,P.a.FRAG_LOADED,P.a.ERROR));return t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){this.cleanTimer(),this.manualLevelIndex=-1},n.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},n.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},n.prototype.stopLoad=function(){this.canload=!1},n.prototype.onManifestLoaded=function(e){var t=[],i=void 0,n={},r=null,s=!1,a=!1,o=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),l=[];if(e.levels.forEach(function(e){e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,a=a||!!e.audioCodec||!(!e.attrs||!e.attrs.AUDIO),!0===o&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),void 0===(r=n[e.bitrate])?(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,t.push(e)):r.url.push(e.url)}),!0===s&&!0===a&&(t=t.filter(function(e){return!!e.videoCodec})),t=t.filter(function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||c(t))&&(!i||c(i))}),e.audioTracks&&(l=e.audioTracks.filter(function(e){return!e.audioCodec||c(e.audioCodec,"audio")})),0<t.length){i=t[0].bitrate,t.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=t;for(var u=0;u<t.length;u++)if(t[u].bitrate===i){this._firstLevel=u,F.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+i);break}this.hls.trigger(P.a.MANIFEST_PARSED,{levels:t,audioTracks:l,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:s,altAudio:0<l.length})}else this.hls.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},n.prototype.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(0<=e&&e<t.length){if(this.cleanTimer(),this.currentLevelIndex!==e){F.b.log("switching to level "+e);var n=t[this.currentLevelIndex=e];n.level=e,i.trigger(P.a.LEVEL_SWITCH,n),i.trigger(P.a.LEVEL_SWITCHING,n)}var r=t[e],s=r.details;if(!s||!0===s.live){var a=r.urlId;i.trigger(P.a.LEVEL_LOADING,{url:r.url[a],level:e,id:a})}}else i.trigger(P.a.ERROR,{type:I.b.OTHER_ERROR,details:I.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},n.prototype.onError=function(e){if(!0!==e.fatal){var t=!1,i=!1,n=void 0;switch(e.details){case I.a.FRAG_LOAD_ERROR:case I.a.FRAG_LOAD_TIMEOUT:case I.a.FRAG_LOOP_LOADING_ERROR:case I.a.KEY_LOAD_ERROR:case I.a.KEY_LOAD_TIMEOUT:n=e.frag.level,i=!0;break;case I.a.LEVEL_LOAD_ERROR:case I.a.LEVEL_LOAD_TIMEOUT:n=e.context.level,t=!0;break;case I.a.REMUX_ALLOC_ERROR:n=e.level,t=!0}void 0!==n&&this.recoverLevel(e,n,t,i)}else e.type===I.b.NETWORK_ERROR&&this.cleanTimer()},n.prototype.recoverLevel=function(e,t,i,n){var r=this,s=this.hls.config,a=e.details,o=this._levels[t],l=void 0,u=void 0,c=void 0;if(o.loadError++,o.fragmentError=n,!0===i){if(!(this.levelRetryCount+1<=s.levelLoadingMaxRetry))return F.b.error("level controller, cannot recover from "+a+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(e.fatal=!0);u=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},u),e.levelRetry=!0,this.levelRetryCount++,F.b.warn("level controller, "+a+", retry in "+u+" ms, current retry count is "+this.levelRetryCount)}!0!==i&&!0!==n||(1<(l=o.url.length)&&o.loadError<l?(F.b.warn("level controller, "+a+" for level "+t+": switching to redundant stream id "+o.urlId),o.urlId=(o.urlId+1)%l,o.details=void 0):-1===this.manualLevelIndex?(c=0===t?this._levels.length-1:t-1,F.b.warn("level controller, "+a+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):!0===n&&(F.b.warn("level controller, "+a+": reload a fragment"),this.currentLevelIndex=null))},n.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},n.prototype.onLevelLoaded=function(e){var t=this,i=e.level;if(i===this.currentLevelIndex){var n=this._levels[i];!1===n.fragmentError&&(n.loadError=0,this.levelRetryCount=0);var r=e.details;if(r.live){var s=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),a=n.details;a&&r.endSN===a.endSN&&(s/=2,F.b.log("same live playlist, reload twice faster")),s-=performance.now()-e.stats.trequest,s=Math.max(1e3,Math.round(s)),F.b.log("live playlist, reload in "+s+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},s)}else this.cleanTimer()}},n.prototype.loadLevel=function(){var e=void 0,t=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(e=this._levels[this.currentLevelIndex])&&0<e.url.length&&(t=e.urlId,this.hls.trigger(P.a.LEVEL_LOADING,{url:e.url[t],level:this.currentLevelIndex,id:t}))},de(n,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),n}(C),pe=i(3),me=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHED,P.a.MEDIA_DETACHING,P.a.FRAG_PARSING_METADATA));return t.id3Track=void 0,t.media=void 0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){C.prototype.destroy.call(this)},n.prototype.onMediaAttached=function(e){this.media=e.media,this.media},n.prototype.onMediaDetaching=function(){this.media=void 0},n.prototype.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var s=pe.a.getID3Frames(i[r].data);if(s){var a=i[r].pts,o=r<i.length-1?i[r+1].pts:t.endPTS;a===o&&(o+=1e-4);for(var l=0;l<s.length;l++){var u=s[l];if(!pe.a.isTimeStampFrame(u)){var c=new n(a,o,"");c.value=u,this.id3Track.addCue(c)}}}}},n}(C),ge=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return t.prototype.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.prototype.getTotalWeight=function(){return this.totalWeight_},t.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},t}(),ve=function(){function r(e,t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ge(t),this.fast_=new ge(i)}return r.prototype.sample=function(e,t){var i=8e3*t/(e=Math.max(e,this.minDelayMs_)),n=e/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)},r.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},r.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},r.prototype.destroy=function(){},r}(),ye=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Ee=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.FRAG_LOADING,P.a.FRAG_LOADED,P.a.FRAG_BUFFERED,P.a.ERROR));return t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=e,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){this.clearTimer(),C.prototype.destroy.call(this)},n.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var i=this.hls,n=e.frag.level,r=i.levels[n].details.live,s=i.config,a=void 0,o=void 0;r?(a=s.abrEwmaFastLive,o=s.abrEwmaSlowLive):(a=s.abrEwmaFastVoD,o=s.abrEwmaSlowVoD),this._bwEstimator=new ve(i,o,a,s.abrEwmaDefaultEstimate)}this.fragCurrent=t}},n.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent,n=i.loader,r=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return F.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=n.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var a=performance.now()-s.trequest,o=Math.abs(t.playbackRate);if(a>500*i.duration/o){var l=e.levels,u=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/a),c=l[i.level],h=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate,d=s.total?s.total:Math.max(s.loaded,Math.round(i.duration*h/8)),f=t.currentTime,p=(d-s.loaded)/u,m=(q.bufferInfo(t,f,e.config.maxBufferHole).end-f)/o;if(m<2*i.duration/o&&m<p){var g=void 0,v=void 0;for(v=i.level-1;r<v;v--){var y=l[v].realBitrate?Math.max(l[v].realBitrate,l[v].bitrate):l[v].bitrate;if((g=i.duration*y/(6.4*u))<m)break}g<p&&(F.b.warn("loading too slow, abort fragment loading and switch to level "+v+":fragLoadedDelay["+v+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+g.toFixed(1)+"<"+p.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=v,this._bwEstimator.sample(a,s.loaded),n.abort(),this.clearTimer(),e.trigger(P.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:s}))}}}},n.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],n=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,r=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(e.frag.bitrateTest){var s=e.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(e)}}},n.prototype.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!(!0===t.aborted||1!==i.loadCounter||"main"!==i.type||isNaN(i.sn)||i.bitrateTest&&t.tload!==t.tbuffered)){var n=t.tparsed-t.trequest;F.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},n.prototype.onError=function(e){switch(e.details){case I.a.FRAG_LOAD_ERROR:case I.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},n.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},n.prototype._findBestLevel=function(e,t,i,n,r,s,a,o,l){for(var u=r;n<=u;u--){var c,h=l[u].details,d=h?h.totalduration/h.fragments.length:t,f=!!h&&h.live;c=u<=e?a*i:o*i;var p=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=p*d/c;if(F.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(c)+"/"+p+"/"+d+"/"+s+"/"+m),p<c&&(!m||f&&!this.bitrateTestDelay||m<s))return u}return-1},ye(n,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,n=e.config,r=e.minAutoLevel,s=e.media,a=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=s?s.currentTime:0,u=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(q.bufferInfo(s,l,n.maxBufferHole).end-l)/u,d=this._findBestLevel(a,o,c,r,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(0<=d)return d;F.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,p=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===h){var g=this.bitrateTestDelay;g&&(f=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-g,F.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),p=m=1)}return d=this._findBestLevel(a,o,c,r,t,h+f,p,m,i),Math.max(d,0)}}]),n}(C),be=s(),Te=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHING,P.a.MEDIA_DETACHING,P.a.MANIFEST_PARSED,P.a.BUFFER_RESET,P.a.BUFFER_APPENDING,P.a.BUFFER_CODECS,P.a.BUFFER_EOS,P.a.BUFFER_FLUSHING,P.a.LEVEL_PTS_UPDATED,P.a.LEVEL_UPDATED));return t._msDuration=null,t._levelDuration=null,t._live=null,t._objectUrl=null,t.onsbue=t.onSBUpdateEnd.bind(t),t.onsbe=t.onSBUpdateError.bind(t),t.pendingTracks={},t.tracks={},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){C.prototype.destroy.call(this)},n.prototype.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(.1<Math.abs(n.timestampOffset-e.start)){var r=n.updating;try{n.abort()}catch(e){r=!0,F.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(F.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},n.prototype.onManifestParsed=function(e){var t=e.audio,i=e.video||e.levels.length&&e.audio,n=0;e.altAudio&&(t||i)&&(n=(t?1:0)+(i?1:0),F.b.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n},n.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var i=this.mediaSource=new be;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(i),this._objectUrl=t.src}},n.prototype.onMediaDetaching=function(){F.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){F.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):F.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(P.a.MEDIA_DETACHED)},n.prototype.onMediaSourceOpen=function(){F.b.log("media source opened"),this.hls.trigger(P.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},n.prototype.checkPendingTracks=function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},n.prototype.onMediaSourceClose=function(){F.b.log("media source closed")},n.prototype.onMediaSourceEnded=function(){F.b.log("media source ended")},n.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;F.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var i=this.parent,t=this.segments.reduce(function(e,t){return t.parent===i?e+1:e},0);this.hls.trigger(P.a.BUFFER_APPENDED,{parent:i,pending:t}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},n.prototype.onSBUpdateError=function(e){F.b.error("sourceBuffer error:",e),this.hls.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_APPENDING_ERROR,fatal:!1})},n.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},n.prototype.onBufferCodecs=function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},n.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;for(var n in e)if(!t[n]){var r=e[n],s=r.levelCodec||r.codec,a=r.container+";codecs="+s;F.b.log("creating sourceBuffer("+a+")");try{var o=t[n]=i.addSourceBuffer(a);o.addEventListener("updateend",this.onsbue),o.addEventListener("error",this.onsbe),this.tracks[n]={codec:s,container:r.container},r.buffer=o}catch(e){F.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:a})}}this.hls.trigger(P.a.BUFFER_CREATED,{tracks:e})},n.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},n.prototype.onBufferAppendFail=function(e){F.b.error("sourceBuffer error:",e.event),this.hls.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.BUFFER_APPENDING_ERROR,fatal:!1})},n.prototype.onBufferEos=function(e){var t=this.sourceBuffer,i=e.type;for(var n in t)i&&n!==i||t[n].ended||(t[n].ended=!0,F.b.log(n+" sourceBuffer now EOS"));this.checkEos()},n.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var n=e[i];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}F.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){F.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},n.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},n.prototype.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._live=t.live,this.updateMediaElementDuration())},n.prototype.updateMediaElementDuration=function(){var e=this.hls.config,t=void 0;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===e.liveDurationInfinity?(F.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||t===1/0||isNaN(t))&&(F.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},n.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var n in i)t+=i[n].buffered.length}catch(e){F.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(P.a.BUFFER_FLUSHED)}},n.prototype.doAppending=function(){var e=this.hls,t=this.sourceBuffer,i=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void F.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var n=i.shift();try{var r=t[n.type];r?r.updating?i.unshift(n):(r.ended=!1,this.parent=n.parent,r.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){F.b.error("error while trying to append buffer:"+t.message),i.unshift(n);var s={type:I.b.MEDIA_ERROR,parent:n.parent};if(22===t.code)return this.segments=[],s.details=I.a.BUFFER_FULL_ERROR,s.fatal=!1,void e.trigger(P.a.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=I.a.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return F.b.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],s.fatal=!0,void e.trigger(P.a.ERROR,s);s.fatal=!1,e.trigger(P.a.ERROR,s)}}}},n.prototype.flushBuffer=function(e,t,i){var n,r,s,a,o,l,u=this.sourceBuffer;if(Object.keys(u).length){if(F.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in u)if(!i||c===i){if((n=u[c]).ended=!1,n.updating)return F.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<n.buffered.length;r++)if(s=n.buffered.start(r),a=n.buffered.end(r),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(o=e,l=t):(o=Math.max(s,e),l=Math.min(a,t)),.5<Math.min(l,a)-o)return this.flushBufferCounter++,F.b.log("flush "+c+" ["+o+","+l+"], of ["+s+","+a+"], pos:"+this.media.currentTime),n.remove(o,l),!1}catch(e){F.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else F.b.warn("abort flushing too many retries");F.b.log("buffer flushed")}return!0},n}(C),we=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Se=function(t){function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,e,P.a.FPS_DROP_LEVEL_CAPPING,P.a.MEDIA_ATTACHING,P.a.MANIFEST_PARSED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),r.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},r.prototype.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},r.prototype.onMediaAttaching=function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null},r.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.prototype.getMaxLevel=function(i){var n=this;if(!this.levels)return-1;var e=this.levels.filter(function(e,t){return r.isLevelAllowed(t,n.restrictedLevels)&&t<=i});return r.getMaxLevelByMediaSize(e,this.mediaWidth,this.mediaHeight)},r.isLevelAllowed=function(e){return-1===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var n=e.length-1,r=0;r<e.length;r+=1){var s=e[r];if((s.width>=t||s.height>=i)&&(a=s,!(o=e[r+1])||a.width!==o.width||a.height!==o.height)){n=r;break}}var a,o;return n},we(r,[{key:"mediaWidth",get:function(){var e=void 0,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=r.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=r.contentScaleFactor),e}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),r}(C),_e=function(t){function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,e,P.a.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,t),i.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},i.prototype.checkFPS=function(e,t,i){var n=performance.now();if(t){if(this.lastTime){var r=n-this.lastTime,s=i-this.lastDroppedFrames,a=t-this.lastDecodedFrames,o=1e3*s/r,l=this.hls;if(l.trigger(P.a.FPS_DROP,{currentDropped:s,currentDecoded:a,totalDroppedFrames:i}),0<o&&s>l.config.fpsDroppedMonitoringThreshold*a){var u=l.currentLevel;F.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),0<u&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(P.a.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},i.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},i}(C),Ce=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return t.prototype.destroy=function(){this.abort(),this.loader=null},t.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.prototype.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.prototype.loadInternal=function(){var e,t=this.context;e=this.loader=new XMLHttpRequest;var i=this.stats;i.tfirst=0,i.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(i){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.prototype.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,n=this.stats,r=this.context,s=this.config;if(!n.aborted&&2<=i)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===i){var a=t.status;if(200<=a&&a<300){n.tload=Math.max(n.tfirst,performance.now());var o=void 0,l=void 0;"arraybuffer"===r.responseType?l=(o=t.response).byteLength:l=(o=t.responseText).length,n.loaded=n.total=l;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,n,r,t)}else n.retry>=s.maxRetry||400<=a&&a<499?(F.b.error(a+" while loading "+r.url),this.callbacks.onError({code:a,text:t.statusText},r,t)):(F.b.warn(a+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},t.prototype.loadtimeout=function(){F.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.prototype.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,t)},t}(),Ae=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),xe=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MANIFEST_LOADING,P.a.MANIFEST_PARSED,P.a.AUDIO_TRACK_LOADED,P.a.ERROR));return t.ticks=0,t.ontick=t.tick.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){this.cleanTimer(),C.prototype.destroy.call(this)},n.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},n.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},n.prototype.doTick=function(){this.updateTrack(this.trackId)},n.prototype.onError=function(e){e.fatal&&e.type===I.b.NETWORK_ERROR&&this.cleanTimer()},n.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},n.prototype.onManifestParsed=function(e){var t=this,i=e.audioTracks||[],n=!1;this.tracks=i,this.hls.trigger(P.a.AUDIO_TRACKS_UPDATED,{audioTracks:i});var r=0;i.forEach(function(e){if(e["default"]&&!n)return t.audioTrack=r,void(n=!0);r++}),!1===n&&i.length&&(F.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},n.prototype.onAudioTrackLoaded=function(e){e.id<this.tracks.length&&(F.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&this.cleanTimer())},n.prototype.setAudioTrackInternal=function(e){if(0<=e&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,F.b.log("switching to audioTrack "+e);var t=this.tracks[e],i=this.hls,n=t.type,r=t.url,s={id:e,type:n,url:r};i.trigger(P.a.AUDIO_TRACK_SWITCH,s),i.trigger(P.a.AUDIO_TRACK_SWITCHING,s);var a=t.details;!r||void 0!==a&&!0!==a.live||(F.b.log("(re)loading playlist for audioTrack "+e),i.trigger(P.a.AUDIO_TRACK_LOADING,{url:r,id:e}))}},n.prototype.updateTrack=function(e){if(0<=e&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,F.b.log("updating audioTrack "+e);var t=this.tracks[e],i=t.url,n=t.details;!i||void 0!==n&&!0!==n.live||(F.b.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(P.a.AUDIO_TRACK_LOADING,{url:i,id:e}))}},Ae(n,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),n}(C),ke=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Re="STOPPED",Ne="STARTING",Le="IDLE",De="PAUSED",Me="KEY_LOADING",Oe="FRAG_LOADING",Pe="FRAG_LOADING_WAITING_RETRY",Ie="WAITING_TRACK",Fe="PARSING",Be="PARSED",Ue="BUFFER_FLUSHING",Ve="ENDED",He="ERROR",je="WAITING_INIT_PTS",Ge=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHED,P.a.MEDIA_DETACHING,P.a.AUDIO_TRACKS_UPDATED,P.a.AUDIO_TRACK_SWITCHING,P.a.AUDIO_TRACK_LOADED,P.a.KEY_LOADED,P.a.FRAG_LOADED,P.a.FRAG_PARSING_INIT_SEGMENT,P.a.FRAG_PARSING_DATA,P.a.FRAG_PARSED,P.a.ERROR,P.a.BUFFER_RESET,P.a.BUFFER_CREATED,P.a.BUFFER_APPENDED,P.a.BUFFER_FLUSHED,P.a.INIT_PTS_FOUND));return t.config=e.config,t.audioCodecSwap=!1,t.ticks=0,t._state=Re,t.ontick=t.tick.bind(t),t.initPTS=[],t.waitingFragment=null,t.videoTrackCC=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),C.prototype.destroy.call(this),this.state=Re},n.prototype.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[i]=n,this.videoTrackCC=i,F.b.log("InitPTS for cc:"+i+" found from video track:"+n),this.state===je&&this.tick())},n.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),(this.fragLoadError=0)<t&&-1===e?(F.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=Le):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=Ne),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=Re},n.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Re},n.prototype.tick=function(){1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)},n.prototype.doTick=function(){var e,t,i,n,r,s=this.hls,a=s.config;switch(this.state){case He:case De:case Ue:break;case Ne:this.state=Ie,this.loadedmetadata=!1;break;case Le:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!a.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,u=this.videoBuffer?this.videoBuffer:this.media,c=q.bufferInfo(l,e,a.maxBufferHole),h=q.bufferInfo(u,e,a.maxBufferHole),d=c.len,f=c.end,p=this.fragPrevious,m=Math.max(a.maxBufferLength,h.len),g=this.audioSwitch,v=this.trackId;if((d<m||g)&&v<o.length){if(void 0===(i=o[v].details)){this.state=Ie;break}if(!g&&!i.live&&p&&p.sn===i.endSN&&!c.nextStart&&(!this.media.seeking||this.media.duration-f<p.duration/2)){this.hls.trigger(P.a.BUFFER_EOS,{type:"audio"}),this.state=Ve;break}var y=i.fragments,E=y.length,b=y[0].start,T=y[E-1].start+y[E-1].duration,w=void 0;if(g)if(i.live&&!i.PTSKnown)F.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),f=0;else if(f=e,i.PTSKnown&&e<b){if(!(c.end>b||c.nextStart))return;F.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=b+.05}if(i.initSegment&&!i.initSegment.data)w=i.initSegment;else if(f<=b){if(w=y[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(w=(n=y,r=this.videoTrackCC,G.search(n,function(e){return e.cc<r?1:e.cc>r?-1:0}))),i.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var S=c.nextStart?c.nextStart:b;return F.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(S+.05)),void(this.media.currentTime=S+.05)}}else{var _=void 0,C=a.maxFragLookUpTolerance,A=p?y[p.sn-y[0].sn+1]:void 0,x=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=f?1:e.start-t>f&&e.start?-1:0};f<T?(T-C<f&&(C=0),_=A&&!x(A)?A:G.search(y,x)):_=y[E-1],_&&(b=(w=_).start,p&&w.level===p.level&&w.sn===p.sn&&(w.sn<i.endSN?(w=y[w.sn+1-i.startSN],F.b.log("SN just loaded, load next one: "+w.sn)):w=null))}if(w)if(w.decryptdata&&null!=w.decryptdata.uri&&null==w.decryptdata.key)F.b.log("Loading key for "+w.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+v),this.state=Me,s.trigger(P.a.KEY_LOADING,{frag:w});else{if(F.b.log("Loading "+w.sn+", cc: "+w.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+v+", currentTime:"+e+",bufferEnd:"+f.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,w.loadCounter){w.loadCounter++;var k=a.fragLoadingLoopThreshold;if(w.loadCounter>k&&Math.abs(this.fragLoadIdx-w.loadIdx)<k)return void s.trigger(P.a.ERROR,{type:I.b.MEDIA_ERROR,details:I.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:w})}else w.loadCounter=1;w.loadIdx=this.fragLoadIdx,this.fragCurrent=w,this.startFragRequested=!0,isNaN(w.sn)||(this.nextLoadPosition=w.start+w.duration),s.trigger(P.a.FRAG_LOADING,{frag:w}),this.state=Oe}}break;case Ie:(t=this.tracks[this.trackId])&&t.details&&(this.state=Le);break;case Pe:var R=performance.now(),N=this.retryDate,L=(l=this.media)&&l.seeking;(!N||N<=R||L)&&(F.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=Le);break;case je:var D=this.videoTrackCC;if(void 0===this.initPTS[D])break;var M=this.waitingFragment;if(M){var O=M.frag.cc;D!==O?(t=this.tracks[this.trackId]).details&&t.details.live&&(F.b.warn("Waiting fragment CC ("+O+") does not match video track CC ("+D+")"),this.waitingFragment=null,this.state=Le):(this.state=Oe,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=Le}},n.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},n.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(F.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},n.prototype.onMediaSeeking=function(){this.state===Ve&&(this.state=Le),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()},n.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.prototype.onAudioTracksUpdated=function(e){F.b.log("audio tracks updated"),this.tracks=e.audioTracks},n.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=De,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=Le,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()},n.prototype.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,n=this.tracks[i],r=t.totalduration,s=0;if(F.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var a=n.details;a&&0<t.fragments.length?(u(a,t),s=t.fragments[0].start,t.PTSKnown?F.b.log("live audio playlist sliding:"+s.toFixed(3)):F.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,F.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;isNaN(o)?this.startPosition=0:(F.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o)}this.nextLoadPosition=this.startPosition}this.state===Ie&&(this.state=Le),this.tick()},n.prototype.onKeyLoaded=function(){this.state===Me&&(this.state=Le,this.tick())},n.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===Oe&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var n=this.tracks[this.trackId],r=n.details,s=r.totalduration,a=t.level,o=t.sn,l=t.cc,u=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",c=this.stats=e.stats;if("initSegment"===o)this.state=Le,c.tparsed=c.tbuffered=performance.now(),r.initSegment.data=e.payload,this.hls.trigger(P.a.FRAG_BUFFERED,{stats:c,frag:t,id:"audio"}),this.tick();else{this.state=Fe,this.appended=!1,this.demuxer||(this.demuxer=new J(this.hls,"audio"));var h=this.initPTS[l],d=r.initSegment?r.initSegment.data:[];if(r.initSegment||void 0!==h){this.pendingBuffering=!0,F.b.log("Demuxing "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+a);this.demuxer.push(e.payload,d,u,null,t,s,!1,h)}else F.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+a),this.waitingFragment=e,this.state=je}}this.fragLoadError=0},n.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Fe){var n=e.tracks,r=void 0;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(P.a.BUFFER_CODECS,n),F.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var s=r.initSegment;if(s){var a={type:"audio",data:s,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(P.a.BUFFER_APPENDING,a))}this.tick()}}},n.prototype.onFragParsingData=function(t){var i=this,e=this.fragCurrent,n=t.frag;if(e&&"audio"===t.id&&"audio"===t.type&&n.sn===e.sn&&n.level===e.level&&this.state===Fe){var r=this.trackId,s=this.tracks[r],a=this.hls;isNaN(t.endPTS)&&(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),F.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),p(s.details,e,t.startPTS,t.endPTS);var o=this.audioSwitch,l=this.media,u=!1;if(o&&l)if(l.readyState){var c=l.currentTime;F.b.log("switching audio track : currentTime:"+c),c>=t.startPTS&&(F.b.log("switching audio track : flushing all audio"),this.state=Ue,a.trigger(P.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,a.trigger(P.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,a.trigger(P.a.AUDIO_TRACK_SWITCHED,{id:r});var h=this.pendingData;this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&h.push({type:t.type,data:e,parent:"audio",content:"data"})}),!u&&h.length&&(h.forEach(function(e){i.state===Fe&&(i.pendingBuffering=!0,i.hls.trigger(P.a.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},n.prototype.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Fe&&(this.stats.tparsed=performance.now(),this.state=Be,this._checkAppendedParsed())},n.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},n.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},n.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==Fe&&t!==Be||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},n.prototype._checkAppendedParsed=function(){if(!(this.state!==Be||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),i.trigger(P.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;F.b.log("audio buffered : "+$.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(P.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=Le}this.tick()}},n.prototype.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case I.a.FRAG_LOAD_ERROR:case I.a.FRAG_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i,t.loadCounter=0;var r=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);F.b.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=Pe}else F.b.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=He}break;case I.a.FRAG_LOOP_LOADING_ERROR:case I.a.AUDIO_TRACK_LOAD_ERROR:case I.a.AUDIO_TRACK_LOAD_TIMEOUT:case I.a.KEY_LOAD_ERROR:case I.a.KEY_LOAD_TIMEOUT:this.state!==He&&(this.state=e.fatal?He:Le,F.b.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case I.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===Fe||this.state===Be)){var s=this.mediaBuffer,a=this.media.currentTime;if(s&&q.isBuffered(s,a)&&q.isBuffered(s,a+.5)){var o=this.config;o.maxMaxBufferLength>=o.maxBufferLength&&(o.maxMaxBufferLength/=2,F.b.warn("audio:reduce max buffer length to "+o.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*o.fragLoadingLoopThreshold),this.state=Le}else F.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Ue,this.hls.trigger(P.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},n.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(F.b.log("appending pending audio data on Buffer Flushed"),e.forEach(function(e){t.hls.trigger(P.a.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=Be):(this.state=Le,this.fragPrevious=null,this.tick())},ke(n,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,F.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),n}(C),qe=function(){function b(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function T(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(e,t,i){var n=this,r=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),s={};r?n=document.createElement("custom"):s.enumerable=!0,n.hasBeenReset=!1;var a="",o=!1,l=e,u=t,c=i,h=null,d="",f=!0,p="auto",m="start",g=50,v="middle",y=50,E="middle";if(Object.defineProperty(n,"id",T({},s,{get:function(){return a},set:function(e){a=""+e}})),Object.defineProperty(n,"pauseOnExit",T({},s,{get:function(){return o},set:function(e){o=!!e}})),Object.defineProperty(n,"startTime",T({},s,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"endTime",T({},s,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"text",T({},s,{get:function(){return c},set:function(e){c=""+e,this.hasBeenReset=!0}})),Object.defineProperty(n,"region",T({},s,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"vertical",T({},s,{get:function(){return d},set:function(e){var t,i="string"==typeof(t=e)&&!!w[t.toLowerCase()]&&t.toLowerCase();if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");d=i,this.hasBeenReset=!0}})),Object.defineProperty(n,"snapToLines",T({},s,{get:function(){return f},set:function(e){f=!!e,this.hasBeenReset=!0}})),Object.defineProperty(n,"line",T({},s,{get:function(){return p},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"lineAlign",T({},s,{get:function(){return m},set:function(e){var t=b(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"position",T({},s,{get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"positionAlign",T({},s,{get:function(){return v},set:function(e){var t=b(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"size",T({},s,{get:function(){return y},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(n,"align",T({},s,{get:function(){return E},set:function(e){var t=b(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),n.displayState=void 0,r)return n}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var w={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};return e.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},e}(),We=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};o.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var ze=new qe(0,0,0),Ye="middle"===ze.align?"middle":"center";n.prototype={parse:function(e){function t(){var e=n.buffer,t=0;for(e=v(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),i}var n=this;e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var r=(i=t()).match(/^(\ucc66\uca29\uca54)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var s=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(s?s=!1:i=t(),n.state){case"HEADER":/:/.test(i)?l(i,function(e,t){},/:/):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new qe(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{g(i,n.cue,n.regionList)}catch(e){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==i.indexOf("--\x3e");if(!i||a&&(s=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(e){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}};var Ke=n,Xe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Qe=function(e){var t=e;return Xe.hasOwnProperty(e)&&(t=Xe[e]),String.fromCharCode(t)},Je={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$e={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ze={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},et={25:2,26:4,29:6,30:8,31:10,27:13,28:15},tt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],it={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e];this.verboseLevel}},nt=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},rt=function(){function s(e,t,i,n,r){y(this,s),this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=n||"black",this.flash=r||!1}return s.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},s.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}},s.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},s.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},s.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},s.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},s}(),st=function(){function a(e,t,i,n,r,s){y(this,a),this.uchar=e||" ",this.penState=new rt(t,i,n,r,s)}return a.prototype.reset=function(){this.uchar=" ",this.penState.reset()},a.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},a.prototype.setPenState=function(e){this.penState.copy(e)},a.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},a.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},a.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},a}(),at=function(){function t(){y(this,t),this.chars=[];for(var e=0;e<100;e++)this.chars.push(new st);this.pos=0,this.currPenState=new rt}return t.prototype.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},t.prototype.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.prototype.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(it.log("ERROR","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(it.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},t.prototype.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},t.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.prototype.insertChar=function(e){144<=e&&this.backSpace();var t=Qe(e);100<=this.pos?it.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.prototype.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.prototype.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var n=this.chars[i].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},t}(),ot=function(){function t(){y(this,t),this.rows=[];for(var e=0;e<15;e++)this.rows.push(new at);this.currRow=14,this.nrRollUpRows=null,this.reset()}return t.prototype.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.prototype.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},t.prototype.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.prototype.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},t.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.prototype.setCursor=function(e){it.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.prototype.setPAC=function(e){it.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var s=r.rows[n].cueStartTime;if(s&&s<it.time)for(var a=0;a<this.nrRollUpRows;a++)this.rows[t-this.nrRollUpRows+a+1].copy(r.rows[n+a])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)},t.prototype.setBkgData=function(e){it.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},t.prototype.rollUp=function(){if(null!==this.nrRollUpRows){it.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),it.log("INFO","Rolling up")}else it.log("DEBUG","roll_up but nrRollUpRows not set yet")},t.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],i="",n=-1,r=0;r<15;r++){var s=this.rows[r].getTextString();s&&(n=r+1,e?t.push("Row "+n+": '"+s+"'"):t.push(s.trim()))}return 0<t.length&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},t.prototype.getTextAndFormat=function(){return this.rows},t}(),lt=function(){function i(e,t){y(this,i),this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ot,this.nonDisplayedMemory=new ot,this.lastOutputScreen=new ot,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},i.prototype.getHandler=function(){return this.outputFilter},i.prototype.setHandler=function(e){this.outputFilter=e},i.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},i.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},i.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,it.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},i.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";it.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(it.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},i.prototype.ccRCL=function(){it.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},i.prototype.ccBS=function(){it.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},i.prototype.ccAOF=function(){},i.prototype.ccAON=function(){},i.prototype.ccDER=function(){it.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},i.prototype.ccRU=function(e){it.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},i.prototype.ccFON=function(){it.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},i.prototype.ccRDC=function(){it.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},i.prototype.ccTR=function(){it.log("INFO","TR"),this.setMode("MODE_TEXT")},i.prototype.ccRTD=function(){it.log("INFO","RTD"),this.setMode("MODE_TEXT")},i.prototype.ccEDM=function(){it.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},i.prototype.ccCR=function(){it.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},i.prototype.ccENM=function(){it.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},i.prototype.ccEOC=function(){if(it.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,it.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},i.prototype.ccTO=function(e){it.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},i.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}it.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},i.prototype.outputDataUpdate=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=it.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},i.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},i}(),ut=function(){function n(e,t,i){y(this,n),this.field=e||1,this.outputs=[t,i],this.channels=[new lt(1,t),new lt(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return n.prototype.getHandler=function(e){return this.channels[e].getHandler()},n.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},n.prototype.addData=function(e,t){var i,n,r,s=!1;this.lastTime=e,it.setTime(e);for(var a=0;a<t.length;a+=2)if(n=127&t[a],r=127&t[a+1],0!==n||0!==r){if(it.log("DATA","["+nt([t[a],t[a+1]])+"] -> ("+nt([n,r])+")"),(i=this.parseCmd(n,r))||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),!i&&(s=this.parseChars(n,r)))if(this.currChNr&&0<=this.currChNr){this.channels[this.currChNr-1].insertChars(s)}else it.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:s?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,it.log("WARNING","Couldn't parse cleaned data "+nt([n,r])+" orig: "+nt([t[a],t[a+1]])))}else this.dataCounters.padding+=2},n.prototype.parseCmd=function(e,t){var i;if(!((20===e||28===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,it.log("DEBUG","Repeated command ("+nt([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var n=this.channels[i-1];return 20===e||28===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},n.prototype.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&32<=t&&t<=47&&((i=17===e?1:2)!==this.currChNr?(it.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),it.log("DEBUG","MIDROW ("+nt([e,t])+")"),!0))},n.prototype.parsePAC=function(e,t){var i,n;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);i=e<=23?1:2,n=64<=t&&t<=95?1===i?Je[e]:Ze[e]:1===i?$e[e]:et[e];var r=this.interpretPAC(n,t);return this.channels[i-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},n.prototype.interpretPAC=function(e,t){var i,n={color:null,italics:!1,indent:null,underline:!1,row:e};return i=95<t?t-96:t-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},n.prototype.parseChars=function(e,t){var i=null,n=null,r=null;if(25<=e?(i=2,r=e-8):(i=1,r=e),17<=r&&r<=19){var s;s=17===r?t+80:18===r?t+112:t+144,it.log("INFO","Special char '"+Qe(s)+"' in channel "+i),n=[s]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var a=nt(n);it.log("DEBUG","Char codes =  "+a.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},n.prototype.parseBackgroundAttributes=function(e,t){var i,n,r;return!(!((16===e||24===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&45<=t&&t<=47)||(i={},16===e||24===e?(n=Math.floor((t-32)/2),i.background=tt[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),r=e<24?1:2,this.channels[r-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null))},n.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},n.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},n}(),ct=function(){function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.timelineController=e,this.track=t,this.startTime=null,this.endTime=null,this.screen=null}return i.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},i.prototype.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.track)},i}(),ht=function(e,t,i){return e.substr(i||0,t.length)===t},dt=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()},ft={parse:function(e,a,n,r,t,i){var s=Object(pe.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),o="00:00.000",l=0,u=0,c=0,h=[],d=void 0,f=!0,p=new Ke;p.oncue=function(e){var t=n[r],i=n.ccOffset;t&&t["new"]&&(void 0!==u?i=n.ccOffset=t.start:function(e,t,i){var n=e[t],r=e[n.prevCC];if(!r||!r["new"]&&n["new"])return e.ccOffset=e.presentationOffset=n.start,n["new"]=!1;for(;r&&r["new"];)e.ccOffset+=n.start-r.start,n["new"]=!1,r=e[(n=r).prevCC];e.presentationOffset=i}(n,r,c)),c&&(i=c+n.ccOffset-n.presentationOffset),e.startTime+=i-u,e.endTime+=i-u,e.id=dt(e.startTime.toString())+dt(e.endTime.toString())+dt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&h.push(e)},p.onparsingerror=function(e){d=e},p.onflush=function(){d&&i?i(d):t(h)},s.forEach(function(e){if(f){if(ht(e,"X-TIMESTAMP-MAP=")){f=!1,e.substr(16).split(",").forEach(function(e){ht(e,"LOCAL:")?o=e.substr(6):ht(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))});try{l-=a=a<0?a+8589934592:a,u=(t=o,i=parseInt(t.substr(-3)),n=parseInt(t.substr(-6,2)),r=parseInt(t.substr(-9,2)),s=9<t.length?parseInt(t.substr(0,t.indexOf(":"))):0,isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s)?-1:(i+=1e3*n,i+=6e4*r,i+=36e5*s))/1e3,c=l/9e4,-1===u&&(d=new Error("Malformed X-TIMESTAMP-MAP: "+e))}catch(a){d=new Error("Malformed X-TIMESTAMP-MAP: "+e)}return}""===e&&(f=!1)}var t,i,n,r,s;p.parse(e+"\n")}),p.flush()}},pt=function(r){function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,r.call(this,e,P.a.MEDIA_ATTACHING,P.a.MEDIA_DETACHING,P.a.FRAG_PARSING_USERDATA,P.a.FRAG_DECRYPTED,P.a.MANIFEST_LOADING,P.a.MANIFEST_LOADED,P.a.FRAG_LOADED,P.a.LEVEL_SWITCHING,P.a.INIT_PTS_FOUND));if(t.hls=e,t.config=e.config,t.enabled=!0,t.Cues=e.config.cueHandler,t.textTracks=[],t.tracks=[],t.unparsedVttFrags=[],t.initPTS=void 0,t.cueRanges=[],t.config.enableCEA708Captions){var i=new ct(t,1),n=new ct(t,2);t.cea608Parser=new ut(0,i,n)}return t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,r),s.prototype.addCues=function(e,t,i,n){for(var r=this.cueRanges,s=!1,a=r.length;a--;){var o=r[a],l=(u=o[0],c=o[1],h=t,d=i,Math.min(c,d)-Math.max(u,h));if(0<=l&&(o[0]=Math.min(o[0],t),o[1]=Math.max(o[1],i),s=!0,.5<l/(i-t)))return}var u,c,h,d;s||r.push([t,i]),this.Cues.newCue(this[e],t,i,n)},s.prototype.onInitPtsFound=function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(e){t.onFragLoaded(e)}),this.unparsedVttFrags=[])},s.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var n=t.textTracks[i];if(!0===n["textTrack"+e])return n}return null},s.prototype.sendAddTrackEvent=function(e,t){var i=null;try{i=new window.Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)},s.prototype.createCaptionsTrack=function(e){var t="textTrack"+e;if(!this[t]){var i=this.getExistingTrack(e);if(i)this[t]=i,E(this[t]),this.sendAddTrackEvent(this[t],this.media);else{var n=this.createTextTrack("captions",this.config["captionsTextTrack"+e+"Label"],this.config.captionsTextTrack1LanguageCode);n&&(n[t]=!0,this[t]=n)}}},s.prototype.createTextTrack=function(e,t,i){var n=this.media;if(n)return n.addTextTrack(e,t,i)},s.prototype.destroy=function(){C.prototype.destroy.call(this)},s.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},s.prototype.onMediaDetaching=function(){E(this.textTrack1),E(this.textTrack2)},s.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},s.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)E(t[i])}},s.prototype.onManifestLoaded=function(e){var a=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var o=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var i,n,r=void 0;if(t<o.length){var s=o[t];(n=e,(i=s)&&i.label===n.name&&!i.textTrack1&&!i.textTrack2)&&(r=s)}r||(r=a.createTextTrack("subtitles",e.name,e.lang)),r.mode=e["default"]?"showing":"hidden",a.textTracks.push(r)})}},s.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},s.prototype.onFragLoaded=function(e){var t=e.frag,i=e.payload;if("main"===t.type){var n=t.sn;if(n!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=n}else if("subtitle"===t.type)if(i.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var s=t.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(t,i)}else this.hls.trigger(P.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},s.prototype._parseVTTs=function(t,e){var i=this.vttCCs;i[t.cc]||(i[t.cc]={start:t.start,prevCC:this.prevCC,"new":!0},this.prevCC=t.cc);var n=this.textTracks,r=this.hls;ft.parse(e,this.initPTS,i,t.cc,function(e){var i=n[t.trackId];e.forEach(function(e){if(!i.cues.getCueById(e.id))try{i.addCue(e)}catch(n){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,i.addCue(t)}}),r.trigger(P.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){F.b.log("Failed to parse VTT cue: "+e),r.trigger(P.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},s.prototype.onFragDecrypted=function(e){var t=e.payload,i=e.frag;if("subtitle"===i.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);this._parseVTTs(i,t)}},s.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var i=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,i)}},s.prototype.extractCea608Data=function(e){for(var t,i,n,r=31&e[0],s=2,a=[],o=0;o<r;o++)t=e[s++],i=127&e[s++],n=127&e[s++],0===i&&0===n||0!=(4&t)&&0===(3&t)&&(a.push(i),a.push(n));return a},s}(C),mt=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),gt=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHED,P.a.MEDIA_DETACHING,P.a.MANIFEST_LOADING,P.a.MANIFEST_LOADED,P.a.SUBTITLE_TRACK_LOADED));return t.tracks=[],t.trackId=-1,t.media=void 0,t.subtitleDisplay=!1,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=b(this.media.textTracks),i=0;i<t.length;i++)"showing"===t[i].mode&&(e=i);this.subtitleTrack=e}},n.prototype.destroy=function(){C.prototype.destroy.call(this)},n.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},n.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},n.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},n.prototype.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.trackId=-1,this.hls.trigger(P.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach(function(e){e["default"]&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},n.prototype.onTick=function(){var e=this.trackId,t=this.tracks[e];if(t){var i=t.details;void 0!==i&&!0!==i.live||(F.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(P.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}},n.prototype.onSubtitleTrackLoaded=function(e){var t=this;e.id<this.tracks.length&&(F.b.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},n.prototype.setSubtitleTrackInternal=function(e){if(!(e<-1||e>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var t=b(this.media.textTracks);if(-1!==this.trackId&&this.subtitleDisplay&&(t[this.trackId].mode="hidden"),this.trackId=e,F.b.log("switching to subtitle track "+e),this.hls.trigger(P.a.SUBTITLE_TRACK_SWITCH,{id:e}),-1!==e){var i=this.tracks[e];this.subtitleDisplay&&(t[e].mode="showing");var n=i.details;void 0!==n&&!0!==n.live||(F.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(P.a.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))}}},mt(n,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&this.setSubtitleTrackInternal(e)}}]),n}(C),vt=i(4),yt="STOPPED",Et="IDLE",bt="KEY_LOADING",Tt="FRAG_LOADING",wt=function(i){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,e,P.a.MEDIA_ATTACHED,P.a.ERROR,P.a.KEY_LOADED,P.a.FRAG_LOADED,P.a.SUBTITLE_TRACKS_UPDATED,P.a.SUBTITLE_TRACK_SWITCH,P.a.SUBTITLE_TRACK_LOADED,P.a.SUBTITLE_FRAG_PROCESSED));return t.config=e.config,t.vttFragSNsProcessed={},t.vttFragQueues=void 0,t.currentlyProcessing=null,t.state=yt,t.currentTrackId=-1,t.ticks=0,t.decrypter=new vt.a(e.observer,e.config),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i),n.prototype.destroy=function(){C.prototype.destroy.call(this),this.state=yt},n.prototype.clearVttFragQueues=function(){var t=this;this.vttFragQueues={},this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})},n.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&-1<this.currentTrackId&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=e,this.hls.trigger(P.a.FRAG_LOADING,{frag:e}),this.state=Tt}},n.prototype.onSubtitleFragProcessed=function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.state=Et,this.nextFrag()},n.prototype.onMediaAttached=function(){this.state=Et},n.prototype.onError=function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},n.prototype.tick=function(){var e=this;1==++this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(function(){e.tick()},1),this.ticks=0)},n.prototype.doTick=function(){var n=this;switch(this.state){case Et:var e,t=this.tracks,r=this.currentTrackId,s=this.vttFragSNsProcessed[r],a=this.vttFragQueues[r],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1;if(!t)break;if(r<t.length&&(e=t[r].details),void 0===e)break;e.fragments.forEach(function(e){(i=e,-1<s.indexOf(i.sn))||e.sn===o||(t=e,a.some(function(e){return e.sn===t.sn}))||(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key?(F.b.log("Loading key for "+e.sn),n.state=bt,n.hls.trigger(P.a.KEY_LOADING,{frag:e})):(e.trackId=r,a.push(e),n.nextFrag()));var t,i})}},n.prototype.onSubtitleTracksUpdated=function(e){var t=this;F.b.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(e){t.vttFragSNsProcessed[e.id]=[]})},n.prototype.onSubtitleTrackSwitch=function(e){this.currentTrackId=e.id,this.clearVttFragQueues()},n.prototype.onSubtitleTrackLoaded=function(){this.tick()},n.prototype.onKeyLoaded=function(){this.state===bt&&(this.state=Et,this.tick())},n.prototype.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,n=e.frag,r=this.hls;if(this.state===Tt&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&null!=i&&null!=i.key&&"AES-128"===i.method){var s;try{s=performance.now()}catch(e){s=Date.now()}this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,function(e){var t;try{t=performance.now()}catch(e){t=Date.now()}r.trigger(P.a.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:s,tdecrypt:t}})})}},n}(C),St={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ce,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:Ee,bufferController:Te,capLevelController:Se,fpsController:_e,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0};St.subtitleStreamController=wt,St.subtitleTrackController=gt,St.timelineController=pt,St.cueHandler=T,St.enableCEA708Captions=!0,St.enableWebVTT=!0,St.captionsTextTrack1Label="English",St.captionsTextTrack1LanguageCode="en",St.captionsTextTrack2Label="Spanish",St.captionsTextTrack2LanguageCode="es",St.audioStreamController=Ge,St.audioTrackController=xe;var _t=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Ct=function(){function y(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);var i=y.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in i)n in e||(e[n]=i[n]);if(void 0!==e.liveMaxLatencyDurationCount&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||void 0===e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(F.a)(e.debug),this.config=e,this._autoLevelCapping=-1;var r=this.observer=new Y.a;r.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.emit.apply(r,[e,e].concat(i))},r.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];r.removeListener.apply(r,[e].concat(i))},this.on=r.on.bind(r),this.off=r.off.bind(r),this.trigger=r.trigger.bind(r);var s=this.abrController=new e.abrController(this),a=new e.bufferController(this),o=new e.capLevelController(this),l=new e.fpsController(this),u=new V(this),c=new H(this),h=new j(this),d=new me(this),f=[this.levelController=new fe(this),this.streamController=new he(this)],p=e.audioStreamController;p&&f.push(new p(this)),this.networkControllers=f;var m=[u,c,h,s,a,o,l,d];if(p=e.audioTrackController){var g=new p(this);this.audioTrackController=g,m.push(g)}if(p=e.subtitleTrackController){var v=new p(this);this.subtitleTrackController=v,m.push(v)}[e.subtitleStreamController,e.timelineController].forEach(function(e){e&&m.push(new e(t))}),this.coreComponents=m}return y.isSupported=function(){return e=s(),t=window.SourceBuffer||window.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!i&&!!n;var e,t,i,n},_t(y,null,[{key:"version",get:function(){return"0.8.9"}},{key:"Events",get:function(){return P.a}},{key:"ErrorTypes",get:function(){return I.b}},{key:"ErrorDetails",get:function(){return I.a}},{key:"DefaultConfig",get:function(){return y.defaultConfig?y.defaultConfig:St},set:function(e){y.defaultConfig=e}}]),y.prototype.destroy=function(){F.b.log("destroy"),this.trigger(P.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},y.prototype.attachMedia=function(e){F.b.log("attachMedia"),this.media=e,this.trigger(P.a.MEDIA_ATTACHING,{media:e})},y.prototype.detachMedia=function(){F.b.log("detachMedia"),this.trigger(P.a.MEDIA_DETACHING),this.media=null},y.prototype.loadSource=function(e){e=S.a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),F.b.log("loadSource:"+e),this.url=e,this.trigger(P.a.MANIFEST_LOADING,{url:e})},y.prototype.startLoad=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;F.b.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},y.prototype.stopLoad=function(){F.b.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},y.prototype.swapAudioCodec=function(){F.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},y.prototype.recoverMediaError=function(){F.b.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},_t(y,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){F.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){F.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){F.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){F.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){F.b.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){F.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,n=0;n<i;n++)if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),y}();t["default"]=Ct},function(e,t,l){function u(e){var t=[],i=e.toString(),n=i.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!n)return t;for(var r,s=n[1],a=new RegExp("(\\\\n|\\W)"+(s+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\w|/|@]+).*?\\)","g");r=a.exec(i);)t.push(r[3]);return t}e.exports=function(e,t){t=t||{};var i=l.m,n=t.all?Object.keys(i):function(e,t){for(var i=[t],n=[],r={};i.length;){var s=i.pop();if(!r[s]&&e[s]){r[s]=!0,n.push(s);var a=u(e[s]);i=i.concat(a)}}return n}(i,e),r="("+function(i){function n(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var r={};n.m=i,n.c=r,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw e};var e=n(n.s=ENTRY_MODULE);return e["default"]||e}.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.map(function(e){return JSON.stringify(e)+": "+i[e].toString()}).join(",")+"})(self);",s=new window.Blob([r],{type:"text/javascript"});if(t.bare)return s;var a=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(s),o=new window.Worker(a);return o.objectURL=a,o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(7),o=i(1),l=i(0),n=i(5),u=i.n(n);t["default"]=function(r){var s=new u.a;s.trigger=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];s.emit.apply(s,[e,e].concat(i))},s.off=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];s.removeListener.apply(s,[e].concat(i))};var n=function(e,t){r.postMessage({event:e,data:t})};r.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var i=JSON.parse(t.config);r.demuxer=new a.a(s,t.typeSupported,i,t.vendor);try{Object(l.a)(!0===i.debug)}catch(r){}n("init",null);break;case"demux":r.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS)}}),s.on(o.a.FRAG_DECRYPTED,n),s.on(o.a.FRAG_PARSING_INIT_SEGMENT,n),s.on(o.a.FRAG_PARSED,n),s.on(o.a.ERROR,n),s.on(o.a.FRAG_PARSING_METADATA,n),s.on(o.a.FRAG_PARSING_USERDATA,n),s.on(o.a.INIT_PTS_FOUND,n),s.on(o.a.FRAG_PARSING_DATA,function(e,t){var i=[],n={event:e,data:t};t.data1&&(n.data1=t.data1.buffer,i.push(t.data1.buffer),delete t.data1),t.data2&&(n.data2=t.data2.buffer,i.push(t.data2.buffer),delete t.data2),r.postMessage(n,i)})}}])["default"]});